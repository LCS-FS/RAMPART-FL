2025-08-04 20:30:06,085 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:06,085 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:06,085 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:06,086 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:06,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:06,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:06,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:06,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:06,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:06,686 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:06,686 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:06,818 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:06,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:06,829 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:06,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:06,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:06,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:06,849 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:06,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:06,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:06,860 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:06,863 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,866 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:06,868 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:06,871 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:06,873 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:06,876 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,878 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:06,881 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:06,883 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:06,885 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:06,895 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:06,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:06,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:06,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:06,907 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:06,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:06,920 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:06,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:06,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:06,941 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:06,948 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:06,961 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:06,961 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:06,961 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:06,961 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:06,961 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:06,962 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:06,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:06,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:06,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:06,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:06,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:06,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:06,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:06,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:06,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:06,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:06,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:06,966 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:06,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:06,966 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:06,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:06,966 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:06,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:06,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:06,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:06,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:06,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:06,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:06,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:06,968 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:06,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:06,969 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:06,969 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:06,969 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:06,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:06,970 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:06,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:06,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:06,978 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:06,978 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:06,980 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:06,980 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:06,982 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:06,982 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:06,982 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:06,983 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:07,002 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3471, Threshold=0.3654, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:07,003 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3471
2025-08-04 20:30:15,252 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:15,252 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:15,253 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:15,253 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:15,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:15,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:15,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:15,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:15,583 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:15,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:15,616 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:15,704 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:15,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:15,709 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:15,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:15,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:15,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:15,719 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:15,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:15,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:15,727 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:15,730 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:15,732 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:15,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:15,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:15,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:15,742 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:15,744 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:15,747 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:15,749 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:15,751 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:15,760 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:15,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:15,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:15,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:15,771 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:15,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:15,783 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:15,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:15,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:15,799 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:15,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:15,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:15,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:15,811 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:15,811 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:15,811 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:15,812 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:15,812 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:15,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:15,812 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:15,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:15,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:15,814 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:15,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:15,814 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:15,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:15,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:15,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:15,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:15,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:15,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:15,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:15,816 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:15,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:15,816 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:15,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:15,816 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:15,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:15,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:15,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:15,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:15,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:15,818 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:15,818 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:15,818 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:15,818 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:15,818 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:15,818 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:15,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:15,825 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:15,825 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:15,826 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:15,826 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:15,827 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 42/400.
2025-08-04 20:30:15,928 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:15,928 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:15,930 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:30:15,930 - ClientAppLogger [Client 5] - INFO - [Client] Round 42: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:30:15,930 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:15,957 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0877, Avg D Loss: 0.9188
2025-08-04 20:30:15,957 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0877, Avg D Loss: 0.9188
2025-08-04 20:30:15,957 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:15,972 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3399, Threshold=0.3569, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:15,972 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:30:15,972 - ClientAppLogger [Client 5] - INFO - Fit completed for round 42. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 42, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0876846313476562, 'd_loss': 0.91881063580513, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.1450798511505127, 'cpu_percent_fit': 46.8375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:30:15,973 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:30:21,244 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:21,244 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:21,244 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:21,245 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:21,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:21,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:21,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:21,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:21,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:21,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:21,745 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:21,868 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:21,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:21,878 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:21,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:21,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:21,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:21,901 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:21,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:21,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:21,910 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:21,914 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,916 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:21,919 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:21,922 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:21,924 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:21,927 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,930 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:21,934 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:21,936 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:21,939 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:21,949 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:21,949 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:21,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:21,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:21,960 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:21,960 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:21,971 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:21,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:21,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:21,989 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:21,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:22,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:22,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:22,003 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:22,003 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:22,003 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:22,004 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:22,004 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:22,004 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:22,006 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:22,006 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:22,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:22,007 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:22,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:22,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:22,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:22,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:22,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:22,009 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:22,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:22,009 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:22,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:22,009 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:22,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:22,011 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:22,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:22,018 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:22,018 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:22,019 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:22,019 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:22,021 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:22,021 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:22,021 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:22,022 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:22,041 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3369, Threshold=0.3551, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:22,041 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3369
2025-08-04 20:30:27,301 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:27,301 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:27,301 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:27,301 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:27,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:27,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:27,529 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:27,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:27,613 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:27,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:27,648 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:27,733 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:27,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:27,738 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:27,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:27,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:27,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:27,748 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:27,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:27,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:27,756 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:27,759 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:27,761 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:27,763 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:27,766 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:27,768 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:27,770 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:27,772 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:27,775 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:27,777 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:27,779 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:27,788 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:27,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:27,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:27,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:27,797 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:27,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:27,806 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:27,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:27,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:27,821 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:27,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:27,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:27,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:27,830 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:27,830 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:27,831 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:27,831 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:27,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:27,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:27,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:27,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:27,833 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:27,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:27,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:27,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:27,835 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:27,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:27,835 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:27,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:27,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:27,837 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:27,837 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:27,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:27,837 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:27,837 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:27,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:27,841 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:27,841 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:27,842 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:27,842 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:27,844 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 43/400.
2025-08-04 20:30:27,945 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:27,945 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:27,946 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:30:27,947 - ClientAppLogger [Client 5] - INFO - [Client] Round 43: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:30:27,947 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:27,971 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.8990
2025-08-04 20:30:27,971 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.8990
2025-08-04 20:30:27,971 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:27,985 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3324, Threshold=0.3493, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:27,985 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:30:27,986 - ClientAppLogger [Client 5] - INFO - Fit completed for round 43. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 43, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0829596281051637, 'd_loss': 0.8989767789840698, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.1412665843963623, 'cpu_percent_fit': 46.54375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:30:27,986 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:30:33,274 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:33,274 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:33,274 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:33,274 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:33,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:33,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:33,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:33,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:33,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:33,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:33,813 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:33,937 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:33,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:33,946 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:33,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:33,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:33,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:33,963 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:33,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:33,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:33,973 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:33,976 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,979 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:33,981 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:33,984 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:33,986 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:33,989 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,991 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:33,994 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:33,996 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:33,998 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:34,009 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:34,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:34,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:34,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:34,022 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:34,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:34,037 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:34,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:34,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:34,056 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:34,062 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:34,078 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:34,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:34,079 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:34,079 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:34,079 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:34,080 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:34,080 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:34,080 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:34,080 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:34,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:34,082 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:34,082 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:34,083 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:34,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:34,083 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:34,083 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:34,084 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:34,084 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:34,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:34,084 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:34,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:34,085 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:34,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:34,085 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:34,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:34,085 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:34,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:34,086 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:34,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:34,086 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:34,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:34,086 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:34,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:34,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:34,095 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:34,096 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:34,097 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:34,097 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:34,099 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:34,099 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:34,100 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:34,101 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:34,120 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3445, Threshold=0.3626, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:34,120 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3445
2025-08-04 20:30:42,373 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:42,374 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:42,374 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:42,374 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:42,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:42,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:42,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:42,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:42,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:42,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:42,782 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:42,867 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:42,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:42,872 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:42,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:42,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:42,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:42,884 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:42,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:42,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:42,892 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:42,895 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:42,897 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:42,899 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:42,902 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:42,904 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:42,907 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:42,909 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:42,912 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:42,913 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:42,915 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:42,924 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:42,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:42,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:42,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:42,934 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:42,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:42,944 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:42,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:42,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:42,959 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:42,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:42,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:42,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:42,969 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:42,969 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:42,969 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:42,969 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:42,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:42,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:42,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:42,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:42,971 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:42,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:42,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:42,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:42,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:42,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:42,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:42,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:42,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:42,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:42,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:42,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:42,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:42,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:42,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:42,975 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:42,975 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:42,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:42,975 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:42,975 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:42,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:42,982 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:42,982 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:42,984 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:42,984 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:42,985 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 44/400.
2025-08-04 20:30:43,086 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:43,086 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:43,087 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:30:43,088 - ClientAppLogger [Client 5] - INFO - [Client] Round 44: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:30:43,088 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:43,112 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.9026
2025-08-04 20:30:43,112 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.9026
2025-08-04 20:30:43,114 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:43,128 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3377, Threshold=0.3544, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:43,128 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:30:43,128 - ClientAppLogger [Client 5] - INFO - Fit completed for round 44. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 44, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0838425397872924, 'd_loss': 0.9025722444057465, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.143204927444458, 'cpu_percent_fit': 46.04375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:30:43,129 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:30:48,412 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:48,412 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:48,412 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:48,412 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:48,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:48,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:48,951 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:48,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:48,995 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:49,134 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:49,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:49,144 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:49,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:49,158 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:49,158 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:49,159 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:49,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:49,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:49,168 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:49,172 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,175 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:49,178 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:49,181 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:49,183 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:49,186 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,189 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:49,193 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:49,196 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:49,199 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:49,214 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:49,214 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:49,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:49,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:49,226 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:49,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:49,238 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:49,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:49,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:49,256 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:49,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:49,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:49,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:49,272 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:49,272 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:49,273 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:49,273 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:49,273 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:49,273 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:49,274 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:49,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:49,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:49,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:49,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:49,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:49,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:49,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:49,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:49,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:49,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:49,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:49,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:49,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:49,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:49,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:49,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:49,279 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:49,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:49,279 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:49,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:49,279 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:49,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:49,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:49,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:49,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:49,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:49,281 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:49,281 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:49,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:49,287 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:49,287 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:49,289 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:49,289 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:49,291 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:49,291 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:49,291 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:49,292 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:49,313 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3354, Threshold=0.3532, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:49,313 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3354
2025-08-04 20:30:57,578 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:57,578 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:30:57,578 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:30:57,578 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:30:57,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:30:57,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:57,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:57,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:57,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:30:57,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:30:57,921 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:58,010 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:58,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:58,016 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:58,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:30:58,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:58,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:30:58,027 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:58,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:58,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:30:58,036 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:58,039 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:58,041 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:58,043 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:58,046 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:58,048 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:58,051 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:58,054 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:58,056 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:58,058 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:58,061 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:58,069 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:58,069 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:30:58,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:30:58,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:30:58,079 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:58,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:30:58,088 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:58,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:30:58,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:58,103 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:58,107 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:30:58,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:30:58,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:58,115 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:58,115 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:58,115 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:58,116 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:58,116 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:30:58,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:58,116 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:30:58,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:58,118 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:30:58,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:30:58,118 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:58,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:30:58,118 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:58,118 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:58,119 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:58,119 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:30:58,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:30:58,119 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:30:58,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:30:58,119 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:30:58,120 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:30:58,120 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:30:58,120 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:30:58,120 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:30:58,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:30:58,121 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:30:58,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:30:58,121 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:58,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:30:58,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:30:58,127 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:30:58,127 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:58,128 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:58,129 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:30:58,130 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 45/400.
2025-08-04 20:30:58,231 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:58,232 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:58,233 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:30:58,233 - ClientAppLogger [Client 5] - INFO - [Client] Round 45: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:30:58,234 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:58,262 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0805, Avg D Loss: 0.8163
2025-08-04 20:30:58,262 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0805, Avg D Loss: 0.8163
2025-08-04 20:30:58,263 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:58,279 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3248, Threshold=0.3408, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:30:58,280 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:30:58,280 - ClientAppLogger [Client 5] - INFO - Fit completed for round 45. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 45, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080525827407837, 'd_loss': 0.816265857219696, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.1499619483947754, 'cpu_percent_fit': 46.225, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:30:58,280 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:31:06,587 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:06,587 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:31:06,587 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:31:06,587 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:31:06,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:31:06,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:07,035 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:07,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:07,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:31:07,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:31:07,186 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:07,332 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:07,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:07,340 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:07,347 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:31:07,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:07,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:31:07,358 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:07,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:07,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:31:07,367 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:07,370 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,373 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:07,375 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:07,378 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:07,380 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:07,383 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,386 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:07,389 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:07,391 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:07,394 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:07,404 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:07,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:31:07,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:31:07,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:31:07,417 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:07,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:31:07,432 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:07,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:31:07,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:07,447 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:07,452 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:31:07,457 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:31:07,457 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:07,457 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:07,457 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:07,458 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:07,458 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:07,458 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:31:07,458 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:07,459 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:31:07,459 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:07,461 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:31:07,461 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:31:07,461 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:07,461 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:31:07,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:31:07,463 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:31:07,463 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:31:07,463 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:31:07,463 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:31:07,463 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:31:07,463 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:31:07,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:31:07,464 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:31:07,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:07,464 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:31:07,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:07,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:07,465 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:07,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:31:07,465 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:31:07,465 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:31:07,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:31:07,475 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:31:07,475 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:07,477 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:07,477 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:31:07,479 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:07,479 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:07,479 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:07,479 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:07,494 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3430, Threshold=0.3602, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:31:07,495 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3430
2025-08-04 20:31:12,749 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:12,749 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:31:12,749 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:31:12,749 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:31:12,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:31:12,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:13,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:13,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:13,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:31:13,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:31:13,122 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:13,207 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:13,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:13,212 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:13,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:31:13,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:13,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:31:13,223 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:13,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:13,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:31:13,231 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:13,234 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:13,236 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:13,239 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:13,241 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:13,244 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:13,246 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:13,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:13,251 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:13,253 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:13,256 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:13,265 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:13,265 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:31:13,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:31:13,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:31:13,274 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:13,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:31:13,282 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:13,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:31:13,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:13,298 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:13,303 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:31:13,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:31:13,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:13,310 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:13,310 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:13,311 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:13,311 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:13,311 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:31:13,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:13,311 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:31:13,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:13,313 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:31:13,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:31:13,313 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:13,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:31:13,314 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:31:13,315 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:31:13,315 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:31:13,315 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:31:13,315 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:31:13,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:31:13,316 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:31:13,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:31:13,316 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:13,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:31:13,317 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:13,317 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:13,317 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:13,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:31:13,317 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:31:13,317 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:31:13,318 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:31:13,324 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:31:13,324 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:13,325 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:13,325 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:31:13,327 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 46/400.
2025-08-04 20:31:13,428 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:13,428 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:13,429 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:31:13,429 - ClientAppLogger [Client 5] - INFO - [Client] Round 46: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:31:13,430 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:13,453 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0816, Avg D Loss: 0.8189
2025-08-04 20:31:13,454 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0816, Avg D Loss: 0.8189
2025-08-04 20:31:13,454 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:13,468 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3314, Threshold=0.3468, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:31:13,469 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:31:13,470 - ClientAppLogger [Client 5] - INFO - Fit completed for round 46. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 46, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.081601119041443, 'd_loss': 0.8188817381858826, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14275455474853516, 'cpu_percent_fit': 46.2, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:31:13,470 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:31:21,731 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:21,731 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:31:21,732 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:31:21,732 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:31:21,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:31:21,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:22,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:22,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:22,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:31:22,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:31:22,229 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:22,366 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:22,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:22,374 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:22,381 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:31:22,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:22,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:31:22,391 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:22,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:22,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:31:22,402 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:22,405 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,408 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:22,410 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:22,413 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:22,415 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:22,418 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,421 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:22,424 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:22,426 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:22,428 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:22,442 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:22,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:31:22,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:31:22,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:31:22,455 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:22,455 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:31:22,466 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:22,467 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:31:22,467 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:22,484 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:22,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:31:22,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:31:22,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:22,497 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:22,497 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:22,497 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:22,497 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:22,498 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:31:22,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:22,498 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:31:22,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:22,500 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:31:22,500 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:31:22,500 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:22,500 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:31:22,500 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:22,500 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:31:22,501 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:22,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:31:22,503 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:22,503 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:22,503 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:22,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:31:22,503 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:31:22,504 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:31:22,504 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:31:22,511 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:31:22,511 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:22,513 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:22,513 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:31:22,514 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:22,514 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:22,514 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:22,515 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:22,533 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3450, Threshold=0.3627, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:31:22,533 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3450
2025-08-04 20:31:33,791 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:33,791 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:31:33,791 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:31:33,791 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:31:33,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:31:33,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:34,152 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:34,152 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:34,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:31:34,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:31:34,271 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:34,412 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:34,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:34,419 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:34,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:31:34,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:34,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:31:34,433 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:34,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:34,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:31:34,444 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:34,448 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,451 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:34,454 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:34,458 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:34,460 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:34,463 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,466 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:34,469 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:34,471 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:34,474 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:34,486 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:34,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:31:34,493 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:31:34,493 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:31:34,499 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:34,499 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:31:34,513 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:34,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:31:34,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:34,529 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:34,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:31:34,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:31:34,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:34,546 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:34,547 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:34,547 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:34,547 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:34,547 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:31:34,548 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:34,548 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:31:34,548 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:34,550 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:31:34,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:31:34,550 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:34,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:31:34,550 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:34,550 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:34,551 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:34,551 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:31:34,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:31:34,551 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:31:34,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:31:34,551 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:31:34,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:31:34,552 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:31:34,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:31:34,552 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:31:34,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:31:34,553 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:31:34,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:31:34,553 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:34,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:31:34,553 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:34,554 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:34,554 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:34,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:31:34,554 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:31:34,554 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:31:34,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:31:34,560 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:31:34,560 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:34,561 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:34,561 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:31:34,563 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:34,563 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:34,563 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:34,564 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:34,580 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3244, Threshold=0.3411, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:31:34,580 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3244
2025-08-04 20:31:39,841 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:39,841 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:31:39,842 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:31:39,842 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:31:39,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:31:39,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:40,108 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:40,109 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:40,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:31:40,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:31:40,207 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:40,301 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:40,306 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:40,307 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:40,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:31:40,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:40,318 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:31:40,318 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:40,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:40,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:31:40,329 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:40,331 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:40,334 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:40,336 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:40,339 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:40,341 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:40,344 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:40,346 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:40,349 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:40,351 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:40,353 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:40,362 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:40,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:31:40,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:31:40,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:31:40,372 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:40,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:31:40,380 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:40,380 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:31:40,380 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:40,396 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:40,400 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:31:40,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:31:40,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:40,405 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:40,405 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:40,405 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:40,405 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:40,406 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:31:40,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:40,406 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:31:40,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:40,408 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:31:40,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:31:40,408 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:40,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:31:40,409 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:31:40,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:31:40,410 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:31:40,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:31:40,410 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:31:40,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:31:40,411 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:31:40,411 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:31:40,411 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:40,411 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:31:40,411 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:40,412 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:40,412 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:40,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:31:40,412 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:31:40,412 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:31:40,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:31:40,416 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:31:40,416 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:40,417 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:40,417 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:31:40,419 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 48/400.
2025-08-04 20:31:40,520 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:40,521 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:40,522 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:31:40,522 - ClientAppLogger [Client 5] - INFO - [Client] Round 48: Training GAN with 11 samples (9 normal, 2 anomalous).
2025-08-04 20:31:40,522 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:40,548 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0840, Avg D Loss: 0.8590
2025-08-04 20:31:40,549 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0840, Avg D Loss: 0.8590
2025-08-04 20:31:40,549 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:40,565 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3178, Threshold=0.3330, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:31:40,565 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:31:40,566 - ClientAppLogger [Client 5] - INFO - Fit completed for round 48. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 48, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0839683055877685, 'd_loss': 0.8590017914772033, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.1465613842010498, 'cpu_percent_fit': 47.0125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11}
2025-08-04 20:31:40,566 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:31:48,851 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:48,851 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:31:48,851 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:31:48,852 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:31:48,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:31:48,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:49,247 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:49,247 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:49,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:31:49,371 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:31:49,371 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:49,536 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:49,543 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:49,543 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:49,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:31:49,560 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:49,560 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:31:49,561 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:49,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:49,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:31:49,570 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:49,574 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,576 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:49,579 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:49,582 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:49,584 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:49,587 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,590 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:49,593 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:49,596 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:49,598 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:49,609 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:49,609 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:31:49,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:31:49,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:31:49,623 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:49,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:31:49,638 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:49,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:31:49,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:49,661 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:49,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:31:49,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:31:49,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:49,676 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:49,677 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:49,677 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:49,677 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:49,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:31:49,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:49,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:31:49,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:49,680 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:31:49,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:31:49,680 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:49,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:31:49,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:49,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:49,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:49,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:31:49,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:31:49,682 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:31:49,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:31:49,682 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:31:49,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:31:49,683 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:31:49,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:31:49,683 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:31:49,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:31:49,683 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:31:49,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:31:49,684 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:49,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:31:49,684 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:49,684 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:49,684 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:49,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:31:49,685 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:31:49,685 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:31:49,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:31:49,691 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:31:49,691 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:49,692 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:49,692 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:31:49,694 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:49,694 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:49,694 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:49,695 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:49,712 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3444, Threshold=0.3632, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:31:49,713 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3444
2025-08-04 20:32:03,993 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:03,993 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:03,993 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:03,993 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:03,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:03,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:04,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:04,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:04,427 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:04,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:04,476 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:04,612 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:04,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:04,621 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:04,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:04,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:04,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:04,647 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:04,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:04,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:04,660 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:04,663 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,666 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:04,668 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:04,672 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:04,674 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:04,677 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,679 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:04,682 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:04,684 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:04,687 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:04,699 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:04,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:04,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:04,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:04,713 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:04,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:04,728 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:04,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:04,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:04,747 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:04,752 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:04,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:04,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:04,762 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:04,762 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:04,763 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:04,763 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:04,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:04,763 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:04,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:04,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:04,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:04,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:04,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:04,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:04,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:04,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:04,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:04,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:04,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:04,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:04,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:04,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:04,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:04,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:04,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:04,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:04,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:04,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:04,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:04,772 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:04,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:04,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:04,776 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:04,777 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:04,778 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:04,778 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:04,780 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:04,780 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:04,780 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:04,781 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:04,801 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3480, Threshold=0.3726, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:04,802 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3480
2025-08-04 20:32:10,060 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:10,060 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:10,060 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:10,060 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:10,060 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:10,060 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:10,337 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:10,337 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:10,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:10,454 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:10,455 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:10,541 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:10,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:10,546 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:10,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:10,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:10,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:10,556 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:10,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:10,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:10,565 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:10,567 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:10,570 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:10,572 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:10,575 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:10,577 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:10,580 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:10,582 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:10,585 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:10,587 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:10,589 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:10,597 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:10,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:10,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:10,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:10,607 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:10,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:10,615 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:10,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:10,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:10,630 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:10,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:10,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:10,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:10,640 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:10,640 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:10,640 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:10,641 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:10,641 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:10,641 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:10,641 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:10,641 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:10,642 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:10,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:10,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:10,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:10,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:10,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:10,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:10,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:10,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:10,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:10,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:10,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:10,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:10,646 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:10,647 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:10,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:10,650 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:10,650 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:10,651 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:10,651 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:10,653 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 50/400.
2025-08-04 20:32:10,754 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:10,754 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:10,756 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:32:10,756 - ClientAppLogger [Client 5] - INFO - [Client] Round 50: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:32:10,756 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:10,781 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.1028, Avg D Loss: 0.9329
2025-08-04 20:32:10,781 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.1028, Avg D Loss: 0.9329
2025-08-04 20:32:10,782 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:10,797 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3637, Threshold=0.3888, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:10,797 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:32:10,797 - ClientAppLogger [Client 5] - INFO - Fit completed for round 50. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 50, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.1027652978897096, 'd_loss': 0.932920640707016, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14440679550170898, 'cpu_percent_fit': 45.88125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:32:10,797 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:32:19,065 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:19,066 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:19,066 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:19,066 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:19,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:19,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:19,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:19,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:19,485 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:19,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:19,533 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:19,664 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:19,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:19,670 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:19,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:19,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:19,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:19,681 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:19,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:19,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:19,690 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:19,693 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:19,695 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:19,698 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:19,701 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:19,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:19,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:19,708 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:19,711 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:19,713 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:19,715 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:19,723 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:19,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:19,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:19,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:19,732 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:19,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:19,740 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:19,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:19,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:19,756 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:19,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:19,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:19,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:19,765 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:19,765 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:19,766 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:19,767 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:19,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:19,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:19,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:19,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:19,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:19,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:19,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:19,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:19,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:19,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:19,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:19,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:19,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:19,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:19,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:19,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:19,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:19,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:19,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:19,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:19,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:19,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:19,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:19,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:19,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:19,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:19,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:19,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:19,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:19,774 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:19,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:19,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:19,778 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:19,778 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:19,779 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:19,780 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:19,781 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:19,781 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:19,781 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:19,782 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:19,797 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3416, Threshold=0.3651, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:19,797 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3416
2025-08-04 20:32:25,044 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:25,044 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:25,045 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:25,045 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:25,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:25,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:25,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:25,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:25,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:25,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:25,393 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:25,478 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:25,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:25,485 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:25,490 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:25,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:25,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:25,495 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:25,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:25,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:25,504 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:25,507 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:25,509 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:25,511 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:25,514 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:25,516 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:25,519 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:25,521 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:25,524 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:25,526 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:25,529 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:25,537 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:25,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:25,542 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:25,543 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:25,547 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:25,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:25,554 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:25,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:25,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:25,569 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:25,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:25,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:25,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:25,579 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:25,579 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:25,580 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:25,580 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:25,580 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:25,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:25,580 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:25,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:25,582 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:25,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:25,582 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:25,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:25,583 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:25,583 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:25,583 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:25,583 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:25,583 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:25,584 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:25,585 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:25,585 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:25,585 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:25,585 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:25,585 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:25,585 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:25,586 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:25,586 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:25,586 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:25,586 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:25,586 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:25,586 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:25,590 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:25,590 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:25,591 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:25,591 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:25,593 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 51/400.
2025-08-04 20:32:25,694 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:25,694 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:25,695 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:32:25,695 - ClientAppLogger [Client 5] - INFO - [Client] Round 51: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:32:25,695 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:25,719 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0954, Avg D Loss: 0.9407
2025-08-04 20:32:25,720 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0954, Avg D Loss: 0.9407
2025-08-04 20:32:25,720 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:25,734 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3517, Threshold=0.3751, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:25,734 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:32:25,735 - ClientAppLogger [Client 5] - INFO - Fit completed for round 51. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 51, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0953779458999633, 'd_loss': 0.9407194077968597, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14124202728271484, 'cpu_percent_fit': 45.91875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:32:25,735 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:32:31,002 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:31,002 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:31,002 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:31,002 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:31,002 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:31,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:31,385 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:31,386 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:31,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:31,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:31,519 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:31,684 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:31,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:31,693 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:31,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:31,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:31,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:31,708 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:31,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:31,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:31,718 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:31,721 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,723 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:31,726 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:31,729 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:31,731 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:31,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:31,740 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:31,743 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:31,746 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:31,759 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:31,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:31,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:31,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:31,770 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:31,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:31,780 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:31,780 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:31,780 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:31,798 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:31,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:31,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:31,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:31,810 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:31,810 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:31,811 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:31,811 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:31,811 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:31,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:31,811 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:31,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:31,813 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:31,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:31,813 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:31,814 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:31,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:31,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:31,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:31,814 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:31,814 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:31,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:31,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:31,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:31,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:31,815 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:31,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:31,816 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:31,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:31,816 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:31,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:31,816 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:31,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:31,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:31,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:31,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:31,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:31,817 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:31,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:31,818 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:31,822 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:31,823 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:31,824 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:31,824 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:31,826 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:31,826 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:31,826 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:31,827 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:31,862 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3487, Threshold=0.3752, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:31,862 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3487
2025-08-04 20:32:40,118 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:40,118 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:40,118 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:40,119 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:40,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:40,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:40,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:40,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:40,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:40,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:40,555 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:40,663 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:40,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:40,668 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:40,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:40,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:40,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:40,682 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:40,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:40,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:40,691 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:40,694 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:40,696 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:40,699 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:40,701 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:40,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:40,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:40,708 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:40,711 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:40,713 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:40,715 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:40,723 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:40,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:40,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:40,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:40,734 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:40,734 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:40,745 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:40,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:40,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:40,759 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:40,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:40,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:40,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:40,769 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:40,769 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:40,769 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:40,769 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:40,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:40,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:40,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:40,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:40,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:40,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:40,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:40,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:40,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:40,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:40,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:40,775 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:40,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:40,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:40,784 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:40,784 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:40,785 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:40,785 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:40,787 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 52/400.
2025-08-04 20:32:40,888 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:40,888 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:40,889 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:32:40,889 - ClientAppLogger [Client 5] - INFO - [Client] Round 52: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:32:40,890 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:40,913 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0987, Avg D Loss: 0.9437
2025-08-04 20:32:40,914 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0987, Avg D Loss: 0.9437
2025-08-04 20:32:40,917 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:40,931 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3655, Threshold=0.3928, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:40,932 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:32:40,932 - ClientAppLogger [Client 5] - INFO - Fit completed for round 52. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 52, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0987255811691283, 'd_loss': 0.943681389093399, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14508318901062012, 'cpu_percent_fit': 45.4125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:32:40,932 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:32:46,209 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:46,209 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:32:46,210 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:32:46,210 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:32:46,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:32:46,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:46,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:46,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:46,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:32:46,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:32:46,773 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:46,880 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:46,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:46,890 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:46,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:32:46,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:46,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:32:46,904 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:46,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:46,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:32:46,914 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:46,917 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,919 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:46,921 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:46,924 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:46,927 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:46,930 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,934 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:46,940 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:46,942 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:46,945 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:46,957 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:46,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:32:46,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:32:46,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:32:46,969 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:46,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:32:46,982 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:46,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:32:46,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:46,999 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:47,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:32:47,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:32:47,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:47,012 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:47,012 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:47,013 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:47,013 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:47,013 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:32:47,013 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:47,013 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:32:47,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:47,015 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:32:47,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:32:47,015 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:47,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:32:47,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:47,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:32:47,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:32:47,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:32:47,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:32:47,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:32:47,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:32:47,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:32:47,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:32:47,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:47,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:32:47,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:47,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:47,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:47,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:32:47,020 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:32:47,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:32:47,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:32:47,024 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:32:47,024 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:47,025 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:47,026 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:32:47,027 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:47,027 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:47,027 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:47,028 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:47,044 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3595, Threshold=0.3884, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:32:47,045 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3595
2025-08-04 20:33:01,313 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:01,313 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:01,313 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:01,313 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:01,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:01,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:01,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:01,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:01,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:01,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:01,724 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:01,818 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:01,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:01,824 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:01,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:01,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:01,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:01,848 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:01,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:01,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:01,858 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:01,861 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:01,863 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:01,865 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:01,868 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:01,871 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:01,873 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:01,875 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:01,878 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:01,880 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:01,883 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:01,892 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:01,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:01,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:01,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:01,902 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:01,902 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:01,911 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:01,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:01,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:01,930 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:01,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:01,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:01,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:01,939 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:01,940 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:01,940 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:01,940 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:01,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:01,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:01,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:01,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:01,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:01,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:01,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:01,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:01,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:01,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:01,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:01,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:01,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:01,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:01,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:01,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:01,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:01,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:01,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:01,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:01,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:01,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:01,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:01,947 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:01,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:01,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:01,950 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:01,950 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:01,951 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:01,951 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:01,953 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:01,953 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:01,953 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:01,954 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:01,970 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3608, Threshold=0.3911, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:33:01,971 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3608
2025-08-04 20:33:10,235 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:10,235 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:10,235 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:10,235 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:10,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:10,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:10,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:10,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:10,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:10,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:10,647 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:10,755 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:10,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:10,761 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:10,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:10,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:10,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:10,772 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:10,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:10,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:10,780 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:10,783 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:10,785 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:10,787 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:10,790 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:10,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:10,795 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:10,798 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:10,801 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:10,803 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:10,805 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:10,814 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:10,814 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:10,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:10,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:10,824 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:10,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:10,832 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:10,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:10,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:10,847 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:10,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:10,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:10,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:10,857 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:10,857 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:10,857 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:10,858 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:10,858 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:10,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:10,858 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:10,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:10,860 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:10,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:10,860 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:10,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:10,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:10,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:10,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:10,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:10,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:10,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:10,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:10,863 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:10,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:10,863 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:10,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:10,863 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:10,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:10,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:10,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:10,864 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:10,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:10,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:10,867 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:10,868 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:10,869 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:10,869 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:10,870 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 54/400.
2025-08-04 20:33:10,971 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:10,971 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:10,973 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:33:10,973 - ClientAppLogger [Client 5] - INFO - [Client] Round 54: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:33:10,973 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:11,001 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0821, Avg D Loss: 0.8960
2025-08-04 20:33:11,002 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0821, Avg D Loss: 0.8960
2025-08-04 20:33:11,002 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:11,019 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3646, Threshold=0.3944, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:33:11,019 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:33:11,020 - ClientAppLogger [Client 5] - INFO - Fit completed for round 54. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 54, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0820870637893676, 'd_loss': 0.8959762454032898, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14927935600280762, 'cpu_percent_fit': 46.31875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:33:11,020 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:33:16,286 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:16,286 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:16,286 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:16,286 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:16,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:16,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:16,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:16,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:16,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:16,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:16,856 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:17,004 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:17,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:17,015 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:17,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:17,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:17,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:17,034 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:17,034 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:17,034 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:17,044 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:17,049 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:17,052 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:17,054 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:17,057 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:17,060 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:17,063 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:17,065 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:17,068 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:17,071 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:17,073 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:17,083 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:17,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:17,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:17,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:17,095 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:17,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:17,105 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:17,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:17,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:17,124 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:17,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:17,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:17,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:17,137 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:17,138 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:17,138 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:17,138 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:17,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:17,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:17,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:17,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:17,140 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:17,140 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:17,141 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:17,141 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:17,141 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:17,141 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:17,141 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:17,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:17,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:17,143 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:17,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:17,143 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:17,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:17,143 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:17,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:17,144 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:17,144 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:17,145 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:17,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:17,145 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:17,145 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:17,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:17,152 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:17,152 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:17,153 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:17,154 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:17,156 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:17,156 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:17,156 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:17,157 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:17,176 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3452, Threshold=0.3729, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:33:17,177 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3452
2025-08-04 20:33:31,470 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:31,471 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:31,471 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:31,471 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:31,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:31,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:31,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:31,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:32,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:32,123 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:32,126 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:32,257 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:32,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:32,264 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:32,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:32,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:32,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:32,282 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:32,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:32,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:32,292 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:32,298 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,301 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:32,303 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:32,306 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:32,308 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:32,310 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,313 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:32,316 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:32,318 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:32,320 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:32,328 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:32,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:32,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:32,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:32,338 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:32,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:32,348 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:32,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:32,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:32,363 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:32,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:32,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:32,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:32,372 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:32,372 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:32,373 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:32,373 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:32,373 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:32,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:32,374 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:32,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:32,375 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:32,375 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:32,375 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:32,375 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:32,376 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:32,377 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:32,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:32,378 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:32,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:32,378 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:32,378 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:32,378 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:32,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:32,379 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:32,379 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:32,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:32,387 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:32,387 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:32,388 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:32,389 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:32,390 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:32,390 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:32,390 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:32,391 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:32,405 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3238, Threshold=0.3466, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:33:32,405 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3238
2025-08-04 20:33:37,658 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:37,658 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:37,658 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:37,659 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:37,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:37,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:37,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:37,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:38,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:38,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:38,074 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:38,166 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:38,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:38,172 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:38,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:38,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:38,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:38,186 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:38,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:38,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:38,195 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:38,198 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:38,200 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:38,202 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:38,205 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:38,207 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:38,209 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:38,212 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:38,215 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:38,217 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:38,219 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:38,230 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:38,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:38,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:38,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:38,241 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:38,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:38,250 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:38,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:38,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:38,266 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:38,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:38,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:38,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:38,279 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:38,279 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:38,280 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:38,280 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:38,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:38,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:38,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:38,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:38,282 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:38,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:38,282 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:38,283 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:38,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:38,284 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:38,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:38,284 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:38,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:38,284 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:38,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:38,285 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:38,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:38,285 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:38,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:38,286 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:38,286 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:38,286 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:38,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:38,286 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:38,287 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:38,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:38,291 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:38,291 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:38,293 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:38,293 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:38,294 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 56/400.
2025-08-04 20:33:38,395 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:38,395 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:38,397 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:33:38,397 - ClientAppLogger [Client 5] - INFO - [Client] Round 56: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:33:38,397 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:38,428 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0888, Avg D Loss: 0.9125
2025-08-04 20:33:38,428 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0888, Avg D Loss: 0.9125
2025-08-04 20:33:38,429 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:38,443 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3423, Threshold=0.3674, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:33:38,443 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:33:38,443 - ClientAppLogger [Client 5] - INFO - Fit completed for round 56. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 56, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0888365507125854, 'd_loss': 0.9125389635562897, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14888334274291992, 'cpu_percent_fit': 46.85625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:33:38,443 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:33:46,720 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:46,720 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:46,721 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:46,721 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:46,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:46,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:47,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:47,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:47,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:47,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:47,151 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:47,250 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:47,257 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:47,258 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:47,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:47,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:47,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:47,321 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:47,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:47,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:47,335 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:47,338 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,340 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:47,342 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:47,345 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:47,351 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:47,354 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,357 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:47,360 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:47,364 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:47,367 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:47,378 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:47,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:47,383 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:47,384 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:47,389 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:47,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:47,405 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:47,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:47,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:47,424 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:47,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:47,440 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:47,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:47,441 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:47,441 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:47,442 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:47,442 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:47,442 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:47,442 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:47,443 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:47,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:47,445 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:47,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:47,446 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:47,446 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:47,446 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:47,446 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:47,447 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:47,447 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:47,447 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:47,447 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:47,447 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:47,447 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:47,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:47,448 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:47,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:47,448 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:47,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:47,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:47,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:47,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:47,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:47,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:47,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:47,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:47,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:47,450 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:47,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:47,451 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:47,457 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:47,458 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:47,459 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:47,460 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:47,461 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:47,461 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:47,462 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:47,462 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:47,486 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3599, Threshold=0.3896, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:33:47,487 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3599
2025-08-04 20:33:52,735 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:52,735 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:52,735 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:52,736 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:52,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:52,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:52,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:52,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:53,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:53,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:53,118 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:53,228 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:53,233 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:53,233 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:53,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:53,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:53,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:53,244 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:53,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:53,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:53,253 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:53,256 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:53,258 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:53,260 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:53,263 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:53,265 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:53,268 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:53,270 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:53,273 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:53,275 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:53,277 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:53,287 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:53,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:53,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:53,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:53,297 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:53,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:53,308 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:53,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:53,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:53,324 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:53,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:53,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:53,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:53,334 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:53,334 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:53,335 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:53,335 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:53,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:53,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:53,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:53,336 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:53,337 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:53,337 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:53,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:53,339 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:53,340 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:53,341 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:53,341 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:53,341 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:53,341 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:53,341 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:53,344 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:53,345 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:53,346 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:53,346 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:53,347 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 57/400.
2025-08-04 20:33:53,448 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:53,448 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:53,450 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:33:53,450 - ClientAppLogger [Client 5] - INFO - [Client] Round 57: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:33:53,450 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:33:53,477 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0887, Avg D Loss: 0.9153
2025-08-04 20:33:53,477 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0887, Avg D Loss: 0.9153
2025-08-04 20:33:53,477 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:33:53,491 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3698, Threshold=0.4003, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:33:53,492 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:33:53,492 - ClientAppLogger [Client 5] - INFO - Fit completed for round 57. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 57, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0887184143066406, 'd_loss': 0.9153117716312409, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14473748207092285, 'cpu_percent_fit': 45.35625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:33:53,492 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:33:58,739 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:58,739 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:33:58,739 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:33:58,739 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:33:58,739 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:33:58,739 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:58,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:58,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:59,076 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:33:59,111 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:33:59,111 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:59,208 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:59,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:59,217 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:59,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:33:59,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:59,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:33:59,235 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:59,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:59,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:33:59,244 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:59,247 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:59,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:59,252 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:59,255 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:59,257 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:59,260 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:59,263 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:59,265 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:59,267 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:59,269 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:59,279 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:59,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:33:59,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:33:59,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:33:59,290 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:59,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:33:59,300 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:59,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:33:59,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:59,318 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:59,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:33:59,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:33:59,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:59,339 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:59,339 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:59,340 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:59,340 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:59,340 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:33:59,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:59,341 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:33:59,341 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:59,342 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:33:59,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:33:59,343 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:59,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:33:59,343 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:33:59,344 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:33:59,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:33:59,345 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:33:59,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:33:59,345 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:33:59,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:33:59,346 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:33:59,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:33:59,346 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:59,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:33:59,347 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:59,347 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:59,347 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:59,347 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:33:59,347 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:33:59,347 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:33:59,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:33:59,352 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:33:59,353 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:59,354 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:59,354 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:33:59,356 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:59,356 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:59,356 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:59,357 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:59,372 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3553, Threshold=0.3840, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:33:59,373 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3553
2025-08-04 20:34:07,630 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:07,630 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:34:07,630 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:34:07,631 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:34:07,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:34:07,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:07,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:07,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:08,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:34:08,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:34:08,057 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:08,175 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:08,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:08,182 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:08,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:34:08,193 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:08,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:34:08,194 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:08,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:08,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:34:08,203 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:08,206 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:08,209 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:08,211 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:08,214 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:08,216 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:08,219 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:08,221 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:08,224 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:08,226 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:08,228 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:08,237 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:08,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:34:08,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:34:08,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:34:08,250 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:08,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:34:08,258 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:08,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:34:08,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:08,274 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:08,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:34:08,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:34:08,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:08,283 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:08,283 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:08,284 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:08,284 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:08,284 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:34:08,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:08,284 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:34:08,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:08,286 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:34:08,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:34:08,286 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:34:08,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:34:08,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:34:08,289 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:08,289 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:34:08,289 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:08,289 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:08,289 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:08,289 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:34:08,290 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:34:08,290 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:34:08,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:34:08,293 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:34:08,293 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:08,294 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:08,294 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:34:08,296 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 58/400.
2025-08-04 20:34:08,397 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:08,398 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:08,399 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:34:08,399 - ClientAppLogger [Client 5] - INFO - [Client] Round 58: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:34:08,399 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:08,424 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0914, Avg D Loss: 0.9143
2025-08-04 20:34:08,424 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0914, Avg D Loss: 0.9143
2025-08-04 20:34:08,424 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:08,438 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3679, Threshold=0.3980, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:34:08,439 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:34:08,440 - ClientAppLogger [Client 5] - INFO - Fit completed for round 58. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 58, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.091429853439331, 'd_loss': 0.914311307668686, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.1437079906463623, 'cpu_percent_fit': 45.7125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:34:08,440 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:34:13,728 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:13,729 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:34:13,729 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:34:13,729 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:34:13,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:34:13,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:14,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:14,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:14,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:34:14,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:34:14,222 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:14,321 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:14,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:14,327 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:14,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:34:14,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:14,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:34:14,340 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:14,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:14,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:34:14,349 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:14,352 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,355 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:14,357 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:14,360 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:14,362 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:14,365 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,367 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:14,370 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:14,372 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:14,374 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:14,383 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:14,383 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:34:14,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:34:14,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:34:14,392 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:14,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:34:14,400 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:14,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:34:14,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:14,416 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:14,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:34:14,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:34:14,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:14,426 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:14,427 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:14,427 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:14,427 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:14,427 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:34:14,427 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:14,428 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:34:14,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:14,429 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:34:14,429 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:34:14,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:34:14,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:34:14,431 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:34:14,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:34:14,431 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:34:14,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:34:14,431 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:34:14,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:34:14,432 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:34:14,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:34:14,432 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:14,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:34:14,432 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:14,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:14,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:14,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:34:14,433 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:34:14,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:34:14,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:34:14,439 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:34:14,439 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:14,440 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:14,440 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:34:14,442 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:14,442 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:14,442 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:14,442 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:14,456 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3646, Threshold=0.3940, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:34:14,456 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3646
2025-08-04 20:34:19,741 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:19,741 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:34:19,742 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:34:19,742 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:34:19,743 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:34:19,743 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:20,147 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:20,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:20,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:34:20,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:34:20,286 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:20,415 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:20,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:20,422 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:20,429 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:34:20,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:20,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:34:20,439 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:20,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:20,440 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:34:20,451 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:20,454 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:20,457 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:20,459 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:20,462 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:20,464 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:20,467 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:20,470 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:20,473 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:20,474 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:20,477 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:20,486 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:20,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:34:20,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:34:20,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:34:20,497 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:20,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:34:20,507 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:20,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:34:20,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:20,522 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:20,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:34:20,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:34:20,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:20,532 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:20,532 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:20,532 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:20,532 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:20,532 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:34:20,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:20,533 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:34:20,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:20,534 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:34:20,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:34:20,534 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:34:20,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:34:20,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:34:20,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:34:20,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:34:20,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:34:20,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:34:20,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:34:20,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:34:20,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:34:20,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:20,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:34:20,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:20,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:20,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:20,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:34:20,538 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:34:20,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:34:20,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:34:20,546 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:34:20,547 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:20,548 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:20,548 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:34:20,549 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 59/400.
2025-08-04 20:34:20,650 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:20,650 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:20,652 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:34:20,652 - ClientAppLogger [Client 5] - INFO - [Client] Round 59: Training GAN with 13 samples (10 normal, 3 anomalous).
2025-08-04 20:34:20,652 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:20,679 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0874, Avg D Loss: 0.9192
2025-08-04 20:34:20,680 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0874, Avg D Loss: 0.9192
2025-08-04 20:34:20,680 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:20,693 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3716, Threshold=0.4015, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:34:20,694 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:34:20,694 - ClientAppLogger [Client 5] - INFO - Fit completed for round 59. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 59, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0873928546905516, 'd_loss': 0.9192395508289337, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14466333389282227, 'cpu_percent_fit': 47.225, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 13}
2025-08-04 20:34:20,694 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:34:25,953 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:25,953 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:34:25,953 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:34:25,953 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:34:25,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:34:25,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:26,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:26,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:26,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:34:26,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:34:26,354 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:26,456 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:26,468 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:26,468 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:26,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:34:26,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:26,485 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:34:26,485 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:26,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:26,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:34:26,497 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:26,500 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:26,502 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:26,504 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:26,507 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:26,509 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:26,512 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:26,515 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:26,518 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:26,520 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:26,523 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:26,536 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:26,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:34:26,542 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:34:26,542 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:34:26,548 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:26,548 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:34:26,560 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:26,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:34:26,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:26,577 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:26,583 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:34:26,591 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:34:26,591 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:26,591 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:26,592 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:26,592 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:26,592 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:26,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:34:26,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:26,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:34:26,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:26,595 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:34:26,595 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:34:26,595 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:26,595 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:34:26,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:34:26,597 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:34:26,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:34:26,597 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:34:26,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:34:26,597 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:34:26,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:34:26,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:34:26,598 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:34:26,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:26,598 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:34:26,599 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:26,599 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:26,599 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:26,599 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:34:26,599 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:34:26,600 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:34:26,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:34:26,605 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:34:26,605 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:26,607 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:26,607 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:34:26,609 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:26,609 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:26,609 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:26,610 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:26,627 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3610, Threshold=0.3909, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:34:26,628 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3610
2025-08-04 20:34:40,920 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,921 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:34:40,921 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:34:40,921 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:34:40,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:34:40,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:41,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:41,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:41,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:34:41,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:34:41,421 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:41,557 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:41,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:41,563 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:41,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:34:41,577 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:41,577 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:34:41,578 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:41,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:41,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:34:41,588 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:41,594 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,596 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:41,598 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:41,601 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:41,603 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:41,606 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,609 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:41,612 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:41,614 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:41,616 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:41,624 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:41,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:34:41,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:34:41,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:34:41,636 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:41,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:34:41,647 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:41,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:34:41,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:41,662 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:41,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:34:41,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:34:41,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:41,671 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:41,671 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:41,671 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:41,672 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:41,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:34:41,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:41,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:34:41,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:41,673 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:34:41,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:34:41,674 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:41,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:34:41,674 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:41,675 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:41,675 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:41,675 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:34:41,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:34:41,675 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:34:41,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:34:41,676 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:34:41,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:34:41,676 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:34:41,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:34:41,676 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:34:41,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:34:41,677 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:34:41,677 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:34:41,677 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:41,677 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:34:41,677 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:41,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:41,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:41,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:34:41,678 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:34:41,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:34:41,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:34:41,685 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:34:41,685 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:41,686 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:41,686 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:34:41,688 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:41,688 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:41,688 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:41,689 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:41,703 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3520, Threshold=0.3789, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:34:41,704 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3520
2025-08-04 20:34:53,013 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:53,014 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:34:53,014 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:34:53,014 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:34:53,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:34:53,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:53,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:53,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:53,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:34:53,562 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:34:53,562 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:53,667 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:53,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:53,674 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:53,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:34:53,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:53,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:34:53,693 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:53,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:53,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:34:53,702 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:53,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,708 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:53,710 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:53,713 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:53,716 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:53,718 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,721 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:53,724 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:53,726 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:53,729 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:53,740 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:53,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:34:53,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:34:53,746 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:34:53,750 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:53,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:34:53,760 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:53,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:34:53,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:53,777 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:53,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:34:53,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:34:53,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,791 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,791 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,792 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,792 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,792 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:34:53,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,792 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:34:53,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:34:53,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:34:53,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:34:53,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:34:53,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:34:53,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:34:53,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:34:53,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:34:53,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:34:53,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:34:53,798 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:34:53,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:34:53,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:34:53,803 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:34:53,803 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,804 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,805 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:34:53,806 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,810 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,810 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,811 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,829 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3576, Threshold=0.3842, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:34:53,829 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3576
2025-08-04 20:35:02,097 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:02,098 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:02,098 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:02,098 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:02,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:02,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:02,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:02,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:02,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:02,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:02,551 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:02,641 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:02,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:02,646 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:02,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:02,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:02,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:02,664 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:02,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:02,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:02,674 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:02,678 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,681 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:02,683 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:02,686 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:02,689 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:02,692 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,694 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:02,697 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:02,700 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:02,702 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:02,712 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:02,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:02,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:02,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:02,723 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:02,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:02,732 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:02,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:02,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:02,748 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:02,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:02,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:02,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:02,759 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:02,759 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:02,760 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:02,760 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:02,760 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:02,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:02,760 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:02,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:02,762 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:02,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:02,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:02,763 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:02,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:02,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:02,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:02,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:02,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:02,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:02,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:02,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:02,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:02,765 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:02,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:02,765 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:02,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:02,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:02,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:02,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:02,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:02,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:02,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:02,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:02,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:02,768 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:02,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:02,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:02,770 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:02,771 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:02,772 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:02,772 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:02,774 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 62/400.
2025-08-04 20:35:02,875 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:02,875 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:02,876 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:35:02,876 - ClientAppLogger [Client 5] - INFO - [Client] Round 62: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:35:02,877 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:02,904 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0895, Avg D Loss: 0.9615
2025-08-04 20:35:02,907 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0895, Avg D Loss: 0.9615
2025-08-04 20:35:02,907 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:02,927 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3706, Threshold=0.3994, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:02,927 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:35:02,928 - ClientAppLogger [Client 5] - INFO - Fit completed for round 62. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 62, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0895060539245605, 'd_loss': 0.9614692866802216, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.1538228988647461, 'cpu_percent_fit': 47.0625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:35:02,928 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:35:08,187 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:08,187 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:08,187 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:08,187 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:08,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:08,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:08,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:08,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:08,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:08,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:08,712 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:08,848 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:08,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:08,855 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:08,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:08,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:08,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:08,873 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:08,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:08,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:08,882 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:08,885 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:08,887 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:08,889 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:08,892 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:08,894 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:08,897 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:08,900 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:08,902 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:08,905 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:08,908 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:08,920 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:08,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:08,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:08,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:08,933 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:08,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:08,951 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:08,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:08,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:08,973 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:08,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:08,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:08,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:08,987 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:08,987 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:08,988 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:08,988 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:08,988 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:08,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:08,988 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:08,989 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:08,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:08,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:08,991 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:08,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:08,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:08,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:08,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:08,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:08,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:08,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:08,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:08,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:08,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:08,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:08,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:08,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:08,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:08,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:08,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:08,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:08,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:08,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:08,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:08,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:08,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:09,001 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:09,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:09,002 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:09,006 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:09,007 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:09,008 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:09,008 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:09,010 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:09,011 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:09,011 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:09,012 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:09,029 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3636, Threshold=0.3956, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:09,029 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3636
2025-08-04 20:35:20,289 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:20,289 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:20,289 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:20,289 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:20,289 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:20,289 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:20,571 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:20,571 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:20,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:20,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:20,696 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:20,794 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:20,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:20,802 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:20,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:20,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:20,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:20,820 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:20,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:20,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:20,829 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:20,832 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:20,835 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:20,837 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:20,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:20,842 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:20,844 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:20,847 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:20,849 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:20,851 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:20,854 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:20,865 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:20,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:20,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:20,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:20,875 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:20,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:20,886 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:20,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:20,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:20,904 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:20,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:20,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:20,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:20,922 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:20,922 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:20,922 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:20,923 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:20,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:20,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:20,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:20,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:20,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:20,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:20,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:20,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:20,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:20,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:20,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:20,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:20,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:20,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:20,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:20,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:20,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:20,928 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:20,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:20,928 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:20,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:20,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:20,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:20,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:20,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:20,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:20,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:20,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:20,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:20,930 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:20,931 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:20,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:20,935 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:20,935 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:20,936 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:20,936 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:20,938 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:20,938 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:20,938 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:20,939 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:20,955 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3798, Threshold=0.4118, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:20,955 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3798
2025-08-04 20:35:29,204 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:29,204 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:29,205 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:29,205 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:29,205 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:29,205 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:29,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:29,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:29,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:29,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:29,588 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:29,696 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:29,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:29,702 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:29,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:29,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:29,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:29,711 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:29,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:29,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:29,720 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:29,722 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:29,725 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:29,727 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:29,729 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:29,732 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:29,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:29,736 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:29,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:29,741 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:29,743 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:29,752 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:29,752 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:29,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:29,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:29,761 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:29,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:29,770 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:29,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:29,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:29,785 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:29,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:29,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:29,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:29,797 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:29,797 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:29,798 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:29,798 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:29,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:29,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:29,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:29,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:29,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:29,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:29,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:29,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:29,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:29,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:29,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:29,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:29,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:29,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:29,804 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:29,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:29,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:29,809 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:29,810 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:29,811 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:29,811 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:29,812 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 64/400.
2025-08-04 20:35:29,912 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:29,913 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:29,914 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:35:29,914 - ClientAppLogger [Client 5] - INFO - [Client] Round 64: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:35:29,914 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:29,938 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0939, Avg D Loss: 0.9550
2025-08-04 20:35:29,938 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0939, Avg D Loss: 0.9550
2025-08-04 20:35:29,939 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:29,953 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3924, Threshold=0.4270, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:29,953 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:35:29,953 - ClientAppLogger [Client 5] - INFO - Fit completed for round 64. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 64, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.09389808177948, 'd_loss': 0.9550140142440796, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14119791984558105, 'cpu_percent_fit': 45.9, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:35:29,954 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:35:35,234 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:35,235 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:35,235 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:35,235 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:35,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:35,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:35,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:35,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:35,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:35,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:35,678 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:35,775 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:35,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:35,783 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:35,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:35,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:35,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:35,796 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:35,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:35,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:35,806 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:35,809 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,811 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:35,814 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:35,817 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:35,819 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:35,822 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:35,827 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:35,829 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:35,831 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:35,841 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:35,841 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:35,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:35,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:35,851 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:35,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:35,861 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:35,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:35,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:35,877 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:35,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:35,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:35,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:35,887 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:35,887 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:35,887 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:35,888 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:35,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:35,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:35,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:35,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:35,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:35,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:35,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:35,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:35,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:35,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:35,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:35,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:35,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:35,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:35,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:35,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:35,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:35,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:35,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:35,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:35,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:35,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:35,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:35,894 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:35,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:35,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:35,898 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:35,898 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:35,899 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:35,899 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:35,900 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:35,901 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:35,901 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:35,901 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:35,920 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3515, Threshold=0.3826, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:35,920 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3515
2025-08-04 20:35:41,178 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:41,178 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:41,179 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:41,179 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:41,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:41,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:41,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:41,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:41,507 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:41,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:41,546 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:41,654 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:41,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:41,659 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:41,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:41,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:41,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:41,669 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:41,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:41,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:41,677 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:41,680 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:41,682 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:41,684 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:41,687 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:41,689 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:41,692 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:41,694 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:41,697 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:41,699 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:41,701 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:41,709 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:41,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:41,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:41,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:41,718 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:41,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:41,726 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:41,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:41,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:41,741 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:41,746 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:41,752 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:41,752 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:41,752 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:41,753 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:41,753 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:41,753 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:41,753 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:41,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:41,754 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:41,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:41,755 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:41,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:41,755 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:41,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:41,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:41,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:41,757 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:41,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:41,757 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:41,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:41,757 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:41,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:41,758 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:41,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:41,758 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:41,758 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:41,758 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:41,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:41,759 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:41,759 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:41,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:41,765 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:41,765 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:41,766 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:41,766 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:41,767 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 65/400.
2025-08-04 20:35:41,869 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:41,869 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:41,870 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:35:41,870 - ClientAppLogger [Client 5] - INFO - [Client] Round 65: Training GAN with 14 samples (11 normal, 3 anomalous).
2025-08-04 20:35:41,870 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:41,895 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0893, Avg D Loss: 0.9697
2025-08-04 20:35:41,896 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0893, Avg D Loss: 0.9697
2025-08-04 20:35:41,896 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:41,910 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3640, Threshold=0.3963, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:41,910 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:35:41,911 - ClientAppLogger [Client 5] - INFO - Fit completed for round 65. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 65, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0892602443695067, 'd_loss': 0.9697083830833435, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14312982559204102, 'cpu_percent_fit': 46.30625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 14}
2025-08-04 20:35:41,911 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:35:47,175 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:47,175 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:47,175 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:47,175 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:47,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:47,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:47,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:47,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:47,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:47,798 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:47,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:47,804 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:47,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:47,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:47,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:47,816 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:47,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:47,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:47,825 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:47,828 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,831 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:47,834 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:47,837 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:47,839 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:47,841 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,844 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:47,847 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:47,849 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:47,851 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:47,861 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:47,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:47,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:47,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:47,872 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:47,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:47,885 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:47,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:47,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:47,902 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:47,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:35:47,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:35:47,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:47,916 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:47,916 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:47,916 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:47,917 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:47,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:35:47,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:47,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:35:47,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:47,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:35:47,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:35:47,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:47,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:35:47,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:47,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:47,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:47,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:35:47,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:35:47,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:35:47,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:35:47,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:35:47,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:35:47,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:35:47,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:35:47,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:35:47,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:35:47,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:35:47,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:35:47,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:47,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:35:47,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:47,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:47,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:47,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:35:47,923 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:35:47,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:35:47,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:35:47,927 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:35:47,927 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:47,929 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:47,929 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:35:47,930 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:47,930 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:47,931 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:47,931 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:47,950 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3656, Threshold=0.4007, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:35:47,950 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3656
2025-08-04 20:35:59,221 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:59,221 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:35:59,221 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:35:59,221 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:35:59,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:35:59,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:59,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:59,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:59,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:35:59,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:35:59,770 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:59,895 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:59,902 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:59,902 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:59,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:35:59,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:59,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:35:59,917 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:59,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:59,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:35:59,927 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:59,930 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:59,932 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:59,934 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:59,937 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:59,939 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:59,942 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:59,944 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:59,947 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:59,949 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:59,951 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:59,963 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:59,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:35:59,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:35:59,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:35:59,975 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:59,976 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:35:59,990 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:59,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:35:59,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:00,008 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:00,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:36:00,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:36:00,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:00,022 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:00,023 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:00,023 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:00,023 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:00,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:36:00,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:00,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:36:00,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:00,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:36:00,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:36:00,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:00,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:36:00,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:00,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:00,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:00,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:36:00,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:36:00,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:36:00,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:36:00,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:36:00,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:36:00,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:36:00,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:36:00,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:36:00,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:36:00,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:36:00,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:36:00,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:00,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:36:00,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:00,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:00,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:00,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:36:00,030 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:36:00,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:36:00,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:36:00,038 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:36:00,038 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:00,040 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:00,043 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:36:00,044 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:00,044 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:00,044 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:00,045 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:00,063 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3767, Threshold=0.4105, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:36:00,063 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3767
2025-08-04 20:36:17,351 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:17,351 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:36:17,351 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:36:17,351 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:36:17,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:36:17,352 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:17,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:17,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:17,731 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:36:17,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:36:17,765 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:17,855 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:17,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:17,861 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:17,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:36:17,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:17,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:36:17,872 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:17,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:17,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:36:17,881 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:17,883 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,885 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:17,887 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:17,890 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:17,892 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:17,895 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,898 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:17,901 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:17,902 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:17,905 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:17,915 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:17,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:36:17,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:36:17,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:36:17,926 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:17,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:36:17,937 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:17,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:36:17,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:17,953 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:17,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:36:17,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:36:17,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:17,963 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:17,963 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:17,964 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:17,964 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:17,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:36:17,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:17,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:36:17,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:17,966 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:36:17,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:36:17,966 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:36:17,967 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:36:17,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:36:17,968 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:36:17,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:36:17,968 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:36:17,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:36:17,968 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:36:17,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:36:17,969 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:36:17,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:36:17,969 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:17,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:36:17,969 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:17,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:17,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:17,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:36:17,970 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:36:17,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:36:17,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:36:17,973 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:36:17,974 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:17,975 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:17,975 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:36:17,976 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:17,977 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:17,977 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:17,977 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:17,992 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3616, Threshold=0.3993, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:36:17,993 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3616
2025-08-04 20:36:23,247 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:23,248 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:36:23,248 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:36:23,248 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:36:23,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:36:23,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:23,470 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:23,470 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:23,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:36:23,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:36:23,581 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:23,691 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:23,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:23,696 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:23,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:36:23,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:23,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:36:23,708 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:23,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:23,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:36:23,716 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:23,719 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:23,722 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:23,724 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:23,727 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:23,729 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:23,732 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:23,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:23,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:23,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:23,741 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:23,750 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:23,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:36:23,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:36:23,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:36:23,760 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:23,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:36:23,769 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:23,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:36:23,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:23,784 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:23,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:36:23,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:36:23,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:23,795 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:23,795 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:23,795 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:23,796 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:23,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:36:23,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:23,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:36:23,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:23,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:36:23,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:36:23,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:23,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:36:23,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:23,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:23,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:36:23,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:36:23,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:36:23,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:36:23,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:36:23,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:36:23,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:23,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:36:23,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:36:23,805 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:36:23,805 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:23,806 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:23,806 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:36:23,807 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 68/400.
2025-08-04 20:36:23,909 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:23,909 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:23,910 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:36:23,911 - ClientAppLogger [Client 5] - INFO - [Client] Round 68: Training GAN with 15 samples (12 normal, 3 anomalous).
2025-08-04 20:36:23,911 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:23,936 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0903, Avg D Loss: 0.9138
2025-08-04 20:36:23,936 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0903, Avg D Loss: 0.9138
2025-08-04 20:36:23,936 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:23,950 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3656, Threshold=0.4028, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:36:23,951 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:36:23,951 - ClientAppLogger [Client 5] - INFO - Fit completed for round 68. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 68, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0902610540390016, 'd_loss': 0.9137573182582855, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14351582527160645, 'cpu_percent_fit': 45.88125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 15}
2025-08-04 20:36:23,951 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:36:29,219 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:29,219 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:36:29,219 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:36:29,219 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:36:29,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:36:29,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:29,549 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:29,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:29,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:36:29,686 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:36:29,686 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:29,808 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:29,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:29,816 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:29,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:36:29,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:29,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:36:29,833 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:29,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:29,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:36:29,842 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:29,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:29,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:29,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:29,855 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:29,858 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,860 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:29,863 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:29,865 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:29,867 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:29,878 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:29,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:36:29,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:36:29,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:36:29,889 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:29,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:36:29,898 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:29,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:36:29,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:29,915 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:29,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:36:29,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:36:29,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:29,978 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:29,978 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:29,978 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:29,979 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:29,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:36:29,979 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:29,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:36:29,979 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:29,981 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:36:29,981 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:36:29,982 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:29,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:36:29,982 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:29,982 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:29,982 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:29,982 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:36:29,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:36:29,983 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:36:29,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:36:29,983 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:36:29,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:36:29,983 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:36:29,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:36:29,984 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:36:29,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:36:29,984 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:36:29,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:36:29,984 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:29,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:36:29,985 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:29,985 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:29,985 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:29,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:36:29,986 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:36:29,986 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:36:29,986 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:36:29,994 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:36:29,994 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:29,996 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:29,996 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:36:29,997 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:29,998 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:29,998 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:29,998 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:30,018 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3689, Threshold=0.4094, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:36:30,019 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3689
2025-08-04 20:36:47,300 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:47,300 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:36:47,300 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:36:47,301 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:36:47,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:36:47,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:47,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:47,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:47,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:36:47,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:36:47,804 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:47,937 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:47,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:47,943 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:47,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:36:47,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:47,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:36:47,957 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:47,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:47,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:36:47,968 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:47,971 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,973 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:47,975 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:47,977 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:47,980 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:47,982 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,985 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:47,988 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:47,989 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:47,992 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:48,004 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:48,004 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:36:48,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:36:48,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:36:48,015 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:48,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:36:48,024 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:48,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:36:48,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:48,039 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:48,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:36:48,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:36:48,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:48,050 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:48,050 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:48,051 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:48,051 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:48,051 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:36:48,051 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:48,051 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:36:48,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:48,053 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:36:48,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:36:48,053 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:48,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:36:48,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:48,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:48,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:48,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:36:48,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:36:48,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:36:48,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:36:48,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:36:48,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:36:48,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:36:48,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:36:48,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:36:48,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:36:48,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:36:48,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:36:48,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:48,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:36:48,062 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:36:48,063 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:48,064 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:48,064 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:36:48,066 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:48,066 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:48,066 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:48,066 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:48,082 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3874, Threshold=0.4355, Accuracy=0.7129, F1=0.7991, Precision=0.9542, Recall=0.6874
2025-08-04 20:36:48,082 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7129, F1: 0.7991, Prec: 0.9542, Rec: 0.6874, Avg Anomaly Score: 0.3874
2025-08-04 20:36:53,353 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:53,353 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:36:53,353 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:36:53,354 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:36:53,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:36:53,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:53,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:53,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:53,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:36:53,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:36:53,742 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:53,827 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:53,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:53,833 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:53,838 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:36:53,843 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:53,843 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:36:53,844 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:53,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:53,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:36:53,853 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:53,857 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:53,860 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:53,863 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:53,866 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:53,868 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:53,871 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:53,874 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:53,877 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:53,879 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:53,881 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:53,890 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:53,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:36:53,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:36:53,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:36:53,901 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:53,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:36:53,910 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:53,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:36:53,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:53,926 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:53,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:36:53,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:36:53,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:53,936 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:53,936 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:53,937 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:53,937 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:53,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:36:53,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:53,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:36:53,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:53,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:36:53,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:36:53,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:53,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:36:53,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:36:53,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:36:53,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:36:53,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:36:53,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:36:53,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:36:53,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:36:53,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:36:53,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:36:53,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:53,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:36:53,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:53,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:53,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:53,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:36:53,945 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:36:53,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:36:53,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:36:53,950 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:36:53,950 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:53,951 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:53,951 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:36:53,953 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 70/400.
2025-08-04 20:36:54,054 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:54,054 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:54,055 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:36:54,056 - ClientAppLogger [Client 5] - INFO - [Client] Round 70: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:36:54,056 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:54,103 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0889, Avg D Loss: 0.9062
2025-08-04 20:36:54,103 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0889, Avg D Loss: 0.9062
2025-08-04 20:36:54,104 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:54,129 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3841, Threshold=0.4300, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:36:54,129 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:36:54,130 - ClientAppLogger [Client 5] - INFO - Fit completed for round 70. Duration: 0.18s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 70, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.088928151130676, 'd_loss': 0.9062391996383667, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.1767444610595703, 'cpu_percent_fit': 45.4, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:36:54,130 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:37:02,413 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:02,413 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:02,413 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:02,413 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:02,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:02,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:02,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:02,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:02,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:02,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:02,930 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:03,054 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:03,060 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:03,061 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:03,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:03,078 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:03,078 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:03,079 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:03,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:03,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:03,088 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:03,091 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:03,093 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:03,095 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:03,098 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:03,100 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:03,103 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:03,106 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:03,108 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:03,111 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:03,114 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:03,124 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:03,124 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:03,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:03,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:03,135 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:03,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:03,148 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:03,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:03,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:03,165 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:03,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:03,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:03,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:03,178 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:03,178 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:03,179 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:03,179 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:03,179 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:03,180 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:03,180 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:03,180 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:03,181 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:03,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:03,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:03,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:03,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:03,184 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:03,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:03,184 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:03,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:03,184 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:03,185 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:03,185 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:03,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:03,185 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:03,185 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:03,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:03,193 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:03,193 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:03,194 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:03,194 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:03,196 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:03,196 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:03,196 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:03,197 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:03,211 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3759, Threshold=0.4313, Accuracy=0.7210, F1=0.8050, Precision=0.9597, Recall=0.6932
2025-08-04 20:37:03,212 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7210, F1: 0.8050, Prec: 0.9597, Rec: 0.6932, Avg Anomaly Score: 0.3759
2025-08-04 20:37:08,464 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:08,464 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:08,464 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:08,465 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:08,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:08,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:08,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:08,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:08,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:08,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:08,829 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:08,911 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:08,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:08,916 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:08,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:08,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:08,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:08,926 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:08,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:08,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:08,935 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:08,938 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:08,940 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:08,942 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:08,946 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:08,948 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:08,950 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:08,953 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:08,955 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:08,957 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:08,960 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:08,969 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:08,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:08,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:08,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:08,979 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:08,979 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:08,988 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:08,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:08,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:09,003 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:09,007 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:09,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:09,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:09,015 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:09,015 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:09,015 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:09,016 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:09,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:09,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:09,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:09,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:09,017 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:09,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:09,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:09,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:09,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:09,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:09,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:09,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:09,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:09,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:09,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:09,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:09,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:09,022 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:09,022 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:09,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:09,025 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:09,026 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:09,027 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:09,027 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:09,028 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 71/400.
2025-08-04 20:37:09,129 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:09,129 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:09,130 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:37:09,131 - ClientAppLogger [Client 5] - INFO - [Client] Round 71: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:37:09,131 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:09,159 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0896, Avg D Loss: 0.9073
2025-08-04 20:37:09,159 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0896, Avg D Loss: 0.9073
2025-08-04 20:37:09,159 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:09,175 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3770, Threshold=0.4305, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:37:09,175 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:37:09,175 - ClientAppLogger [Client 5] - INFO - Fit completed for round 71. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 71, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.089572811126709, 'd_loss': 0.9072990238666534, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14713048934936523, 'cpu_percent_fit': 45.95, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:37:09,176 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:37:17,441 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:17,441 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:17,441 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:17,442 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:17,442 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:17,442 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:17,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:17,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:17,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:17,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:17,859 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:17,957 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:17,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:17,963 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:17,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:18,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:18,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:18,016 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:18,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:18,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:18,024 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:18,027 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:18,029 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:18,032 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:18,035 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:18,038 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:18,041 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:18,043 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:18,047 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:18,049 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:18,051 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:18,061 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:18,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:18,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:18,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:18,071 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:18,071 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:18,082 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:18,082 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:18,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:18,099 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:18,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:18,109 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:18,109 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:18,109 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:18,109 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:18,110 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:18,110 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:18,110 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:18,110 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:18,111 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:18,111 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:18,112 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:18,112 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:18,113 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:18,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:18,113 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:18,113 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:18,113 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:18,113 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:18,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:18,114 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:18,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:18,114 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:18,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:18,114 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:18,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:18,115 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:18,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:18,115 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:18,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:18,115 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:18,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:18,116 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:18,116 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:18,116 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:18,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:18,117 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:18,117 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:18,117 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:18,120 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:18,120 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:18,122 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:18,122 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:18,123 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:18,123 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:18,124 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:18,124 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:18,141 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3807, Threshold=0.4396, Accuracy=0.7274, F1=0.8095, Precision=0.9651, Recall=0.6971
2025-08-04 20:37:18,141 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7274, F1: 0.8095, Prec: 0.9651, Rec: 0.6971, Avg Anomaly Score: 0.3807
2025-08-04 20:37:23,390 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:23,391 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:23,391 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:23,391 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:23,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:23,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:23,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:23,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:23,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:23,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:23,751 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:23,859 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:23,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:23,864 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:23,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:23,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:23,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:23,878 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:23,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:23,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:23,887 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:23,890 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:23,892 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:23,894 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:23,897 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:23,900 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:23,902 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:23,905 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:23,907 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:23,910 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:23,912 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:23,920 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:23,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:23,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:23,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:23,931 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:23,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:23,942 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:23,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:23,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:23,957 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:23,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:23,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:23,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:23,967 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:23,967 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:23,967 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:23,967 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:23,968 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:23,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:23,968 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:23,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:23,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:23,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:23,970 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:23,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:23,971 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:23,971 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:23,971 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:23,971 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:23,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:23,971 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:23,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:23,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:23,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:23,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:23,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:23,972 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:23,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:23,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:23,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:23,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:23,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:23,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:23,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:23,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:23,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:23,974 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:23,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:23,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:23,981 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:23,981 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:23,982 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:23,982 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:23,984 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 72/400.
2025-08-04 20:37:24,085 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:24,085 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:24,086 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:37:24,087 - ClientAppLogger [Client 5] - INFO - [Client] Round 72: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:37:24,087 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:24,115 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.8592
2025-08-04 20:37:24,115 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.8592
2025-08-04 20:37:24,116 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:24,132 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3746, Threshold=0.4309, Accuracy=0.7274, F1=0.8095, Precision=0.9651, Recall=0.6971
2025-08-04 20:37:24,132 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8095
2025-08-04 20:37:24,133 - ClientAppLogger [Client 5] - INFO - Fit completed for round 72. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 72, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0847089290618896, 'd_loss': 0.8591902494430542, 'post_fit_local_f1': 0.8094701240135288, 'fit_time_seconds': 0.1490769386291504, 'cpu_percent_fit': 45.8375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:37:24,133 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:37:29,403 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:29,403 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:29,404 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:29,404 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:29,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:29,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:29,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:29,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:29,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:29,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:29,905 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:30,034 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:30,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:30,041 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:30,047 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:30,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:30,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:30,059 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:30,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:30,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:30,070 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:30,073 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:30,076 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:30,079 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:30,082 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:30,084 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:30,087 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:30,091 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:30,094 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:30,096 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:30,098 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:30,110 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:30,110 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:30,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:30,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:30,122 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:30,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:30,132 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:30,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:30,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:30,149 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:30,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:30,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:30,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:30,159 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:30,159 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:30,160 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:30,160 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:30,160 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:30,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:30,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:30,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:30,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:30,162 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:30,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:30,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:30,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:30,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:30,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:30,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:30,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:30,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:30,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:30,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:30,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:30,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:30,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:30,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:30,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:30,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:30,166 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:30,167 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:30,167 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:30,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:30,173 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:30,174 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:30,175 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:30,175 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:30,176 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:30,177 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:30,177 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:30,178 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:30,193 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3564, Threshold=0.4145, Accuracy=0.7306, F1=0.8117, Precision=0.9677, Recall=0.6990
2025-08-04 20:37:30,194 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7306, F1: 0.8117, Prec: 0.9677, Rec: 0.6990, Avg Anomaly Score: 0.3564
2025-08-04 20:37:35,448 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:35,449 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:35,449 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:35,449 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:35,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:35,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:35,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:35,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:35,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:35,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:35,837 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:35,925 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:35,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:35,931 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:35,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:35,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:35,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:35,943 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:35,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:35,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:35,951 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:35,954 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:35,956 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:35,958 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:35,961 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:35,964 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:35,966 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:35,969 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:35,972 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:35,973 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:35,976 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:35,986 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:35,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:35,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:35,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:35,997 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:35,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:36,005 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:36,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:36,006 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:36,020 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:36,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:36,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:36,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:36,033 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:36,033 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:36,033 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:36,034 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:36,034 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:36,034 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:36,034 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:36,034 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:36,036 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:36,036 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:36,036 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:36,036 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:36,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:36,038 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:36,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:36,038 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:36,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:36,038 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:36,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:36,039 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:36,039 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:36,039 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:36,039 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:36,039 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:36,040 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:36,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:36,046 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:36,047 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:36,048 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:36,048 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:36,050 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 73/400.
2025-08-04 20:37:36,151 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:36,151 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:36,153 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:37:36,153 - ClientAppLogger [Client 5] - INFO - [Client] Round 73: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:37:36,153 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:36,176 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0895, Avg D Loss: 0.8682
2025-08-04 20:37:36,177 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0895, Avg D Loss: 0.8682
2025-08-04 20:37:36,180 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:36,195 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3600, Threshold=0.4182, Accuracy=0.7274, F1=0.8095, Precision=0.9651, Recall=0.6971
2025-08-04 20:37:36,196 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8095
2025-08-04 20:37:36,196 - ClientAppLogger [Client 5] - INFO - Fit completed for round 73. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 73, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0895498275756834, 'd_loss': 0.8681700646877288, 'post_fit_local_f1': 0.8094701240135288, 'fit_time_seconds': 0.14584898948669434, 'cpu_percent_fit': 46.1625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:37:36,196 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:37:44,472 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:44,472 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:44,472 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:44,473 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:44,473 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:44,473 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:44,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:44,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:44,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:44,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:44,893 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:44,990 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:44,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:44,996 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:45,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:45,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:45,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:45,010 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:45,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:45,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:45,019 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:45,022 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:45,024 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:45,027 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:45,029 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:45,031 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:45,034 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:45,037 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:45,039 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:45,041 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:45,044 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:45,054 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:45,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:45,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:45,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:45,064 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:45,064 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:45,072 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:45,072 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:45,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:45,088 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:45,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:45,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:45,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:45,098 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:45,098 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:45,098 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:45,099 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:45,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:45,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:45,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:45,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:45,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:45,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:45,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:45,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:45,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:45,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:45,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:45,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:45,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:45,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:45,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:45,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:45,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:45,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:45,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:45,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:45,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:45,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:45,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:45,106 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:45,106 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:45,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:45,110 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:45,110 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:45,112 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:45,112 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:45,113 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:45,113 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:45,113 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:45,114 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:45,128 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3716, Threshold=0.4364, Accuracy=0.7306, F1=0.8117, Precision=0.9677, Recall=0.6990
2025-08-04 20:37:45,128 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7306, F1: 0.8117, Prec: 0.9677, Rec: 0.6990, Avg Anomaly Score: 0.3716
2025-08-04 20:37:50,404 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:50,404 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:50,404 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:50,404 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:50,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:50,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:50,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:50,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:50,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:50,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:50,754 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:50,835 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:50,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:50,840 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:50,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:50,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:50,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:50,850 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:50,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:50,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:50,858 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:50,861 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:50,863 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:50,865 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:50,868 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:50,870 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:50,873 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:50,875 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:50,878 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:50,880 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:50,882 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:50,890 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:50,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:50,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:50,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:50,899 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:50,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:50,908 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:50,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:50,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:50,923 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:50,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:50,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:50,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:50,933 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:50,933 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:50,933 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:50,934 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:50,934 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:50,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:50,934 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:50,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:50,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:50,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:50,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:50,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:50,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:50,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:50,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:50,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:50,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:50,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:50,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:50,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:50,940 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:50,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:50,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:50,944 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:50,944 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:50,945 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:50,945 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:50,947 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 74/400.
2025-08-04 20:37:51,048 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:51,048 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:51,050 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:37:51,050 - ClientAppLogger [Client 5] - INFO - [Client] Round 74: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:37:51,050 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:51,076 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0849, Avg D Loss: 0.8718
2025-08-04 20:37:51,076 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0849, Avg D Loss: 0.8718
2025-08-04 20:37:51,076 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:51,090 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3853, Threshold=0.4512, Accuracy=0.7306, F1=0.8117, Precision=0.9677, Recall=0.6990
2025-08-04 20:37:51,090 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8117
2025-08-04 20:37:51,091 - ClientAppLogger [Client 5] - INFO - Fit completed for round 74. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 74, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0849292993545534, 'd_loss': 0.8717932045459748, 'post_fit_local_f1': 0.8117249154453213, 'fit_time_seconds': 0.14385080337524414, 'cpu_percent_fit': 45.43125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:37:51,091 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:37:56,373 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:56,373 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:37:56,373 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:37:56,373 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:37:56,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:37:56,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:56,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:56,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:56,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:37:56,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:37:56,817 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:56,920 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:56,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:56,926 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:56,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:37:56,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:56,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:37:56,943 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:56,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:56,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:37:56,952 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:56,956 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,958 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:56,960 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:56,963 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:56,965 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:56,968 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,971 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:56,974 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:56,976 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:56,978 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:56,990 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:56,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:37:56,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:37:56,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:37:57,000 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:57,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:37:57,012 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:57,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:37:57,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:57,029 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:57,035 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:37:57,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:37:57,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:57,043 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:57,043 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:57,044 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:57,044 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:57,044 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:37:57,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:57,045 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:37:57,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:57,046 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:37:57,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:37:57,047 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:57,047 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:37:57,047 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:57,047 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:57,048 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:57,048 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:37:57,048 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:37:57,048 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:37:57,048 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:37:57,049 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:37:57,049 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:37:57,049 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:37:57,049 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:37:57,049 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:37:57,049 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:37:57,050 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:37:57,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:37:57,050 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:57,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:37:57,051 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:57,051 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:57,051 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:57,051 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:37:57,051 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:37:57,052 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:37:57,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:37:57,054 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:37:57,054 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:57,055 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:57,056 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:37:57,057 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:57,057 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:57,058 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:57,059 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:57,076 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3769, Threshold=0.4400, Accuracy=0.7339, F1=0.8140, Precision=0.9704, Recall=0.7010
2025-08-04 20:37:57,076 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7339, F1: 0.8140, Prec: 0.9704, Rec: 0.7010, Avg Anomaly Score: 0.3769
2025-08-04 20:38:02,343 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:02,343 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:02,343 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:02,343 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:02,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:02,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:02,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:02,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:02,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:02,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:02,755 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:02,869 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:02,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:02,876 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:02,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:02,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:02,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:02,888 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:02,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:02,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:02,897 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:02,900 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:02,902 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:02,905 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:02,908 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:02,910 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:02,912 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:02,915 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:02,918 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:02,921 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:02,924 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:02,933 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:02,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:02,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:02,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:02,943 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:02,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:02,953 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:02,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:02,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:02,969 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:02,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:02,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:02,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:02,985 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:02,985 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:02,986 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:02,986 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:02,986 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:02,986 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:02,987 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:02,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:02,988 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:02,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:02,989 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:02,989 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:02,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:02,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:02,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:02,991 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:02,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:02,991 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:02,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:02,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:02,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:02,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:02,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:02,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:02,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:02,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:02,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:02,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:02,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:02,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:02,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:02,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:02,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:02,994 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:02,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:02,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:03,002 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:03,002 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:03,003 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:03,004 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:03,005 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 75/400.
2025-08-04 20:38:03,106 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:03,107 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:03,108 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:38:03,109 - ClientAppLogger [Client 5] - INFO - [Client] Round 75: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:38:03,109 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:03,138 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0842, Avg D Loss: 0.8700
2025-08-04 20:38:03,139 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0842, Avg D Loss: 0.8700
2025-08-04 20:38:03,139 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:03,174 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3889, Threshold=0.4539, Accuracy=0.7306, F1=0.8117, Precision=0.9677, Recall=0.6990
2025-08-04 20:38:03,174 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8117
2025-08-04 20:38:03,175 - ClientAppLogger [Client 5] - INFO - Fit completed for round 75. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 75, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0842346429824827, 'd_loss': 0.8700103998184204, 'post_fit_local_f1': 0.8117249154453213, 'fit_time_seconds': 0.1690065860748291, 'cpu_percent_fit': 46.81875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:38:03,175 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:38:08,441 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:08,441 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:08,441 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:08,441 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:08,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:08,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:08,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:08,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:08,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:08,949 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:08,949 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:09,069 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:09,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:09,079 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:09,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:09,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:09,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:09,096 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:09,096 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:09,096 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:09,107 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:09,110 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,112 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:09,115 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:09,118 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:09,120 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:09,122 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,125 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:09,128 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:09,130 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:09,132 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:09,143 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:09,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:09,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:09,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:09,155 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:09,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:09,170 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:09,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:09,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:09,190 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:09,195 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:09,200 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:09,201 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:09,201 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:09,201 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:09,201 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:09,202 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:09,202 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:09,202 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:09,202 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:09,202 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:09,204 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:09,204 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:09,205 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:09,205 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:09,205 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:09,205 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:09,205 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:09,206 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:09,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:09,206 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:09,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:09,206 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:09,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:09,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:09,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:09,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:09,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:09,208 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:09,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:09,208 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:09,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:09,208 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:09,209 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:09,209 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:09,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:09,209 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:09,210 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:09,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:09,214 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:09,214 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:09,215 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:09,215 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:09,217 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:09,217 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:09,217 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:09,218 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:09,247 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3778, Threshold=0.4497, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:09,247 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3778
2025-08-04 20:38:14,494 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:14,494 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:14,494 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:14,494 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:14,494 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:14,494 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:14,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:14,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:14,868 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:14,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:14,899 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:14,994 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:15,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:15,001 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:15,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:15,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:15,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:15,059 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:15,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:15,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:15,068 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:15,071 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:15,073 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:15,076 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:15,078 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:15,081 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:15,083 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:15,086 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:15,089 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:15,091 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:15,093 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:15,104 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:15,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:15,110 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:15,110 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:15,115 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:15,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:15,124 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:15,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:15,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:15,141 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:15,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:15,150 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:15,150 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:15,151 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:15,151 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:15,151 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:15,151 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:15,152 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:15,152 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:15,152 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:15,152 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:15,153 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:15,153 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:15,154 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:15,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:15,154 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:15,154 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:15,154 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:15,155 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:15,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:15,157 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:15,157 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:15,157 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:15,157 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:15,158 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:15,158 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:15,158 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:15,164 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:15,165 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:15,166 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:15,166 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:15,167 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 76/400.
2025-08-04 20:38:15,268 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:15,269 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:15,270 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:38:15,271 - ClientAppLogger [Client 5] - INFO - [Client] Round 76: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:38:15,271 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:15,299 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.8716
2025-08-04 20:38:15,299 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.8716
2025-08-04 20:38:15,300 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:15,316 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3757, Threshold=0.4456, Accuracy=0.7371, F1=0.8162, Precision=0.9731, Recall=0.7029
2025-08-04 20:38:15,317 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8162
2025-08-04 20:38:15,317 - ClientAppLogger [Client 5] - INFO - Fit completed for round 76. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 76, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0829533100128175, 'd_loss': 0.8716377794742585, 'post_fit_local_f1': 0.8162344983089064, 'fit_time_seconds': 0.14956426620483398, 'cpu_percent_fit': 44.99375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:38:15,317 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:38:23,589 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:23,589 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:23,589 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:23,589 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:23,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:23,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:23,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:23,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:24,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:24,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:24,061 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:24,189 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:24,198 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:24,198 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:24,204 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:24,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:24,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:24,210 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:24,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:24,211 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:24,219 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:24,222 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,225 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:24,227 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:24,230 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:24,232 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:24,235 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,238 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:24,241 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:24,243 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:24,245 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:24,256 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:24,256 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:24,261 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:24,261 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:24,265 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:24,266 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:24,275 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:24,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:24,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:24,292 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:24,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:24,305 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:24,306 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:24,306 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:24,306 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:24,306 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:24,307 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:24,307 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:24,307 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:24,307 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:24,307 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:24,309 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:24,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:24,309 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:24,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:24,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:24,311 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:24,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:24,311 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:24,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:24,311 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:24,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:24,312 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:24,312 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:24,312 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:24,312 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:24,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:24,317 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:24,317 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:24,318 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:24,318 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:24,320 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:24,320 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:24,320 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:24,321 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:24,337 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3753, Threshold=0.4494, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:24,337 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3753
2025-08-04 20:38:29,596 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:29,597 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:29,597 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:29,597 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:29,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:29,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:29,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:29,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:29,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:29,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:29,964 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:30,053 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:30,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:30,058 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:30,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:30,069 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:30,069 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:30,070 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:30,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:30,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:30,079 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:30,082 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:30,084 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:30,086 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:30,089 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:30,091 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:30,094 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:30,096 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:30,099 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:30,101 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:30,103 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:30,113 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:30,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:30,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:30,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:30,122 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:30,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:30,131 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:30,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:30,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:30,147 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:30,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:30,158 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:30,158 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:30,158 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:30,158 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:30,159 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:30,159 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:30,159 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:30,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:30,159 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:30,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:30,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:30,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:30,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:30,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:30,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:30,162 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:30,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:30,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:30,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:30,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:30,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:30,164 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:30,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:30,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:30,168 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:30,168 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:30,169 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:30,169 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:30,171 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 77/400.
2025-08-04 20:38:30,271 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:30,272 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:30,273 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:38:30,273 - ClientAppLogger [Client 5] - INFO - [Client] Round 77: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:38:30,273 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:30,305 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.8714
2025-08-04 20:38:30,305 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.8714
2025-08-04 20:38:30,305 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:30,320 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3742, Threshold=0.4474, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:30,320 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:38:30,320 - ClientAppLogger [Client 5] - INFO - Fit completed for round 77. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 77, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0836467266082765, 'd_loss': 0.8714161932468414, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.1493244171142578, 'cpu_percent_fit': 46.16875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:38:30,320 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:38:35,596 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:35,597 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:35,597 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:35,597 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:35,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:35,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:35,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:35,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:36,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:36,107 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:36,107 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:36,278 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:36,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:36,284 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:36,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:36,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:36,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:36,314 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:36,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:36,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:36,322 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:36,325 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,328 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:36,330 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:36,332 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:36,335 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:36,338 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,340 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:36,343 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:36,345 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:36,348 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:36,358 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:36,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:36,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:36,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:36,370 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:36,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:36,387 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:36,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:36,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:36,404 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:36,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:36,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:36,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:36,414 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:36,415 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:36,415 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:36,415 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:36,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:36,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:36,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:36,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:36,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:36,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:36,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:36,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:36,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:36,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:36,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:36,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:36,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:36,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:36,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:36,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:36,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:36,421 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:36,422 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:36,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:36,433 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:36,433 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:36,434 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:36,434 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:36,436 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:36,436 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:36,436 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:36,437 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:36,450 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3743, Threshold=0.4522, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:36,450 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3743
2025-08-04 20:38:41,719 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:41,719 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:41,719 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:41,719 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:41,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:41,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:42,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:42,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:42,112 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:42,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:42,152 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:42,248 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:42,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:42,254 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:42,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:42,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:42,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:42,264 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:42,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:42,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:42,273 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:42,275 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:42,278 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:42,280 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:42,283 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:42,285 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:42,287 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:42,290 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:42,293 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:42,295 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:42,298 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:42,306 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:42,306 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:42,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:42,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:42,316 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:42,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:42,324 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:42,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:42,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:42,344 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:42,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:42,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:42,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:42,360 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:42,360 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:42,360 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:42,361 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:42,361 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:42,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:42,361 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:42,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:42,363 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:42,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:42,364 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:42,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:42,364 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:42,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:42,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:42,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:42,365 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:42,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:42,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:42,366 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:42,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:42,366 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:42,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:42,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:42,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:42,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:42,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:42,368 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:42,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:42,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:42,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:42,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:42,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:42,370 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:42,370 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:42,371 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:42,379 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:42,379 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:42,381 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:42,381 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:42,382 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 78/400.
2025-08-04 20:38:42,483 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:42,484 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:42,485 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:38:42,485 - ClientAppLogger [Client 5] - INFO - [Client] Round 78: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:38:42,485 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:42,513 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0821, Avg D Loss: 0.8690
2025-08-04 20:38:42,514 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0821, Avg D Loss: 0.8690
2025-08-04 20:38:42,515 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:42,532 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3741, Threshold=0.4509, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:42,533 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:38:42,533 - ClientAppLogger [Client 5] - INFO - Fit completed for round 78. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 78, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082119035720825, 'd_loss': 0.8690493881702424, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.1507575511932373, 'cpu_percent_fit': 45.3625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:38:42,533 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:38:47,803 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:47,803 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:47,803 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:47,803 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:47,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:47,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:48,076 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:48,077 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:48,171 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:48,199 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:48,199 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:48,296 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:48,304 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:48,305 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:48,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:48,326 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:48,326 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:48,327 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:48,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:48,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:48,337 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:48,340 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,342 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:48,344 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:48,347 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:48,350 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:48,353 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,356 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:48,359 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:48,360 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:48,363 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:48,373 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:48,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:48,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:48,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:48,383 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:48,383 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:48,391 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:48,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:48,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:48,406 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:48,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:48,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:48,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:48,415 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:48,415 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:48,415 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:48,416 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:48,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:48,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:48,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:48,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:48,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:48,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:48,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:48,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:48,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:48,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:48,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:48,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:48,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:48,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:48,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:48,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:48,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:48,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:48,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:48,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:48,422 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:48,422 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:48,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:48,422 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:48,422 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:48,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:48,426 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:48,426 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:48,428 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:48,428 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:48,429 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:48,429 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:48,430 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:48,430 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:48,444 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3749, Threshold=0.4516, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:48,445 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3749
2025-08-04 20:38:53,696 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:53,696 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:38:53,696 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:38:53,696 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:38:53,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:38:53,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:53,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:53,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:54,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:38:54,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:38:54,105 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:54,218 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:54,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:54,225 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:54,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:38:54,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:54,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:38:54,239 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:54,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:54,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:38:54,249 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:54,252 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:54,254 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:54,256 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:54,259 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:54,261 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:54,263 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:54,266 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:54,269 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:54,271 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:54,273 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:54,282 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:54,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:38:54,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:38:54,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:38:54,291 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:54,292 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:38:54,300 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:54,300 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:38:54,300 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:54,316 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:54,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:38:54,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:38:54,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:54,328 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:54,328 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:54,329 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:54,329 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:54,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:38:54,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:54,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:38:54,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:54,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:38:54,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:38:54,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:54,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:38:54,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:38:54,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:38:54,333 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:38:54,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:38:54,333 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:38:54,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:38:54,333 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:38:54,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:38:54,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:54,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:38:54,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:54,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:54,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:54,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:38:54,335 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:38:54,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:38:54,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:38:54,341 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:38:54,342 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:54,343 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:54,343 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:38:54,344 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 79/400.
2025-08-04 20:38:54,447 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:54,447 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:54,448 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:38:54,448 - ClientAppLogger [Client 5] - INFO - [Client] Round 79: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:38:54,448 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:38:54,474 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0810, Avg D Loss: 0.8586
2025-08-04 20:38:54,474 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0810, Avg D Loss: 0.8586
2025-08-04 20:38:54,474 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:38:54,488 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3710, Threshold=0.4484, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:38:54,488 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:38:54,489 - ClientAppLogger [Client 5] - INFO - Fit completed for round 79. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 79, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.081020140647888, 'd_loss': 0.858625304698944, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14333629608154297, 'cpu_percent_fit': 45.8125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:38:54,489 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:39:02,770 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:02,771 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:02,771 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:02,775 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:02,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:02,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:03,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:03,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:03,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:03,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:03,245 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:03,340 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:03,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:03,346 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:03,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:03,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:03,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:03,357 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:03,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:03,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:03,366 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:03,368 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,370 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:03,373 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:03,375 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:03,377 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:03,380 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:03,382 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:03,385 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:03,387 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:03,389 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:03,399 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:03,400 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:03,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:03,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:03,410 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:03,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:03,419 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:03,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:03,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:03,436 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:03,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:03,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:03,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:03,449 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:03,450 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:03,450 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:03,450 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:03,451 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:03,451 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:03,451 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:03,451 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:03,452 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:03,453 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:03,453 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:03,453 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:03,453 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:03,453 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:03,453 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:03,454 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:03,455 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:03,455 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:03,455 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:03,455 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:03,456 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:03,456 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:03,456 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:03,456 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:03,456 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:03,456 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:03,457 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:03,457 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:03,457 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:03,457 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:03,461 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:03,462 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:03,463 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:03,463 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:03,464 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:03,464 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:03,464 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:03,465 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:03,481 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3704, Threshold=0.4403, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:03,481 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3704
2025-08-04 20:39:17,765 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:17,765 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:17,766 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:17,766 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:17,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:17,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:18,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:18,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:18,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:18,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:18,281 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:18,400 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:18,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:18,408 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:18,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:18,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:18,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:18,423 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:18,423 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:18,423 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:18,431 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:18,434 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,436 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:18,439 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:18,441 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:18,443 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:18,446 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,449 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:18,452 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:18,454 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:18,456 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:18,466 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:18,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:18,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:18,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:18,477 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:18,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:18,490 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:18,490 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:18,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:18,508 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:18,514 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:18,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:18,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:18,527 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:18,527 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:18,527 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:18,528 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:18,528 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:18,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:18,528 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:18,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:18,530 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:18,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:18,531 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:18,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:18,531 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:18,531 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:18,531 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:18,531 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:18,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:18,532 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:18,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:18,532 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:18,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:18,532 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:18,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:18,533 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:18,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:18,533 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:18,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:18,534 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:18,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:18,534 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:18,534 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:18,534 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:18,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:18,535 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:18,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:18,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:18,543 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:18,543 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:18,545 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:18,545 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:18,546 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:18,546 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:18,546 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:18,547 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:18,577 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3962, Threshold=0.4678, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:18,577 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3962
2025-08-04 20:39:23,844 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:23,844 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:23,844 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:23,845 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:23,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:23,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:24,110 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:24,111 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:24,197 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:24,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:24,226 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:24,312 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:24,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:24,317 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:24,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:24,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:24,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:24,331 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:24,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:24,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:24,340 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:24,343 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:24,345 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:24,347 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:24,350 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:24,352 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:24,354 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:24,357 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:24,359 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:24,361 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:24,363 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:24,372 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:24,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:24,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:24,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:24,381 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:24,381 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:24,390 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:24,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:24,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:24,405 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:24,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:24,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:24,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:24,413 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:24,413 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:24,414 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:24,414 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:24,414 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:24,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:24,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:24,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:24,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:24,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:24,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:24,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:24,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:24,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:24,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:24,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:24,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:24,418 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:24,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:24,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:24,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:24,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:24,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:24,419 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:24,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:24,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:24,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:24,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:24,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:24,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:24,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:24,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:24,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:24,421 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:24,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:24,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:24,423 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:24,423 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:24,424 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:24,424 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:24,425 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 81/400.
2025-08-04 20:39:24,527 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:24,527 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:24,528 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:39:24,528 - ClientAppLogger [Client 5] - INFO - [Client] Round 81: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:39:24,528 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:24,553 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.8910
2025-08-04 20:39:24,553 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.8910
2025-08-04 20:39:24,554 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:24,568 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3922, Threshold=0.4626, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:24,568 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:39:24,569 - ClientAppLogger [Client 5] - INFO - Fit completed for round 81. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 81, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0844146251678466, 'd_loss': 0.8910233736038208, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.1432328224182129, 'cpu_percent_fit': 46.25625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:39:24,569 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:39:29,843 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:29,844 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:29,844 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:29,844 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:29,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:29,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:30,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:30,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:30,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:30,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:30,416 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:30,569 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:30,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:30,580 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:30,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:30,614 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:30,614 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:30,615 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:30,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:30,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:30,624 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:30,627 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,630 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:30,632 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:30,635 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:30,637 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:30,640 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,643 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:30,646 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:30,648 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:30,650 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:30,660 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:30,660 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:30,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:30,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:30,671 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:30,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:30,684 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:30,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:30,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:30,704 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:30,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:30,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:30,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:30,714 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:30,714 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:30,715 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:30,715 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:30,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:30,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:30,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:30,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:30,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:30,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:30,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:30,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:30,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:30,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:30,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:30,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:30,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:30,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:30,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:30,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:30,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:30,721 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:30,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:30,721 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:30,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:30,721 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:30,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:30,722 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:30,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:30,722 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:30,722 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:30,723 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:30,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:30,723 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:30,723 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:30,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:30,736 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:30,737 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:30,738 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:30,738 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:30,740 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:30,740 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:30,740 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:30,741 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:30,757 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3846, Threshold=0.4477, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:30,758 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3846
2025-08-04 20:39:36,030 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:36,030 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:36,031 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:36,031 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:36,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:36,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:36,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:36,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:36,393 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:36,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:36,429 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:36,516 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:36,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:36,522 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:36,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:36,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:36,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:36,533 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:36,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:36,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:36,541 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:36,544 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:36,547 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:36,549 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:36,552 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:36,554 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:36,556 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:36,559 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:36,561 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:36,563 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:36,566 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:36,575 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:36,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:36,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:36,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:36,585 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:36,585 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:36,593 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:36,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:36,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:36,609 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:36,614 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:36,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:36,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:36,619 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:36,619 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:36,619 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:36,620 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:36,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:36,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:36,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:36,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:36,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:36,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:36,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:36,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:36,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:36,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:36,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:36,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:36,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:36,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:36,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:36,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:36,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:36,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:36,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:36,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:36,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:36,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:36,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:36,626 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:36,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:36,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:36,630 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:36,631 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:36,632 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:36,632 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:36,633 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 82/400.
2025-08-04 20:39:36,735 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:36,735 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:36,736 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:39:36,736 - ClientAppLogger [Client 5] - INFO - [Client] Round 82: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:39:36,736 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:36,821 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.9075
2025-08-04 20:39:36,821 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.9075
2025-08-04 20:39:36,821 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:36,837 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3864, Threshold=0.4498, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:36,838 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:39:36,838 - ClientAppLogger [Client 5] - INFO - Fit completed for round 82. Duration: 0.20s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 82, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085485601425171, 'd_loss': 0.9074682354927063, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.2043323516845703, 'cpu_percent_fit': 47.83125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:39:36,838 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:39:42,113 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:42,114 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:42,114 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:42,114 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:42,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:42,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:42,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:42,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:42,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:42,548 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:42,548 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:42,659 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:42,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:42,666 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:42,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:42,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:42,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:42,680 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:42,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:42,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:42,690 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:42,693 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,696 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:42,698 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:42,701 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:42,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:42,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,709 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:42,713 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:42,716 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:42,719 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:42,730 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:42,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:42,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:42,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:42,741 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:42,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:42,753 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:42,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:42,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:42,771 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:42,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:42,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:42,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:42,783 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:42,783 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:42,783 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:42,784 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:42,784 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:42,784 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:42,784 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:42,784 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:42,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:42,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:42,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:42,787 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:42,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:42,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:42,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:42,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:42,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:42,789 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:42,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:42,789 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:42,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:42,789 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:42,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:42,790 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:42,790 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:42,790 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:42,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:42,791 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:42,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:42,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:42,795 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:42,795 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:42,797 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:42,797 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:42,799 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:42,799 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:42,799 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:42,800 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:42,817 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3731, Threshold=0.4309, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:42,817 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3731
2025-08-04 20:39:48,066 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:48,066 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:48,066 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:48,066 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:48,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:48,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:48,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:48,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:48,400 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:48,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:48,434 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:48,521 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:48,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:48,527 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:48,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:48,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:48,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:48,538 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:48,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:48,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:48,546 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:48,549 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:48,551 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:48,553 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:48,556 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:48,558 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:48,561 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:48,563 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:48,566 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:48,568 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:48,570 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:48,579 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:48,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:48,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:48,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:48,588 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:48,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:48,596 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:48,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:48,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:48,611 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:48,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:48,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:48,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:48,621 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:48,621 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:48,621 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:48,622 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:48,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:48,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:48,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:48,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:48,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:48,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:48,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:48,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:48,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:48,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:48,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:48,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:48,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:48,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:48,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:48,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:48,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:48,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:48,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:48,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:48,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:48,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:48,627 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:48,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:48,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:48,631 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:48,631 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:48,632 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:48,633 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:48,634 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 83/400.
2025-08-04 20:39:48,735 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:48,735 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:48,736 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:39:48,737 - ClientAppLogger [Client 5] - INFO - [Client] Round 83: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:39:48,737 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:48,762 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.9178
2025-08-04 20:39:48,762 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.9178
2025-08-04 20:39:48,762 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:48,776 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3808, Threshold=0.4401, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:48,777 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:39:48,777 - ClientAppLogger [Client 5] - INFO - Fit completed for round 83. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 83, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083550238609314, 'd_loss': 0.9177546083927155, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14338922500610352, 'cpu_percent_fit': 45.3875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:39:48,778 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:39:57,063 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:57,063 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:39:57,063 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:39:57,063 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:39:57,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:39:57,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:57,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:57,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:57,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:39:57,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:39:57,535 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:57,664 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:57,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:57,670 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:57,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:39:57,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:57,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:39:57,713 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:57,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:57,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:39:57,722 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:57,725 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:57,728 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:57,730 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:57,733 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:57,735 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:57,738 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:57,741 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:57,744 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:57,746 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:57,749 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:57,761 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:57,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:39:57,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:39:57,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:39:57,775 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:57,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:39:57,790 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:57,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:39:57,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:57,807 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:57,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:39:57,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:39:57,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:57,821 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:57,821 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:57,821 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:57,822 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:57,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:39:57,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:57,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:39:57,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:57,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:39:57,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:39:57,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:57,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:39:57,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:57,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:57,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:57,826 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:39:57,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:39:57,826 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:39:57,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:39:57,826 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:39:57,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:39:57,827 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:39:57,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:39:57,827 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:39:57,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:39:57,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:39:57,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:39:57,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:57,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:39:57,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:57,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:57,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:57,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:39:57,829 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:39:57,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:39:57,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:39:57,838 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:39:57,838 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:57,839 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:57,839 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:39:57,841 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:57,841 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:57,841 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:57,842 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:57,856 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4037, Threshold=0.4682, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:39:57,856 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4037
2025-08-04 20:40:12,148 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:12,148 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:40:12,148 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:40:12,149 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:40:12,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:40:12,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:12,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:12,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:12,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:40:12,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:40:12,620 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:12,748 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:12,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:12,755 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:12,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:40:12,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:12,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:40:12,773 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:12,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:12,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:40:12,784 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:12,787 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,791 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:12,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:12,796 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:12,799 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:12,803 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,805 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:12,808 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:12,811 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:12,814 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:12,825 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:12,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:40:12,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:40:12,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:40:12,835 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:12,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:40:12,845 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:12,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:40:12,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:12,862 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:12,867 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:40:12,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:40:12,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:12,874 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:12,874 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:12,874 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:12,875 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:12,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:40:12,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:12,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:40:12,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:12,877 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:40:12,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:40:12,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:12,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:40:12,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:12,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:12,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:12,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:40:12,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:40:12,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:40:12,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:40:12,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:40:12,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:40:12,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:40:12,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:40:12,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:40:12,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:40:12,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:40:12,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:40:12,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:12,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:40:12,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:12,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:12,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:12,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:40:12,882 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:40:12,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:40:12,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:40:12,886 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:40:12,886 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:12,888 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:12,888 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:40:12,889 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:12,889 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:12,890 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:12,890 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:12,908 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4070, Threshold=0.4706, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:40:12,908 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4070
2025-08-04 20:40:18,170 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:18,170 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:40:18,170 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:40:18,170 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:40:18,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:40:18,171 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:18,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:18,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:18,512 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:40:18,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:40:18,547 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:18,633 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:18,639 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:18,639 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:18,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:40:18,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:18,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:40:18,650 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:18,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:18,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:40:18,658 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:18,661 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:18,664 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:18,666 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:18,669 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:18,671 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:18,674 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:18,676 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:18,679 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:18,681 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:18,684 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:18,693 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:18,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:40:18,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:40:18,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:40:18,702 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:18,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:40:18,710 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:18,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:40:18,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:18,725 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:18,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:40:18,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:40:18,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:18,736 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:18,736 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:18,736 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:18,736 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:18,737 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:40:18,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:18,737 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:40:18,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:18,738 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:40:18,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:40:18,739 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:40:18,740 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:40:18,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:40:18,741 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:40:18,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:40:18,741 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:18,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:40:18,741 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:18,742 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:18,742 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:18,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:40:18,742 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:40:18,743 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:40:18,743 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:40:18,746 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:40:18,746 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:18,748 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:18,748 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:40:18,749 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 85/400.
2025-08-04 20:40:18,850 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:18,850 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:18,851 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:40:18,851 - ClientAppLogger [Client 5] - INFO - [Client] Round 85: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:40:18,852 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:18,877 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8866
2025-08-04 20:40:18,877 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8866
2025-08-04 20:40:18,881 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:18,895 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4026, Threshold=0.4633, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:40:18,895 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:40:18,895 - ClientAppLogger [Client 5] - INFO - Fit completed for round 85. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 85, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084123969078064, 'd_loss': 0.8865955173969269, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14632701873779297, 'cpu_percent_fit': 46.59375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:40:18,896 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:40:24,176 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:24,177 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:40:24,177 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:40:24,177 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:40:24,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:40:24,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:24,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:24,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:24,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:40:24,734 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:40:24,734 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:24,893 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:24,902 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:24,903 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:24,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:40:24,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:24,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:40:24,915 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:24,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:24,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:40:24,924 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:24,927 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,930 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:24,933 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:24,936 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:24,939 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:24,943 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,945 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:24,949 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:24,951 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:24,954 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:24,964 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:24,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:40:24,969 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:40:24,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:40:24,975 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:24,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:40:24,986 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:24,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:40:24,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:25,005 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:25,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:40:25,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:40:25,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:25,019 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:25,019 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:25,020 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:25,020 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:25,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:40:25,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:25,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:40:25,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:25,022 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:40:25,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:40:25,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:25,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:40:25,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:25,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:25,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:25,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:40:25,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:40:25,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:40:25,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:40:25,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:40:25,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:40:25,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:40:25,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:40:25,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:40:25,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:40:25,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:40:25,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:40:25,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:25,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:40:25,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:25,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:25,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:25,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:40:25,027 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:40:25,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:40:25,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:40:25,035 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:40:25,035 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:25,036 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:25,036 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:40:25,038 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:25,038 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:25,038 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:25,039 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:25,055 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3845, Threshold=0.4376, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:40:25,055 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3845
2025-08-04 20:40:30,315 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:30,316 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:40:30,316 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:40:30,316 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:40:30,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:40:30,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:30,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:30,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:30,704 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:40:30,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:40:30,742 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:30,836 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:30,841 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:30,841 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:30,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:40:30,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:30,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:40:30,852 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:30,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:30,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:40:30,861 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:30,865 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:30,867 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:30,870 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:30,873 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:30,875 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:30,877 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:30,880 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:30,882 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:30,884 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:30,886 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:30,895 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:30,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:40:30,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:40:30,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:40:30,905 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:30,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:40:30,915 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:30,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:40:30,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:30,930 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:30,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:40:30,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:40:30,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:30,941 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:30,941 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:30,942 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:30,942 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:30,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:40:30,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:30,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:40:30,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:30,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:40:30,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:40:30,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:30,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:40:30,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:40:30,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:40:30,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:40:30,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:40:30,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:40:30,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:40:30,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:40:30,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:40:30,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:40:30,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:30,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:40:30,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:30,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:30,948 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:30,948 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:40:30,948 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:40:30,948 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:40:30,948 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:40:30,951 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:40:30,951 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:30,953 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:30,953 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:40:30,954 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 86/400.
2025-08-04 20:40:31,055 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:31,055 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:31,056 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:40:31,057 - ClientAppLogger [Client 5] - INFO - [Client] Round 86: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:40:31,057 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:31,083 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0886, Avg D Loss: 0.9288
2025-08-04 20:40:31,083 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0886, Avg D Loss: 0.9288
2025-08-04 20:40:31,086 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:31,102 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3851, Threshold=0.4300, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:40:31,102 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:40:31,102 - ClientAppLogger [Client 5] - INFO - Fit completed for round 86. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 86, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0885661602020265, 'd_loss': 0.9287877261638642, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14794278144836426, 'cpu_percent_fit': 46.35625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:40:31,102 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:40:39,378 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:39,378 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:40:39,379 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:40:39,379 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:40:39,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:40:39,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:39,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:39,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:40,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:40:40,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:40:40,094 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:40,268 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:40,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:40,276 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:40,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:40:40,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:40,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:40:40,295 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:40,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:40,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:40:40,309 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:40,314 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,317 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:40,321 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:40,325 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:40,328 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:40,331 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,335 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:40,340 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:40,343 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:40,346 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:40,361 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:40,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:40:40,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:40:40,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:40:40,374 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:40,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:40:40,388 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:40,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:40:40,389 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:40,407 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:40,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:40:40,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:40:40,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:40,419 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:40,419 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:40,419 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:40,420 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:40,420 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:40:40,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:40,421 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:40:40,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:40,422 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:40:40,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:40:40,423 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:40,423 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:40:40,423 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:40,423 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:40,424 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:40,424 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:40:40,424 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:40:40,424 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:40:40,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:40:40,425 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:40:40,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:40:40,425 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:40:40,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:40:40,426 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:40:40,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:40:40,427 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:40:40,427 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:40:40,427 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:40,427 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:40:40,428 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:40,429 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:40,429 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:40,429 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:40:40,429 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:40:40,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:40:40,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:40:40,438 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:40:40,438 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:40,439 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:40,440 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:40:40,441 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:40,441 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:40,441 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:40,442 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:40,470 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4158, Threshold=0.4849, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:40:40,470 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4158
2025-08-04 20:40:54,761 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:54,761 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:40:54,762 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:40:54,762 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:40:54,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:40:54,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:55,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:55,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:55,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:40:55,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:40:55,244 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:55,351 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:55,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:55,360 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:55,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:40:55,376 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:55,376 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:40:55,376 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:55,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:55,377 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:40:55,387 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:55,390 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,392 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:55,395 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:55,398 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:55,400 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:55,403 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,405 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:55,408 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:55,410 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:55,412 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:55,426 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:55,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:40:55,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:40:55,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:40:55,439 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:55,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:40:55,452 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:55,453 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:40:55,453 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:55,472 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:55,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:40:55,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:40:55,490 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:55,490 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:55,490 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:55,491 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:55,491 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:55,492 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:40:55,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:55,492 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:40:55,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:55,493 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:40:55,494 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:40:55,494 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:55,494 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:40:55,494 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:55,495 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:55,495 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:55,495 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:40:55,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:40:55,496 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:40:55,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:40:55,496 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:40:55,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:40:55,497 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:40:55,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:40:55,497 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:40:55,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:40:55,498 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:40:55,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:40:55,499 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:55,499 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:40:55,499 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:55,499 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:55,499 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:55,500 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:40:55,500 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:40:55,500 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:40:55,500 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:40:55,504 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:40:55,504 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:55,506 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:55,506 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:40:55,508 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:55,508 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:55,508 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:55,509 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:55,538 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4203, Threshold=0.4826, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:40:55,538 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4203
2025-08-04 20:41:00,804 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:00,804 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:00,805 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:00,805 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:00,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:00,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:01,117 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:01,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:01,202 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:01,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:01,245 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:01,358 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:01,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:01,365 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:01,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:01,382 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:01,382 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:01,383 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:01,383 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:01,383 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:01,392 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:01,395 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:01,397 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:01,399 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:01,402 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:01,404 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:01,406 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:01,409 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:01,412 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:01,414 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:01,416 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:01,426 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:01,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:01,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:01,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:01,437 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:01,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:01,449 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:01,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:01,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:01,466 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:01,470 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:01,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:01,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:01,477 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:01,477 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:01,477 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:01,477 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:01,478 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:01,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:01,478 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:01,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:01,480 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:01,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:01,480 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:01,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:01,480 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:01,481 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:01,481 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:01,481 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:01,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:01,481 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:01,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:01,482 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:01,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:01,482 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:01,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:01,482 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:01,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:01,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:01,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:01,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:01,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:01,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:01,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:01,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:01,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:01,484 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:01,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:01,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:01,492 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:01,492 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:01,494 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:01,494 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:01,496 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 88/400.
2025-08-04 20:41:01,596 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:01,597 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:01,598 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:41:01,598 - ClientAppLogger [Client 5] - INFO - [Client] Round 88: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:41:01,598 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:01,633 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0879, Avg D Loss: 0.9166
2025-08-04 20:41:01,633 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0879, Avg D Loss: 0.9166
2025-08-04 20:41:01,637 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:01,653 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3992, Threshold=0.4474, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:01,653 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:41:01,654 - ClientAppLogger [Client 5] - INFO - Fit completed for round 88. Duration: 0.16s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 88, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0878828048706053, 'd_loss': 0.9166165351867676, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.1578834056854248, 'cpu_percent_fit': 43.68125, 'ram_mb_fit': 1.65625, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:41:01,654 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:41:09,920 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:09,920 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:09,920 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:09,920 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:09,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:09,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:10,303 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:10,304 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:10,402 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:10,429 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:10,429 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:10,593 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:10,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:10,604 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:10,613 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:10,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:10,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:10,626 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:10,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:10,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:10,639 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:10,642 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,644 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:10,647 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:10,650 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:10,652 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:10,655 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,658 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:10,661 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:10,663 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:10,667 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:10,680 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:10,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:10,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:10,686 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:10,692 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:10,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:10,706 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:10,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:10,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:10,724 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:10,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:10,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:10,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:10,740 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:10,740 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:10,741 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:10,741 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:10,741 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:10,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:10,742 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:10,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:10,744 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:10,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:10,745 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:10,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:10,745 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:10,745 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:10,746 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:10,746 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:10,746 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:10,746 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:10,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:10,747 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:10,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:10,747 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:10,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:10,748 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:10,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:10,749 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:10,749 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:10,749 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:10,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:10,750 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:10,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:10,756 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:10,757 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:10,758 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:10,758 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:10,760 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:10,760 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:10,760 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:10,761 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:10,796 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3896, Threshold=0.4391, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:10,797 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3896
2025-08-04 20:41:16,055 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:16,055 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:16,055 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:16,056 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:16,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:16,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:16,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:16,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:16,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:16,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:16,483 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:16,584 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:16,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:16,592 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:16,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:16,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:16,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:16,604 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:16,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:16,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:16,614 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:16,617 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:16,619 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:16,622 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:16,625 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:16,627 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:16,630 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:16,633 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:16,635 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:16,638 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:16,641 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:16,652 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:16,652 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:16,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:16,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:16,665 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:16,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:16,679 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:16,679 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:16,679 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:16,698 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:16,703 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:16,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:16,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:16,712 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:16,712 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:16,712 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:16,713 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:16,713 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:16,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:16,713 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:16,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:16,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:16,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:16,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:16,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:16,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:16,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:16,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:16,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:16,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:16,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:16,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:16,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:16,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:16,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:16,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:16,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:16,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:16,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:16,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:16,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:16,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:16,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:16,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:16,720 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:16,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:16,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:16,725 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:16,725 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:16,727 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:16,727 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:16,728 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 89/400.
2025-08-04 20:41:16,830 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:16,830 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:16,832 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:41:16,832 - ClientAppLogger [Client 5] - INFO - [Client] Round 89: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:41:16,832 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:16,870 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0857, Avg D Loss: 0.9143
2025-08-04 20:41:16,871 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0857, Avg D Loss: 0.9143
2025-08-04 20:41:16,871 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:16,888 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3882, Threshold=0.4299, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:16,889 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:41:16,889 - ClientAppLogger [Client 5] - INFO - Fit completed for round 89. Duration: 0.16s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 89, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0857213735580444, 'd_loss': 0.9143172204494476, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.16042017936706543, 'cpu_percent_fit': 46.5625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:41:16,889 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:41:22,170 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:22,170 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:22,170 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:22,171 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:22,171 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:22,171 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:22,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:22,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:22,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:22,734 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:22,734 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:22,885 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:22,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:22,894 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:22,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:22,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:22,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:22,967 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:22,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:22,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:22,979 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:22,983 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,985 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:22,987 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:22,990 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:22,993 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:22,996 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:22,999 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:23,002 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:23,005 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:23,009 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:23,021 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:23,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:23,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:23,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:23,036 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:23,036 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:23,053 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:23,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:23,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:23,075 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:23,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:23,092 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:23,092 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:23,092 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:23,093 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:23,093 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:23,093 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:23,094 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:23,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:23,094 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:23,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:23,096 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:23,096 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:23,096 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:23,097 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:23,097 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:23,097 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:23,097 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:23,097 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:23,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:23,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:23,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:23,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:23,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:23,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:23,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:23,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:23,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:23,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:23,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:23,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:23,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:23,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:23,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:23,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:23,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:23,101 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:23,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:23,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:23,111 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:23,111 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:23,112 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:23,112 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:23,113 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:23,114 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:23,114 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:23,114 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:23,132 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3939, Threshold=0.4351, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:23,132 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3939
2025-08-04 20:41:34,408 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:34,408 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:34,409 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:34,409 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:34,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:34,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:34,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:34,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:35,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:35,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:35,121 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:35,308 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:35,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:35,320 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:35,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:35,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:35,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:35,346 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:35,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:35,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:35,360 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:35,364 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,368 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:35,373 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:35,377 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:35,382 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:35,386 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,389 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:35,392 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:35,395 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:35,398 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:35,409 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:35,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:35,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:35,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:35,421 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:35,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:35,438 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:35,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:35,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:35,457 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:35,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:35,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:35,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:35,472 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:35,472 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:35,472 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:35,472 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:35,473 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:35,473 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:35,474 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:35,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:35,476 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:35,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:35,476 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:35,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:35,477 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:35,477 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:35,477 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:35,477 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:35,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:35,478 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:35,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:35,479 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:35,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:35,480 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:35,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:35,480 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:35,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:35,481 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:35,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:35,482 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:35,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:35,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:35,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:35,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:35,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:35,484 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:35,485 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:35,485 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:35,496 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:35,496 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:35,498 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:35,498 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:35,500 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:35,501 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:35,501 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:35,502 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:35,529 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4365, Threshold=0.5006, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:35,529 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4365
2025-08-04 20:41:49,803 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:49,804 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:49,804 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:49,804 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:49,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:49,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:50,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:50,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:50,380 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:50,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:50,432 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:50,551 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:50,560 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:50,560 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:50,567 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:50,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:50,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:50,576 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:50,576 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:50,576 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:50,587 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:50,591 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,594 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:50,596 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:50,600 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:50,606 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:50,608 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,611 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:50,614 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:50,618 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:50,620 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:50,632 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:50,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:50,639 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:50,639 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:50,645 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:50,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:50,659 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:50,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:50,660 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:50,675 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:50,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:50,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:50,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:50,694 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:50,694 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:50,695 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:50,695 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:50,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:50,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:50,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:50,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:50,697 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:50,697 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:50,697 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:50,697 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:50,697 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:50,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:50,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:50,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:50,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:50,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:50,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:50,699 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:50,699 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:50,699 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:50,699 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:50,699 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:50,699 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:50,700 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:50,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:50,700 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:50,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:50,700 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:50,701 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:50,701 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:50,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:50,701 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:50,701 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:50,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:50,705 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:50,705 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:50,706 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:50,706 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:50,708 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:50,708 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:50,708 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:50,708 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:50,724 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4261, Threshold=0.4958, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:50,724 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4261
2025-08-04 20:41:55,978 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:55,978 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:41:55,978 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:41:55,978 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:41:55,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:41:55,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:56,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:56,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:56,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:41:56,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:41:56,344 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:56,452 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:56,457 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:56,458 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:56,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:41:56,467 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:56,467 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:41:56,468 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:56,468 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:56,468 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:41:56,476 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:56,479 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:56,481 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:56,483 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:56,486 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:56,488 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:56,491 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:56,493 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:56,496 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:56,498 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:56,500 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:56,508 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:56,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:41:56,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:41:56,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:41:56,518 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:56,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:41:56,526 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:56,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:41:56,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:56,541 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:56,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:41:56,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:41:56,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:56,552 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:56,552 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:56,552 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:56,553 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:56,553 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:41:56,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:56,553 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:41:56,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:56,555 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:41:56,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:41:56,555 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:56,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:41:56,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:56,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:56,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:56,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:41:56,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:41:56,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:41:56,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:41:56,557 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:41:56,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:41:56,557 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:41:56,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:41:56,558 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:41:56,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:41:56,558 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:41:56,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:41:56,558 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:56,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:41:56,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:56,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:56,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:56,559 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:41:56,560 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:41:56,560 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:41:56,560 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:41:56,563 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:41:56,564 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:56,565 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:56,565 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:41:56,566 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 92/400.
2025-08-04 20:41:56,668 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:56,668 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:56,670 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:41:56,670 - ClientAppLogger [Client 5] - INFO - [Client] Round 92: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:41:56,670 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:56,696 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0901, Avg D Loss: 0.8907
2025-08-04 20:41:56,696 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0901, Avg D Loss: 0.8907
2025-08-04 20:41:56,696 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:56,711 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4049, Threshold=0.4599, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:41:56,711 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:41:56,712 - ClientAppLogger [Client 5] - INFO - Fit completed for round 92. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 92, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0900500774383546, 'd_loss': 0.8906595349311829, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14496660232543945, 'cpu_percent_fit': 45.9875, 'ram_mb_fit': 8.5390625, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:41:56,712 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:42:04,999 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:04,999 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:42:04,999 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:42:04,999 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:42:04,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:42:04,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:05,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:05,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:05,543 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:42:05,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:42:05,595 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:05,731 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:05,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:05,738 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:05,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:42:05,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:05,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:42:05,759 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:05,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:05,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:42:05,770 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:05,773 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,775 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:05,778 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:05,781 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:05,783 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:05,785 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,788 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:05,791 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:05,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:05,796 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:05,805 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:05,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:42:05,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:42:05,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:42:05,815 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:05,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:42:05,827 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:42:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:05,844 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:05,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:42:05,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:42:05,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:05,854 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:05,854 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:05,855 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:05,855 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:05,855 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:42:05,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:05,856 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:42:05,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:05,857 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:42:05,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:42:05,858 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:05,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:42:05,858 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:05,858 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:42:05,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:42:05,860 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:05,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:42:05,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:05,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:05,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:05,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:42:05,861 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:42:05,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:42:05,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:42:05,871 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:42:05,871 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:05,872 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:05,872 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:42:05,874 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:05,874 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:05,874 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:05,875 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:05,888 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3910, Threshold=0.4461, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:42:05,888 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3910
2025-08-04 20:42:20,159 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:20,159 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:42:20,160 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:42:20,160 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:42:20,160 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:42:20,160 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:20,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:20,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:20,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:42:20,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:42:20,557 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:20,651 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:20,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:20,657 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:20,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:42:20,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:20,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:42:20,670 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:20,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:20,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:42:20,679 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:20,682 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:20,684 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:20,690 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:20,693 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:20,695 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:20,698 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:20,700 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:20,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:20,705 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:20,707 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:20,718 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:20,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:42:20,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:42:20,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:42:20,728 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:20,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:42:20,738 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:20,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:42:20,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:20,753 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:20,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:42:20,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:42:20,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:20,766 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:20,766 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:20,766 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:20,766 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:20,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:42:20,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:20,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:42:20,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:20,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:42:20,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:42:20,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:20,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:42:20,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:20,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:42:20,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:42:20,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:42:20,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:42:20,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:42:20,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:42:20,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:42:20,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:42:20,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:20,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:42:20,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:20,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:20,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:20,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:42:20,773 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:42:20,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:42:20,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:42:20,776 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:42:20,776 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:20,777 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:20,778 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:42:20,779 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:20,779 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:20,779 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:20,780 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:20,794 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4089, Threshold=0.4551, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:42:20,794 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4089
2025-08-04 20:42:32,077 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:32,077 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:42:32,077 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:42:32,077 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:42:32,077 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:42:32,077 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:32,350 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:32,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:32,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:42:32,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:42:32,469 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:32,577 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:32,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:32,582 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:32,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:42:32,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:32,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:42:32,593 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:32,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:32,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:42:32,601 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:32,604 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:32,606 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:32,608 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:32,611 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:32,613 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:32,615 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:32,618 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:32,620 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:32,622 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:32,624 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:32,633 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:32,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:42:32,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:42:32,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:42:32,642 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:32,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:42:32,650 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:32,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:42:32,651 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:32,665 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:32,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:42:32,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:42:32,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:32,675 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:32,675 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:32,675 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:32,676 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:32,676 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:42:32,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:32,676 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:42:32,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:32,677 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:42:32,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:42:32,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:32,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:42:32,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:32,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:32,678 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:42:32,679 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:32,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:42:32,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:32,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:32,681 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:32,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:42:32,681 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:42:32,682 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:42:32,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:42:32,689 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:42:32,689 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:32,690 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:32,690 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:42:32,691 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 94/400.
2025-08-04 20:42:32,792 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:32,792 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:32,793 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:42:32,794 - ClientAppLogger [Client 5] - INFO - [Client] Round 94: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:42:32,794 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:32,820 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0827, Avg D Loss: 0.8495
2025-08-04 20:42:32,820 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0827, Avg D Loss: 0.8495
2025-08-04 20:42:32,820 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:32,834 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4085, Threshold=0.4501, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:42:32,834 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:42:32,834 - ClientAppLogger [Client 5] - INFO - Fit completed for round 94. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 94, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0827013492584228, 'd_loss': 0.8494602859020233, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14281535148620605, 'cpu_percent_fit': 46.2625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:42:32,835 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:42:38,114 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:38,114 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:42:38,115 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:42:38,115 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:42:38,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:42:38,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:38,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:38,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:38,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:42:38,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:42:38,685 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:38,795 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:38,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:38,803 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:38,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:42:38,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:38,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:42:38,820 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:38,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:38,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:42:38,830 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:38,833 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,836 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:38,838 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:38,841 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:38,843 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:38,846 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:38,851 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:38,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:38,855 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:38,866 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:38,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:42:38,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:42:38,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:42:38,877 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:38,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:42:38,889 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:38,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:42:38,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:38,909 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:38,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:42:38,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:42:38,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:38,926 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:38,926 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:38,927 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:38,927 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:38,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:42:38,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:38,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:42:38,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:38,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:42:38,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:42:38,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:42:38,931 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:42:38,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:42:38,931 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:42:38,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:42:38,931 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:42:38,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:42:38,932 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:42:38,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:42:38,932 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:42:38,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:42:38,932 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:38,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:42:38,933 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:38,933 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:38,933 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:38,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:42:38,933 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:42:38,934 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:42:38,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:42:38,938 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:42:38,938 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:38,939 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:38,939 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:42:38,941 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:38,941 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:38,941 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:38,942 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:38,962 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3863, Threshold=0.4237, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:42:38,963 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3863
2025-08-04 20:42:47,226 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:47,226 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:42:47,226 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:42:47,227 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:42:47,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:42:47,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:47,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:47,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:47,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:42:47,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:42:47,579 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:47,662 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:47,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:47,668 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:47,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:42:47,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:47,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:42:47,682 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:47,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:47,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:42:47,691 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:47,694 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:47,696 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:47,698 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:47,701 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:47,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:47,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:47,709 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:47,711 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:47,713 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:47,716 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:47,724 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:47,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:42:47,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:42:47,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:42:47,733 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:47,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:42:47,742 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:47,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:42:47,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:47,757 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:47,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:42:47,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:42:47,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:47,767 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:47,767 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:47,767 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:47,767 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:47,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:42:47,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:47,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:42:47,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:47,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:42:47,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:42:47,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:47,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:42:47,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:47,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:42:47,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:42:47,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:42:47,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:42:47,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:42:47,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:42:47,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:42:47,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:42:47,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:47,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:42:47,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:47,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:47,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:47,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:42:47,774 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:42:47,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:42:47,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:42:47,778 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:42:47,778 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:47,780 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:47,780 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:42:47,781 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 95/400.
2025-08-04 20:42:47,882 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:47,883 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:47,884 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:42:47,885 - ClientAppLogger [Client 5] - INFO - [Client] Round 95: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:42:47,885 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:42:47,911 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.8474
2025-08-04 20:42:47,912 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.8474
2025-08-04 20:42:47,912 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:42:47,929 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4303, Threshold=0.4772, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:42:47,929 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:42:47,930 - ClientAppLogger [Client 5] - INFO - Fit completed for round 95. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 95, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0834129571914675, 'd_loss': 0.8473707854747772, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.14855122566223145, 'cpu_percent_fit': 46.10625, 'ram_mb_fit': 3.56640625, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:42:47,930 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:42:56,194 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:56,194 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:42:56,194 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:42:56,194 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:42:56,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:42:56,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:56,549 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:56,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:56,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:42:56,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:42:56,698 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:56,832 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:56,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:56,843 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:56,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:42:56,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:56,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:42:56,864 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:56,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:56,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:42:56,874 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:56,877 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:56,880 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:56,882 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:56,885 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:56,887 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:56,890 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:56,892 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:56,895 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:56,898 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:56,900 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:56,911 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:56,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:42:56,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:42:56,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:42:56,924 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:56,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:42:56,937 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:56,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:42:56,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:56,960 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:56,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:42:56,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:42:56,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:56,985 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:56,985 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:56,986 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:56,986 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:56,987 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:42:56,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:56,987 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:42:56,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:56,989 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:42:56,989 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:42:56,989 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:56,989 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:42:56,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:56,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:56,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:56,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:42:56,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:42:56,991 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:42:56,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:42:56,991 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:42:56,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:42:56,991 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:42:56,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:42:56,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:42:56,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:42:56,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:42:56,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:42:56,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:56,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:42:56,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:56,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:56,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:56,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:42:56,994 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:42:56,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:42:56,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:42:57,003 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:42:57,003 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:57,005 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:57,005 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:42:57,006 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:57,007 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:57,007 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:57,007 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:57,026 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4055, Threshold=0.4346, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:42:57,027 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4055
2025-08-04 20:43:05,279 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:05,280 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:43:05,280 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:43:05,280 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:43:05,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:43:05,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:05,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:05,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:05,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:43:05,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:43:05,636 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:05,719 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:05,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:05,725 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:05,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:43:05,734 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:05,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:43:05,735 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:05,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:05,735 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:43:05,743 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:05,746 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:05,748 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:05,750 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:05,753 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:05,755 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:05,758 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:05,760 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:05,763 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:05,765 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:05,767 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:05,776 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:05,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:43:05,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:43:05,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:43:05,785 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:05,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:43:05,793 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:05,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:43:05,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:05,808 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:05,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:43:05,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:43:05,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:05,819 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:05,819 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:05,819 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:05,820 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:05,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:43:05,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:05,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:43:05,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:05,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:43:05,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:43:05,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:05,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:43:05,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:43:05,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:43:05,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:43:05,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:43:05,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:43:05,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:43:05,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:43:05,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:43:05,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:05,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:43:05,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:05,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:05,826 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:05,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:43:05,826 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:43:05,826 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:43:05,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:43:05,831 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:43:05,831 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:05,833 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:05,833 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:43:05,834 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 96/400.
2025-08-04 20:43:05,935 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:05,935 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:05,936 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:43:05,936 - ClientAppLogger [Client 5] - INFO - [Client] Round 96: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:43:05,936 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:05,962 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0800, Avg D Loss: 0.8448
2025-08-04 20:43:05,962 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0800, Avg D Loss: 0.8448
2025-08-04 20:43:05,962 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:05,977 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4332, Threshold=0.4689, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:43:05,977 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:43:05,977 - ClientAppLogger [Client 5] - INFO - Fit completed for round 96. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 96, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0800190448760985, 'd_loss': 0.84478719830513, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.1428391933441162, 'cpu_percent_fit': 45.66875, 'ram_mb_fit': 2.87109375, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:43:05,977 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:43:11,236 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:11,237 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:43:11,237 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:43:11,237 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:43:11,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:43:11,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:11,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:11,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:11,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:43:11,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:43:11,671 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:11,792 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:11,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:11,801 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:11,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:43:11,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:11,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:43:11,820 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:11,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:11,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:43:11,830 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:11,833 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:11,836 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:11,838 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:11,841 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:11,843 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:11,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:11,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:11,851 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:11,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:11,855 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:11,867 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:11,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:43:11,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:43:11,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:43:11,882 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:11,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:43:11,897 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:11,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:43:11,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:11,913 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:11,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:43:11,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:43:11,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:11,935 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:11,935 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:11,935 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:11,935 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:11,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:43:11,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:11,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:43:11,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:43:11,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:11,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:43:11,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:43:11,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:43:11,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:43:11,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:43:11,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:43:11,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:43:11,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:43:11,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:43:11,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:43:11,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:11,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:43:11,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:11,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:11,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:11,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:43:11,942 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:43:11,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:43:11,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:43:11,947 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:43:11,948 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:11,949 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:11,949 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:43:11,951 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:11,951 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:11,951 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:11,951 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:11,969 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4391, Threshold=0.4755, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:43:11,969 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4391
2025-08-04 20:43:26,242 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:26,242 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:43:26,242 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:43:26,243 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:43:26,243 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:43:26,243 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:26,543 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:26,543 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:26,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:43:26,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:43:26,669 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:26,789 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:26,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:26,798 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:26,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:43:26,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:26,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:43:26,813 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:26,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:26,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:43:26,822 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:26,825 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:26,828 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:26,830 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:26,833 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:26,835 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:26,838 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:26,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:26,843 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:26,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:26,847 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:26,860 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:26,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:43:26,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:43:26,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:43:26,874 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:26,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:43:26,886 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:26,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:43:26,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:26,905 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:26,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:43:26,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:43:26,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:26,916 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:26,917 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:26,917 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:26,917 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:26,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:43:26,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:26,918 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:43:26,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:26,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:43:26,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:43:26,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:26,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:43:26,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:26,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:26,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:43:26,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:43:26,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:43:26,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:43:26,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:43:26,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:43:26,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:43:26,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:26,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:43:26,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:26,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:26,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:26,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:43:26,924 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:43:26,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:43:26,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:43:26,931 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:43:26,931 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:26,932 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:26,932 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:43:26,934 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:26,934 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:26,934 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:26,935 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:26,951 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4121, Threshold=0.4402, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:43:26,951 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4121
2025-08-04 20:43:44,229 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:44,229 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:43:44,229 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:43:44,229 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:43:44,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:43:44,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:44,512 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:44,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:44,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:43:44,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:43:44,650 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:44,780 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:44,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:44,790 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:44,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:43:44,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:44,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:43:44,805 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:44,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:44,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:43:44,815 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:44,818 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:44,820 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:44,823 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:44,825 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:44,828 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:44,831 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:44,834 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:44,837 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:44,839 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:44,841 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:44,851 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:44,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:43:44,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:43:44,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:43:44,861 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:44,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:43:44,872 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:44,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:43:44,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:44,890 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:44,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:43:44,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:43:44,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:44,905 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:44,905 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:44,905 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:44,905 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:44,905 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:43:44,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:44,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:43:44,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:44,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:43:44,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:43:44,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:43:44,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:43:44,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:43:44,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:43:44,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:43:44,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:43:44,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:43:44,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:43:44,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:43:44,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:43:44,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:43:44,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:44,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:43:44,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:44,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:44,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:44,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:43:44,912 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:43:44,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:43:44,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:43:44,917 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:43:44,918 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:44,919 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:44,919 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:43:44,921 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:44,921 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:44,921 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:44,922 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:44,939 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4486, Threshold=0.4756, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:43:44,940 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4486
2025-08-04 20:43:59,209 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:59,209 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:43:59,209 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:43:59,209 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:43:59,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:43:59,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:59,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:59,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:59,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:43:59,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:43:59,673 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:59,801 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:59,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:59,809 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:59,818 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:43:59,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:59,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:43:59,826 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:59,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:59,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:43:59,836 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:59,839 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:59,841 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:59,844 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:59,847 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:59,849 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:59,852 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:59,854 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:59,857 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:59,859 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:59,862 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:59,872 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:59,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:43:59,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:43:59,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:43:59,883 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:59,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:43:59,896 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:59,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:43:59,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:59,917 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:59,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:43:59,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:43:59,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:59,939 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:59,940 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:59,940 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:59,940 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:59,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:43:59,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:59,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:43:59,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:59,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:43:59,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:43:59,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:59,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:43:59,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:43:59,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:43:59,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:43:59,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:43:59,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:43:59,945 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:43:59,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:43:59,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:43:59,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:43:59,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:59,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:43:59,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:59,946 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:59,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:59,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:43:59,947 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:43:59,947 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:43:59,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:43:59,955 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:43:59,956 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:59,957 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:59,957 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:43:59,959 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:59,959 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:59,959 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:59,960 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:59,976 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3872, Threshold=0.3938, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:43:59,976 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.3872
2025-08-04 20:44:05,227 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:05,227 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:44:05,227 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:44:05,227 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:44:05,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:44:05,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:05,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:05,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:05,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:44:05,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:44:05,631 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:05,742 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:05,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:05,748 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:05,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:44:05,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:05,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:44:05,760 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:05,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:05,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:44:05,769 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:05,772 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:05,774 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:05,776 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:05,779 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:05,781 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:05,784 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:05,786 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:05,789 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:05,791 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:05,794 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:05,802 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:05,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:44:05,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:44:05,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:44:05,811 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:05,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:44:05,820 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:05,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:44:05,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:05,835 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:05,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:44:05,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:44:05,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:05,846 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:05,846 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:05,847 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:05,847 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:05,847 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:44:05,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:05,847 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:44:05,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:05,849 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:44:05,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:44:05,850 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:05,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:44:05,850 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:05,850 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:05,851 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:05,851 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:44:05,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:44:05,851 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:44:05,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:44:05,851 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:44:05,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:44:05,852 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:44:05,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:44:05,852 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:44:05,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:44:05,852 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:44:05,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:44:05,853 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:05,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:44:05,853 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:05,853 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:05,853 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:05,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:44:05,854 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:44:05,854 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:44:05,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:44:05,861 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:44:05,861 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:05,863 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:05,863 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:44:05,864 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 100/400.
2025-08-04 20:44:05,966 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:05,966 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:05,967 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:44:05,967 - ClientAppLogger [Client 5] - INFO - [Client] Round 100: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:44:05,967 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:05,996 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0912, Avg D Loss: 0.8195
2025-08-04 20:44:05,996 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0912, Avg D Loss: 0.8195
2025-08-04 20:44:06,000 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:06,023 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4618, Threshold=0.4894, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:44:06,024 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:44:06,024 - ClientAppLogger [Client 5] - INFO - Fit completed for round 100. Duration: 0.16s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 100, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.091235566139221, 'd_loss': 0.8194661796092987, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.15984702110290527, 'cpu_percent_fit': 44.8375, 'ram_mb_fit': 0.17578125, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:44:06,024 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:44:11,279 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,279 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:44:11,279 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:44:11,279 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:44:11,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:44:11,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:11,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:11,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:11,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:44:11,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:44:11,795 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:11,931 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:11,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:11,941 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:11,948 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:44:11,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:11,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:44:11,960 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:11,960 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:11,961 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:44:11,972 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:11,975 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:11,978 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:11,981 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:11,984 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:11,987 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:11,991 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:11,994 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:11,998 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:12,000 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:12,002 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:12,016 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:12,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:44:12,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:44:12,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:44:12,031 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:12,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:44:12,046 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:12,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:44:12,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:12,066 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:12,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:44:12,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:44:12,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:12,093 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:12,094 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:12,094 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:12,095 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:12,095 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:44:12,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:12,095 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:44:12,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:12,097 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:44:12,097 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:44:12,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:12,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:44:12,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:12,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:12,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:12,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:44:12,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:44:12,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:44:12,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:44:12,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:44:12,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:44:12,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:44:12,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:44:12,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:44:12,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:44:12,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:44:12,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:44:12,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:12,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:44:12,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:12,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:12,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:12,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:44:12,103 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:44:12,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:44:12,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:44:12,109 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:44:12,109 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:12,111 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:12,111 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:44:12,112 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:12,113 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:12,113 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:12,114 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:12,134 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4091, Threshold=0.4197, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:44:12,134 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4091
2025-08-04 20:44:20,386 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:20,386 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:44:20,386 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:44:20,386 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:44:20,386 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:44:20,386 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:20,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:20,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:20,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:44:20,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:44:20,790 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:20,909 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:20,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:20,915 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:20,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:44:20,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:20,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:44:20,926 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:20,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:20,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:44:20,935 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:20,938 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:20,941 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:20,943 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:20,945 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:20,948 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:20,950 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:20,953 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:20,956 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:20,958 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:20,961 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:20,970 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:20,970 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:44:20,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:44:20,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:44:20,980 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:20,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:44:20,991 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:20,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:44:20,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:21,009 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:21,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:44:21,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:44:21,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:21,024 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:21,024 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:21,025 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:21,025 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:21,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:44:21,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:21,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:44:21,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:21,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:44:21,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:44:21,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:21,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:44:21,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:21,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:21,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:21,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:44:21,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:44:21,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:44:21,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:44:21,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:44:21,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:44:21,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:21,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:44:21,031 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:21,031 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:21,031 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:21,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:44:21,032 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:44:21,032 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:44:21,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:44:21,036 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:44:21,036 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:21,037 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:21,038 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:44:21,039 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 101/400.
2025-08-04 20:44:21,140 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:21,140 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:21,141 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:44:21,141 - ClientAppLogger [Client 5] - INFO - [Client] Round 101: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:44:21,141 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:21,168 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0910, Avg D Loss: 0.8187
2025-08-04 20:44:21,168 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0910, Avg D Loss: 0.8187
2025-08-04 20:44:21,170 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:21,184 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4658, Threshold=0.4909, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:44:21,184 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:44:21,184 - ClientAppLogger [Client 5] - INFO - Fit completed for round 101. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 101, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0909985065460206, 'd_loss': 0.8186893582344055, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.1451263427734375, 'cpu_percent_fit': 44.8125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:44:21,184 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:44:32,445 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:32,446 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:44:32,446 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:44:32,446 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:44:32,446 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:44:32,446 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:32,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:32,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:32,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:44:32,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:44:32,822 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:32,945 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:32,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:32,957 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:32,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:44:32,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:32,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:44:32,974 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:32,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:32,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:44:32,987 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:32,990 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:32,993 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:32,995 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:32,998 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:33,000 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:33,002 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,005 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:33,008 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:33,010 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:33,012 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:33,023 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:33,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:44:33,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:44:33,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:44:33,035 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:33,035 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:44:33,049 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:33,049 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:44:33,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:33,066 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:33,072 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:44:33,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:44:33,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:33,087 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:33,088 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:33,088 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:33,088 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:33,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:44:33,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:33,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:44:33,090 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:33,091 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:44:33,091 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:44:33,091 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:33,092 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:44:33,092 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:33,092 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:33,092 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:33,093 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:44:33,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:44:33,093 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:44:33,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:44:33,093 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:44:33,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:44:33,094 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:44:33,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:44:33,094 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:44:33,094 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:44:33,095 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:44:33,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:44:33,095 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:33,095 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:44:33,096 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:33,096 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:33,096 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:33,096 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:44:33,097 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:44:33,097 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:44:33,097 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:44:33,105 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:44:33,105 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:33,106 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:33,109 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:44:33,111 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:33,111 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:33,111 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:33,112 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:33,131 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4200, Threshold=0.4291, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:44:33,131 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4200
2025-08-04 20:44:50,404 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:50,404 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:44:50,404 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:44:50,404 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:44:50,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:44:50,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:50,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:50,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:50,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:44:50,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:44:50,859 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:51,028 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:51,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:51,037 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:51,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:44:51,051 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:51,051 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:44:51,052 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:51,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:51,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:44:51,065 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:51,069 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,071 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:51,074 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:51,076 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:51,079 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:51,082 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,085 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:51,087 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:51,089 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:51,091 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:51,102 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:51,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:44:51,107 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:44:51,108 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:44:51,114 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:51,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:44:51,127 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:51,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:44:51,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:51,145 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:51,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:44:51,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:44:51,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:51,168 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:51,169 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:51,169 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:51,169 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:51,170 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:44:51,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:51,170 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:44:51,171 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:51,172 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:44:51,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:44:51,173 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:51,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:44:51,173 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:51,173 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:51,174 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:51,174 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:44:51,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:44:51,175 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:44:51,175 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:44:51,175 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:44:51,175 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:44:51,175 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:44:51,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:44:51,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:44:51,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:44:51,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:44:51,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:44:51,177 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:51,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:44:51,177 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:51,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:51,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:51,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:44:51,179 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:44:51,179 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:44:51,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:44:51,187 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:44:51,187 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:51,188 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:51,189 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:44:51,190 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:51,191 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:51,191 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:51,191 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:51,210 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4411, Threshold=0.4569, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:44:51,211 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4411
2025-08-04 20:44:59,467 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:59,468 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:44:59,468 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:44:59,468 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:44:59,468 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:44:59,468 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:59,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:59,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:59,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:44:59,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:44:59,852 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:59,937 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:59,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:59,943 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:59,949 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:44:59,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:59,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:44:59,954 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:59,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:59,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:44:59,964 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:59,967 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:59,969 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:59,971 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:59,974 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:59,976 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:59,979 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:59,982 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:59,984 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:59,986 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:59,989 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:59,998 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:59,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:45:00,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:45:00,004 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:45:00,009 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:00,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:45:00,019 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:00,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:45:00,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:00,036 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:00,041 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:45:00,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:45:00,050 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:00,051 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:00,051 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:00,051 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:00,051 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:00,051 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:45:00,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:00,052 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:45:00,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:00,053 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:45:00,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:45:00,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:00,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:45:00,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:00,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:00,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:00,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:45:00,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:45:00,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:45:00,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:45:00,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:45:00,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:45:00,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:45:00,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:45:00,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:45:00,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:45:00,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:45:00,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:45:00,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:00,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:45:00,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:00,058 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:00,058 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:00,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:45:00,058 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:45:00,058 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:45:00,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:45:00,062 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:45:00,063 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:00,064 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:00,064 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:45:00,066 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 103/400.
2025-08-04 20:45:00,167 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:00,167 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:00,169 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:45:00,169 - ClientAppLogger [Client 5] - INFO - [Client] Round 103: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:45:00,170 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:00,200 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0862, Avg D Loss: 0.8181
2025-08-04 20:45:00,200 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0862, Avg D Loss: 0.8181
2025-08-04 20:45:00,200 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:00,215 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4564, Threshold=0.4799, Accuracy=0.7435, F1=0.8207, Precision=0.9785, Recall=0.7068
2025-08-04 20:45:00,215 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8207
2025-08-04 20:45:00,216 - ClientAppLogger [Client 5] - INFO - Fit completed for round 103. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 103, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0862064123153687, 'd_loss': 0.8181157052516937, 'post_fit_local_f1': 0.8207440811724915, 'fit_time_seconds': 0.1496732234954834, 'cpu_percent_fit': 46.025, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:45:00,216 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:45:11,492 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:11,493 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:45:11,493 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:45:11,493 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:45:11,493 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:45:11,493 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:11,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:11,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:11,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:45:11,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:45:11,905 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:12,054 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:12,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:12,062 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:12,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:45:12,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:12,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:45:12,075 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:12,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:12,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:45:12,084 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:12,089 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,091 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:12,093 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:12,096 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:12,100 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:12,103 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,105 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:12,109 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:12,111 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:12,113 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:12,125 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:12,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:45:12,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:45:12,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:45:12,138 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:12,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:45:12,155 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:12,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:45:12,156 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:12,177 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:12,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:45:12,202 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:45:12,202 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:12,203 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:12,203 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:12,203 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:12,204 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:12,204 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:45:12,204 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:12,204 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:45:12,205 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:12,206 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:45:12,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:45:12,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:12,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:45:12,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:12,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:12,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:12,207 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:45:12,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:45:12,208 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:45:12,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:45:12,208 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:45:12,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:45:12,208 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:45:12,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:45:12,209 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:45:12,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:45:12,210 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:45:12,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:45:12,210 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:12,210 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:45:12,210 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:12,211 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:12,211 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:12,211 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:45:12,212 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:45:12,212 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:45:12,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:45:12,220 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:45:12,220 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:12,222 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:12,222 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:45:12,224 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:12,224 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:12,224 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:12,226 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:12,244 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4585, Threshold=0.4874, Accuracy=0.7435, F1=0.8207, Precision=0.9785, Recall=0.7068
2025-08-04 20:45:12,245 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7435, F1: 0.8207, Prec: 0.9785, Rec: 0.7068, Avg Anomaly Score: 0.4585
2025-08-04 20:45:32,527 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:32,527 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:45:32,527 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:45:32,527 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:45:32,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:45:32,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:32,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:32,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:32,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:45:32,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:45:32,947 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:33,082 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:33,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:33,093 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:33,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:45:33,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:33,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:45:33,116 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:33,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:33,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:45:33,126 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:33,129 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,132 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:33,134 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:33,137 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:33,139 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:33,141 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,144 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:33,147 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:33,149 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:33,151 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:33,164 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:33,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:45:33,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:45:33,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:45:33,174 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:33,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:45:33,185 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:33,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:45:33,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:33,202 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:33,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:45:33,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:45:33,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:33,216 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:33,217 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:33,217 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:33,217 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:33,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:45:33,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:33,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:45:33,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:33,220 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:45:33,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:45:33,220 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:33,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:45:33,221 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:33,221 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:33,221 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:33,221 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:45:33,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:45:33,221 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:45:33,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:45:33,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:45:33,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:45:33,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:45:33,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:45:33,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:45:33,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:45:33,223 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:45:33,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:45:33,223 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:33,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:45:33,223 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:33,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:33,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:33,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:45:33,224 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:45:33,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:45:33,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:45:33,234 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:45:33,234 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:33,235 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:33,236 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:45:33,237 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:33,237 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:33,238 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:33,238 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:33,255 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4901, Threshold=0.5230, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:45:33,255 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.4901
2025-08-04 20:45:47,526 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:47,526 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:45:47,526 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:45:47,526 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:45:47,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:45:47,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:47,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:47,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:47,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:45:47,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:45:47,897 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:47,985 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:47,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:47,991 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:47,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:45:48,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:48,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:45:48,004 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:48,004 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:48,004 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:45:48,012 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:48,015 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:48,017 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:48,019 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:48,022 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:48,024 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:48,026 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:48,029 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:48,032 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:48,034 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:48,036 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:48,046 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:48,047 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:45:48,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:45:48,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:45:48,057 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:48,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:45:48,067 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:48,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:45:48,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:48,083 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:48,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:45:48,096 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:45:48,097 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:48,097 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:48,097 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:48,097 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:48,098 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:48,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:45:48,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:48,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:45:48,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:48,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:45:48,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:45:48,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:48,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:45:48,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:48,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:48,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:48,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:45:48,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:45:48,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:45:48,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:45:48,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:45:48,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:45:48,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:45:48,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:45:48,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:45:48,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:45:48,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:45:48,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:45:48,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:48,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:45:48,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:48,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:48,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:48,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:45:48,104 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:45:48,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:45:48,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:45:48,108 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:45:48,108 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:48,109 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:48,109 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:45:48,111 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:48,111 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:48,111 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:48,112 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:48,128 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5021, Threshold=0.5630, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:45:48,128 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.5021
2025-08-04 20:45:59,385 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:59,385 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:45:59,385 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:45:59,385 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:45:59,385 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:45:59,385 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:59,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:59,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:59,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:45:59,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:45:59,774 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:59,870 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:59,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:59,876 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:59,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:45:59,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:59,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:45:59,896 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:59,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:59,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:45:59,909 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:59,912 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:59,915 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:59,917 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:59,920 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:59,922 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:59,925 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:59,928 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:59,931 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:59,933 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:59,935 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:59,945 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:59,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:45:59,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:45:59,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:45:59,955 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:59,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:45:59,963 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:59,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:45:59,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:59,979 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:59,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:45:59,989 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:45:59,989 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:59,989 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:59,989 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:59,989 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:59,990 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:59,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:45:59,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:59,990 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:45:59,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:59,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:45:59,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:45:59,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:59,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:45:59,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:59,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:59,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:59,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:45:59,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:45:59,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:45:59,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:45:59,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:45:59,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:45:59,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:59,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:45:59,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:59,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:59,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:59,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:45:59,996 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:45:59,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:45:59,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:45:59,999 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:00,000 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:00,001 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:00,002 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:00,003 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:00,003 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:00,003 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:00,004 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:00,018 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4587, Threshold=0.4916, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:46:00,020 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4587
2025-08-04 20:46:05,272 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:05,272 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:46:05,272 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:46:05,272 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:46:05,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:46:05,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:05,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:05,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:05,641 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:46:05,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:46:05,681 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:05,810 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:05,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:05,816 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:05,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:46:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:46:05,827 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:46:05,835 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:05,838 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:05,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:05,842 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:05,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:05,847 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:05,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:05,852 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:05,855 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:05,857 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:05,859 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:05,869 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:05,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:46:05,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:46:05,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:46:05,880 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:05,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:46:05,891 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:05,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:46:05,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:05,908 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:05,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:46:05,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:46:05,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:05,922 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:05,922 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:05,922 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:05,923 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:05,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:46:05,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:05,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:46:05,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:05,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:46:05,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:46:05,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:05,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:46:05,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:05,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:05,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:46:05,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:46:05,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:46:05,928 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:46:05,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:46:05,928 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:46:05,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:46:05,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:05,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:46:05,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:05,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:05,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:05,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:46:05,930 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:46:05,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:46:05,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:46:05,937 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:05,938 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:05,939 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:05,939 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:05,941 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 107/400.
2025-08-04 20:46:06,042 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:06,042 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:06,043 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:46:06,043 - ClientAppLogger [Client 5] - INFO - [Client] Round 107: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 20:46:06,044 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:06,074 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0908, Avg D Loss: 0.8582
2025-08-04 20:46:06,074 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0908, Avg D Loss: 0.8582
2025-08-04 20:46:06,075 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:06,107 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4714, Threshold=0.5012, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:46:06,107 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:46:06,108 - ClientAppLogger [Client 5] - INFO - Fit completed for round 107. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 107, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0908205270767213, 'd_loss': 0.8582257032394409, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.16713356971740723, 'cpu_percent_fit': 45.34375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 32}
2025-08-04 20:46:06,108 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:46:14,362 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:14,362 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:46:14,362 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:46:14,362 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:46:14,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:46:14,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:14,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:14,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:14,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:46:14,726 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:46:14,726 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:14,821 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:14,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:14,828 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:14,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:46:14,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:14,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:46:14,839 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:14,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:14,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:46:14,849 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:14,851 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:14,854 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:14,856 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:14,858 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:14,860 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:14,863 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:14,865 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:14,868 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:14,870 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:14,872 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:14,882 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:14,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:46:14,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:46:14,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:46:14,892 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:14,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:46:14,904 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:14,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:46:14,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:14,920 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:14,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:46:14,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:46:14,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:14,932 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:14,932 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:14,933 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:14,933 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:14,933 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:46:14,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:14,934 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:46:14,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:14,935 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:46:14,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:46:14,935 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:46:14,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:46:14,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:46:14,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:46:14,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:46:14,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:46:14,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:46:14,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:46:14,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:46:14,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:14,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:46:14,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:14,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:14,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:14,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:46:14,939 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:46:14,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:46:14,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:46:14,946 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:14,946 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:14,947 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:14,947 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:14,948 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:14,949 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:14,949 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:14,949 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:14,964 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4647, Threshold=0.5008, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:46:14,964 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4647
2025-08-04 20:46:29,230 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:29,230 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:46:29,231 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:46:29,231 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:46:29,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:46:29,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:29,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:29,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:29,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:46:29,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:46:29,589 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:29,681 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:29,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:29,689 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:29,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:46:29,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:29,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:46:29,705 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:29,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:29,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:46:29,715 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:29,718 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:29,720 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:29,722 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:29,725 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:29,727 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:29,730 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:29,732 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:29,735 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:29,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:29,739 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:29,749 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:29,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:46:29,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:46:29,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:46:29,761 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:29,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:46:29,772 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:29,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:46:29,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:29,788 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:29,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:46:29,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:46:29,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:29,797 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:29,797 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:29,797 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:29,798 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:29,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:46:29,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:29,798 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:46:29,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:29,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:46:29,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:46:29,800 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:29,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:46:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:46:29,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:46:29,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:46:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:46:29,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:46:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:46:29,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:46:29,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:46:29,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:46:29,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:46:29,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:46:29,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:46:29,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:29,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:46:29,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:29,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:29,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:29,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:46:29,804 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:46:29,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:46:29,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:46:29,807 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:29,807 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:29,808 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:29,808 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:29,809 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:29,809 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:29,809 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:29,810 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:29,824 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4840, Threshold=0.5313, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:46:29,824 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4840
2025-08-04 20:46:38,084 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:38,084 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:46:38,085 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:46:38,085 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:46:38,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:46:38,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:38,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:38,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:38,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:46:38,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:46:38,462 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:38,556 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:38,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:38,564 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:38,571 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:46:38,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:38,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:46:38,579 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:38,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:38,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:46:38,588 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:38,590 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:38,593 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:38,595 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:38,597 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:38,599 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:38,602 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:38,604 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:38,607 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:38,609 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:38,611 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:38,621 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:38,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:46:38,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:46:38,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:46:38,631 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:38,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:46:38,639 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:38,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:46:38,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:38,655 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:38,660 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:46:38,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:46:38,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:38,666 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:38,666 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:38,666 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:38,667 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:38,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:46:38,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:38,668 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:46:38,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:38,669 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:46:38,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:46:38,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:38,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:46:38,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:38,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:38,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:38,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:46:38,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:46:38,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:46:38,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:46:38,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:46:38,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:38,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:46:38,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:38,673 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:38,673 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:38,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:46:38,673 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:46:38,673 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:46:38,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:46:38,679 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:38,679 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:38,680 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:38,680 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:38,681 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 109/400.
2025-08-04 20:46:38,783 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:38,783 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:38,784 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:46:38,785 - ClientAppLogger [Client 5] - INFO - [Client] Round 109: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 20:46:38,785 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:38,814 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0927, Avg D Loss: 0.8542
2025-08-04 20:46:38,814 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0927, Avg D Loss: 0.8542
2025-08-04 20:46:38,814 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:38,830 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4791, Threshold=0.5132, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:46:38,830 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:46:38,830 - ClientAppLogger [Client 5] - INFO - Fit completed for round 109. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 109, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0927181005477906, 'd_loss': 0.8542314767837524, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.14870858192443848, 'cpu_percent_fit': 46.0125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 32}
2025-08-04 20:46:38,830 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:46:44,088 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:44,088 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:46:44,088 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:46:44,088 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:46:44,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:46:44,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:44,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:44,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:44,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:46:44,447 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:46:44,447 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:44,543 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:44,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:44,552 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:44,559 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:46:44,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:44,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:46:44,570 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:44,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:44,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:46:44,579 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:44,582 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:44,584 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:44,586 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:44,589 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:44,591 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:44,594 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:44,596 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:44,599 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:44,601 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:44,605 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:44,617 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:44,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:46:44,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:46:44,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:46:44,627 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:44,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:46:44,635 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:44,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:46:44,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:44,651 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:44,655 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:46:44,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:46:44,660 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:44,660 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:44,660 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:44,660 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:44,660 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:44,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:46:44,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:44,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:46:44,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:44,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:46:44,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:46:44,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:44,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:46:44,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:46:44,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:46:44,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:46:44,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:46:44,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:46:44,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:46:44,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:46:44,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:46:44,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:44,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:46:44,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:44,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:44,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:44,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:46:44,667 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:46:44,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:46:44,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:46:44,670 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:44,670 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:44,672 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:44,672 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:44,674 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:44,674 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:44,674 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:44,675 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:44,692 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4675, Threshold=0.5081, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:46:44,692 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4675
2025-08-04 20:46:58,953 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:58,953 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:46:58,953 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:46:58,953 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:46:58,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:46:58,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:59,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:59,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:59,303 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:46:59,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:46:59,343 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:59,459 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:59,467 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:59,468 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:59,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:46:59,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:59,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:46:59,488 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:59,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:59,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:46:59,498 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:59,502 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:59,504 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:59,506 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:59,509 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:59,512 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:59,514 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:59,517 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:59,520 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:59,522 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:59,524 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:59,534 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:59,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:46:59,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:46:59,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:46:59,543 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:59,544 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:46:59,553 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:59,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:46:59,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:59,570 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:59,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:46:59,586 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:46:59,586 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:59,586 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:59,587 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:59,587 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:59,587 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:59,588 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:46:59,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:59,588 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:46:59,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:59,590 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:46:59,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:46:59,590 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:59,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:46:59,590 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:59,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:59,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:59,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:46:59,591 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:46:59,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:46:59,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:46:59,592 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:46:59,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:46:59,592 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:46:59,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:46:59,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:46:59,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:46:59,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:46:59,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:46:59,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:59,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:46:59,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:59,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:59,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:59,595 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:46:59,595 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:46:59,595 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:46:59,595 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:46:59,599 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:46:59,599 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:59,601 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:59,601 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:46:59,602 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:59,603 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:59,603 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:59,603 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:59,634 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5054, Threshold=0.5567, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:46:59,635 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.5054
2025-08-04 20:47:04,879 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:04,879 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:47:04,879 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:47:04,879 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:47:04,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:47:04,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:05,124 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:05,124 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:05,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:47:05,242 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:47:05,242 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:05,324 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:05,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:05,329 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:05,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:47:05,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:05,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:47:05,340 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:05,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:05,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:47:05,353 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:05,356 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:05,358 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:05,360 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:05,363 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:05,365 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:05,367 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:05,370 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:05,372 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:05,374 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:05,377 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:05,386 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:05,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:47:05,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:47:05,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:47:05,396 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:05,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:47:05,404 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:05,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:47:05,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:05,419 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:05,424 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:47:05,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:47:05,429 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:05,429 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:05,429 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:05,430 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:05,430 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:05,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:47:05,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:05,430 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:47:05,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:05,432 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:47:05,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:47:05,432 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:47:05,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:47:05,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:47:05,434 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:47:05,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:47:05,434 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:47:05,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:47:05,434 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:47:05,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:47:05,435 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:47:05,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:47:05,435 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:05,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:47:05,435 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:05,436 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:05,436 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:05,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:47:05,436 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:47:05,436 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:47:05,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:47:05,440 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:47:05,440 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:05,441 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:05,441 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:47:05,443 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 111/400.
2025-08-04 20:47:05,544 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:05,544 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:05,545 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:47:05,545 - ClientAppLogger [Client 5] - INFO - [Client] Round 111: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 20:47:05,546 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:05,582 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0953, Avg D Loss: 0.8545
2025-08-04 20:47:05,582 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0953, Avg D Loss: 0.8545
2025-08-04 20:47:05,583 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:05,599 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4828, Threshold=0.5244, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:47:05,599 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:47:05,599 - ClientAppLogger [Client 5] - INFO - Fit completed for round 111. Duration: 0.16s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 111, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0953059673309324, 'd_loss': 0.8545473873615265, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.15644478797912598, 'cpu_percent_fit': 45.09375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 32}
2025-08-04 20:47:05,600 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:47:13,858 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:13,858 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:47:13,859 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:47:13,859 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:47:13,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:47:13,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:14,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:14,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:14,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:47:14,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:47:14,254 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:14,347 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:14,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:14,354 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:14,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:47:14,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:14,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:47:14,370 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:14,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:14,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:47:14,380 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:14,382 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:14,385 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:14,387 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:14,390 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:14,393 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:14,396 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:14,398 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:14,401 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:14,403 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:14,405 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:14,415 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:14,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:47:14,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:47:14,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:47:14,427 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:14,427 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:47:14,439 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:14,440 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:47:14,440 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:14,456 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:14,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:47:14,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:47:14,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:14,503 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:14,504 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:14,504 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:14,504 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:14,504 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:47:14,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:14,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:47:14,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:14,506 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:47:14,507 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:47:14,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:47:14,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:47:14,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:47:14,509 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:47:14,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:47:14,509 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:47:14,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:47:14,510 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:47:14,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:47:14,510 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:47:14,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:47:14,511 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:14,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:47:14,511 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:14,512 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:14,512 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:14,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:47:14,516 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:47:14,516 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:47:14,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:47:14,519 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:47:14,519 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:14,520 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:14,520 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:47:14,522 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:14,522 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:14,522 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:14,523 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:14,540 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4767, Threshold=0.5195, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:47:14,540 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4767
2025-08-04 20:47:31,814 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:31,814 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:47:31,815 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:47:31,815 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:47:31,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:47:31,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:32,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:32,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:32,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:47:32,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:47:32,173 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:32,265 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:32,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:32,272 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:32,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:47:32,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:32,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:47:32,285 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:32,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:32,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:47:32,294 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:32,297 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:32,299 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:32,301 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:32,304 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:32,307 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:32,310 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:32,312 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:32,315 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:32,317 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:32,320 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:32,332 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:32,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:47:32,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:47:32,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:47:32,344 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:32,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:47:32,356 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:32,356 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:47:32,356 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:32,374 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:32,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:47:32,385 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:47:32,385 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:32,385 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:32,385 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:32,386 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:32,387 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:32,387 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:47:32,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:32,388 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:47:32,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:32,389 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:47:32,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:47:32,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:32,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:47:32,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:32,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:32,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:32,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:47:32,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:47:32,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:47:32,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:47:32,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:47:32,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:47:32,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:47:32,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:47:32,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:47:32,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:47:32,393 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:47:32,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:47:32,394 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:32,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:47:32,394 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:32,395 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:32,396 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:32,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:47:32,396 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:47:32,396 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:47:32,397 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:47:32,402 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:47:32,402 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:32,403 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:32,403 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:47:32,405 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:32,405 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:32,405 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:32,406 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:32,425 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4463, Threshold=0.4735, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:47:32,426 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4463
2025-08-04 20:47:43,688 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:43,689 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:47:43,689 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:47:43,689 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:47:43,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:47:43,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:44,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:44,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:44,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:47:44,140 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:47:44,140 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:44,263 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:44,269 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:44,269 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:44,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:47:44,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:44,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:47:44,286 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:44,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:44,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:47:44,297 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:44,301 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:44,305 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:44,309 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:44,313 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:44,317 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:44,320 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:44,323 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:44,326 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:44,328 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:44,330 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:44,340 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:44,341 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:47:44,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:47:44,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:47:44,351 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:44,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:47:44,361 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:44,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:47:44,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:44,377 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:44,382 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:47:44,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:47:44,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:44,387 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:44,387 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:44,388 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:44,388 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:44,388 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:47:44,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:44,388 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:47:44,389 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:44,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:47:44,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:47:44,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:44,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:47:44,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:47:44,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:47:44,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:47:44,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:47:44,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:47:44,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:47:44,393 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:47:44,393 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:47:44,393 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:44,393 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:47:44,393 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:44,393 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:44,394 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:44,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:47:44,394 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:47:44,394 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:47:44,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:47:44,402 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:47:44,403 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:44,404 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:44,404 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:47:44,406 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:44,406 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:44,406 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:44,407 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:44,421 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4885, Threshold=0.5424, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:47:44,421 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4885
2025-08-04 20:48:01,697 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:01,697 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:01,698 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:01,698 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:01,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:01,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:01,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:02,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:02,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:02,120 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:02,120 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:02,218 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:02,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:02,224 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:02,230 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:02,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:02,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:02,236 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:02,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:02,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:02,244 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:02,247 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:02,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:02,251 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:02,254 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:02,256 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:02,259 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:02,262 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:02,265 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:02,267 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:02,270 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:02,280 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:02,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:02,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:02,285 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:02,289 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:02,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:02,299 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:02,300 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:02,300 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:02,316 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:02,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:02,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:02,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:02,327 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:02,327 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:02,328 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:02,328 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:02,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:02,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:02,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:02,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:02,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:02,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:02,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:02,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:02,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:02,333 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:02,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:02,333 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:02,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:02,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:02,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:02,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:02,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:02,334 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:02,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:02,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:02,338 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:02,339 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:02,340 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:02,340 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:02,342 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:02,342 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:02,342 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:02,343 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:02,359 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5202, Threshold=0.5820, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:48:02,359 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5202
2025-08-04 20:48:07,616 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:07,617 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:07,617 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:07,617 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:07,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:07,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:07,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:07,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:07,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:08,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:08,027 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:08,120 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:08,124 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:08,125 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:08,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:08,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:08,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:08,139 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:08,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:08,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:08,148 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:08,151 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:08,153 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:08,155 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:08,158 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:08,160 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:08,163 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:08,165 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:08,168 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:08,170 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:08,173 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:08,183 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:08,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:08,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:08,191 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:08,196 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:08,196 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:08,206 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:08,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:08,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:08,222 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:08,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:08,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:08,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:08,232 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:08,232 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:08,233 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:08,233 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:08,233 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:08,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:08,234 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:08,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:08,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:08,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:08,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:08,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:08,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:08,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:08,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:08,237 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:08,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:08,237 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:08,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:08,237 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:08,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:08,238 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:08,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:08,238 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:08,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:08,238 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:08,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:08,239 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:08,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:08,239 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:08,239 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:08,239 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:08,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:08,240 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:08,240 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:08,240 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:08,244 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:08,244 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:08,246 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:08,246 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:08,248 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 115/400.
2025-08-04 20:48:08,349 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:08,349 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:08,351 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:48:08,351 - ClientAppLogger [Client 5] - INFO - [Client] Round 115: Training GAN with 33 samples (26 normal, 7 anomalous).
2025-08-04 20:48:08,351 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:08,402 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0875, Avg D Loss: 0.8271
2025-08-04 20:48:08,403 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0875, Avg D Loss: 0.8271
2025-08-04 20:48:08,403 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:08,419 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.6597, Threshold=0.7509, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:48:08,419 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8185
2025-08-04 20:48:08,420 - ClientAppLogger [Client 5] - INFO - Fit completed for round 115. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 115, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0874553535923814, 'd_loss': 0.8271433588230248, 'post_fit_local_f1': 0.818489289740699, 'fit_time_seconds': 0.17179250717163086, 'cpu_percent_fit': 46.775, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 33}
2025-08-04 20:48:08,420 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:48:13,674 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:13,675 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:13,675 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:13,675 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:13,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:13,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:13,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:13,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:14,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:14,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:14,122 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:14,241 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:14,249 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:14,249 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:14,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:14,262 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:14,262 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:14,263 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:14,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:14,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:14,272 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:14,275 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:14,277 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:14,280 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:14,282 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:14,285 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:14,287 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:14,290 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:14,292 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:14,294 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:14,297 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:14,308 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:14,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:14,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:14,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:14,319 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:14,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:14,328 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:14,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:14,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:14,344 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:14,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:14,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:14,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:14,354 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:14,354 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:14,354 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:14,355 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:14,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:14,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:14,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:14,356 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:14,357 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:14,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:14,357 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:14,358 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:14,359 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:14,359 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:14,359 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:14,359 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:14,359 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:14,359 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:14,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:14,360 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:14,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:14,360 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:14,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:14,360 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:14,361 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:14,361 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:14,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:14,361 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:14,361 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:14,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:14,365 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:14,365 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:14,366 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:14,367 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:14,368 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:14,369 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:14,369 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:14,369 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:14,385 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5528, Threshold=0.6185, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:48:14,386 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.5528
2025-08-04 20:48:25,654 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:25,655 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:25,655 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:25,655 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:25,655 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:25,655 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:25,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:25,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:26,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:26,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:26,101 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:26,224 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:26,230 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:26,230 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:26,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:26,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:26,251 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:26,251 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:26,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:26,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:26,260 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:26,263 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:26,266 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:26,268 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:26,271 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:26,273 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:26,275 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:26,278 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:26,281 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:26,283 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:26,285 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:26,295 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:26,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:26,300 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:26,300 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:26,306 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:26,306 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:26,317 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:26,318 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:26,318 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:26,334 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:26,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:26,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:26,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:26,346 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:26,346 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:26,346 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:26,347 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:26,347 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:26,347 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:26,347 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:26,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:26,350 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:26,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:26,351 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:26,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:26,351 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:26,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:26,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:26,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:26,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:26,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:26,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:26,354 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:26,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:26,354 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:26,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:26,354 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:26,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:26,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:26,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:26,355 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:26,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:26,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:26,364 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:26,364 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:26,365 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:26,365 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:26,367 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:26,367 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:26,367 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:26,368 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:26,388 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4636, Threshold=0.5131, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:48:26,388 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4636
2025-08-04 20:48:31,644 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:31,644 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:31,645 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:31,645 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:31,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:31,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:31,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:31,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:31,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:32,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:32,017 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:32,115 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:32,120 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:32,121 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:32,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:32,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:32,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:32,132 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:32,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:32,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:32,141 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:32,144 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:32,146 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:32,148 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:32,151 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:32,153 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:32,156 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:32,158 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:32,161 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:32,163 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:32,165 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:32,174 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:32,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:32,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:32,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:32,184 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:32,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:32,192 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:32,192 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:32,193 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:32,209 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:32,214 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:32,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:32,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:32,221 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:32,221 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:32,221 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:32,222 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:32,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:32,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:32,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:32,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:32,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:32,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:32,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:32,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:32,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:32,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:32,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:32,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:32,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:32,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:32,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:32,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:32,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:32,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:32,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:32,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:32,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:32,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:32,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:32,228 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:32,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:32,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:32,232 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:32,232 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:32,233 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:32,234 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:32,235 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 117/400.
2025-08-04 20:48:32,336 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:32,336 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:32,338 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 20:48:32,338 - ClientAppLogger [Client 5] - INFO - [Client] Round 117: Training GAN with 35 samples (27 normal, 8 anomalous).
2025-08-04 20:48:32,338 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:32,391 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0954, Avg D Loss: 0.8155
2025-08-04 20:48:32,391 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0954, Avg D Loss: 0.8155
2025-08-04 20:48:32,391 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:32,407 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4707, Threshold=0.5031, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:48:32,408 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:48:32,408 - ClientAppLogger [Client 5] - INFO - Fit completed for round 117. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 117, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0953554882322036, 'd_loss': 0.8155335872513907, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.1724841594696045, 'cpu_percent_fit': 47.00625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 35}
2025-08-04 20:48:32,408 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:48:40,665 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:40,665 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:40,665 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:40,665 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:40,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:40,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:40,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:40,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:41,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:41,110 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:41,110 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:41,240 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:41,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:41,248 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:41,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:41,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:41,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:41,275 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:41,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:41,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:41,286 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:41,289 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:41,291 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:41,294 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:41,297 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:41,299 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:41,301 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:41,304 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:41,307 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:41,309 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:41,311 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:41,321 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:41,322 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:41,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:41,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:41,332 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:41,332 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:41,341 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:41,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:41,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:41,356 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:41,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:41,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:41,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:41,366 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:41,366 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:41,367 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:41,367 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:41,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:41,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:41,368 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:41,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:41,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:41,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:41,370 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:41,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:41,370 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:41,370 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:41,371 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:41,371 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:41,371 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:41,371 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:41,371 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:41,372 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:41,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:41,373 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:41,373 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:41,373 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:41,373 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:41,374 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:41,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:41,374 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:41,374 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:41,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:41,384 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:41,385 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:41,386 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:41,386 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:41,388 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:41,388 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:41,389 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:41,389 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:41,406 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4841, Threshold=0.5295, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:48:41,406 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4841
2025-08-04 20:48:52,667 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:52,667 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:48:52,667 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:48:52,667 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:48:52,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:48:52,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:52,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:52,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:53,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:48:53,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:48:53,115 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:53,238 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:53,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:53,246 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:53,251 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:48:53,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:53,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:48:53,258 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:53,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:53,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:48:53,267 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:53,270 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:53,272 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:53,274 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:53,277 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:53,280 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:53,282 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:53,285 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:53,288 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:53,290 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:53,292 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:53,302 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:53,302 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:48:53,307 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:48:53,307 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:48:53,312 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:53,312 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:48:53,323 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:53,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:48:53,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:53,339 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:53,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:48:53,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:48:53,349 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:53,349 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:53,349 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:53,349 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:53,350 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:53,350 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:48:53,350 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:53,350 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:48:53,350 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:53,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:48:53,352 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:48:53,352 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:53,352 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:48:53,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:53,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:53,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:53,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:48:53,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:48:53,353 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:48:53,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:48:53,354 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:48:53,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:48:53,354 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:48:53,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:48:53,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:48:53,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:48:53,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:48:53,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:48:53,355 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:53,356 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:48:53,356 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:53,356 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:53,356 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:53,356 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:48:53,356 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:48:53,357 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:48:53,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:48:53,364 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:48:53,364 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:53,365 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:53,365 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:48:53,367 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:53,367 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:53,367 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:53,368 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:53,384 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5128, Threshold=0.5729, Accuracy=0.7403, F1=0.8185, Precision=0.9758, Recall=0.7049
2025-08-04 20:48:53,384 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7403, F1: 0.8185, Prec: 0.9758, Rec: 0.7049, Avg Anomaly Score: 0.5128
2025-08-04 20:49:04,650 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:04,651 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:49:04,651 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:49:04,651 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:49:04,651 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:49:04,651 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:04,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:04,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:05,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:49:05,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:49:05,074 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:05,201 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:05,211 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:05,212 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:05,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:49:05,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:05,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:49:05,232 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:05,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:05,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:49:05,241 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:05,244 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:05,246 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:05,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:05,252 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:05,254 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:05,256 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:05,259 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:05,262 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:05,264 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:05,267 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:05,278 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:05,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:49:05,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:49:05,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:49:05,290 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:05,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:49:05,303 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:05,304 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:49:05,304 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:05,319 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:05,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:49:05,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:49:05,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:05,330 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:05,330 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:05,330 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:05,330 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:05,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:49:05,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:05,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:49:05,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:05,333 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:49:05,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:49:05,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:49:05,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:49:05,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:49:05,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:49:05,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:49:05,335 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:49:05,335 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:49:05,336 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:49:05,336 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:49:05,336 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:49:05,336 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:49:05,336 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:05,336 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:49:05,337 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:05,337 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:05,337 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:05,337 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:49:05,338 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:49:05,338 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:49:05,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:49:05,339 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:49:05,339 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:05,341 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:05,341 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:49:05,342 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:05,342 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:05,342 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:05,343 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:05,359 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4935, Threshold=0.5451, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:49:05,359 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4935
2025-08-04 20:49:25,714 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:25,715 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:49:25,715 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:49:25,715 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:49:25,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:49:25,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:26,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:26,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:26,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:49:26,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:49:26,106 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:26,187 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:26,191 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:26,192 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:26,197 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:49:26,205 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:26,205 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:49:26,206 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:26,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:26,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:49:26,215 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:26,218 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:26,220 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:26,222 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:26,225 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:26,227 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:26,229 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:26,232 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:26,234 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:26,236 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:26,238 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:26,247 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:26,247 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:49:26,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:49:26,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:49:26,256 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:26,256 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:49:26,263 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:26,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:49:26,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:26,279 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:26,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:49:26,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:49:26,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:26,289 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:26,289 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:26,289 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:26,289 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:26,289 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:49:26,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:26,290 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:49:26,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:26,291 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:49:26,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:49:26,292 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:26,292 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:49:26,292 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:26,292 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:26,292 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:26,293 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:49:26,293 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:49:26,293 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:49:26,293 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:49:26,293 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:49:26,293 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:49:26,294 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:26,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:49:26,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:26,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:26,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:26,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:49:26,296 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:49:26,296 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:49:26,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:49:26,303 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:49:26,303 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:26,304 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:26,304 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:49:26,305 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:26,306 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:26,306 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:26,306 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:26,320 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5112, Threshold=0.5650, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:49:26,320 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5112
2025-08-04 20:49:31,582 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:31,582 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:49:31,582 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:49:31,582 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:49:31,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:49:31,583 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:31,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:31,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:31,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:49:31,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:49:31,923 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:32,016 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:32,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:32,024 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:32,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:49:32,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:32,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:49:32,041 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:32,041 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:32,041 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:49:32,049 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:32,052 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:32,054 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:32,056 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:32,059 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:32,061 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:32,064 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:32,066 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:32,069 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:32,071 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:32,073 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:32,082 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:32,082 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:49:32,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:49:32,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:49:32,092 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:32,092 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:49:32,102 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:32,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:49:32,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:32,117 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:32,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:49:32,127 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:49:32,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:32,128 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:32,128 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:32,128 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:32,128 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:32,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:49:32,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:32,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:49:32,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:32,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:49:32,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:49:32,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:32,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:49:32,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:32,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:49:32,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:49:32,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:49:32,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:49:32,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:49:32,140 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:49:32,140 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:32,141 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:32,141 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:49:32,143 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 121/400.
2025-08-04 20:49:32,244 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:32,244 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:32,246 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 20:49:32,246 - ClientAppLogger [Client 5] - INFO - [Client] Round 121: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 20:49:32,246 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:32,299 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0868, Avg D Loss: 0.8054
2025-08-04 20:49:32,300 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0868, Avg D Loss: 0.8054
2025-08-04 20:49:32,300 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:32,315 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4196, Threshold=0.4196, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:49:32,315 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:49:32,315 - ClientAppLogger [Client 5] - INFO - Fit completed for round 121. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 121, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.086833723386129, 'd_loss': 0.80539885825581, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.1724545955657959, 'cpu_percent_fit': 47.20625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 36}
2025-08-04 20:49:32,316 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:49:37,603 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:37,603 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:49:37,603 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:49:37,603 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:49:37,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:49:37,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:37,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:37,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:37,987 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:49:38,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:49:38,028 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:38,124 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:38,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:38,131 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:38,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:49:38,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:38,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:49:38,143 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:38,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:38,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:49:38,151 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:38,154 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:38,156 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:38,158 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:38,161 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:38,163 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:38,165 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:38,168 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:38,170 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:38,172 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:38,174 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:38,184 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:38,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:49:38,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:49:38,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:49:38,193 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:38,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:49:38,203 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:38,203 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:49:38,203 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:38,219 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:38,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:49:38,230 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:49:38,230 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:38,230 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:38,230 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:38,230 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:38,231 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:38,231 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:49:38,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:38,231 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:49:38,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:38,232 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:38,233 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:49:38,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:49:38,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:49:38,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:49:38,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:49:38,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:49:38,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:38,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:49:38,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:38,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:38,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:38,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:49:38,236 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:49:38,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:49:38,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:49:38,243 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:49:38,243 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:38,245 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:38,245 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:49:38,246 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:38,246 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:38,246 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:38,247 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:38,260 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4533, Threshold=0.4839, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:49:38,261 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4533
2025-08-04 20:49:49,529 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:49,530 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:49:49,530 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:49:49,530 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:49:49,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:49:49,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:49,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:49,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:49,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:49:49,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:49:49,969 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:50,092 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:50,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:50,101 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:50,107 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:49:50,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:50,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:49:50,130 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:50,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:50,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:49:50,139 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:50,142 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:50,144 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:50,147 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:50,149 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:50,152 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:50,155 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:50,157 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:50,160 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:50,162 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:50,165 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:50,176 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:50,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:49:50,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:49:50,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:49:50,186 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:50,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:49:50,197 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:50,198 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:49:50,198 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:50,212 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:50,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:49:50,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:49:50,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:50,222 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:50,222 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:50,222 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:50,222 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:50,223 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:49:50,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:50,223 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:49:50,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:50,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:49:50,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:49:50,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:50,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:49:50,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:50,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:50,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:50,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:49:50,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:49:50,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:49:50,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:49:50,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:49:50,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:50,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:49:50,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:50,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:50,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:50,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:49:50,228 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:49:50,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:49:50,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:49:50,236 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:49:50,236 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:50,237 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:50,237 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:49:50,239 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:50,239 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:50,239 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:50,240 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:50,255 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5213, Threshold=0.5932, Accuracy=0.7435, F1=0.8207, Precision=0.9785, Recall=0.7068
2025-08-04 20:49:50,255 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7435, F1: 0.8207, Prec: 0.9785, Rec: 0.7068, Avg Anomaly Score: 0.5213
2025-08-04 20:49:55,506 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:55,506 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:49:55,506 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:49:55,506 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:49:55,506 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:49:55,506 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:55,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:55,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:55,948 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:49:55,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:49:55,997 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:56,121 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:56,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:56,128 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:56,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:49:56,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:56,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:49:56,144 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:56,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:56,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:49:56,154 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:56,157 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:56,160 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:56,162 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:56,165 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:56,168 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:56,171 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:56,174 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:56,176 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:56,179 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:56,182 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:56,192 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:56,192 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:49:56,197 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:49:56,197 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:49:56,203 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:56,203 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:49:56,215 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:56,215 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:49:56,215 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:56,235 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:56,240 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:49:56,246 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:49:56,246 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:56,246 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:56,246 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:56,247 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:56,247 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:56,248 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:49:56,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:56,248 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:49:56,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:56,250 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:49:56,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:49:56,250 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:49:56,251 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:49:56,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:49:56,252 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:49:56,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:49:56,252 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:49:56,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:49:56,252 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:49:56,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:49:56,253 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:49:56,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:49:56,253 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:56,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:49:56,253 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:56,254 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:56,254 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:56,254 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:49:56,254 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:49:56,254 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:49:56,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:49:56,260 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:49:56,261 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:56,262 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:56,262 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:49:56,263 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 123/400.
2025-08-04 20:49:56,364 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:56,364 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:56,365 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 20:49:56,365 - ClientAppLogger [Client 5] - INFO - [Client] Round 123: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 20:49:56,366 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:56,665 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0880, Avg D Loss: 0.8010
2025-08-04 20:49:56,666 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0880, Avg D Loss: 0.8010
2025-08-04 20:49:56,666 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:56,691 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5297, Threshold=0.5794, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:49:56,691 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:49:56,692 - ClientAppLogger [Client 5] - INFO - Fit completed for round 123. Duration: 0.43s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 123, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0879795789718627, 'd_loss': 0.8009887191984388, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.428455114364624, 'cpu_percent_fit': 43.075, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 36}
2025-08-04 20:49:56,692 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:50:04,963 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:04,963 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:50:04,963 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:50:04,963 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:50:04,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:50:04,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:05,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:05,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:05,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:50:05,475 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:50:05,475 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:05,579 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:05,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:05,588 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:05,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:50:05,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:05,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:50:05,607 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:05,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:05,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:50:05,617 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:05,620 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,622 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:05,625 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:05,628 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:05,630 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:05,633 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,636 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:05,639 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:05,640 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:05,643 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:05,652 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:05,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:50:05,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:50:05,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:50:05,663 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:05,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:50:05,673 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:05,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:50:05,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:05,691 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:05,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:05,705 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:05,705 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:05,705 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:05,705 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:50:05,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:05,706 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:50:05,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:05,707 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:50:05,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:50:05,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:05,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:50:05,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:05,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:05,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:50:05,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:50:05,710 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:50:05,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:50:05,710 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:50:05,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:50:05,710 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:05,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:50:05,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:50:05,718 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:50:05,718 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:05,719 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:05,719 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:50:05,721 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:05,721 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:05,721 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:05,722 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:05,737 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5381, Threshold=0.6099, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:50:05,737 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5381
2025-08-04 20:50:20,011 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:20,011 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:50:20,011 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:50:20,011 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:50:20,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:50:20,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:20,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:20,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:20,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:50:20,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:50:20,547 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:20,675 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:20,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:20,683 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:20,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:50:20,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:20,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:50:20,702 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:20,703 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:20,703 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:50:20,713 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:20,716 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,718 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:20,720 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:20,723 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:20,725 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:20,728 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,730 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:20,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:20,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:20,739 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:20,749 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:20,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:50:20,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:50:20,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:50:20,760 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:20,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:50:20,774 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:20,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:50:20,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:20,792 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:20,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:50:20,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:50:20,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:20,804 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:20,804 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:20,804 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:20,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:50:20,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:50:20,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:50:20,809 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:50:20,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:50:20,809 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:50:20,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:50:20,810 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:50:20,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:50:20,810 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:20,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:50:20,811 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:20,811 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:20,811 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:20,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:50:20,812 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:50:20,812 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:50:20,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:50:20,817 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:50:20,817 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:20,819 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:20,819 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:50:20,820 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:20,821 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:20,821 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:20,822 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:20,838 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5176, Threshold=0.5876, Accuracy=0.7435, F1=0.8207, Precision=0.9785, Recall=0.7068
2025-08-04 20:50:20,839 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7435, F1: 0.8207, Prec: 0.9785, Rec: 0.7068, Avg Anomaly Score: 0.5176
2025-08-04 20:50:38,120 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:38,120 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:50:38,120 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:50:38,121 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:50:38,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:50:38,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:38,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:38,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:38,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:50:38,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:50:38,580 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:38,681 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:38,688 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:38,688 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:38,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:50:38,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:38,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:50:38,702 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:38,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:38,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:50:38,712 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:38,715 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,718 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:38,720 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:38,723 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:38,725 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:38,728 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,730 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:38,733 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:38,736 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:38,738 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:38,750 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:38,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:50:38,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:50:38,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:50:38,760 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:38,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:50:38,770 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:38,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:50:38,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:38,786 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:38,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:50:38,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:50:38,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:38,800 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:38,800 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:38,801 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:38,801 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:38,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:50:38,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:38,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:50:38,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:38,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:50:38,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:50:38,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:50:38,805 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:50:38,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:50:38,805 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:50:38,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:50:38,805 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:50:38,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:50:38,806 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:50:38,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:50:38,806 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:50:38,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:50:38,807 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:38,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:50:38,807 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:38,807 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:38,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:38,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:50:38,808 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:50:38,808 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:50:38,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:50:38,814 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:50:38,815 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:38,816 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:38,816 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:50:38,817 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:38,817 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:38,818 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:38,818 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:38,834 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5243, Threshold=0.5880, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:50:38,834 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5243
2025-08-04 20:50:50,103 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:50,103 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:50:50,104 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:50:50,104 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:50:50,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:50:50,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:50,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:50,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:50,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:50:50,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:50:50,687 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:50,835 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:50,843 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:50,843 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:50,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:50:50,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:50,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:50:50,862 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:50,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:50,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:50:50,874 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:50,877 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,879 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:50,882 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:50,885 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:50,888 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:50,891 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,894 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:50,897 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:50,899 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:50,902 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:50,922 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:50,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:50:50,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:50:50,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:50:50,935 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:50,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:50:50,951 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:50,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:50:50,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:50,972 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:50,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:50:50,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:50:50,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:50,994 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:50,994 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:50,994 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:50,995 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:50,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:50:50,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:50,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:50:50,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:50,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:50:50,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:50:50,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:50,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:50:50,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:50,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:50,999 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:50,999 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:50:50,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:50:50,999 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:50:51,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:50:51,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:50:51,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:50:51,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:50:51,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:50:51,001 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:50:51,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:50:51,001 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:50:51,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:50:51,001 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:51,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:50:51,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:51,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:51,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:51,002 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:50:51,003 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:50:51,003 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:50:51,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:50:51,009 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:50:51,010 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:51,011 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:51,011 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:50:51,013 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:51,013 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:51,013 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:51,014 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:51,046 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5151, Threshold=0.5864, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:50:51,046 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5151
2025-08-04 20:50:59,320 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:59,320 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:50:59,320 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:50:59,320 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:50:59,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:50:59,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:59,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:59,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:59,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:50:59,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:50:59,750 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:59,847 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:59,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:59,854 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:59,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:50:59,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:59,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:50:59,866 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:59,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:59,867 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:50:59,875 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:59,878 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:59,880 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:59,882 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:59,885 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:59,887 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:59,890 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:59,892 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:59,895 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:59,897 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:59,899 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:59,909 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:59,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:50:59,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:50:59,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:50:59,922 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:59,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:50:59,932 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:59,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:50:59,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:59,947 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:59,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:50:59,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:50:59,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:59,958 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:59,958 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:59,958 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:59,959 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:59,959 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:50:59,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:59,959 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:50:59,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:59,961 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:50:59,961 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:50:59,961 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:59,961 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:50:59,961 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:59,961 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:50:59,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:59,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:50:59,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:59,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:59,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:59,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:50:59,964 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:50:59,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:50:59,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:50:59,970 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:50:59,970 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:59,971 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:59,972 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:50:59,973 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 127/400.
2025-08-04 20:51:00,073 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:00,074 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:00,075 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 20:51:00,075 - ClientAppLogger [Client 5] - INFO - [Client] Round 127: Training GAN with 37 samples (29 normal, 8 anomalous).
2025-08-04 20:51:00,075 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:00,124 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0912, Avg D Loss: 0.8132
2025-08-04 20:51:00,124 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0912, Avg D Loss: 0.8132
2025-08-04 20:51:00,125 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:00,139 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5513, Threshold=0.6164, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:00,139 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:51:00,140 - ClientAppLogger [Client 5] - INFO - Fit completed for round 127. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 127, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0912256324613416, 'd_loss': 0.8131904827581871, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.16686797142028809, 'cpu_percent_fit': 47.125, 'ram_mb_fit': 1.73828125, 'accumulated_train_samples_this_round': 37}
2025-08-04 20:51:00,140 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:51:08,404 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:08,404 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:08,404 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:08,404 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:08,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:08,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:08,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:08,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:08,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:51:08,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:51:08,933 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:09,094 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:09,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:09,103 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:09,108 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:51:09,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:09,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:51:09,117 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:09,117 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:09,117 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:51:09,128 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:09,131 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:09,133 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:09,135 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:09,139 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:09,141 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:09,144 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:09,146 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:09,150 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:09,152 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:09,154 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:09,164 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:09,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:51:09,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:51:09,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:51:09,173 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:09,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:51:09,183 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:09,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:51:09,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:09,202 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:09,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:51:09,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:51:09,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:09,214 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:09,214 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:09,214 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:09,214 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:09,214 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:51:09,214 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:09,215 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:51:09,215 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:09,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:51:09,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:51:09,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:51:09,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:51:09,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:51:09,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:51:09,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:09,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:51:09,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:09,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:09,220 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:09,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:51:09,220 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:51:09,220 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:51:09,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:51:09,227 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:51:09,227 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:09,228 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:09,228 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:51:09,229 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:09,229 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:09,230 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:09,230 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:09,244 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5176, Threshold=0.5879, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:09,244 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5176
2025-08-04 20:51:23,521 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:23,521 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:23,521 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:23,521 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:23,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:23,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:23,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:23,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:23,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:51:24,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:51:24,024 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:24,127 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:24,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:24,136 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:24,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:51:24,153 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:24,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:51:24,154 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:24,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:24,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:51:24,165 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:24,169 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,171 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:24,173 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:24,176 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:24,179 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:24,181 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,184 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:24,187 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:24,188 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:24,191 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:24,201 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:24,201 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:51:24,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:51:24,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:51:24,212 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:24,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:51:24,223 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:24,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:51:24,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:24,240 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:24,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:51:24,251 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:51:24,251 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:24,251 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:24,251 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:24,252 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:24,252 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:24,252 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:51:24,252 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:24,252 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:51:24,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:24,254 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:51:24,254 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:51:24,254 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:24,254 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:51:24,255 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:24,255 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:24,255 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:24,255 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:51:24,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:51:24,256 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:51:24,257 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:51:24,257 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:51:24,257 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:51:24,257 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:24,257 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:51:24,257 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:51:24,258 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:51:24,266 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:51:24,266 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:24,267 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:24,267 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:51:24,269 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:24,269 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:24,270 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:24,270 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:24,288 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5122, Threshold=0.5747, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:24,288 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5122
2025-08-04 20:51:29,538 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:29,538 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:29,538 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:29,539 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:29,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:29,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:29,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:29,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:29,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:51:29,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:51:29,945 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:30,103 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:30,111 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:30,111 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:30,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:51:30,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:30,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:51:30,126 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:30,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:30,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:51:30,138 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:30,141 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,144 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:30,146 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:30,149 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:30,152 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:30,155 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,157 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:30,160 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:30,162 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:30,164 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:30,175 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:30,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:51:30,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:51:30,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:51:30,187 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:30,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:51:30,198 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:30,198 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:51:30,199 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:30,214 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:30,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:51:30,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:51:30,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:30,231 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:30,231 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:30,232 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:30,232 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:30,232 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:51:30,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:30,232 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:51:30,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:30,234 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:51:30,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:51:30,234 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:30,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:51:30,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:51:30,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:51:30,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:51:30,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:51:30,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:51:30,236 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:51:30,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:51:30,237 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:51:30,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:51:30,237 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:30,237 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:51:30,237 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:30,238 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:30,238 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:30,238 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:51:30,238 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:51:30,238 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:51:30,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:51:30,247 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:51:30,247 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:30,248 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:30,249 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:51:30,250 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 129/400.
2025-08-04 20:51:30,352 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:30,352 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:30,354 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:51:30,354 - ClientAppLogger [Client 5] - INFO - [Client] Round 129: Training GAN with 39 samples (30 normal, 9 anomalous).
2025-08-04 20:51:30,354 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:30,409 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0866, Avg D Loss: 0.8240
2025-08-04 20:51:30,409 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0866, Avg D Loss: 0.8240
2025-08-04 20:51:30,409 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:30,426 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4858, Threshold=0.5085, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:30,427 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:51:30,427 - ClientAppLogger [Client 5] - INFO - Fit completed for round 129. Duration: 0.18s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 129, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0865621193861346, 'd_loss': 0.8240008713343204, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17645812034606934, 'cpu_percent_fit': 47.39375, 'ram_mb_fit': 3.07421875, 'accumulated_train_samples_this_round': 39}
2025-08-04 20:51:30,427 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:51:38,687 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:38,687 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:38,687 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:38,687 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:38,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:38,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:38,986 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:38,986 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:39,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:51:39,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:51:39,115 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:39,270 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:39,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:39,280 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:39,287 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:51:39,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:39,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:51:39,297 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:39,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:39,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:51:39,307 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:39,310 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,312 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:39,315 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:39,319 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:39,321 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:39,324 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,327 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:39,330 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:39,332 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:39,335 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:39,349 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:39,350 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:51:39,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:51:39,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:51:39,364 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:39,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:51:39,380 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:39,381 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:51:39,381 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:39,403 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:39,410 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:51:39,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:51:39,431 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:39,431 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:39,432 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:39,432 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:39,432 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:39,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:51:39,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:39,433 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:51:39,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:39,435 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:51:39,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:51:39,436 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:39,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:51:39,436 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:39,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:39,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:39,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:51:39,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:51:39,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:51:39,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:51:39,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:51:39,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:51:39,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:51:39,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:51:39,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:51:39,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:51:39,439 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:51:39,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:51:39,439 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:39,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:51:39,440 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:39,441 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:39,441 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:39,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:51:39,441 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:51:39,442 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:51:39,442 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:51:39,454 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:51:39,455 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:39,457 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:39,458 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:51:39,459 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:39,459 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:39,460 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:39,461 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:39,479 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5119, Threshold=0.5792, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:39,479 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5119
2025-08-04 20:51:44,732 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:44,732 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:44,733 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:44,733 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:44,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:44,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:44,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:44,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:45,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:51:45,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:51:45,119 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:45,217 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:45,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:45,223 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:45,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:51:45,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:45,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:51:45,271 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:45,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:45,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:51:45,280 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:45,283 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:45,285 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:45,287 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:45,290 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:45,292 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:45,295 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:45,297 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:45,300 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:45,302 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:45,304 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:45,315 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:45,315 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:51:45,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:51:45,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:51:45,326 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:45,326 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:51:45,337 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:45,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:51:45,338 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:45,353 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:45,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:51:45,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:51:45,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:45,362 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:45,363 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:45,363 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:45,363 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:45,363 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:51:45,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:45,364 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:51:45,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:45,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:51:45,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:51:45,366 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:45,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:51:45,366 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:51:45,367 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:51:45,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:51:45,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:45,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:51:45,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:45,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:45,369 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:45,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:51:45,370 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:51:45,370 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:51:45,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:51:45,379 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:51:45,379 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:45,380 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:45,380 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:51:45,381 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 130/400.
2025-08-04 20:51:45,483 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:45,483 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:45,485 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:51:45,485 - ClientAppLogger [Client 5] - INFO - [Client] Round 130: Training GAN with 39 samples (30 normal, 9 anomalous).
2025-08-04 20:51:45,486 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:45,539 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0865, Avg D Loss: 0.8302
2025-08-04 20:51:45,539 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0865, Avg D Loss: 0.8302
2025-08-04 20:51:45,539 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:45,554 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5487, Threshold=0.6046, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:45,554 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:51:45,555 - ClientAppLogger [Client 5] - INFO - Fit completed for round 130. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 130, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0865043640136722, 'd_loss': 0.8301979896349785, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.1731717586517334, 'cpu_percent_fit': 46.93125, 'ram_mb_fit': 0.3046875, 'accumulated_train_samples_this_round': 39}
2025-08-04 20:51:45,555 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:51:53,814 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:53,815 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:53,815 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:53,815 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:53,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:53,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,199 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,200 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:54,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:51:54,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:51:54,346 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:54,463 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:54,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:54,472 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:54,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:51:54,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:54,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:51:54,487 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:54,488 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:54,488 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:51:54,498 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:54,502 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,504 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:54,507 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:54,510 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:54,512 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:54,515 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,518 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:54,521 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:54,523 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:54,525 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:54,541 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:54,541 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:51:54,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:51:54,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:51:54,555 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:54,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:51:54,572 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:54,573 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:51:54,573 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:54,594 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:54,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:51:54,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:51:54,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:54,620 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:54,620 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:54,621 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:54,621 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:54,621 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:51:54,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:54,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:51:54,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:54,624 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:51:54,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:51:54,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:54,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:51:54,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:54,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:54,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:54,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:51:54,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:51:54,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:51:54,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:51:54,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:51:54,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:51:54,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:51:54,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:51:54,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:51:54,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:51:54,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:51:54,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:51:54,631 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:54,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:51:54,631 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:54,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:54,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:54,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:51:54,632 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:51:54,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:51:54,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:51:54,639 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:51:54,639 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:54,641 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:54,641 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:51:54,642 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:54,643 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:54,643 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:54,644 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:54,679 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4846, Threshold=0.5311, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:51:54,679 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4846
2025-08-04 20:51:59,933 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:59,933 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:51:59,933 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:51:59,934 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:51:59,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:51:59,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:00,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:00,239 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:00,322 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:00,349 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:00,352 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:00,442 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:00,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:00,449 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:00,456 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:00,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:00,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:00,466 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:00,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:00,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:00,476 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:00,479 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:00,481 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:00,483 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:00,486 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:00,488 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:00,491 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:00,493 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:00,496 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:00,498 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:00,500 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:00,510 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:00,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:00,515 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:00,515 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:00,520 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:00,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:00,530 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:00,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:00,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:00,546 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:00,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:00,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:00,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:00,558 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:00,558 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:00,558 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:00,558 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:00,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:00,559 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:00,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:00,559 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:00,560 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:00,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:00,561 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:00,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:00,561 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:00,561 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:00,561 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:00,562 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:00,563 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:00,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:00,563 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:00,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:00,563 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:00,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:00,564 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:00,564 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:00,564 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:00,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:00,565 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:00,565 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:00,565 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:00,569 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:00,569 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:00,571 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:00,571 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:00,573 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 131/400.
2025-08-04 20:52:00,674 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:00,674 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:00,676 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:52:00,676 - ClientAppLogger [Client 5] - INFO - [Client] Round 131: Training GAN with 40 samples (31 normal, 9 anomalous).
2025-08-04 20:52:00,676 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:00,734 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0903, Avg D Loss: 0.8295
2025-08-04 20:52:00,735 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0903, Avg D Loss: 0.8295
2025-08-04 20:52:00,735 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:00,751 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5920, Threshold=0.6725, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:00,751 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:52:00,751 - ClientAppLogger [Client 5] - INFO - Fit completed for round 131. Duration: 0.18s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 131, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0902539014816286, 'd_loss': 0.8294854652881621, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17876911163330078, 'cpu_percent_fit': 47.525, 'ram_mb_fit': 0.125, 'accumulated_train_samples_this_round': 40}
2025-08-04 20:52:00,752 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:52:06,026 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,027 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:06,027 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:06,027 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:06,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:06,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:06,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:06,442 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:06,544 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:06,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:06,591 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:06,735 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:06,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:06,745 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:06,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:06,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:06,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:06,776 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:06,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:06,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:06,790 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:06,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:06,796 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:06,799 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:06,802 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:06,805 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:06,808 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:06,810 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:06,814 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:06,819 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:06,823 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:06,834 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:06,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:06,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:06,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:06,845 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:06,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:06,862 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:06,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:06,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:06,884 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:06,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:06,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:06,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:06,905 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:06,905 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:06,906 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:06,906 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:06,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:06,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:06,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:06,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:06,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:06,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:06,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:06,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:06,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:06,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:06,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:06,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:06,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:06,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:06,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:06,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:06,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:06,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:06,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:06,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:06,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:06,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:06,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:06,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:06,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:06,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:06,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:06,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:06,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:06,913 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:06,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:06,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:06,922 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:06,922 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:06,924 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:06,924 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:06,926 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:06,927 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:06,927 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:06,928 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:06,970 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5098, Threshold=0.5718, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:06,970 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5098
2025-08-04 20:52:12,229 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:12,229 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:12,229 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:12,229 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:12,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:12,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:12,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:12,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:12,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:12,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:12,627 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:12,730 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:12,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:12,737 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:12,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:12,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:12,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:12,760 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:12,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:12,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:12,769 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:12,772 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:12,775 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:12,777 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:12,780 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:12,782 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:12,785 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:12,787 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:12,790 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:12,792 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:12,794 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:12,804 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:12,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:12,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:12,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:12,817 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:12,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:12,825 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:12,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:12,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:12,841 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:12,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:12,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:12,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:12,850 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:12,850 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:12,850 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:12,851 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:12,851 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:12,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:12,851 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:12,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:12,853 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:12,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:12,853 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:12,854 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:12,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:12,855 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:12,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:12,855 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:12,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:12,855 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:12,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:12,856 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:12,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:12,856 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:12,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:12,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:12,862 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:12,862 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:12,863 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:12,863 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:12,865 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 132/400.
2025-08-04 20:52:12,966 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:12,967 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:12,968 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:52:12,968 - ClientAppLogger [Client 5] - INFO - [Client] Round 132: Training GAN with 40 samples (31 normal, 9 anomalous).
2025-08-04 20:52:12,969 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:13,022 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0937, Avg D Loss: 0.8290
2025-08-04 20:52:13,022 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0937, Avg D Loss: 0.8290
2025-08-04 20:52:13,025 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:13,041 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4422, Threshold=0.4548, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:13,041 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:52:13,041 - ClientAppLogger [Client 5] - INFO - Fit completed for round 132. Duration: 0.18s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 132, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0937299346923828, 'd_loss': 0.8289901912212372, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17636990547180176, 'cpu_percent_fit': 47.375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 40}
2025-08-04 20:52:13,041 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:52:18,296 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:18,296 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:18,297 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:18,297 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:18,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:18,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:18,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:18,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:18,780 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:18,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:18,834 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:19,003 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:19,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:19,011 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:19,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:19,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:19,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:19,026 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:19,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:19,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:19,036 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:19,038 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,041 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:19,043 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:19,046 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:19,048 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:19,051 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,053 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:19,056 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:19,058 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:19,060 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:19,070 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:19,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:19,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:19,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:19,081 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:19,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:19,092 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:19,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:19,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:19,110 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:19,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:19,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:19,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:19,126 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:19,126 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:19,130 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:19,130 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:19,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:19,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:19,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:19,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:19,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:19,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:19,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:19,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:19,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:19,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:19,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:19,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:19,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:19,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:19,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:19,135 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:19,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:19,135 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:19,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:19,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:19,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:19,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:19,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:19,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:19,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:19,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:19,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:19,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:19,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:19,138 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:19,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:19,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:19,145 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:19,145 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:19,147 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:19,147 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:19,148 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:19,148 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:19,149 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:19,149 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:19,168 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5295, Threshold=0.5952, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:19,169 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5295
2025-08-04 20:52:24,421 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:24,421 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:24,421 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:24,421 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:24,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:24,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:24,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:24,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:24,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:24,838 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:24,838 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:24,947 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:24,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:24,953 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:24,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:24,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:24,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:24,967 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:24,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:24,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:24,976 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:24,979 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:24,981 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:24,983 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:24,986 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:24,988 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:24,990 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:24,993 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:24,996 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:24,998 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:25,000 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:25,010 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:25,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:25,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:25,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:25,021 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:25,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:25,033 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:25,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:25,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:25,048 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:25,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:25,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:25,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:25,059 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:25,059 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:25,059 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:25,059 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:25,060 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:25,060 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:25,060 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:25,060 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:25,061 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:25,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:25,062 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:25,062 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:25,062 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:25,062 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:25,062 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:25,062 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:25,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:25,063 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:25,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:25,063 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:25,063 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:25,063 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:25,064 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:25,064 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:25,064 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:25,064 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:25,064 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:25,064 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:25,065 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:25,065 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:25,065 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:25,065 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:25,065 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:25,066 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:25,066 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:25,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:25,070 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:25,071 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:25,072 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:25,072 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:25,073 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 133/400.
2025-08-04 20:52:25,174 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:25,174 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:25,176 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:52:25,176 - ClientAppLogger [Client 5] - INFO - [Client] Round 133: Training GAN with 41 samples (32 normal, 9 anomalous).
2025-08-04 20:52:25,176 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:25,226 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0850, Avg D Loss: 0.8166
2025-08-04 20:52:25,226 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0850, Avg D Loss: 0.8166
2025-08-04 20:52:25,226 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:25,240 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4898, Threshold=0.5072, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:25,241 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:52:25,241 - ClientAppLogger [Client 5] - INFO - Fit completed for round 133. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 133, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085009720848828, 'd_loss': 0.8165890051097404, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.1677393913269043, 'cpu_percent_fit': 47.6, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 41}
2025-08-04 20:52:25,241 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:52:36,530 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:36,530 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:36,530 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:36,530 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:36,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:36,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:36,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:36,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:36,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:36,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:36,999 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:37,130 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:37,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:37,138 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:37,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:37,150 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:37,150 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:37,151 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:37,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:37,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:37,160 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:37,163 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,165 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:37,167 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:37,170 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:37,172 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:37,175 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,178 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:37,181 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:37,184 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:37,186 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:37,196 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:37,196 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:37,201 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:37,201 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:37,209 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:37,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:37,222 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:37,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:37,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:37,244 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:37,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:37,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:37,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:37,258 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:37,258 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:37,259 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:37,259 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:37,259 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:37,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:37,260 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:37,260 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:37,261 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:37,261 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:37,262 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:37,262 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:37,262 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:37,262 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:37,263 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:37,263 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:37,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:37,263 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:37,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:37,264 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:37,265 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:37,266 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:37,267 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:37,267 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:37,267 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:37,268 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:37,268 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:37,268 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:37,268 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:37,269 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:37,269 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:37,269 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:37,269 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:37,270 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:37,270 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:37,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:37,274 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:37,274 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:37,276 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:37,276 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:37,278 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:37,278 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:37,278 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:37,278 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:37,296 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5665, Threshold=0.6410, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:37,297 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5665
2025-08-04 20:52:42,569 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:42,569 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:42,569 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:42,569 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:42,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:42,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:42,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:42,845 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:42,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:42,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:42,964 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:43,051 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:43,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:43,057 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:43,062 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:43,069 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:43,069 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:43,070 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:43,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:43,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:43,080 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:43,083 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:43,085 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:43,087 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:43,090 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:43,092 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:43,095 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:43,097 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:43,100 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:43,102 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:43,104 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:43,113 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:43,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:43,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:43,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:43,123 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:43,123 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:43,132 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:43,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:43,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:43,149 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:43,153 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:43,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:43,160 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:43,160 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:43,160 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:43,160 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:43,160 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:43,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:43,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:43,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:43,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:43,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:43,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:43,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:43,163 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:43,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:43,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:43,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:43,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:43,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:43,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:43,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:43,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:43,165 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:43,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:43,166 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:43,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:43,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:43,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:43,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:43,167 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:43,167 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:43,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:43,173 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:43,173 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:43,175 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:43,175 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:43,176 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 134/400.
2025-08-04 20:52:43,278 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:43,278 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:43,280 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:52:43,280 - ClientAppLogger [Client 5] - INFO - [Client] Round 134: Training GAN with 41 samples (32 normal, 9 anomalous).
2025-08-04 20:52:43,280 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:43,333 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0905, Avg D Loss: 0.8104
2025-08-04 20:52:43,333 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0905, Avg D Loss: 0.8104
2025-08-04 20:52:43,334 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:43,349 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4649, Threshold=0.4717, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:43,350 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:52:43,350 - ClientAppLogger [Client 5] - INFO - Fit completed for round 134. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 134, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.090488294275796, 'd_loss': 0.8104093493484867, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17344450950622559, 'cpu_percent_fit': 47.56875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 41}
2025-08-04 20:52:43,350 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:52:48,616 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:48,616 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:48,617 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:48,617 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:48,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:48,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:48,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:48,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:49,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:49,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:49,118 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:49,241 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:49,247 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:49,248 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:49,268 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:49,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:49,283 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:49,284 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:49,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:49,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:49,294 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:49,297 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:49,300 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:49,303 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:49,306 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:49,309 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:49,312 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:49,316 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:49,320 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:49,323 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:49,326 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:49,336 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:49,336 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:49,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:49,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:49,350 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:49,352 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:49,368 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:49,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:49,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:49,387 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:49,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:49,399 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:49,399 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:49,399 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:49,399 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:49,400 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:49,400 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:49,400 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:49,400 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:49,401 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:49,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:49,402 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:49,402 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:49,403 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:49,403 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:49,403 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:49,403 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:49,404 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:49,405 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:49,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:49,405 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:49,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:49,405 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:49,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:49,406 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:49,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:49,406 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:49,406 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:49,407 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:49,407 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:49,407 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:49,407 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:49,407 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:49,418 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:49,421 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:49,422 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:49,423 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:49,425 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:49,425 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:49,425 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:49,426 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:49,444 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5059, Threshold=0.5591, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:49,444 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5059
2025-08-04 20:52:54,694 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:54,694 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:52:54,695 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:52:54,695 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:52:54,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:52:54,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:55,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:55,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:55,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:52:55,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:52:55,130 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:55,213 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:55,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:55,220 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:55,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:52:55,233 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:55,233 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:52:55,234 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:55,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:55,234 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:52:55,242 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:55,245 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:55,247 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:55,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:55,252 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:55,254 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:55,256 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:55,259 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:55,262 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:55,264 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:55,266 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:55,275 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:55,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:52:55,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:52:55,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:52:55,286 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:55,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:52:55,297 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:55,298 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:52:55,298 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:55,312 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:55,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:52:55,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:52:55,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:55,324 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:55,324 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:55,325 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:55,325 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:55,325 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:52:55,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:55,325 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:52:55,326 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:55,327 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:52:55,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:52:55,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:52:55,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:52:55,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:52:55,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:55,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:52:55,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:55,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:55,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:55,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:52:55,331 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:52:55,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:52:55,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:52:55,335 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:52:55,335 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:55,336 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:55,336 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:52:55,338 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 135/400.
2025-08-04 20:52:55,439 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:55,439 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:55,440 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:52:55,441 - ClientAppLogger [Client 5] - INFO - [Client] Round 135: Training GAN with 42 samples (33 normal, 9 anomalous).
2025-08-04 20:52:55,441 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:55,500 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0938, Avg D Loss: 0.8128
2025-08-04 20:52:55,500 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0938, Avg D Loss: 0.8128
2025-08-04 20:52:55,500 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:55,517 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4370, Threshold=0.4430, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:52:55,517 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:52:55,517 - ClientAppLogger [Client 5] - INFO - Fit completed for round 135. Duration: 0.18s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 135, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.093787483941941, 'd_loss': 0.8128231167793274, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17908382415771484, 'cpu_percent_fit': 47.05625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 42}
2025-08-04 20:52:55,517 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:53:00,780 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:00,780 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:53:00,780 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:53:00,780 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:53:00,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:53:00,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:01,195 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:01,195 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:01,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:53:01,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:53:01,333 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:01,474 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:01,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:01,483 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:01,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:53:01,512 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:01,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:53:01,513 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:01,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:01,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:53:01,523 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:01,526 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:01,528 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:01,531 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:01,534 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:01,536 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:01,538 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:01,541 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:01,544 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:01,546 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:01,548 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:01,558 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:01,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:53:01,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:53:01,563 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:53:01,570 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:01,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:53:01,583 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:01,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:53:01,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:01,601 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:01,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:53:01,611 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:53:01,611 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:01,611 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:01,611 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:01,612 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:01,612 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:01,612 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:53:01,612 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:01,613 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:53:01,613 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:01,614 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:53:01,614 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:53:01,615 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:01,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:53:01,615 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:01,615 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:01,615 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:01,616 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:53:01,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:53:01,616 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:53:01,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:53:01,616 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:53:01,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:53:01,617 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:53:01,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:53:01,617 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:53:01,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:53:01,618 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:53:01,618 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:53:01,618 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:01,618 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:53:01,618 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:01,619 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:01,619 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:01,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:53:01,620 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:53:01,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:53:01,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:53:01,631 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:53:01,631 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:01,633 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:01,633 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:53:01,635 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:01,635 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:01,635 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:01,636 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:01,654 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5118, Threshold=0.5794, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:53:01,655 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5118
2025-08-04 20:53:12,923 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:12,924 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:53:12,924 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:53:12,924 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:53:12,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:53:12,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:13,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:13,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:13,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:53:13,365 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:53:13,365 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:13,460 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:13,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:13,467 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:13,472 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:53:13,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:13,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:53:13,478 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:13,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:13,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:53:13,487 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:13,492 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:13,495 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:13,497 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:13,501 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:13,504 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:13,507 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:13,509 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:13,512 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:13,515 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:13,517 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:13,526 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:13,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:53:13,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:53:13,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:53:13,537 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:13,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:53:13,545 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:13,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:53:13,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:13,561 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:13,566 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:53:13,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:53:13,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:13,575 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:13,575 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:13,576 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:13,576 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:13,576 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:53:13,576 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:13,577 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:53:13,577 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:13,578 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:53:13,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:53:13,579 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:13,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:53:13,579 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:13,579 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:13,579 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:13,579 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:53:13,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:53:13,581 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:53:13,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:53:13,581 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:53:13,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:53:13,581 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:13,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:53:13,582 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:13,582 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:13,582 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:13,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:53:13,582 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:53:13,583 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:53:13,583 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:53:13,588 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:53:13,588 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:13,589 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:13,590 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:53:13,591 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:13,591 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:13,591 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:13,592 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:13,610 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5407, Threshold=0.6078, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:53:13,610 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5407
2025-08-04 20:53:18,859 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:18,859 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:53:18,859 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:53:18,859 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:53:18,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:53:18,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:19,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:19,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:19,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:53:19,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:53:19,278 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:19,397 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:19,403 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:19,403 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:19,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:53:19,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:19,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:53:19,415 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:19,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:19,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:53:19,424 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:19,426 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:19,429 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:19,431 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:19,434 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:19,436 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:19,438 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:19,441 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:19,443 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:19,445 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:19,447 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:19,458 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:19,458 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:53:19,463 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:53:19,464 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:53:19,468 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:19,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:53:19,477 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:19,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:53:19,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:19,492 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:19,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:53:19,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:53:19,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:19,501 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:19,502 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:19,502 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:19,502 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:19,502 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:53:19,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:19,502 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:53:19,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:19,504 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:53:19,504 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:53:19,504 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:19,504 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:53:19,504 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:19,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:19,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:19,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:53:19,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:53:19,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:53:19,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:53:19,506 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:53:19,506 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:53:19,506 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:53:19,506 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:53:19,506 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:53:19,506 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:53:19,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:53:19,507 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:53:19,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:19,507 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:53:19,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:19,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:19,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:19,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:53:19,508 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:53:19,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:53:19,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:53:19,512 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:53:19,512 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:19,513 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:19,513 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:53:19,514 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 137/400.
2025-08-04 20:53:19,615 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:19,615 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:19,616 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:53:19,616 - ClientAppLogger [Client 5] - INFO - [Client] Round 137: Training GAN with 42 samples (33 normal, 9 anomalous).
2025-08-04 20:53:19,616 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:19,665 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8115
2025-08-04 20:53:19,666 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8115
2025-08-04 20:53:19,669 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:19,684 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5055, Threshold=0.5240, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:53:19,685 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:53:19,685 - ClientAppLogger [Client 5] - INFO - Fit completed for round 137. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 137, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0832111313229515, 'd_loss': 0.811475042785917, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17090058326721191, 'cpu_percent_fit': 47.2, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 42}
2025-08-04 20:53:19,685 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:53:33,962 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:33,962 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:53:33,962 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:53:33,962 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:53:33,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:53:33,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:34,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:34,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:34,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:53:34,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:53:34,417 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:34,540 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:34,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:34,545 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:34,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:53:34,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:34,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:53:34,556 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:34,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:34,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:53:34,564 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:34,567 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:34,569 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:34,571 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:34,574 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:34,576 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:34,579 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:34,582 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:34,585 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:34,586 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:34,588 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:34,596 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:34,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:53:34,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:53:34,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:53:34,606 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:34,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:53:34,616 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:34,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:53:34,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:34,632 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:34,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:53:34,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:53:34,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:34,644 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:34,644 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:34,645 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:34,645 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:34,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:53:34,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:34,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:53:34,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:34,647 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:53:34,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:53:34,647 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:53:34,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:53:34,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:53:34,649 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:53:34,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:53:34,649 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:53:34,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:53:34,650 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:53:34,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:53:34,650 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:53:34,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:53:34,650 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:34,651 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:53:34,651 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:34,651 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:34,651 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:34,652 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:53:34,652 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:53:34,652 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:53:34,652 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:53:34,659 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:53:34,659 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:34,660 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:34,660 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:53:34,662 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:34,662 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:34,662 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:34,663 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:34,678 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5396, Threshold=0.6029, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:53:34,678 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5396
2025-08-04 20:53:54,962 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:54,963 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:53:54,963 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:53:54,963 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:53:54,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:53:54,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:55,341 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:55,341 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:55,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:53:55,475 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:53:55,475 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:55,591 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:55,598 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:55,598 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:55,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:53:55,612 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:55,613 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:53:55,613 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:55,613 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:55,613 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:53:55,622 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:55,625 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:55,627 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:55,629 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:55,632 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:55,634 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:55,637 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:55,639 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:55,642 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:55,644 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:55,646 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:55,656 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:55,656 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:53:55,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:53:55,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:53:55,668 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:55,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:53:55,683 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:55,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:53:55,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:55,700 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:55,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:53:55,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:53:55,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:55,711 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:55,711 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:55,711 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:55,711 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:55,711 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:53:55,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:55,712 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:53:55,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:55,713 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:53:55,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:53:55,713 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:53:55,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:53:55,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:53:55,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:53:55,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:53:55,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:53:55,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:53:55,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:53:55,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:53:55,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:53:55,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:55,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:53:55,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:55,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:55,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:55,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:53:55,717 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:53:55,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:53:55,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:53:55,719 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:53:55,719 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:55,721 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:55,721 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:53:55,722 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:55,723 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:55,723 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:55,723 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:55,741 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5307, Threshold=0.5980, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:53:55,741 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5307
2025-08-04 20:54:01,023 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:01,023 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:54:01,023 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:54:01,023 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:54:01,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:54:01,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:01,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:01,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:01,460 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:54:01,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:54:01,496 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:01,588 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:01,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:01,594 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:01,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:54:01,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:01,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:54:01,606 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:01,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:01,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:54:01,614 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:01,617 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:01,619 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:01,621 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:01,624 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:01,626 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:01,629 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:01,631 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:01,634 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:01,635 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:01,638 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:01,648 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:01,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:54:01,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:54:01,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:54:01,658 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:01,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:54:01,670 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:01,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:54:01,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:01,687 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:01,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:54:01,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:54:01,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:01,702 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:01,702 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:01,703 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:01,703 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:01,703 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:54:01,703 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:01,703 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:54:01,704 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:01,705 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:54:01,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:54:01,705 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:01,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:54:01,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:54:01,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:54:01,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:01,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:54:01,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:01,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:01,708 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:01,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:54:01,709 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:54:01,709 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:54:01,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:54:01,716 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:54:01,716 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:01,717 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:01,718 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:54:01,719 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 139/400.
2025-08-04 20:54:01,820 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:01,821 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:01,822 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 10 anomalous samples to GAN training data (target: 10).
2025-08-04 20:54:01,822 - ClientAppLogger [Client 5] - INFO - [Client] Round 139: Training GAN with 44 samples (34 normal, 10 anomalous).
2025-08-04 20:54:01,822 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:01,873 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0912, Avg D Loss: 0.8163
2025-08-04 20:54:01,873 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0912, Avg D Loss: 0.8163
2025-08-04 20:54:01,873 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:01,888 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5015, Threshold=0.5210, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:54:01,889 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:54:01,889 - ClientAppLogger [Client 5] - INFO - Fit completed for round 139. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 139, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.091240572929382, 'd_loss': 0.8163320568474856, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17011761665344238, 'cpu_percent_fit': 47.2625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 44}
2025-08-04 20:54:01,890 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:54:13,149 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:13,149 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:54:13,149 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:54:13,149 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:54:13,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:54:13,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:13,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:13,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:13,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:54:13,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:54:13,606 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:13,699 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:13,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:13,706 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:13,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:54:13,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:13,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:54:13,718 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:13,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:13,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:54:13,727 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:13,730 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:13,732 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:13,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:13,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:13,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:13,742 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:13,745 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:13,748 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:13,750 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:13,752 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:13,762 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:13,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:54:13,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:54:13,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:54:13,774 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:13,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:54:13,789 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:13,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:54:13,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:13,806 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:13,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:54:13,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:54:13,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:13,816 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:13,816 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:13,817 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:13,817 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:13,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:54:13,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:13,817 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:54:13,818 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:13,819 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:54:13,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:54:13,819 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:54:13,820 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:54:13,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:54:13,821 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:54:13,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:54:13,821 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:54:13,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:54:13,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:54:13,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:54:13,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:13,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:54:13,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:13,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:13,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:13,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:54:13,824 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:54:13,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:54:13,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:54:13,827 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:54:13,827 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:13,828 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:13,828 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:54:13,830 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:13,830 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:13,830 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:13,831 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:13,847 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5663, Threshold=0.6433, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:54:13,847 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5663
2025-08-04 20:54:31,139 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:31,139 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:54:31,139 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:54:31,139 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:54:31,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:54:31,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:31,470 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:31,470 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:31,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:54:31,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:54:31,606 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:31,716 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:31,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:31,723 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:31,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:54:31,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:31,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:54:31,736 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:31,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:31,736 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:54:31,745 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:31,748 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:31,750 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:31,752 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:31,755 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:31,757 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:31,759 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:31,762 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:31,764 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:31,766 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:31,768 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:31,777 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:31,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:54:31,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:54:31,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:54:31,787 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:31,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:54:31,800 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:31,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:54:31,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:31,815 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:31,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:54:31,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:54:31,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:31,824 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:31,824 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:31,825 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:31,825 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:31,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:54:31,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:31,826 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:54:31,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:31,827 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:54:31,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:54:31,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:31,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:54:31,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:31,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:31,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:31,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:54:31,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:54:31,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:54:31,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:54:31,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:54:31,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:54:31,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:54:31,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:54:31,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:54:31,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:54:31,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:31,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:54:31,832 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:54:31,832 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:54:31,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:54:31,835 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:54:31,835 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:31,836 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:31,837 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:54:31,838 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:31,838 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:31,839 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:31,839 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:31,853 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5247, Threshold=0.5843, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:54:31,854 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5247
2025-08-04 20:54:52,165 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:52,165 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:54:52,166 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:54:52,166 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:54:52,166 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:54:52,166 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:52,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:52,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:52,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:54:52,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:54:52,595 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:52,707 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:52,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:52,713 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:52,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:54:52,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:52,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:54:52,750 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:52,751 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:52,751 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:54:52,759 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:52,762 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:52,764 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:52,767 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:52,769 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:52,772 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:52,774 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:52,777 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:52,779 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:52,782 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:52,784 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:52,794 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:52,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:54:52,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:54:52,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:54:52,804 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:52,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:54:52,814 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:52,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:54:52,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:52,831 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:52,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:54:52,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:54:52,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:52,842 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:52,843 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:52,843 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:52,843 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:52,843 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:54:52,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:52,844 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:54:52,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:52,846 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:54:52,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:54:52,846 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:52,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:54:52,846 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:52,846 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:54:52,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:54:52,848 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:52,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:54:52,849 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:52,849 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:52,850 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:52,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:54:52,850 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:54:52,850 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:54:52,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:54:52,858 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:54:52,858 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:52,859 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:52,859 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:54:52,861 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:52,861 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:52,861 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:52,862 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:52,877 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5546, Threshold=0.6180, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:54:52,877 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5546
2025-08-04 20:55:13,155 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:13,155 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:55:13,155 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:55:13,155 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:55:13,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:55:13,155 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:13,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:13,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:13,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:55:13,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:55:13,589 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:13,711 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:13,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:13,719 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:13,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:55:13,731 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:13,731 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:55:13,732 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:13,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:13,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:55:13,741 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:13,744 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:13,746 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:13,749 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:13,751 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:13,754 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:13,756 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:13,759 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:13,761 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:13,763 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:13,766 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:13,776 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:13,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:55:13,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:55:13,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:55:13,789 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:13,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:55:13,805 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:13,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:55:13,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:13,821 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:13,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:55:13,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:55:13,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:13,831 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:13,831 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:13,832 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:13,832 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:13,832 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:55:13,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:13,833 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:55:13,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:13,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:55:13,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:55:13,835 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:13,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:55:13,835 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:13,835 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:55:13,836 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:13,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:55:13,838 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:13,838 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:13,838 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:13,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:55:13,839 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:55:13,839 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:55:13,839 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:55:13,844 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:55:13,844 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:13,846 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:13,846 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:55:13,848 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:13,848 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:13,848 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:13,849 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:13,864 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5390, Threshold=0.6018, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:55:13,864 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5390
2025-08-04 20:55:34,154 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:34,154 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:55:34,154 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:55:34,154 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:55:34,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:55:34,154 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:34,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:34,503 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:34,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:55:34,639 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:55:34,639 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:34,743 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:34,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:34,749 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:34,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:55:34,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:34,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:55:34,801 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:34,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:34,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:55:34,810 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:34,814 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,816 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:34,819 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:34,822 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:34,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:34,827 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,829 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:34,832 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:34,834 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:34,838 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:34,853 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:34,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:55:34,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:55:34,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:55:34,869 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:34,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:55:34,883 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:34,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:55:34,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:34,903 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:34,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:55:34,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:55:34,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:34,920 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:34,920 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:34,920 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:34,921 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:34,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:55:34,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:34,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:55:34,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:34,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:55:34,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:55:34,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:34,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:55:34,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:34,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:34,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:34,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:55:34,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:55:34,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:55:34,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:55:34,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:55:34,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:55:34,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:55:34,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:55:34,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:55:34,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:55:34,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:55:34,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:55:34,928 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:34,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:55:34,928 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:34,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:34,929 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:34,929 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:55:34,930 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:55:34,930 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:55:34,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:55:34,938 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:55:34,938 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:34,939 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:34,940 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:55:34,941 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:34,941 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:34,942 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:34,943 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:34,962 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4743, Threshold=0.5083, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:55:34,962 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4743
2025-08-04 20:55:55,246 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:55,246 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:55:55,246 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:55:55,247 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:55:55,247 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:55:55,247 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:55,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:55,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:55,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:55:55,814 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:55:55,814 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:55,985 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:55,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:55,998 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:56,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:55:56,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,021 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:55:56,033 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,037 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,039 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,042 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,046 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,049 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,052 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,055 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,058 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,061 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,064 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,082 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:55:56,090 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,090 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:55:56,100 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:55:56,115 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:55:56,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,137 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:55:56,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:55:56,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,160 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,160 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,161 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,161 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,161 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:55:56,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,162 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:55:56,162 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,163 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:55:56,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,164 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,165 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,166 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:55:56,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:55:56,167 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:55:56,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:55:56,167 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:55:56,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:55:56,168 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:55:56,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:55:56,168 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:55:56,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:55:56,169 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:55:56,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:55:56,169 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:55:56,169 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,170 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,170 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:55:56,173 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:55:56,173 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:55:56,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:55:56,180 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:55:56,180 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,182 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,182 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:55:56,184 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,184 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,185 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,186 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,234 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5729, Threshold=0.6495, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:55:56,234 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5729
2025-08-04 20:56:01,494 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:01,495 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:56:01,495 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:56:01,495 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:56:01,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:56:01,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:01,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:01,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:01,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:56:01,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:56:01,941 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:02,031 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:02,036 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:02,036 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:02,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:56:02,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:02,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:56:02,046 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:02,047 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:02,047 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:56:02,055 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:02,057 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:02,059 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:02,061 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:02,064 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:02,066 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:02,068 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:02,071 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:02,074 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:02,076 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:02,079 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:02,088 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:02,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:56:02,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:56:02,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:56:02,098 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:02,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:56:02,107 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:02,108 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:56:02,108 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:02,123 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:02,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:56:02,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:56:02,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:02,133 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:02,133 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:02,133 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:02,133 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:02,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:56:02,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:02,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:56:02,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:02,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:56:02,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:56:02,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:02,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:56:02,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:56:02,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:56:02,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:56:02,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:56:02,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:56:02,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:56:02,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:56:02,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:56:02,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:02,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:56:02,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:02,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:02,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:02,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:56:02,140 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:56:02,140 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:56:02,140 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:56:02,143 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:56:02,143 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:02,144 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:02,144 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:56:02,145 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 145/400.
2025-08-04 20:56:02,246 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:02,246 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:02,247 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 10 anomalous samples to GAN training data (target: 10).
2025-08-04 20:56:02,248 - ClientAppLogger [Client 5] - INFO - [Client] Round 145: Training GAN with 45 samples (35 normal, 10 anomalous).
2025-08-04 20:56:02,248 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:02,303 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0886, Avg D Loss: 0.7912
2025-08-04 20:56:02,304 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0886, Avg D Loss: 0.7912
2025-08-04 20:56:02,304 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:02,318 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5072, Threshold=0.5371, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:56:02,318 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:56:02,318 - ClientAppLogger [Client 5] - INFO - Fit completed for round 145. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 145, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.088612491289775, 'd_loss': 0.7912201485368939, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17275166511535645, 'cpu_percent_fit': 47.6, 'ram_mb_fit': 3.65625, 'accumulated_train_samples_this_round': 45}
2025-08-04 20:56:02,318 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:56:07,593 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:07,594 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:56:07,594 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:56:07,594 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:56:07,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:56:07,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:08,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:08,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,147 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:56:08,199 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:56:08,200 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:08,385 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:08,395 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:08,395 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:08,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:56:08,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:08,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:56:08,415 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:08,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:08,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:56:08,432 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:08,437 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,441 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:08,444 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:08,449 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:08,452 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:08,457 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,461 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:08,465 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:08,467 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:08,471 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:08,485 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:08,485 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:56:08,490 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:56:08,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:56:08,496 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:08,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:56:08,510 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:08,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:56:08,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:08,530 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:08,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:56:08,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:56:08,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:08,551 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:08,551 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:08,551 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:08,552 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:08,552 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:56:08,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:08,552 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:56:08,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:08,554 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:56:08,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:56:08,555 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:08,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:56:08,555 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:08,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:08,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:08,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:56:08,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:56:08,556 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:56:08,556 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:56:08,557 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:56:08,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:56:08,557 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:56:08,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:56:08,558 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:56:08,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:56:08,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:56:08,559 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:56:08,559 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:08,560 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:56:08,560 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:08,560 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:08,561 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:08,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:56:08,561 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:56:08,561 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:56:08,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:56:08,571 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:56:08,572 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:08,578 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:08,578 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:56:08,580 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:08,580 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:08,580 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:08,581 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:08,599 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5019, Threshold=0.5336, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:56:08,600 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5019
2025-08-04 20:56:25,889 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:25,889 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:56:25,889 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:56:25,889 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:56:25,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:56:25,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:26,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:26,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:26,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:56:26,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:56:26,364 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:26,508 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:26,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:26,516 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:26,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:56:26,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:26,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:56:26,537 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:26,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:26,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:56:26,548 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:26,552 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,557 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:26,560 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:26,563 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:26,565 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:26,568 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,571 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:26,573 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:26,575 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:26,578 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:26,589 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:26,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:56:26,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:56:26,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:56:26,603 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:26,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:56:26,621 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:26,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:56:26,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:26,644 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:26,651 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:56:26,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:56:26,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:26,667 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:26,667 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:26,668 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:26,668 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:26,668 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:56:26,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:26,669 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:56:26,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:26,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:56:26,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:56:26,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:26,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:56:26,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:26,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:26,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:56:26,672 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:56:26,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:56:26,673 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:56:26,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:56:26,673 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:56:26,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:56:26,674 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:26,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:56:26,674 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:26,674 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:26,674 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:26,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:56:26,675 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:56:26,675 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:56:26,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:56:26,682 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:56:26,682 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:26,684 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:26,684 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:56:26,687 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:26,687 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:26,687 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:26,688 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:26,705 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5556, Threshold=0.6257, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:56:26,705 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5556
2025-08-04 20:56:46,980 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:46,980 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:56:46,980 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:56:46,980 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:56:46,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:56:46,981 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:47,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:47,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:47,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:56:47,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:56:47,574 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:47,747 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:47,756 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:47,756 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:47,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:56:47,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:47,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:56:47,771 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:47,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:47,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:56:47,781 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:47,785 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,789 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:47,792 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:47,796 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:47,799 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:47,803 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,807 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:47,811 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:47,814 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:47,818 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:47,834 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:47,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:56:47,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:56:47,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:56:47,853 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:47,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:56:47,868 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:47,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:56:47,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:47,888 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:47,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:56:47,902 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:56:47,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:47,904 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:47,904 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:47,905 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:47,905 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:47,905 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:56:47,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:47,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:56:47,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:47,907 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:56:47,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:56:47,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:47,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:56:47,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:47,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:47,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:47,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:56:47,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:56:47,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:56:47,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:56:47,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:56:47,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:56:47,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:56:47,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:56:47,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:56:47,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:56:47,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:56:47,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:56:47,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:47,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:56:47,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:47,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:47,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:47,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:56:47,918 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:56:47,918 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:56:47,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:56:47,926 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:56:47,926 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:47,928 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:47,930 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:56:47,932 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:47,932 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:47,932 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:47,933 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:47,951 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4731, Threshold=0.5000, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:56:47,951 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4731
2025-08-04 20:57:05,242 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:05,242 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:57:05,243 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:57:05,243 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:57:05,243 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:57:05,243 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:05,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:05,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:05,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:57:05,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:57:05,668 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:05,800 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:05,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:05,811 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:05,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:57:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:05,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:57:05,828 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:05,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:05,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:57:05,838 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:05,841 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:05,844 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:05,846 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:05,849 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:05,851 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:05,854 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:05,857 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:05,860 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:05,862 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:05,866 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:05,880 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:05,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:57:05,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:57:05,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:57:05,895 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:05,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:57:05,922 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:05,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:57:05,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:05,951 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:05,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:57:05,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:57:05,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:05,971 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:05,971 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:05,972 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:05,972 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:05,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:57:05,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:05,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:57:05,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:05,975 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:57:05,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:57:05,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:05,976 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:57:05,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:05,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:05,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:05,977 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:57:05,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:57:05,977 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:57:05,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:57:05,978 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:57:05,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:57:05,978 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:57:05,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:57:05,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:57:05,979 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:57:05,980 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:57:05,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:57:05,980 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:05,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:57:05,981 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:05,981 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:05,981 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:05,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:57:05,982 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:57:05,982 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:57:05,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:57:05,988 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:57:05,989 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:05,990 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:05,991 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:57:05,993 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:05,993 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:05,993 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:05,994 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:06,016 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5276, Threshold=0.5789, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:57:06,017 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5276
2025-08-04 20:57:26,295 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:26,295 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:57:26,295 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:57:26,296 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:57:26,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:57:26,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:26,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:26,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:26,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:57:26,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:57:26,804 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:26,926 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:26,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:26,934 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:26,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:57:26,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:26,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:57:26,947 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:26,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:26,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:57:26,957 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:26,960 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:26,962 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:26,965 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:26,968 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:26,970 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:26,973 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:26,975 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:26,978 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:26,980 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:26,982 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:26,992 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:26,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:57:26,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:57:26,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:57:27,003 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:27,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:57:27,016 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:27,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:57:27,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:27,034 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:27,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:57:27,051 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:57:27,051 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:27,051 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:27,051 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:27,052 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:27,052 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:27,052 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:57:27,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:27,053 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:57:27,053 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:27,054 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:57:27,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:57:27,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:27,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:57:27,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:27,055 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:27,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:27,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:57:27,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:57:27,056 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:57:27,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:57:27,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:57:27,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:57:27,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:57:27,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:57:27,057 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:57:27,057 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:57:27,058 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:57:27,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:57:27,058 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:27,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:57:27,058 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:27,059 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:27,059 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:27,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:57:27,059 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:57:27,059 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:57:27,060 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:57:27,065 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:57:27,065 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:27,066 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:27,066 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:57:27,068 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:27,068 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:27,068 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:27,069 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:27,089 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5358, Threshold=0.5880, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:57:27,089 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5358
2025-08-04 20:57:47,389 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:47,389 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:57:47,389 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:57:47,389 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:57:47,389 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:57:47,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:47,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:47,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:47,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:57:47,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:57:47,809 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:47,934 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:47,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:47,941 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:47,947 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:57:47,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:47,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:57:47,968 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:47,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:47,968 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:57:47,977 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:47,980 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:47,983 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:47,985 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:47,988 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:47,990 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:47,993 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:47,996 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:47,999 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:48,001 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:48,003 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:48,014 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:48,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:57:48,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:57:48,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:57:48,024 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:48,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:57:48,035 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:48,035 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:57:48,035 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:48,052 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:48,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:57:48,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:57:48,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:48,067 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:48,067 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:48,067 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:48,068 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:48,068 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:57:48,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:48,068 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:57:48,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:48,070 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:57:48,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:57:48,070 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:57:48,071 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:57:48,072 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:57:48,072 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:57:48,072 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:57:48,072 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:57:48,072 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:57:48,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:57:48,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:57:48,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:57:48,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:57:48,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:48,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:57:48,074 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:48,074 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:48,074 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:48,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:57:48,075 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:57:48,075 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:57:48,075 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:57:48,083 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:57:48,083 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:48,085 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:48,085 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:57:48,086 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:48,087 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:48,087 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:48,088 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:48,104 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5406, Threshold=0.5982, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:57:48,104 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5406
2025-08-04 20:57:53,378 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:53,378 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:57:53,378 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:57:53,379 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:57:53,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:57:53,379 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:53,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:53,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:53,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:57:53,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:57:53,898 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:53,994 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:54,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:54,000 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:54,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:57:54,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:54,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:57:54,011 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:54,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:54,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:57:54,020 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:54,023 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:54,025 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:54,027 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:54,030 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:54,032 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:54,034 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:54,037 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:54,039 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:54,041 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:54,043 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:54,052 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:54,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:57:54,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:57:54,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:57:54,061 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:54,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:57:54,070 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:54,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:57:54,071 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:54,087 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:54,092 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:57:54,097 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:57:54,097 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:54,097 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:54,098 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:54,098 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:54,098 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:54,098 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:57:54,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:54,099 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:57:54,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:54,100 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:57:54,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:57:54,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:54,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:57:54,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:54,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:54,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:54,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:57:54,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:57:54,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:57:54,102 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:57:54,102 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:57:54,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:57:54,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:54,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:57:54,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:54,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:54,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:54,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:57:54,105 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:57:54,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:57:54,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:57:54,110 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:57:54,110 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:54,111 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:54,112 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:57:54,113 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 151/400.
2025-08-04 20:57:54,214 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:54,215 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:54,216 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 10 anomalous samples to GAN training data (target: 10).
2025-08-04 20:57:54,217 - ClientAppLogger [Client 5] - INFO - [Client] Round 151: Training GAN with 46 samples (36 normal, 10 anomalous).
2025-08-04 20:57:54,217 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:54,272 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0850, Avg D Loss: 0.7899
2025-08-04 20:57:54,272 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0850, Avg D Loss: 0.7899
2025-08-04 20:57:54,273 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:54,289 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5197, Threshold=0.5525, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:57:54,289 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:57:54,289 - ClientAppLogger [Client 5] - INFO - Fit completed for round 151. Duration: 0.18s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 151, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0850420184757397, 'd_loss': 0.7899442600167316, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.1761610507965088, 'cpu_percent_fit': 47.4125, 'ram_mb_fit': 4.96484375, 'accumulated_train_samples_this_round': 46}
2025-08-04 20:57:54,290 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:58:05,560 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:05,560 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:58:05,560 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:58:05,560 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:58:05,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:58:05,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:05,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:05,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:06,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:58:06,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:58:06,129 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:06,298 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:06,304 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:06,304 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:06,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:58:06,347 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:06,347 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:58:06,348 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:06,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:06,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:58:06,357 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:06,360 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:06,362 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:06,365 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:06,367 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:06,370 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:06,372 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:06,375 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:06,378 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:06,380 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:06,382 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:06,394 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:06,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:58:06,399 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:58:06,399 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:58:06,406 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:06,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:58:06,418 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:06,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:58:06,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:06,435 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:06,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:58:06,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:58:06,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:06,445 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:06,445 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:06,446 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:06,446 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:06,446 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:58:06,446 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:06,447 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:58:06,447 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:06,448 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:58:06,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:58:06,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:06,449 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:58:06,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:06,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:06,449 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:58:06,450 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:58:06,451 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:58:06,451 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:58:06,451 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:58:06,451 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:58:06,451 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:06,452 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:58:06,452 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:06,452 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:06,452 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:06,452 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:58:06,453 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:58:06,453 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:58:06,453 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:58:06,458 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:58:06,458 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:06,460 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:06,460 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:58:06,462 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:06,462 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:06,462 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:06,463 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:06,480 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5172, Threshold=0.5673, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:58:06,481 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5172
2025-08-04 20:58:26,796 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:26,796 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:58:26,796 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:58:26,796 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:58:26,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:58:26,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:27,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:27,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:27,199 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:58:27,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:58:27,223 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:27,346 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:27,354 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:27,354 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:27,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:58:27,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:27,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:58:27,369 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:27,369 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:27,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:58:27,379 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:27,382 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:27,384 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:27,386 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:27,389 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:27,391 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:27,394 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:27,396 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:27,399 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:27,401 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:27,404 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:27,414 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:27,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:58:27,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:58:27,420 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:58:27,425 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:27,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:58:27,439 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:27,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:58:27,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:27,457 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:27,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:58:27,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:58:27,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:27,478 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:27,479 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:27,479 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:27,480 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:27,480 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:58:27,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:27,481 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:58:27,481 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:27,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:58:27,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:58:27,483 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:27,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:58:27,484 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:58:27,485 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:58:27,485 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:58:27,485 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:58:27,485 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:58:27,485 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:58:27,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:58:27,486 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:58:27,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:58:27,486 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:27,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:58:27,486 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:27,487 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:27,487 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:27,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:58:27,487 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:58:27,487 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:58:27,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:58:27,496 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:58:27,497 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:27,498 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:27,498 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:58:27,500 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:27,500 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:27,500 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:27,501 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:27,518 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5696, Threshold=0.6411, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:58:27,518 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5696
2025-08-04 20:58:44,811 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:44,811 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:58:44,811 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:58:44,811 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:58:44,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:58:44,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:45,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:45,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:45,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:58:45,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:58:45,248 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:45,372 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:45,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:45,379 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:45,384 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:58:45,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:45,406 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:58:45,407 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:45,407 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:45,407 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:58:45,416 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:45,419 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:45,422 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:45,424 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:45,427 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:45,429 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:45,432 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:45,434 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:45,437 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:45,439 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:45,442 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:45,455 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:45,455 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:58:45,460 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:58:45,460 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:58:45,468 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:45,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:58:45,482 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:45,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:58:45,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:45,499 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:45,504 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:58:45,512 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:58:45,512 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:45,512 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:45,512 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:45,513 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:45,513 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:45,514 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:58:45,514 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:45,514 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:58:45,515 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:45,516 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:58:45,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:58:45,517 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:45,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:58:45,517 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:45,517 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:45,517 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:45,518 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:58:45,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:58:45,518 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:58:45,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:58:45,518 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:58:45,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:58:45,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:58:45,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:58:45,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:58:45,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:58:45,520 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:58:45,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:58:45,520 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:45,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:58:45,520 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:45,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:45,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:45,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:58:45,521 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:58:45,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:58:45,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:58:45,530 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:58:45,530 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:45,531 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:45,531 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:58:45,533 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:45,533 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:45,533 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:45,534 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:45,550 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4745, Threshold=0.5083, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:58:45,550 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4745
2025-08-04 20:59:05,832 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:05,833 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:59:05,833 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:59:05,833 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:59:05,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:59:05,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:06,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:06,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:06,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:59:06,359 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:59:06,359 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:06,511 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:06,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:06,522 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:06,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:59:06,544 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:06,544 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:59:06,544 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:06,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:06,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:59:06,554 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:06,557 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:06,559 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:06,562 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:06,564 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:06,566 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:06,569 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:06,572 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:06,575 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:06,577 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:06,579 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:06,591 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:06,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:59:06,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:59:06,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:59:06,604 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:06,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:59:06,616 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:06,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:59:06,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:06,637 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:06,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:59:06,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:59:06,658 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:06,658 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:06,658 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:06,658 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:06,659 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:06,659 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:59:06,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:06,659 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:59:06,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:06,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:59:06,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:59:06,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:06,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:59:06,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:06,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:06,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:06,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:59:06,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:59:06,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:59:06,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:59:06,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:59:06,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:59:06,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:59:06,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:59:06,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:59:06,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:59:06,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:59:06,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:59:06,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:06,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:59:06,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:06,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:06,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:06,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:59:06,666 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:59:06,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:59:06,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:59:06,677 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:59:06,677 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:06,679 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:06,680 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:59:06,682 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:06,682 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:06,682 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:06,683 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:06,703 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5322, Threshold=0.5884, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:59:06,703 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5322
2025-08-04 20:59:23,984 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:23,984 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:59:23,984 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:59:23,985 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:59:23,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:59:23,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:24,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:24,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:24,367 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:59:24,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:59:24,409 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:24,556 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:24,562 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:24,562 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:24,568 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:59:24,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:24,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:59:24,590 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:24,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:24,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:59:24,599 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:24,602 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:24,604 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:24,606 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:24,609 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:24,611 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:24,614 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:24,616 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:24,619 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:24,621 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:24,624 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:24,635 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:24,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:59:24,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:59:24,640 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:59:24,649 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:24,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:59:24,662 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:24,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:59:24,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:24,679 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:24,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:59:24,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:59:24,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:24,690 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:24,690 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:24,691 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:24,691 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:24,691 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:59:24,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:24,692 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:59:24,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:24,693 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:59:24,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:59:24,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:24,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:59:24,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:24,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:24,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:24,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:59:24,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:59:24,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:59:24,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:59:24,696 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:59:24,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:59:24,696 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:59:24,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:59:24,696 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:59:24,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:59:24,697 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:59:24,697 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:59:24,697 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:24,697 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:59:24,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:24,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:24,699 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:24,699 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:59:24,699 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:59:24,700 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:59:24,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:59:24,705 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:59:24,705 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:24,707 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:24,707 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:59:24,709 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:24,709 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:24,709 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:24,710 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:24,752 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5257, Threshold=0.5766, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:59:24,753 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5257
2025-08-04 20:59:36,043 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:36,044 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:59:36,044 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:59:36,044 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:59:36,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:59:36,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:36,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:36,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:36,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:59:36,472 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:59:36,472 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:36,618 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:36,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:36,624 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:36,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:59:36,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:36,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:59:36,636 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:36,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:36,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:59:36,645 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:36,649 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:36,651 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:36,653 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:36,656 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:36,659 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:36,661 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:36,664 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:36,667 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:36,669 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:36,671 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:36,684 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:36,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:59:36,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:59:36,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:59:36,700 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:36,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:59:36,718 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:36,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:59:36,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:36,738 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:36,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:59:36,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:59:36,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:36,762 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:36,763 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:36,763 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:36,763 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:36,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:59:36,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:36,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:59:36,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:36,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:59:36,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:59:36,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:36,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:59:36,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:36,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:36,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:36,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:59:36,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:59:36,768 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:59:36,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:59:36,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:59:36,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:59:36,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:59:36,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:59:36,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:59:36,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:59:36,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:59:36,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:59:36,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:36,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:59:36,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:36,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:36,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:36,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:59:36,771 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:59:36,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:59:36,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:59:36,782 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:59:36,782 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:36,783 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:36,784 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:59:36,785 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:36,785 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:36,785 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:36,786 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:36,803 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5035, Threshold=0.5645, Accuracy=0.7435, F1=0.8207, Precision=0.9785, Recall=0.7068
2025-08-04 20:59:36,804 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7435, F1: 0.8207, Prec: 0.9785, Rec: 0.7068, Avg Anomaly Score: 0.5035
2025-08-04 20:59:45,082 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:45,083 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:59:45,083 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:59:45,083 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:59:45,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:59:45,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:45,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:45,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:45,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:59:45,612 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:59:45,612 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:45,748 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:45,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:45,754 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:45,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:59:45,780 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:45,780 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:59:45,781 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:45,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:45,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:59:45,790 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:45,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:45,795 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:45,797 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:45,800 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:45,802 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:45,804 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:45,807 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:45,810 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:45,812 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:45,814 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:45,824 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:45,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:59:45,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:59:45,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:59:45,833 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:45,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:59:45,844 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:45,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:59:45,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:45,861 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:45,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:59:45,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:59:45,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:45,871 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:45,871 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:45,872 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:45,872 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:45,872 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:59:45,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:45,872 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:59:45,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:45,874 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:59:45,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:59:45,874 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:45,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:59:45,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:59:45,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:59:45,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:59:45,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:59:45,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:59:45,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:59:45,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:59:45,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:59:45,877 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:45,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:59:45,877 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:45,877 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:45,877 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:45,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:59:45,878 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:59:45,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:59:45,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:59:45,883 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:59:45,883 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:45,884 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:45,884 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:59:45,886 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 157/400.
2025-08-04 20:59:45,986 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:45,987 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:45,988 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 11 anomalous samples to GAN training data (target: 11).
2025-08-04 20:59:45,989 - ClientAppLogger [Client 5] - INFO - [Client] Round 157: Training GAN with 50 samples (39 normal, 11 anomalous).
2025-08-04 20:59:45,989 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:46,043 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0868, Avg D Loss: 0.7979
2025-08-04 20:59:46,044 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0868, Avg D Loss: 0.7979
2025-08-04 20:59:46,044 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:46,060 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5377, Threshold=0.5906, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:59:46,060 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 20:59:46,061 - ClientAppLogger [Client 5] - INFO - Fit completed for round 157. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 157, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0867603693008427, 'd_loss': 0.7979035997390747, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.1747446060180664, 'cpu_percent_fit': 47.1875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 50}
2025-08-04 20:59:46,061 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:59:51,339 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:51,339 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:59:51,339 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:59:51,339 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:59:51,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:59:51,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:51,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:51,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:51,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:59:51,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:59:51,880 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:51,984 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:51,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:51,991 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:52,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:59:52,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:52,013 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:59:52,014 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:52,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:52,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:59:52,024 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:52,027 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,029 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:52,032 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:52,035 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:52,037 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:52,040 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,042 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:52,045 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:52,047 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:52,050 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:52,062 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:52,062 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:59:52,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:59:52,067 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:59:52,073 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:52,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:59:52,083 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:52,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:59:52,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:52,099 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:52,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:59:52,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:59:52,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:52,138 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:52,138 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:52,138 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:52,139 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:52,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:59:52,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:52,140 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:59:52,140 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:52,141 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:59:52,141 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:59:52,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:52,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:59:52,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:52,142 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:52,143 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:52,143 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:59:52,143 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:59:52,143 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:59:52,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:59:52,144 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:59:52,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:59:52,144 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:59:52,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:59:52,145 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:59:52,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:59:52,145 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:59:52,145 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:59:52,145 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:52,146 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:59:52,146 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:52,146 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:52,146 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:52,147 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:59:52,147 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:59:52,147 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:59:52,147 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:59:52,152 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:59:52,152 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:52,154 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:52,154 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:59:52,156 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:52,156 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:52,156 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:52,157 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:52,177 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5101, Threshold=0.5534, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 20:59:52,178 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5101
