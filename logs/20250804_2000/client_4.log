2025-08-04 20:21:14,851 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:14,851 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:21:14,851 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:21:14,852 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:21:14,852 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:21:14,852 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:15,271 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:15,274 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:15,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:21:15,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:21:15,412 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:15,570 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:15,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:15,577 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:15,584 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:21:15,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:15,592 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:21:15,593 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:15,593 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:15,593 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:21:15,603 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:15,607 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:15,610 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:15,613 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:15,616 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:15,619 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:15,623 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:15,626 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:15,630 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:15,633 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:15,636 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:15,648 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:15,648 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:21:15,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:21:15,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:21:15,658 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:15,658 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:21:15,669 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:15,669 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:21:15,669 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:15,685 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:15,690 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:21:15,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:21:15,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:15,706 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:15,706 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:15,706 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:15,706 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:15,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:21:15,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:15,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:21:15,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:15,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:21:15,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:21:15,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:15,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:21:15,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:15,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:15,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:15,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:21:15,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:21:15,710 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:21:15,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:21:15,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:21:15,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:21:15,711 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:21:15,711 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:21:15,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:21:15,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:21:15,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:21:15,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:21:15,712 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:15,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:21:15,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:15,714 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:15,718 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:15,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:21:15,718 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:21:15,718 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:21:15,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:21:15,725 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:21:15,725 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:15,727 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:15,727 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:21:15,729 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:15,729 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:15,729 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:15,730 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:15,778 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5013, Accuracy=0.5195, F1=0.6679, Precision=0.8055, Recall=0.5704
2025-08-04 20:21:15,778 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5195, F1: 0.6679, Prec: 0.8055, Rec: 0.5704, Avg Anomaly Score: 0.5018
2025-08-04 20:21:30,460 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:30,460 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:21:30,460 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:21:30,461 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:21:30,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:21:30,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:30,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:30,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:30,768 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:21:30,809 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:21:30,809 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:30,913 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:30,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:30,918 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:30,923 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:21:30,928 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:30,928 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:21:30,929 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:30,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:30,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:21:30,937 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:30,940 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,942 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:30,945 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:30,947 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:30,950 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:30,952 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,954 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:30,957 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:30,959 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:30,961 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:30,969 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:30,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:21:30,973 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:21:30,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:21:30,978 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,978 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:21:30,987 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:21:30,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:31,002 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:31,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:21:31,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:21:31,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:31,012 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:31,012 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:31,012 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:31,012 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:31,013 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:21:31,013 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:31,013 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:21:31,013 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:31,015 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:21:31,015 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:21:31,015 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:31,015 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:21:31,015 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:31,015 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:21:31,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:21:31,017 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:21:31,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:21:31,017 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:21:31,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:21:31,017 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:21:31,017 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:21:31,018 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:31,018 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:21:31,018 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:31,018 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:31,022 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:31,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:21:31,022 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:21:31,022 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:21:31,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:21:31,026 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:21:31,026 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:31,027 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:31,027 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:21:31,028 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:31,029 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:31,029 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:31,029 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:31,071 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5013, Accuracy=0.5195, F1=0.6679, Precision=0.8055, Recall=0.5704
2025-08-04 20:21:31,071 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5195, F1: 0.6679, Prec: 0.8055, Rec: 0.5704, Avg Anomaly Score: 0.5018
2025-08-04 20:21:42,461 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:42,461 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:21:42,461 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:21:42,461 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:21:42,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:21:42,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:42,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:42,861 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:42,958 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:21:43,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:21:43,001 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:43,110 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:43,115 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:43,115 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:43,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:21:43,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:43,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:21:43,126 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:43,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:43,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:21:43,134 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:43,137 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:43,139 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:43,141 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:43,144 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:43,146 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:43,149 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:43,151 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:43,154 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:43,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:43,158 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:43,166 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:43,166 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:21:43,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:21:43,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:21:43,175 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:43,175 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:21:43,184 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:43,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:21:43,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:43,198 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:43,202 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:21:43,210 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:21:43,210 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:43,210 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:43,210 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:43,210 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:43,210 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:43,211 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:21:43,211 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:43,211 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:21:43,211 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:43,212 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:21:43,212 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:21:43,213 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:43,213 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:21:43,213 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:43,213 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:43,213 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:43,213 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:21:43,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:21:43,215 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:21:43,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:21:43,215 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:21:43,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:21:43,215 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:43,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:21:43,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:43,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:43,220 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:43,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:21:43,220 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:21:43,220 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:21:43,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:21:43,226 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:21:43,226 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:43,228 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:43,228 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:21:43,229 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:43,229 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:43,229 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:43,230 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:43,271 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5079, Threshold=0.5076, Accuracy=0.5351, F1=0.6787, Precision=0.8183, Recall=0.5798
2025-08-04 20:21:43,271 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5351, F1: 0.6787, Prec: 0.8183, Rec: 0.5798, Avg Anomaly Score: 0.5079
2025-08-04 20:21:54,659 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:54,659 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:21:54,659 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:21:54,660 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:21:54,660 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:21:54,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:55,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:55,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:55,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:21:55,272 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:21:55,273 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:55,402 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:55,409 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:55,409 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:55,414 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:21:55,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:55,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:21:55,422 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:55,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:55,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:21:55,432 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:55,435 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,437 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:55,439 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:55,442 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:55,445 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:55,447 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,450 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:55,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:55,455 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:55,457 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:55,467 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:55,467 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:21:55,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:21:55,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:21:55,477 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:55,477 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:21:55,487 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:55,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:21:55,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:55,504 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:55,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:21:55,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:21:55,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:55,516 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:55,516 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:55,516 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:55,517 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:55,517 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:21:55,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:55,517 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:21:55,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:55,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:21:55,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:21:55,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:55,520 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:21:55,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:55,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:55,520 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:21:55,521 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:21:55,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:21:55,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:21:55,522 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:21:55,522 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:21:55,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:21:55,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:55,523 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:21:55,523 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:55,524 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:55,524 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:55,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:21:55,527 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:21:55,527 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:21:55,527 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:21:55,533 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:21:55,534 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:55,535 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:55,536 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:21:55,538 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:55,538 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:55,538 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:55,539 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:55,588 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.5020, F1=0.6558, Precision=0.7907, Recall=0.5603
2025-08-04 20:21:55,589 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5020, F1: 0.6558, Prec: 0.7907, Rec: 0.5603, Avg Anomaly Score: 0.5085
2025-08-04 20:22:09,919 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,919 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:22:09,919 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:22:09,919 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:22:09,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:22:09,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:10,324 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:10,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:10,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:22:10,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:22:10,485 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:10,623 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:10,629 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:10,630 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:10,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:22:10,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:10,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:22:10,641 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:10,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:10,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:22:10,650 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:10,653 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,656 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:10,659 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:10,663 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:10,666 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:10,668 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,670 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:10,673 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:10,675 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:10,677 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:10,686 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:10,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:22:10,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:22:10,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:22:10,695 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:10,695 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:22:10,704 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:10,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:22:10,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:10,722 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:10,727 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:22:10,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:22:10,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:10,734 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:10,735 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:10,735 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:10,735 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:10,736 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:22:10,736 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:10,736 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:22:10,736 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:10,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:22:10,738 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:22:10,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:10,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:22:10,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:10,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:10,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:10,740 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:22:10,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:22:10,740 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:22:10,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:22:10,740 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:22:10,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:22:10,741 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:22:10,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:22:10,741 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:22:10,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:22:10,742 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:22:10,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:22:10,742 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:10,742 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:22:10,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:10,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:10,743 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:10,743 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:22:10,743 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:22:10,744 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:22:10,744 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:22:10,747 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:22:10,748 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,749 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,749 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:22:10,750 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,750 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,751 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,751 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,796 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.4894, F1=0.6471, Precision=0.7802, Recall=0.5528
2025-08-04 20:22:10,796 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.4894, F1: 0.6471, Prec: 0.7802, Rec: 0.5528, Avg Anomaly Score: 0.5085
2025-08-04 20:22:22,066 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:22,067 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:22:22,067 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:22:22,067 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:22:22,067 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:22:22,067 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:22,307 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:22,307 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:22,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:22:22,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:22:22,438 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:22,555 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:22,561 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:22,562 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:22,568 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:22:22,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:22,578 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:22:22,579 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:22,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:22,579 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:22:22,588 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:22,591 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:22,593 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:22,595 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:22,598 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:22,601 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:22,603 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:22,606 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:22,609 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:22,611 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:22,614 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:22,625 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:22,625 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:22:22,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:22:22,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:22:22,636 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:22,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:22:22,647 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:22,648 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:22:22,648 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:22,666 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:22,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:22:22,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:22:22,679 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:22,680 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:22,680 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:22,680 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:22,680 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:22,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:22:22,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:22,681 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:22:22,681 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:22,683 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:22:22,683 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:22:22,683 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:22,683 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:22:22,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:22,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:22,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:22,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:22:22,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:22:22,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:22:22,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:22:22,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:22:22,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:22:22,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:22:22,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:22:22,686 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:22:22,686 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:22:22,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:22:22,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:22:22,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:22,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:22:22,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:22,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:22,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:22,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:22:22,688 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:22:22,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:22:22,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:22:22,692 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:22:22,692 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:22,693 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:22,693 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:22:22,695 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:22,697 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:22,697 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:22,698 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:22,748 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.4914, F1=0.6485, Precision=0.7819, Recall=0.5540
2025-08-04 20:22:22,748 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.4914, F1: 0.6485, Prec: 0.7819, Rec: 0.5540, Avg Anomaly Score: 0.5053
2025-08-04 20:22:40,076 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:40,076 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:22:40,076 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:22:40,076 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:22:40,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:22:40,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:40,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:40,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,748 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:22:40,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:22:40,802 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,963 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,971 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,976 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:22:40,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,983 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:22:40,994 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,997 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:41,000 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:41,002 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:41,005 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:41,007 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:41,010 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:41,014 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:41,017 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:41,020 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:41,022 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:41,034 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:41,034 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:22:41,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:22:41,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:22:41,044 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:41,045 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:22:41,056 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:41,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:22:41,057 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:41,076 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:41,085 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:22:41,091 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:22:41,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:41,094 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:41,094 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:41,095 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:41,095 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:41,095 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:22:41,096 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:41,096 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:22:41,096 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:41,098 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:22:41,098 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:22:41,098 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:41,099 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:22:41,100 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:41,100 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:41,100 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:41,100 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:22:41,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:22:41,101 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:22:41,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:22:41,101 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:22:41,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:22:41,101 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:22:41,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:22:41,102 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:22:41,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:22:41,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:22:41,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:22:41,104 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:41,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:22:41,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:41,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:41,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:41,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:22:41,106 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:22:41,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:22:41,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:22:41,110 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:22:41,110 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:41,111 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:41,111 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:22:41,113 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:41,113 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:41,113 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:41,114 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:41,158 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4971, Threshold=0.4943, Accuracy=0.4914, F1=0.6485, Precision=0.7819, Recall=0.5540
2025-08-04 20:22:41,159 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.4914, F1: 0.6485, Prec: 0.7819, Rec: 0.5540, Avg Anomaly Score: 0.4971
2025-08-04 20:22:52,426 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:52,426 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:22:52,426 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:22:52,426 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:22:52,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:22:52,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:52,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:52,779 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:52,866 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:22:52,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:22:52,925 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:53,074 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:53,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:53,080 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:53,088 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:22:53,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:53,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:22:53,095 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:53,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:53,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:22:53,103 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:53,107 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:53,110 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:53,112 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:53,116 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:53,119 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:53,122 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:53,125 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:53,127 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:53,130 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:53,132 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:53,142 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:53,142 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:22:53,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:22:53,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:22:53,152 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:53,152 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:22:53,160 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:53,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:22:53,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:53,176 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:53,180 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:22:53,186 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:22:53,186 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:53,186 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:53,186 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:53,186 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:53,186 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:53,187 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:22:53,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:53,187 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:22:53,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:53,188 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:22:53,188 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:22:53,189 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:53,189 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:22:53,189 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:53,189 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:22:53,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:22:53,191 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:22:53,191 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:22:53,191 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:22:53,191 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:22:53,192 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:22:53,192 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:22:53,192 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:53,192 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:22:53,192 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:53,192 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:53,193 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:53,193 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:22:53,193 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:22:53,193 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:22:53,193 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:22:53,197 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:22:53,197 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:53,198 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:53,198 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:22:53,200 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:53,200 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:53,200 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:53,201 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:53,242 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4817, Threshold=0.4777, Accuracy=0.4973, F1=0.6526, Precision=0.7869, Recall=0.5575
2025-08-04 20:22:53,242 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.4973, F1: 0.6526, Prec: 0.7869, Rec: 0.5575, Avg Anomaly Score: 0.4817
2025-08-04 20:23:07,552 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:07,552 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:23:07,553 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:23:07,553 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:23:07,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:23:07,553 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:07,854 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:07,854 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:07,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:23:07,990 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:23:07,990 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:08,108 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:08,114 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:08,114 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:08,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:23:08,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:08,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:23:08,126 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:08,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:08,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:23:08,135 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:08,138 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:08,140 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:08,142 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:08,145 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:08,147 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:08,149 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:08,152 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:08,155 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:08,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:08,159 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:08,167 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:08,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:23:08,173 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:23:08,173 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:23:08,177 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:08,177 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:23:08,186 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:08,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:23:08,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:08,201 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:08,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:23:08,212 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:23:08,212 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:08,212 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:08,212 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:08,213 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:08,213 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:08,213 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:23:08,213 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:08,214 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:23:08,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:08,215 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:23:08,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:23:08,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:08,216 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:23:08,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:08,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:08,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:08,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:23:08,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:23:08,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:23:08,218 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:23:08,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:23:08,218 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:23:08,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:08,219 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:23:08,219 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:08,219 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:08,219 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:08,219 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:23:08,220 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:23:08,220 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:23:08,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:23:08,226 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:23:08,226 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:08,228 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:08,228 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:23:08,229 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:08,230 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:08,230 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:08,230 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:08,272 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4585, Threshold=0.4523, Accuracy=0.5036, F1=0.6569, Precision=0.7923, Recall=0.5610
2025-08-04 20:23:08,272 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5036, F1: 0.6569, Prec: 0.7923, Rec: 0.5610, Avg Anomaly Score: 0.4585
2025-08-04 20:23:19,603 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:19,603 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:23:19,603 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:23:19,603 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:23:19,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:23:19,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:20,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:23:20,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:23:20,143 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:20,270 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:20,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:20,276 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:20,281 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:23:20,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:20,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:23:20,288 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:20,288 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:20,288 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:23:20,297 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:20,299 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,301 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:20,304 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:20,306 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:20,308 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:20,310 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,313 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:20,316 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:20,317 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:20,320 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:20,328 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:20,328 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:23:20,333 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:23:20,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:23:20,338 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:20,338 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:23:20,347 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:20,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:23:20,347 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:20,363 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:20,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:23:20,377 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:23:20,377 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:20,377 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:20,377 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:20,377 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:20,378 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:20,378 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:23:20,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:20,378 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:23:20,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:20,380 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:23:20,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:23:20,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:20,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:23:20,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:20,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:20,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:20,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:23:20,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:23:20,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:23:20,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:23:20,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:23:20,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:23:20,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:20,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:23:20,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:20,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:20,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:20,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:23:20,385 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:23:20,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:23:20,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:23:20,391 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:23:20,391 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:20,392 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:20,392 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:23:20,393 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:20,394 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:20,394 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:20,394 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:20,434 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4200, Threshold=0.4110, Accuracy=0.5053, F1=0.6581, Precision=0.7935, Recall=0.5622
2025-08-04 20:23:20,434 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5053, F1: 0.6581, Prec: 0.7935, Rec: 0.5622, Avg Anomaly Score: 0.4200
2025-08-04 20:23:31,744 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:31,744 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:23:31,744 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:23:31,745 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:23:31,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:23:31,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:32,115 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:32,116 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:32,211 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:23:32,263 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:23:32,263 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:32,397 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:32,404 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:32,404 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:32,415 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:23:32,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:32,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:23:32,422 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:32,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:32,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:23:32,431 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:32,434 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,436 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:32,438 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:32,441 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:32,443 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:32,446 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:32,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:32,453 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:32,455 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:32,465 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:32,465 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:23:32,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:23:32,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:23:32,476 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:32,476 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:23:32,484 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:32,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:23:32,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:32,500 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:32,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:23:32,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:23:32,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:32,511 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:32,511 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:32,512 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:32,512 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:32,512 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:23:32,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:32,513 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:23:32,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:32,514 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:23:32,514 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:23:32,515 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:23:32,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:23:32,516 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:23:32,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:23:32,516 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:23:32,516 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:23:32,517 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:23:32,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:23:32,517 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:23:32,517 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:23:32,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:32,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:23:32,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:32,518 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:32,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:32,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:23:32,519 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:23:32,519 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:23:32,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:23:32,523 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:23:32,523 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:32,525 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:32,525 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:23:32,526 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:32,526 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:32,526 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:32,527 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:32,572 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3637, Threshold=0.3516, Accuracy=0.5066, F1=0.6590, Precision=0.7946, Recall=0.5630
2025-08-04 20:23:32,572 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5066, F1: 0.6590, Prec: 0.7946, Rec: 0.5630, Avg Anomaly Score: 0.3637
2025-08-04 20:23:46,904 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:46,904 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:23:46,904 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:23:46,904 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:23:46,904 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:23:46,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:47,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:47,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:47,398 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:23:47,443 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:23:47,444 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:47,574 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:47,582 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:47,582 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:47,588 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:23:47,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:47,597 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:23:47,598 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:47,598 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:47,598 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:23:47,606 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:47,609 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,612 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:47,614 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:47,617 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:47,620 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:47,623 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,625 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:47,628 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:47,630 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:47,632 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:47,642 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:47,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:23:47,647 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:23:47,647 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:23:47,653 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:47,653 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:23:47,663 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:47,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:23:47,663 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:47,679 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:47,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:23:47,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:23:47,701 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:47,701 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:47,701 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:47,702 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:47,702 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:47,702 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:23:47,702 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:47,703 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:23:47,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:47,704 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:23:47,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:23:47,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:47,705 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:23:47,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:47,705 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:47,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:47,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:23:47,706 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:23:47,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:23:47,706 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:23:47,706 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:23:47,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:23:47,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:23:47,707 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:23:47,707 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:23:47,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:23:47,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:23:47,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:23:47,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:47,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:23:47,708 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:47,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:47,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:47,709 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:23:47,709 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:23:47,709 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:23:47,710 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:23:47,717 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:23:47,717 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:47,718 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:47,718 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:23:47,720 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:47,720 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:47,720 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:47,721 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:47,766 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3028, Threshold=0.2955, Accuracy=0.5245, F1=0.6714, Precision=0.8095, Recall=0.5736
2025-08-04 20:23:47,766 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5245, F1: 0.6714, Prec: 0.8095, Rec: 0.5736, Avg Anomaly Score: 0.3028
2025-08-04 20:23:59,065 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:59,065 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:23:59,065 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:23:59,066 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:23:59,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:23:59,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:59,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:59,461 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:59,563 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:23:59,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:23:59,618 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:59,761 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:59,768 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:59,768 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:59,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:23:59,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:59,781 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:23:59,782 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:59,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:59,782 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:23:59,791 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:59,794 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,796 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:59,798 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:59,801 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:59,804 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:59,806 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,809 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:59,812 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:59,814 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:59,816 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:59,825 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:59,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:23:59,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:23:59,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:23:59,836 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:59,836 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:23:59,846 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:59,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:23:59,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:59,863 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:59,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:23:59,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:23:59,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:59,878 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:59,878 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:59,879 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:59,879 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:59,879 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:23:59,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:59,879 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:23:59,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:59,881 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:23:59,881 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:23:59,881 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:23:59,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:23:59,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:23:59,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:23:59,883 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:23:59,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:23:59,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:23:59,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:23:59,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:23:59,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:23:59,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:59,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:23:59,885 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:59,885 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:59,885 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:59,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:23:59,885 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:23:59,886 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:23:59,886 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:23:59,890 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:23:59,890 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:59,892 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:59,892 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:23:59,893 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:59,893 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:59,893 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:59,894 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:59,936 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3047, Threshold=0.3024, Accuracy=0.5610, F1=0.6966, Precision=0.8399, Recall=0.5951
2025-08-04 20:23:59,936 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5610, F1: 0.6966, Prec: 0.8399, Rec: 0.5951, Avg Anomaly Score: 0.3047
2025-08-04 20:24:11,225 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:11,225 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:24:11,225 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:24:11,225 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:24:11,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:24:11,225 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:11,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:11,526 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:11,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:24:11,667 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:24:11,668 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:11,802 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:11,808 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:11,808 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:11,815 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:24:11,820 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:11,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:24:11,821 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:11,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:11,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:24:11,830 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:11,833 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,836 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:11,838 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:11,840 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:11,842 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:11,845 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,847 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:11,850 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:11,852 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:11,854 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:11,863 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:11,864 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:24:11,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:24:11,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:24:11,873 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:11,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:24:11,881 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:11,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:24:11,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:11,898 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:11,904 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:24:11,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:24:11,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:11,915 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:11,915 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:11,916 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:11,916 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:11,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:24:11,916 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:11,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:24:11,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:11,918 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:24:11,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:24:11,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:11,919 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:24:11,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:11,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:11,919 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:11,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:24:11,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:24:11,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:24:11,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:24:11,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:24:11,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:24:11,921 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:24:11,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:24:11,921 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:24:11,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:24:11,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:24:11,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:24:11,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:11,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:24:11,923 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:11,923 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:11,923 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:11,923 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:24:11,924 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:24:11,924 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:24:11,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:24:11,930 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:24:11,930 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:11,932 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:11,932 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:24:11,934 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:11,934 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:11,934 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:11,935 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:11,976 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3221, Threshold=0.3241, Accuracy=0.5921, F1=0.7181, Precision=0.8658, Recall=0.6135
2025-08-04 20:24:11,977 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.5921, F1: 0.7181, Prec: 0.8658, Rec: 0.6135, Avg Anomaly Score: 0.3221
2025-08-04 20:24:23,269 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:23,269 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:24:23,270 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:24:23,270 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:24:23,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:24:23,270 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:23,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:23,575 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:23,666 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:24:23,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:24:23,719 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:23,861 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:23,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:23,868 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:23,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:24:23,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:23,879 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:24:23,880 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:23,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:23,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:24:23,890 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:23,892 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,895 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:23,897 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:23,900 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:23,902 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:23,905 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,907 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:23,910 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:23,912 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:23,914 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:23,925 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:23,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:24:23,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:24:23,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:24:23,935 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:23,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:24:23,947 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:23,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:24:23,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:23,965 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:23,970 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:24:23,978 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:24:23,978 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:23,978 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:23,978 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:23,979 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:23,979 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:23,979 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:24:23,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:23,980 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:24:23,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:23,981 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:24:23,981 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:24:23,982 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:23,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:24:23,982 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:23,982 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:23,982 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:23,983 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:24:23,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:24:23,983 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:24:23,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:24:23,983 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:24:23,983 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:24:23,984 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:24:23,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:24:23,984 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:24:23,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:24:23,985 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:24:23,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:24:23,985 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:23,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:24:23,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:23,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:23,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:23,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:24:23,986 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:24:23,987 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:24:23,987 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:24:23,991 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:24:23,991 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:23,993 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:23,993 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:24:23,994 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:23,995 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:23,995 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:23,995 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:24,043 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3019, Threshold=0.3064, Accuracy=0.6796, F1=0.7786, Precision=0.9387, Recall=0.6651
2025-08-04 20:24:24,043 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6796, F1: 0.7786, Prec: 0.9387, Rec: 0.6651, Avg Anomaly Score: 0.3019
2025-08-04 20:24:35,333 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:35,333 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:24:35,333 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:24:35,334 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:24:35,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:24:35,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:35,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:35,609 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:35,714 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:24:35,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:24:35,766 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:35,934 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:35,941 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:35,942 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:35,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:24:35,959 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:35,960 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:24:35,960 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:35,961 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:35,961 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:24:35,971 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:35,974 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,977 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:35,979 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:35,982 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:35,985 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:35,987 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,990 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:35,993 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:35,995 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:35,997 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:36,009 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:36,009 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:24:36,014 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:24:36,014 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:24:36,020 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:36,020 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:24:36,032 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:36,033 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:24:36,033 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:36,050 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:36,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:24:36,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:24:36,073 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:36,074 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:36,074 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:36,074 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:36,075 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:36,075 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:24:36,075 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:36,075 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:24:36,075 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:36,077 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:24:36,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:24:36,077 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:36,077 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:24:36,078 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:36,078 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:36,078 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:36,078 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:24:36,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:24:36,079 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:24:36,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:24:36,079 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:24:36,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:24:36,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:24:36,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:24:36,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:24:36,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:24:36,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:24:36,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:24:36,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:36,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:24:36,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:36,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:36,086 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:36,086 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:24:36,086 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:24:36,086 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:24:36,087 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:24:36,097 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:24:36,097 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:36,099 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:36,099 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:24:36,101 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:36,101 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:36,101 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:36,102 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:36,145 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.2997, Threshold=0.3047, Accuracy=0.6617, F1=0.7662, Precision=0.9238, Recall=0.6545
2025-08-04 20:24:36,145 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6617, F1: 0.7662, Prec: 0.9238, Rec: 0.6545, Avg Anomaly Score: 0.2997
2025-08-04 20:24:47,434 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:47,434 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:24:47,434 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:24:47,435 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:24:47,435 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:24:47,435 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:47,728 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:47,728 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:47,821 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:24:47,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:24:47,877 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:48,016 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:48,024 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:48,025 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:48,032 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:24:48,042 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:48,042 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:24:48,043 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:48,043 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:48,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:24:48,054 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:48,057 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,060 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:48,062 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:48,065 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:48,068 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:48,071 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,073 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:48,076 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:48,078 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:48,081 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:48,097 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:48,097 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:24:48,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:24:48,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:24:48,108 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:48,108 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:24:48,119 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:48,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:24:48,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:48,137 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:48,142 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:24:48,151 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:24:48,151 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:48,151 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:48,151 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:48,152 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:48,152 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:48,152 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:24:48,152 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:48,153 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:24:48,153 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:48,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:24:48,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:24:48,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:48,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:24:48,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:48,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:48,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:48,156 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:24:48,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:24:48,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:24:48,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:24:48,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:24:48,157 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:24:48,157 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:24:48,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:24:48,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:24:48,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:24:48,159 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:24:48,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:24:48,160 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:48,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:24:48,160 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:48,161 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:48,161 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:48,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:24:48,162 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:24:48,162 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:24:48,162 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:24:48,168 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:24:48,168 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:48,169 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:48,170 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:24:48,171 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:48,171 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:48,172 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:48,172 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:48,220 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.2982, Threshold=0.3045, Accuracy=0.6624, F1=0.7667, Precision=0.9244, Recall=0.6549
2025-08-04 20:24:48,220 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6624, F1: 0.7667, Prec: 0.9244, Rec: 0.6549, Avg Anomaly Score: 0.2982
2025-08-04 20:24:59,517 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:59,517 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:24:59,517 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:24:59,518 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:24:59,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:24:59,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:59,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:59,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:59,940 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:24:59,993 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:24:59,993 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:00,117 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:00,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:00,127 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:00,134 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:25:00,142 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:00,142 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:25:00,143 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:00,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:00,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:25:00,152 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:00,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,158 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:00,160 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:00,163 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:00,165 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:00,168 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,170 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:00,173 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:00,175 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:00,178 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:00,189 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:00,190 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:25:00,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:25:00,195 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:25:00,200 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:00,200 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:25:00,212 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:00,213 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:25:00,213 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:00,229 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:00,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:25:00,244 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:25:00,244 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:00,244 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:00,244 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:00,245 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:00,245 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:00,245 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:25:00,246 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:00,246 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:25:00,246 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:00,248 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:25:00,248 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:25:00,248 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:00,249 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:25:00,249 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:00,249 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:00,249 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:00,249 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:25:00,250 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:25:00,250 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:25:00,250 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:25:00,251 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:25:00,251 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:25:00,251 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:25:00,252 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:25:00,252 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:25:00,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:25:00,253 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:25:00,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:25:00,253 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:00,254 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:25:00,254 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:00,254 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:00,255 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:00,255 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:25:00,256 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:25:00,256 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:25:00,256 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:25:00,260 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:25:00,260 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:00,263 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:00,263 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:25:00,265 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:00,265 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:00,265 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:00,266 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:00,311 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3053, Threshold=0.3144, Accuracy=0.6670, F1=0.7699, Precision=0.9282, Recall=0.6577
2025-08-04 20:25:00,311 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6670, F1: 0.7699, Prec: 0.9282, Rec: 0.6577, Avg Anomaly Score: 0.3053
2025-08-04 20:25:11,611 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:11,611 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:25:11,611 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:25:11,611 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:25:11,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:25:11,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:11,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:11,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:12,041 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:25:12,092 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:25:12,092 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:12,250 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:12,260 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:12,260 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:12,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:25:12,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:12,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:25:12,276 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:12,276 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:12,276 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:25:12,285 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:12,288 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,291 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:12,296 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:12,299 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:12,301 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:12,304 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,307 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:12,309 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:12,311 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:12,314 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:12,325 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:12,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:25:12,330 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:25:12,330 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:25:12,336 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:12,336 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:25:12,350 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:12,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:25:12,351 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:12,367 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:12,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:25:12,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:25:12,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:12,378 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:12,378 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:12,379 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:12,379 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:12,379 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:25:12,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:12,379 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:25:12,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:12,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:25:12,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:25:12,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:12,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:25:12,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:12,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:12,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:12,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:25:12,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:25:12,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:25:12,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:25:12,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:25:12,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:25:12,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:25:12,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:25:12,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:25:12,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:25:12,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:25:12,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:25:12,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:12,385 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:25:12,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:12,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:12,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:12,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:25:12,387 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:25:12,387 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:25:12,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:25:12,395 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:25:12,395 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:12,397 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:12,397 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:25:12,398 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:12,398 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:12,399 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:12,399 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:12,449 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3088, Threshold=0.3190, Accuracy=0.6670, F1=0.7699, Precision=0.9282, Recall=0.6577
2025-08-04 20:25:12,450 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6670, F1: 0.7699, Prec: 0.9282, Rec: 0.6577, Avg Anomaly Score: 0.3088
2025-08-04 20:25:23,763 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:23,763 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:25:23,763 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:25:23,763 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:25:23,763 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:25:23,764 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:24,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:24,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:24,159 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:25:24,209 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:25:24,210 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:24,361 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:24,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:24,373 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:24,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:25:24,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:24,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:25:24,389 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:24,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:24,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:25:24,399 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:24,402 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,404 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:24,406 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:24,409 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:24,411 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:24,414 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,416 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:24,419 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:24,421 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:24,423 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:24,434 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:24,434 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:25:24,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:25:24,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:25:24,444 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:24,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:25:24,456 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:24,456 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:25:24,457 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:24,475 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:24,482 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:25:24,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:25:24,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:24,500 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:24,500 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:24,501 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:24,501 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:24,501 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:25:24,501 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:24,502 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:25:24,502 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:24,503 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:25:24,503 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:25:24,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:24,504 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:25:24,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:24,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:24,504 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:24,505 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:25:24,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:25:24,505 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:25:24,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:25:24,505 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:25:24,505 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:25:24,509 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:25:24,509 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:25:24,510 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:25:24,510 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:25:24,510 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:25:24,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:25:24,511 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:24,511 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:25:24,511 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:24,511 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:24,512 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:24,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:25:24,512 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:25:24,512 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:25:24,512 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:25:24,522 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:25:24,523 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:24,525 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:24,525 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:25:24,527 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:24,527 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:24,527 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:24,530 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:24,578 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3208, Threshold=0.3321, Accuracy=0.6670, F1=0.7699, Precision=0.9282, Recall=0.6577
2025-08-04 20:25:24,578 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6670, F1: 0.7699, Prec: 0.9282, Rec: 0.6577, Avg Anomaly Score: 0.3208
2025-08-04 20:25:35,877 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:35,877 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:25:35,877 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:25:35,878 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:25:35,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:25:35,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:36,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:36,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:36,319 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:25:36,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:25:36,368 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:36,493 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:36,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:36,501 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:36,508 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:25:36,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:36,518 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:25:36,519 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:36,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:36,519 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:25:36,529 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:36,532 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,535 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:36,537 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:36,540 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:36,542 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:36,545 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,547 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:36,550 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:36,551 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:36,554 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:36,565 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:36,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:25:36,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:25:36,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:25:36,577 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:36,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:25:36,594 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:36,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:25:36,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:36,613 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:36,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:25:36,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:25:36,628 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:36,628 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:36,628 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:36,629 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:36,629 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:36,629 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:25:36,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:36,630 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:25:36,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:36,631 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:25:36,631 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:25:36,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:36,632 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:25:36,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:36,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:36,632 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:25:36,633 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:25:36,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:25:36,634 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:25:36,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:25:36,635 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:25:36,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:25:36,635 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:36,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:25:36,636 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:36,636 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:36,636 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:36,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:25:36,637 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:25:36,637 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:25:36,637 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:25:36,645 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:25:36,646 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:36,647 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:36,647 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:25:36,648 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:36,649 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:36,649 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:36,650 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:36,704 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3183, Threshold=0.3303, Accuracy=0.6683, F1=0.7708, Precision=0.9293, Recall=0.6585
2025-08-04 20:25:36,704 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6683, F1: 0.7708, Prec: 0.9293, Rec: 0.6585, Avg Anomaly Score: 0.3183
2025-08-04 20:25:48,007 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:48,007 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:25:48,007 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:25:48,007 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:25:48,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:25:48,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:48,323 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:48,323 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:48,421 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:25:48,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:25:48,470 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:48,604 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:48,612 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:48,612 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:48,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:25:48,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:48,626 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:25:48,627 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:48,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:48,627 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:25:48,636 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:48,639 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,641 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:48,644 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:48,647 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:48,649 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:48,651 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,654 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:48,657 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:48,659 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:48,661 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:48,671 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:48,672 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:25:48,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:25:48,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:25:48,682 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:48,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:25:48,694 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:48,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:25:48,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:48,710 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:48,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:25:48,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:25:48,730 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:48,730 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:48,730 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:48,731 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:48,731 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:48,731 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:25:48,731 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:48,732 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:25:48,732 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:48,733 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:25:48,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:25:48,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:48,734 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:25:48,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:48,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:48,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:48,734 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:25:48,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:25:48,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:25:48,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:25:48,735 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:25:48,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:25:48,736 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:25:48,736 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:25:48,736 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:25:48,737 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:25:48,737 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:25:48,737 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:25:48,737 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:48,737 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:25:48,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:48,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:48,738 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:48,738 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:25:48,739 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:25:48,739 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:25:48,739 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:25:48,749 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:25:48,749 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:48,751 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:48,751 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:25:48,753 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:48,753 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:48,754 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:48,754 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:48,804 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3218, Threshold=0.3343, Accuracy=0.6783, F1=0.7777, Precision=0.9376, Recall=0.6643
2025-08-04 20:25:48,804 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6783, F1: 0.7777, Prec: 0.9376, Rec: 0.6643, Avg Anomaly Score: 0.3218
2025-08-04 20:26:03,101 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,101 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:26:03,101 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:26:03,101 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:26:03,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:26:03,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:03,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:03,472 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:03,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:26:03,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:26:03,608 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:03,785 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:03,793 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:03,794 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:03,816 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:26:03,840 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:03,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:26:03,842 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:03,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:03,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:26:03,853 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:03,858 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:03,860 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:03,863 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:03,866 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:03,868 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:03,872 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:03,875 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:03,879 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:03,881 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:03,884 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:03,899 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:03,899 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:26:03,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:26:03,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:26:03,913 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:03,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:26:03,932 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:03,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:26:03,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:03,955 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:03,962 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:26:03,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:26:03,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:03,971 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:03,972 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:03,973 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:03,973 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:03,973 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:26:03,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:03,974 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:26:03,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:03,976 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:26:03,976 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:26:03,979 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:03,979 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:26:03,979 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:03,979 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:03,980 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:03,980 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:26:03,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:26:03,980 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:26:03,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:26:03,981 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:26:03,981 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:26:03,982 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:26:03,982 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:26:03,983 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:26:03,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:26:03,984 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:26:03,984 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:26:03,985 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:03,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:26:03,985 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:03,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:03,986 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:03,986 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:26:03,987 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:26:03,990 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:26:03,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:26:04,002 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:26:04,004 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,009 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,010 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:26:04,014 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,014 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,014 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,015 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,090 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3296, Threshold=0.3437, Accuracy=0.6803, F1=0.7790, Precision=0.9393, Recall=0.6655
2025-08-04 20:26:04,091 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6803, F1: 0.7790, Prec: 0.9393, Rec: 0.6655, Avg Anomaly Score: 0.3296
2025-08-04 20:26:15,372 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:15,372 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:26:15,372 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:26:15,372 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:26:15,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:26:15,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:15,753 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:15,753 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:15,852 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:26:15,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:26:15,932 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,115 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,124 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,135 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:26:16,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,148 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:26:16,158 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,162 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,164 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,167 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,169 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,172 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,175 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,178 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,181 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,183 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,185 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,200 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,200 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:26:16,205 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:26:16,215 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:26:16,230 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:26:16,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,252 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:26:16,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:26:16,278 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,278 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,279 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,279 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,279 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,280 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:26:16,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,280 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:26:16,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,282 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:26:16,282 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,283 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:26:16,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:26:16,285 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:26:16,285 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:26:16,285 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:26:16,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:26:16,286 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:26:16,286 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:26:16,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:26:16,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:26:16,287 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:26:16,288 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,288 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,289 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,289 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:26:16,289 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:26:16,289 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:26:16,290 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:26:16,301 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:26:16,301 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,303 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,303 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:26:16,305 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,305 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,305 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,306 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,362 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3210, Threshold=0.3343, Accuracy=0.6789, F1=0.7781, Precision=0.9382, Recall=0.6647
2025-08-04 20:26:16,363 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6789, F1: 0.7781, Prec: 0.9382, Rec: 0.6647, Avg Anomaly Score: 0.3210
2025-08-04 20:26:27,638 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:27,638 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:26:27,639 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:26:27,639 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:26:27,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:26:27,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:27,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:27,952 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:26:28,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:26:28,090 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,250 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,261 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,261 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:26:28,316 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,316 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,317 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,318 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,318 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:26:28,328 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,331 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,334 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,337 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,340 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,343 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,346 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,349 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,352 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,354 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,357 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,368 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:26:28,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:26:28,381 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:26:28,400 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:26:28,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,422 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:26:28,437 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:26:28,437 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,437 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,437 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,438 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,438 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,438 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:26:28,438 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,438 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:26:28,439 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,440 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:26:28,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,441 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,441 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,442 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:26:28,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:26:28,442 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:26:28,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:26:28,442 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:26:28,442 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:26:28,443 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:26:28,443 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:26:28,444 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:26:28,444 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:26:28,444 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:26:28,445 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:26:28,445 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,445 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:26:28,445 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,445 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,446 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:26:28,446 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:26:28,446 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:26:28,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:26:28,456 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:26:28,456 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,458 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,458 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:26:28,460 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,460 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,460 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:28,461 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,505 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3255, Threshold=0.3405, Accuracy=0.6816, F1=0.7799, Precision=0.9404, Recall=0.6663
2025-08-04 20:26:28,505 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6816, F1: 0.7799, Prec: 0.9404, Rec: 0.6663, Avg Anomaly Score: 0.3255
2025-08-04 20:26:39,765 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:39,765 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:26:39,766 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:26:39,766 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:26:39,766 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:26:39,766 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,029 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,029 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:26:40,177 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:26:40,177 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:40,340 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:40,350 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:40,350 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:40,358 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:26:40,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:40,368 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:26:40,368 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:40,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:40,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:26:40,378 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:40,382 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,384 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:40,387 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:40,389 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:40,392 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:40,394 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,397 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:40,400 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:40,402 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:40,406 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:40,422 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:40,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:26:40,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:26:40,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:26:40,435 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:40,436 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:26:40,453 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:40,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:26:40,454 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:40,473 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:40,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:26:40,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:26:40,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:40,489 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:40,489 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:40,490 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:40,490 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:40,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:26:40,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:40,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:26:40,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:40,493 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:26:40,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:26:40,494 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:40,494 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:26:40,494 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:40,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:40,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:40,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:26:40,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:26:40,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:26:40,496 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:26:40,496 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:26:40,496 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:26:40,497 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:26:40,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:26:40,497 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:26:40,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:26:40,498 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:26:40,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:26:40,498 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:40,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:26:40,499 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:40,499 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:40,499 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:40,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:26:40,500 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:26:40,500 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:26:40,500 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:26:40,506 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:26:40,506 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:40,508 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:40,508 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:26:40,510 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:40,510 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:40,510 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:40,511 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:40,559 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3295, Threshold=0.3459, Accuracy=0.6836, F1=0.7813, Precision=0.9420, Recall=0.6674
2025-08-04 20:26:40,560 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6836, F1: 0.7813, Prec: 0.9420, Rec: 0.6674, Avg Anomaly Score: 0.3295
2025-08-04 20:26:51,842 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:51,842 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:26:51,842 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:26:51,842 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:26:51,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:26:51,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:52,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:52,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:52,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:26:52,227 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:26:52,227 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:52,356 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:52,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:52,366 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:52,373 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:26:52,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:52,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:26:52,382 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:52,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:52,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:26:52,391 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:52,394 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:52,396 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:52,399 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:52,401 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:52,404 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:52,406 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:52,409 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:52,412 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:52,414 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:52,416 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:52,426 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:52,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:26:52,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:26:52,432 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:26:52,437 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:52,437 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:26:52,448 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:52,448 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:26:52,448 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:52,465 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:52,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:26:52,482 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:26:52,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:52,483 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:52,483 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:52,483 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:52,484 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:52,484 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:26:52,484 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:52,485 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:26:52,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:52,486 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:26:52,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:26:52,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:52,487 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:26:52,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:52,487 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:52,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:52,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:26:52,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:26:52,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:26:52,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:26:52,488 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:26:52,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:26:52,489 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:26:52,489 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:26:52,490 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:26:52,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:26:52,490 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:26:52,490 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:26:52,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:52,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:26:52,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:52,491 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:52,492 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:52,492 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:26:52,493 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:26:52,493 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:26:52,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:26:52,500 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:26:52,500 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:52,502 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:52,502 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:26:52,504 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:52,504 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:52,504 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:52,505 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:52,554 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3319, Threshold=0.3480, Accuracy=0.6849, F1=0.7822, Precision=0.9431, Recall=0.6682
2025-08-04 20:26:52,554 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6849, F1: 0.7822, Prec: 0.9431, Rec: 0.6682, Avg Anomaly Score: 0.3319
2025-08-04 20:27:03,833 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:03,834 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:27:03,834 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:27:03,834 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:27:03,834 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:27:03,834 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:04,087 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:04,087 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:04,168 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:27:04,211 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:27:04,211 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:04,316 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:04,321 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:04,321 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:04,326 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:27:04,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:04,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:27:04,331 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:04,331 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:04,332 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:27:04,340 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:04,343 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:04,345 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:04,348 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:04,351 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:04,353 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:04,355 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:04,358 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:04,360 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:04,362 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:04,364 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:04,374 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:04,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:27:04,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:27:04,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:27:04,383 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:04,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:27:04,393 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:04,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:27:04,394 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:04,409 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:04,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:27:04,418 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:27:04,418 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:04,419 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:04,419 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:04,419 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:04,419 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:04,420 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:27:04,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:04,420 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:27:04,420 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:04,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:27:04,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:27:04,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:04,422 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:27:04,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:04,422 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:27:04,423 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:27:04,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:27:04,424 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:27:04,424 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:27:04,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:27:04,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:27:04,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:27:04,425 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:04,425 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:27:04,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:04,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:04,426 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:04,426 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:27:04,427 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:27:04,427 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:27:04,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:27:04,430 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:27:04,430 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:04,432 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:04,432 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:27:04,433 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:04,434 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:04,434 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:04,434 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:04,476 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3283, Threshold=0.3430, Accuracy=0.6856, F1=0.7827, Precision=0.9437, Recall=0.6686
2025-08-04 20:27:04,477 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6856, F1: 0.7827, Prec: 0.9437, Rec: 0.6686, Avg Anomaly Score: 0.3283
2025-08-04 20:27:15,759 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:15,759 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:27:15,759 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:27:15,759 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:27:15,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:27:15,760 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:16,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:16,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:16,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:27:16,175 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:27:16,176 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:16,298 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:16,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:16,304 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:16,308 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:27:16,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:16,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:27:16,314 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:16,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:16,314 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:27:16,322 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:16,325 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:16,327 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:16,330 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:16,332 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:16,335 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:16,337 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:16,340 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:16,343 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:16,345 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:16,347 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:16,356 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:16,356 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:27:16,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:27:16,361 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:27:16,366 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:16,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:27:16,376 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:16,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:27:16,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:16,392 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:16,396 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:27:16,404 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:27:16,405 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:16,405 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:16,405 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:16,405 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:16,405 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:16,406 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:27:16,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:16,406 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:27:16,406 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:16,407 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:27:16,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:27:16,408 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:16,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:27:16,408 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:16,408 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:16,409 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:16,409 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:27:16,409 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:27:16,409 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:27:16,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:27:16,410 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:27:16,410 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:27:16,411 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:27:16,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:27:16,411 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:27:16,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:27:16,412 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:27:16,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:27:16,412 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:16,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:27:16,412 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:16,413 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:16,413 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:16,413 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:27:16,413 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:27:16,413 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:27:16,414 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:27:16,419 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:27:16,419 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:16,420 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:16,420 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:27:16,422 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:16,422 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:16,423 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:16,423 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:16,462 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3313, Threshold=0.3463, Accuracy=0.6882, F1=0.7845, Precision=0.9459, Recall=0.6702
2025-08-04 20:27:16,462 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6882, F1: 0.7845, Prec: 0.9459, Rec: 0.6702, Avg Anomaly Score: 0.3313
2025-08-04 20:27:33,740 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:33,740 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:27:33,740 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:27:33,740 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:27:33,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:27:33,740 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:34,010 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:34,010 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:34,096 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:27:34,141 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:27:34,141 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:34,260 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:34,267 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:34,267 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:34,275 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:27:34,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:34,283 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:27:34,283 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:34,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:34,284 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:27:34,292 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:34,294 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:34,297 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:34,299 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:34,302 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:34,304 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:34,307 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:34,309 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:34,312 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:34,313 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:34,316 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:34,325 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:34,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:27:34,330 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:27:34,330 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:27:34,335 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:34,335 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:27:34,345 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:34,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:27:34,345 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:34,360 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:34,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:27:34,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:27:34,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:34,374 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:34,374 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:34,375 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:34,375 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:34,375 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:27:34,375 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:34,376 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:27:34,376 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:34,378 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:27:34,378 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:27:34,378 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:34,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:27:34,379 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:34,379 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:34,379 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:34,379 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:27:34,379 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:27:34,380 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:27:34,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:27:34,380 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:27:34,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:27:34,380 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:27:34,380 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:27:34,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:27:34,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:27:34,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:27:34,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:27:34,381 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:34,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:27:34,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:34,382 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:34,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:34,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:27:34,386 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:27:34,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:27:34,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:27:34,391 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:27:34,391 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:34,392 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:34,392 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:27:34,394 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:34,394 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:34,394 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:34,395 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:34,436 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3323, Threshold=0.3492, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:27:34,436 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3323
2025-08-04 20:27:45,704 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:45,704 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:27:45,704 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:27:45,704 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:27:45,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:27:45,704 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:45,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:45,947 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:46,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:27:46,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:27:46,060 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:46,153 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:46,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:46,158 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:46,173 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:27:46,205 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:46,205 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:27:46,206 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:46,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:46,206 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:27:46,215 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:46,218 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:46,220 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:46,222 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:46,225 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:46,227 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:46,230 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:46,233 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:46,235 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:46,237 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:46,239 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:46,248 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:46,248 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:27:46,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:27:46,253 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:27:46,258 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:46,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:27:46,268 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:46,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:27:46,269 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:46,283 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:46,287 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:27:46,292 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:27:46,292 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:46,293 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:46,293 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:46,293 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:46,293 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:46,293 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:27:46,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:46,294 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:27:46,294 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:46,295 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:27:46,296 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:27:46,296 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:46,296 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:27:46,296 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:46,296 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:46,296 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:46,297 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:27:46,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:27:46,297 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:27:46,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:27:46,297 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:27:46,297 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:27:46,298 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:27:46,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:27:46,298 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:27:46,298 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:27:46,299 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:27:46,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:27:46,299 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:46,299 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:27:46,299 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:46,299 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:46,303 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:46,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:27:46,303 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:27:46,303 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:27:46,303 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:27:46,309 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:27:46,309 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:46,318 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:46,318 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:27:46,320 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:46,320 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:46,320 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:46,321 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:46,364 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3366, Threshold=0.3546, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:27:46,364 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3366
2025-08-04 20:28:00,630 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:00,630 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:28:00,630 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:28:00,630 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:28:00,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:28:00,630 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:00,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:00,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:00,972 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:28:01,011 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:28:01,011 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:01,122 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:01,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:01,128 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:01,133 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:28:01,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:01,139 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:28:01,140 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:01,140 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:01,140 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:28:01,148 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:01,151 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:01,153 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:01,156 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:01,159 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:01,161 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:01,163 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:01,166 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:01,168 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:01,170 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:01,173 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:01,182 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:01,182 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:28:01,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:28:01,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:28:01,191 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:01,191 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:28:01,201 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:01,201 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:28:01,201 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:01,216 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:01,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:28:01,231 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:28:01,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:01,232 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:01,232 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:01,232 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:01,233 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:01,233 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:28:01,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:01,233 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:28:01,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:01,235 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:28:01,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:28:01,235 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:01,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:28:01,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:01,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:01,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:01,236 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:28:01,236 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:28:01,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:28:01,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:28:01,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:28:01,237 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:28:01,237 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:28:01,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:28:01,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:28:01,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:28:01,238 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:28:01,238 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:28:01,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:01,239 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:28:01,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:01,239 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:01,243 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:01,243 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:28:01,243 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:28:01,243 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:28:01,243 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:28:01,249 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:28:01,249 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:01,251 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:01,251 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:28:01,253 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:01,253 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:01,253 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:01,254 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:01,296 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3391, Threshold=0.3566, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:28:01,297 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3391
2025-08-04 20:28:15,569 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:15,569 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:28:15,569 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:28:15,570 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:28:15,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:28:15,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:15,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:15,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:15,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:28:15,950 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:28:15,950 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:16,036 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:16,043 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:16,043 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:16,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:28:16,057 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:16,057 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:28:16,058 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:16,058 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:16,058 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:28:16,067 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:16,070 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:16,072 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:16,074 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:16,077 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:16,079 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:16,082 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:16,085 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:16,088 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:16,090 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:16,092 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:16,101 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:16,101 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:28:16,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:28:16,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:28:16,110 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:16,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:28:16,119 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:16,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:28:16,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:16,134 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:16,140 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:28:16,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:28:16,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:16,146 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:16,146 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:16,147 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:16,147 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:16,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:28:16,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:16,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:28:16,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:16,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:28:16,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:28:16,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:16,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:28:16,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:16,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:16,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:16,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:28:16,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:28:16,151 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:28:16,151 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:28:16,151 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:28:16,151 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:28:16,151 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:28:16,152 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:28:16,152 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:28:16,152 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:28:16,153 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:28:16,153 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:28:16,153 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:16,153 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:28:16,153 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:16,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:16,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:16,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:28:16,158 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:28:16,158 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:28:16,158 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:28:16,162 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:28:16,162 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:16,164 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:16,164 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:28:16,166 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:16,166 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:16,166 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:16,167 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:16,210 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3376, Threshold=0.3547, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:28:16,210 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3376
2025-08-04 20:28:27,485 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:27,485 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:28:27,485 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:28:27,485 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:28:27,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:28:27,485 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:27,764 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:27,764 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:27,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:28:27,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:28:27,894 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:28,012 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:28,018 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:28,019 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:28,024 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:28:28,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:28,030 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:28:28,030 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:28,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:28,031 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:28:28,040 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:28,043 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:28,045 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:28,048 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:28,050 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:28,053 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:28,055 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:28,058 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:28,061 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:28,063 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:28,065 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:28,074 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:28,074 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:28:28,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:28:28,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:28:28,085 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:28,085 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:28:28,094 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:28,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:28:28,095 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:28,110 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:28,115 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:28:28,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:28:28,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:28,121 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:28,121 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:28,122 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:28,122 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:28,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:28:28,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:28,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:28:28,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:28,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:28:28,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:28:28,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:28,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:28:28,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:28,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:28,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:28,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:28:28,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:28:28,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:28:28,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:28:28,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:28:28,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:28:28,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:28:28,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:28:28,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:28:28,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:28:28,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:28:28,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:28:28,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:28,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:28:28,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:28,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:28,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:28,128 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:28:28,128 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:28:28,129 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:28:28,129 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:28:28,132 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:28:28,133 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:28,134 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:28,134 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:28:28,136 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:28,136 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:28,136 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:28,137 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:28,180 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3403, Threshold=0.3579, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:28:28,180 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3403
2025-08-04 20:28:42,482 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:42,482 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:28:42,482 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:28:42,482 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:28:42,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:28:42,483 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:42,757 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:42,757 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:42,842 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:28:42,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:28:42,876 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:42,963 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:42,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:42,969 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:42,974 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:28:42,979 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:42,979 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:28:42,980 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:42,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:42,980 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:28:42,990 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:42,993 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,995 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:42,997 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:43,000 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:43,002 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:43,005 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:43,007 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:43,010 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:43,012 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:43,014 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:43,023 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:43,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:28:43,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:28:43,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:28:43,034 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:43,035 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:28:43,047 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:43,047 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:28:43,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:43,064 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:43,068 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:28:43,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:28:43,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:43,079 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:43,079 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:43,080 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:43,080 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:43,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:28:43,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:43,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:28:43,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:43,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:28:43,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:28:43,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:43,083 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:28:43,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:43,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:28:43,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:28:43,085 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:28:43,085 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:28:43,085 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:28:43,085 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:28:43,086 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:28:43,086 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:28:43,086 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:43,086 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:28:43,087 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:43,087 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:43,090 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:43,090 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:28:43,090 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:28:43,090 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:28:43,091 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:28:43,097 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:28:43,097 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:43,098 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:43,098 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:28:43,100 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:43,101 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:43,101 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:43,101 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:43,142 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3367, Threshold=0.3546, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:28:43,142 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3367
2025-08-04 20:28:54,416 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:54,417 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:28:54,417 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:28:54,417 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:28:54,417 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:28:54,417 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:54,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:54,726 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:54,808 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:28:54,850 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:28:54,850 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:55,030 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:55,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:55,036 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:55,042 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:28:55,049 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:55,049 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:28:55,050 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:55,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:55,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:28:55,059 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:55,062 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:55,064 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:55,066 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:55,069 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:55,071 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:55,074 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:55,076 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:55,079 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:55,081 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:55,084 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:55,094 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:55,094 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:28:55,098 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:28:55,099 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:28:55,104 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:55,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:28:55,117 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:55,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:28:55,117 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:55,133 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:55,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:28:55,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:28:55,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:55,145 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:55,145 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:55,145 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:55,145 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:55,145 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:28:55,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:55,146 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:28:55,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:55,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:28:55,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:28:55,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:55,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:28:55,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:55,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:55,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:55,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:28:55,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:28:55,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:28:55,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:28:55,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:28:55,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:28:55,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:28:55,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:28:55,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:28:55,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:28:55,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:28:55,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:28:55,151 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:55,151 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:28:55,151 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:55,151 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:55,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:55,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:28:55,155 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:28:55,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:28:55,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:28:55,163 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:28:55,163 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:55,165 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:55,165 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:28:55,166 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:55,167 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:55,167 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:55,167 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:55,210 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3409, Threshold=0.3591, Accuracy=0.6889, F1=0.7850, Precision=0.9464, Recall=0.6706
2025-08-04 20:28:55,210 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6889, F1: 0.7850, Prec: 0.9464, Rec: 0.6706, Avg Anomaly Score: 0.3409
2025-08-04 20:29:12,512 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:12,512 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:29:12,513 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:29:12,513 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:29:12,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:29:12,513 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:12,817 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:12,817 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:12,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:29:12,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:29:12,935 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:13,032 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:13,038 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:13,039 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:13,047 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:29:13,055 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:13,055 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:29:13,055 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:13,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:13,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:29:13,065 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:13,068 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:13,070 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:13,073 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:13,076 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:13,078 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:13,081 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:13,083 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:13,086 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:13,088 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:13,090 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:13,100 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:13,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:29:13,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:29:13,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:29:13,110 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:13,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:29:13,118 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:13,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:29:13,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:13,133 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:13,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:29:13,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:29:13,143 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:13,143 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:13,143 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:13,143 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:13,144 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:13,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:29:13,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:13,144 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:29:13,144 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:13,146 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:29:13,146 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:29:13,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:13,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:29:13,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:13,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:13,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:13,147 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:29:13,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:29:13,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:29:13,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:29:13,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:29:13,148 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:29:13,148 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:29:13,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:29:13,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:29:13,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:29:13,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:29:13,149 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:29:13,149 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:13,150 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:29:13,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:13,150 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:13,154 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:13,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:29:13,154 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:29:13,155 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:29:13,155 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:29:13,157 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:29:13,157 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:13,158 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:13,158 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:29:13,160 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:13,160 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:13,160 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:13,160 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:13,201 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3378, Threshold=0.3570, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:29:13,201 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3378
2025-08-04 20:29:24,461 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:24,461 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:29:24,461 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:29:24,462 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:29:24,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:29:24,462 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:24,733 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:24,735 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:24,829 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:29:24,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:29:24,877 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:24,999 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:25,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:25,007 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:25,016 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:29:25,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:25,023 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:29:25,024 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:25,024 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:25,024 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:29:25,033 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:25,036 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:25,039 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:25,041 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:25,044 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:25,046 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:25,049 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:25,051 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:25,054 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:25,056 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:25,058 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:25,068 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:25,069 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:29:25,074 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:29:25,074 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:29:25,079 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:25,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:29:25,089 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:25,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:29:25,089 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:25,105 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:25,110 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:29:25,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:29:25,120 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:25,120 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:25,120 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:25,121 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:25,121 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:25,121 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:29:25,121 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:25,122 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:29:25,122 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:25,123 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:29:25,123 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:29:25,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:25,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:29:25,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:25,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:25,124 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:25,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:29:25,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:29:25,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:29:25,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:29:25,125 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:29:25,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:29:25,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:29:25,126 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:29:25,126 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:29:25,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:29:25,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:29:25,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:29:25,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:25,127 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:29:25,127 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:25,128 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:25,131 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:25,131 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:29:25,131 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:29:25,131 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:29:25,132 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:29:25,137 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:29:25,138 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:25,139 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:25,139 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:29:25,141 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:25,141 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:25,141 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:25,141 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:25,186 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3345, Threshold=0.3542, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:29:25,186 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3345
2025-08-04 20:29:36,450 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:36,450 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:29:36,450 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:29:36,451 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:29:36,451 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:29:36,451 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:36,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:36,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:36,805 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:29:36,834 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:29:36,834 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:36,930 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:36,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:36,935 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:36,943 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:29:36,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:36,951 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:29:36,951 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:36,952 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:36,952 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:29:36,960 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:36,963 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:36,965 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:36,967 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:36,970 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:36,972 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:36,975 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:36,977 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:36,980 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:36,981 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:36,983 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:36,992 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:36,993 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:29:36,997 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:29:36,998 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:29:37,003 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:37,003 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:29:37,011 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:37,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:29:37,012 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:37,028 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:37,033 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:29:37,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:29:37,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:37,040 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:37,040 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:37,040 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:37,041 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:37,041 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:29:37,041 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:37,041 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:29:37,041 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:37,043 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:29:37,043 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:29:37,043 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:29:37,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:29:37,045 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:29:37,045 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:29:37,045 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:29:37,045 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:29:37,046 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:29:37,046 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:29:37,046 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:29:37,046 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:29:37,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:37,047 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:29:37,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:37,047 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:37,051 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:37,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:29:37,051 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:29:37,051 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:29:37,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:29:37,055 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:29:37,055 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:37,056 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:37,056 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:29:37,058 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:37,058 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:37,059 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:37,059 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:37,105 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3373, Threshold=0.3561, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:29:37,105 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3373
2025-08-04 20:29:42,354 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:42,354 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:29:42,354 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:29:42,354 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:29:42,354 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:29:42,355 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:42,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:42,577 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:42,661 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:29:42,703 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:29:42,704 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:42,818 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:42,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:42,825 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:42,832 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:29:42,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:42,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:29:42,840 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:42,840 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:42,840 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:29:42,849 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:42,852 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:42,854 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:42,856 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:42,858 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:42,860 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:42,863 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:42,865 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:42,868 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:42,870 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:42,872 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:42,883 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:42,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:29:42,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:29:42,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:29:42,893 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:42,893 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:29:42,901 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:42,902 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:29:42,902 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:42,917 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:42,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:29:42,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:29:42,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:42,928 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:42,928 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:42,928 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:42,928 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:42,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:29:42,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:42,929 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:29:42,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:42,930 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:29:42,931 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:29:42,931 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:42,931 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:29:42,931 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:29:42,932 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:29:42,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:29:42,933 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:29:42,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:29:42,933 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:29:42,933 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:29:42,934 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:29:42,934 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:29:42,934 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:42,934 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:29:42,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:42,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:42,935 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:42,935 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:29:42,936 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:29:42,936 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:29:42,936 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:29:42,940 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:29:42,940 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:42,942 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:42,942 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:29:42,951 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 40/400.
2025-08-04 20:29:43,058 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:43,058 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:43,069 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 18 anomalous samples to GAN training data (target: 18).
2025-08-04 20:29:43,070 - ClientAppLogger [Client 4] - INFO - [Client] Round 40: Training GAN with 78 samples (60 normal, 18 anomalous).
2025-08-04 20:29:43,071 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:45,782 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0871, Avg D Loss: 0.8724
2025-08-04 20:29:45,782 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0871, Avg D Loss: 0.8724
2025-08-04 20:29:45,782 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:45,835 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3528, Threshold=0.3726, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:29:45,836 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.7854
2025-08-04 20:29:45,836 - ClientAppLogger [Client 4] - INFO - Fit completed for round 40. Duration: 2.88s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 40, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.087093868622413, 'd_loss': 0.8724098488306389, 'post_fit_local_f1': 0.7854362262422716, 'fit_time_seconds': 2.8848395347595215, 'cpu_percent_fit': 4.40625, 'ram_mb_fit': 139.9453125, 'accumulated_train_samples_this_round': 78}
2025-08-04 20:29:45,836 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 20:29:54,112 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:54,112 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 20:29:54,112 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 20:29:54,113 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 20:29:54,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 20:29:54,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:54,502 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:54,502 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:54,603 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 20:29:54,639 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 20:29:54,640 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:54,747 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:54,753 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:54,753 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:54,759 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 20:29:54,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:54,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 20:29:54,766 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:54,766 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:54,766 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 20:29:54,776 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:54,779 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,781 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:54,784 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:54,786 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:54,789 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:54,791 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,794 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:54,797 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:54,799 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:54,801 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:54,812 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:54,812 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 20:29:54,818 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 20:29:54,818 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 20:29:54,825 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:54,825 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 20:29:54,838 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:54,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 20:29:54,839 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:54,858 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:54,863 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 20:29:54,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 20:29:54,869 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:54,869 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:54,869 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:54,870 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:54,870 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:54,870 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 20:29:54,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:54,871 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 20:29:54,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:54,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 20:29:54,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 20:29:54,873 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 20:29:54,874 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 20:29:54,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 20:29:54,875 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 20:29:54,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 20:29:54,875 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 20:29:54,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 20:29:54,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 20:29:54,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 20:29:54,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 20:29:54,876 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 20:29:54,876 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:54,877 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 20:29:54,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:54,877 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:54,881 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:54,881 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 20:29:54,881 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 20:29:54,881 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 20:29:54,882 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 20:29:54,888 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 20:29:54,888 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:54,890 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:54,890 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 20:29:54,891 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:54,892 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:54,892 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:54,892 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:54,936 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.3441, Threshold=0.3638, Accuracy=0.6895, F1=0.7854, Precision=0.9470, Recall=0.6710
2025-08-04 20:29:54,936 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.6895, F1: 0.7854, Prec: 0.9470, Rec: 0.6710, Avg Anomaly Score: 0.3441
