2025-08-04 20:21:13,486 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:13,486 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:21:13,486 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:21:13,490 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:21:13,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:21:13,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:14,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:14,230 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:14,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:21:14,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:21:14,362 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:14,533 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:14,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:14,540 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:14,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:21:14,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:14,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:21:14,552 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:14,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:14,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:21:14,560 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:14,563 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:14,565 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:14,568 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:14,570 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:14,573 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:14,575 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:14,578 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:14,581 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:14,583 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:14,586 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:14,596 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:14,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:21:14,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:21:14,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:21:14,607 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:14,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:21:14,618 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:14,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:21:14,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:14,635 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:14,640 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:21:14,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:21:14,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:14,658 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:14,658 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:14,658 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:14,659 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:14,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:21:14,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:14,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:21:14,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:14,661 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:21:14,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:21:14,661 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:14,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:21:14,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:14,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:14,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:14,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:21:14,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:21:14,663 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:21:14,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:21:14,663 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:21:14,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:21:14,663 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:21:14,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:21:14,664 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:21:14,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:21:14,664 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:21:14,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:21:14,665 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:14,665 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:21:14,666 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:14,666 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:14,666 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:14,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:21:14,667 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:21:14,667 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:21:14,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:21:14,673 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:21:14,673 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:14,675 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:14,675 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:21:14,677 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:14,677 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:14,677 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:14,678 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:14,712 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5013, Accuracy=0.5156, F1=0.6619, Precision=0.7907, Recall=0.5692
2025-08-04 20:21:14,712 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5156, F1: 0.6619, Prec: 0.7907, Rec: 0.5692, Avg Anomaly Score: 0.5017
2025-08-04 20:21:29,587 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:29,587 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:21:29,587 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:21:29,587 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:21:29,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:21:29,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:30,103 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:30,103 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:30,212 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:21:30,242 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:21:30,242 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:30,334 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:30,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:30,339 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:30,344 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:21:30,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:30,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:21:30,351 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:30,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:30,352 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:21:30,360 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:30,363 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,365 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:30,367 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:30,369 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:30,372 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:30,375 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,377 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:30,380 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:30,382 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:30,385 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:30,394 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:30,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:21:30,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:21:30,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:21:30,404 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,404 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:21:30,415 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:21:30,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,431 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:21:30,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:21:30,440 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,440 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,440 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,440 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,441 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:21:30,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:21:30,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:21:30,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:21:30,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:21:30,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:21:30,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:21:30,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:21:30,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:21:30,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:21:30,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:21:30,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:21:30,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:21:30,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:21:30,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,447 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:21:30,448 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:21:30,448 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:21:30,448 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:21:30,452 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:21:30,452 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,453 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,454 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:21:30,455 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,455 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,455 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,456 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,490 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5013, Accuracy=0.5156, F1=0.6619, Precision=0.7907, Recall=0.5692
2025-08-04 20:21:30,490 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5156, F1: 0.6619, Prec: 0.7907, Rec: 0.5692, Avg Anomaly Score: 0.5017
2025-08-04 20:21:41,819 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,819 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:21:41,819 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:21:41,820 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:21:41,820 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:21:41,820 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:42,268 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:42,268 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:42,390 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:21:42,430 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:21:42,430 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,598 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,611 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,622 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:21:42,634 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,635 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,635 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,636 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,636 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:21:42,649 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,653 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,656 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,659 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,664 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,667 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,670 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,674 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,677 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,680 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,682 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,694 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,695 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:21:42,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:21:42,710 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:21:42,726 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,726 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:21:42,727 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,746 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:21:42,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:21:42,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,763 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,763 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,763 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,763 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:21:42,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:21:42,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:21:42,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:21:42,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:21:42,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:21:42,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:21:42,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:21:42,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:21:42,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:21:42,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:21:42,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:21:42,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:21:42,771 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:21:42,771 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,772 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,772 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,772 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:21:42,772 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:21:42,772 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:21:42,772 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:21:42,777 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:21:42,777 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,779 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,779 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:21:42,781 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,781 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,781 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,781 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,820 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5077, Accuracy=0.5295, F1=0.6716, Precision=0.8023, Recall=0.5776
2025-08-04 20:21:42,820 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5295, F1: 0.6716, Prec: 0.8023, Rec: 0.5776, Avg Anomaly Score: 0.5078
2025-08-04 20:21:54,144 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:54,144 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:21:54,144 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:21:54,145 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:21:54,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:21:54,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,778 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:21:54,813 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:21:54,814 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:55,058 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:55,071 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:55,072 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:55,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:21:55,109 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:55,110 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:21:55,111 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:55,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:55,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:21:55,123 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:55,127 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,131 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:55,134 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:55,137 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:55,141 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:55,144 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,147 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:55,151 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:55,157 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:55,160 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:55,177 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:55,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:21:55,182 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:21:55,182 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:21:55,190 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:55,191 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:21:55,207 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:55,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:21:55,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:55,224 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:55,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:21:55,240 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:21:55,240 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:55,240 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:55,240 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:55,243 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:21:55,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:21:55,244 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:55,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:21:55,244 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:55,244 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:55,245 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:55,245 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:21:55,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:21:55,245 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:21:55,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:21:55,246 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:21:55,246 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:21:55,246 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:21:55,246 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:55,249 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:55,249 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:21:55,249 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:21:55,249 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:21:55,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:21:55,257 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:21:55,258 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:55,259 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:55,259 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:21:55,261 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:55,261 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:55,261 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:55,262 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:55,305 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.4960, F1=0.6483, Precision=0.7744, Recall=0.5575
2025-08-04 20:21:55,305 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4960, F1: 0.6483, Prec: 0.7744, Rec: 0.5575, Avg Anomaly Score: 0.5085
2025-08-04 20:22:09,628 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,628 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:22:09,628 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:22:09,629 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:22:09,632 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:22:09,633 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:10,050 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:10,050 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:10,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:22:10,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:22:10,181 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:10,291 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:10,299 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:10,300 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:10,307 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:22:10,319 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:10,319 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:22:10,320 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:10,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:10,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:22:10,332 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:10,335 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,338 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:10,340 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:10,344 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:10,347 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:10,350 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,353 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:10,356 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:10,358 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:10,360 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:10,371 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:10,372 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:22:10,377 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:22:10,377 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:22:10,383 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:10,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:22:10,401 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:10,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:22:10,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:10,428 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:10,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:22:10,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:22:10,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:10,446 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:10,446 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:10,447 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:10,447 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:10,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:22:10,447 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:10,448 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:22:10,448 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:10,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:22:10,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:22:10,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:10,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:22:10,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:10,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:10,451 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:10,451 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:22:10,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:22:10,451 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:22:10,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:22:10,452 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:22:10,452 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:22:10,452 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:22:10,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:22:10,453 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:22:10,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:22:10,454 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:22:10,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:22:10,454 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:10,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:22:10,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:10,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:10,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:10,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:22:10,456 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:22:10,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:22:10,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:22:10,461 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:22:10,461 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,462 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,463 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:22:10,464 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,465 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,465 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,466 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,516 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.4886, F1=0.6431, Precision=0.7682, Recall=0.5530
2025-08-04 20:22:10,518 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4886, F1: 0.6431, Prec: 0.7682, Rec: 0.5530, Avg Anomaly Score: 0.5085
2025-08-04 20:22:24,824 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,824 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:22:24,824 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:22:24,824 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:22:24,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:22:24,825 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:25,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:25,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:25,271 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:22:25,296 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:22:25,296 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:25,398 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:25,409 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:25,410 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:25,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:22:25,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:25,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:22:25,427 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:25,427 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:25,427 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:22:25,436 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:25,439 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,441 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:25,443 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:25,446 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:25,448 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:25,450 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,453 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:25,455 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:25,458 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:25,460 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:25,472 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:25,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:22:25,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:22:25,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:22:25,484 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:25,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:22:25,499 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:25,499 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:22:25,499 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:25,519 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:25,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:22:25,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:22:25,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:25,538 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:25,538 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:25,538 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:25,538 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:25,539 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:22:25,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:25,539 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:22:25,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:25,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:22:25,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:22:25,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:25,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:22:25,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:25,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:25,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:22:25,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:22:25,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:22:25,544 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:22:25,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:22:25,544 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:22:25,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:22:25,545 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:25,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:22:25,545 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:25,545 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:25,546 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:25,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:22:25,546 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:22:25,546 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:22:25,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:22:25,553 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:22:25,553 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:25,555 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:25,555 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:22:25,556 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:25,557 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:25,557 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:25,558 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:25,597 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.4840, F1=0.6398, Precision=0.7643, Recall=0.5502
2025-08-04 20:22:25,598 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4840, F1: 0.6398, Prec: 0.7643, Rec: 0.5502, Avg Anomaly Score: 0.5053
2025-08-04 20:22:39,902 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:39,902 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:22:39,902 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:22:39,903 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:22:39,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:22:39,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:40,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:40,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,388 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:22:40,422 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:22:40,423 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,614 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,623 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,624 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,633 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:22:40,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,654 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:22:40,664 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,667 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,669 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:40,672 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:40,675 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:40,677 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:40,680 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,683 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:40,686 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:40,688 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:40,694 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:40,705 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:40,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:22:40,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:22:40,711 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:22:40,719 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:40,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:22:40,741 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:40,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:22:40,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:40,762 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:40,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:22:40,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:22:40,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:40,777 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:40,777 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:40,778 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:40,778 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:40,778 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:22:40,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:40,779 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:22:40,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:40,781 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:22:40,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:22:40,781 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:40,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:22:40,782 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:40,782 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:40,782 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:40,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:22:40,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:22:40,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:22:40,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:22:40,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:22:40,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:22:40,784 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:22:40,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:22:40,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:22:40,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:22:40,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:22:40,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:22:40,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:40,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:22:40,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:40,787 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:40,787 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:40,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:22:40,788 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:22:40,788 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:22:40,788 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:22:40,795 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:22:40,795 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:40,797 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:40,797 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:22:40,798 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:40,799 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:40,799 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:40,799 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:40,839 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4970, Threshold=0.4943, Accuracy=0.4868, F1=0.6418, Precision=0.7667, Recall=0.5519
2025-08-04 20:22:40,840 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4868, F1: 0.6418, Prec: 0.7667, Rec: 0.5519, Avg Anomaly Score: 0.4970
2025-08-04 20:22:55,135 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:55,135 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:22:55,135 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:22:55,135 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:22:55,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:22:55,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:55,428 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:55,429 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:55,517 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:22:55,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:22:55,541 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:55,637 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:55,643 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:55,644 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:55,649 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:22:55,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:55,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:22:55,657 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:55,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:55,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:22:55,667 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:55,671 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:55,674 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:55,677 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:55,682 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:55,684 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:55,687 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:55,690 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:55,693 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:55,695 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:55,697 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:55,707 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:55,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:22:55,711 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:22:55,711 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:22:55,717 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:55,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:22:55,728 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:55,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:22:55,729 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:55,743 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:55,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:22:55,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:22:55,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:55,752 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:55,753 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:55,753 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:55,753 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:55,753 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:22:55,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:55,754 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:22:55,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:55,755 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:22:55,755 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:22:55,755 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:22:55,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:22:55,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:22:55,757 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:22:55,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:22:55,757 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:22:55,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:22:55,757 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:55,758 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:55,759 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:55,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:22:55,759 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:22:55,759 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:22:55,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:22:55,763 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:22:55,763 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:55,764 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:55,765 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:22:55,766 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:55,766 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:55,766 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:55,767 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:55,801 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4816, Threshold=0.4777, Accuracy=0.4933, F1=0.6463, Precision=0.7721, Recall=0.5558
2025-08-04 20:22:55,801 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4933, F1: 0.6463, Prec: 0.7721, Rec: 0.5558, Avg Anomaly Score: 0.4816
2025-08-04 20:23:07,077 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:07,077 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:23:07,077 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:23:07,078 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:23:07,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:23:07,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:07,378 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:07,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:07,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:23:07,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:23:07,512 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:07,638 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:07,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:07,645 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:07,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:23:07,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:07,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:23:07,662 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:07,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:07,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:23:07,672 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:07,675 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,678 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:07,680 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:07,683 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:07,685 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:07,688 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,690 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:07,693 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:07,695 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:07,697 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:07,711 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:07,711 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:23:07,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:23:07,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:23:07,724 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:07,724 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:23:07,735 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:07,735 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:23:07,735 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:07,753 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:07,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:23:07,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:23:07,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:07,763 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:07,763 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:07,763 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:07,764 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:07,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:23:07,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:07,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:23:07,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:07,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:23:07,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:23:07,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:07,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:23:07,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:23:07,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:23:07,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:23:07,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:23:07,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:23:07,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:23:07,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:23:07,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:23:07,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:23:07,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:07,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:23:07,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:07,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:07,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:07,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:23:07,770 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:23:07,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:23:07,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:23:07,776 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:23:07,776 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:07,778 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:07,778 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:23:07,779 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:07,780 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:07,780 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:07,781 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:07,813 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4583, Threshold=0.4523, Accuracy=0.4951, F1=0.6476, Precision=0.7736, Recall=0.5569
2025-08-04 20:23:07,813 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4951, F1: 0.6476, Prec: 0.7736, Rec: 0.5569, Avg Anomaly Score: 0.4583
2025-08-04 20:23:19,093 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:19,093 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:23:19,093 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:23:19,093 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:23:19,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:23:19,094 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:19,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:23:19,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:23:19,603 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:19,731 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:19,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:19,742 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:19,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:23:19,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:19,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:23:19,764 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:19,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:19,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:23:19,775 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:19,778 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,780 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:19,783 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:19,786 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:19,789 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:19,791 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,794 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:19,797 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:19,799 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:19,801 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:19,812 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:19,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:23:19,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:23:19,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:23:19,826 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:19,826 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:23:19,842 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:19,843 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:23:19,843 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:19,859 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:19,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:23:19,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:23:19,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:19,883 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:19,883 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:19,883 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:19,884 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:19,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:23:19,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:19,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:23:19,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:19,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:23:19,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:23:19,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:19,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:23:19,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:19,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:19,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:19,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:23:19,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:23:19,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:23:19,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:23:19,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:23:19,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:23:19,890 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:23:19,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:23:19,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:23:19,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:23:19,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:23:19,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:23:19,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:19,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:23:19,892 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:19,892 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:19,895 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:19,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:23:19,896 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:23:19,896 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:23:19,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:23:19,903 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:23:19,904 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:19,905 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:19,906 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:23:19,907 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:19,907 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:19,907 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:19,908 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:19,948 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4197, Threshold=0.4110, Accuracy=0.4960, F1=0.6483, Precision=0.7744, Recall=0.5575
2025-08-04 20:23:19,948 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.4960, F1: 0.6483, Prec: 0.7744, Rec: 0.5575, Avg Anomaly Score: 0.4197
2025-08-04 20:23:31,230 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:31,231 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:23:31,231 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:23:31,231 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:23:31,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:23:31,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:31,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:31,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:31,631 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:23:31,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:23:31,662 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:31,792 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:31,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:31,799 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:31,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:23:31,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:31,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:23:31,816 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:31,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:31,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:23:31,827 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:31,830 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:31,832 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:31,835 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:31,838 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:31,840 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:31,842 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:31,845 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:31,848 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:31,850 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:31,852 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:31,867 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:31,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:23:31,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:23:31,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:23:31,879 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:31,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:23:31,892 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:31,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:23:31,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:31,910 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:31,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:23:31,926 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:23:31,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:31,927 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:31,927 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:31,927 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:31,928 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:31,928 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:23:31,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:31,928 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:23:31,929 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:31,930 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:23:31,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:23:31,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:31,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:23:31,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:31,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:31,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:31,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:23:31,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:23:31,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:23:31,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:23:31,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:23:31,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:23:31,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:23:31,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:23:31,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:23:31,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:23:31,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:23:31,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:23:31,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:31,934 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:23:31,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:31,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:31,937 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:31,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:23:31,938 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:23:31,938 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:23:31,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:23:31,944 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:23:31,944 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:31,946 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:31,946 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:23:31,947 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:31,948 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:31,948 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:31,948 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:31,983 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3634, Threshold=0.3516, Accuracy=0.5016, F1=0.6522, Precision=0.7791, Recall=0.5608
2025-08-04 20:23:31,983 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5016, F1: 0.6522, Prec: 0.7791, Rec: 0.5608, Avg Anomaly Score: 0.3634
2025-08-04 20:23:37,244 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:37,245 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:23:37,245 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:23:37,245 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:23:37,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:23:37,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:37,474 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:37,474 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:37,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:23:37,576 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:23:37,576 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:37,666 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:37,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:37,672 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:37,681 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:23:37,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:37,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:23:37,702 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:37,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:37,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:23:37,710 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:37,713 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:37,715 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:37,717 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:37,720 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:37,722 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:37,725 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:37,727 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:37,730 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:37,732 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:37,734 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:37,744 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:37,744 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:23:37,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:23:37,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:23:37,755 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:37,755 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:23:37,764 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:37,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:23:37,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:37,779 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:37,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:23:37,789 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:23:37,789 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:37,789 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:37,789 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:37,790 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:37,790 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:37,790 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:23:37,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:37,791 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:23:37,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:37,792 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:23:37,792 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:23:37,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:37,793 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:23:37,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:37,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:37,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:37,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:23:37,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:23:37,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:23:37,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:23:37,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:23:37,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:23:37,796 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:37,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:23:37,796 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:37,796 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:37,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:37,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:23:37,800 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:23:37,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:23:37,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:23:37,803 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:23:37,804 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:37,805 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:37,805 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:23:37,806 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 12/400.
2025-08-04 20:23:37,908 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:37,908 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:37,909 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:23:37,910 - ClientAppLogger [Client 7] - INFO - [Client] Round 12: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:23:37,911 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:39,428 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0522, Avg D Loss: 0.9253
2025-08-04 20:23:39,428 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0522, Avg D Loss: 0.9253
2025-08-04 20:23:39,430 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:39,469 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3539, Threshold=0.3412, Accuracy=0.5035, F1=0.6535, Precision=0.7806, Recall=0.5619
2025-08-04 20:23:39,469 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.6535
2025-08-04 20:23:39,470 - ClientAppLogger [Client 7] - INFO - Fit completed for round 12. Duration: 1.66s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 12, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0522499799728395, 'd_loss': 0.9253325879573822, 'post_fit_local_f1': 0.6534717715768981, 'fit_time_seconds': 1.6632072925567627, 'cpu_percent_fit': 6.5625, 'ram_mb_fit': 113.65234375, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:23:39,470 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:23:47,756 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:47,756 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:23:47,756 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:23:47,756 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:23:47,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:23:47,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:48,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:48,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:48,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:23:48,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:23:48,139 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:48,241 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:48,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:48,247 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:48,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:23:48,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:48,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:23:48,284 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:48,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:48,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:23:48,293 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:48,296 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:48,299 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:48,301 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:48,304 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:48,306 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:48,309 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:48,311 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:48,314 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:48,316 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:48,319 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:48,328 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:48,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:23:48,333 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:23:48,333 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:23:48,339 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:48,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:23:48,350 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:48,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:23:48,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:48,365 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:48,370 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:23:48,375 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:23:48,375 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:48,375 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:48,375 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:48,376 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:48,376 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:48,376 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:23:48,376 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:48,377 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:23:48,377 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:48,378 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:23:48,378 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:23:48,379 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:48,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:23:48,379 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:48,379 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:48,379 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:23:48,380 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:23:48,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:23:48,381 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:23:48,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:23:48,381 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:23:48,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:23:48,382 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:48,382 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:23:48,382 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:48,382 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:48,384 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:48,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:23:48,384 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:23:48,384 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:23:48,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:23:48,385 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:23:48,385 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:48,387 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:48,387 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:23:48,388 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:48,389 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:48,389 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:48,390 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:48,423 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3026, Threshold=0.2955, Accuracy=0.5212, F1=0.6658, Precision=0.7953, Recall=0.5725
2025-08-04 20:23:48,423 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5212, F1: 0.6658, Prec: 0.7953, Rec: 0.5725, Avg Anomaly Score: 0.3026
2025-08-04 20:23:59,730 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:59,730 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:23:59,731 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:23:59,731 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:23:59,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:23:59,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:00,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:00,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:00,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:24:00,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:24:00,168 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:00,266 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:00,272 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:00,272 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:00,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:24:00,285 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:00,286 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:24:00,286 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:00,286 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:00,286 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:24:00,298 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:00,301 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,304 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:00,306 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:00,309 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:00,312 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:00,314 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,317 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:00,320 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:00,322 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:00,324 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:00,335 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:00,335 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:24:00,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:24:00,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:24:00,347 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:00,347 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:24:00,357 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:00,357 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:24:00,358 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:00,375 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:00,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:24:00,388 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:24:00,389 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:00,389 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:00,389 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:00,389 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:00,390 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:00,390 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:24:00,390 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:00,391 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:24:00,391 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:00,392 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:24:00,392 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:24:00,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:24:00,394 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:24:00,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:24:00,394 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:24:00,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:24:00,394 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:24:00,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:24:00,395 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:24:00,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:24:00,395 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:24:00,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:24:00,395 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:00,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:24:00,396 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:00,396 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:00,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:00,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:24:00,400 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:24:00,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:24:00,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:24:00,405 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:24:00,405 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:00,406 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:00,406 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:24:00,408 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:00,408 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:00,408 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:00,409 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:00,445 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3046, Threshold=0.3025, Accuracy=0.5528, F1=0.6879, Precision=0.8217, Recall=0.5915
2025-08-04 20:24:00,445 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5528, F1: 0.6879, Prec: 0.8217, Rec: 0.5915, Avg Anomaly Score: 0.3046
2025-08-04 20:24:11,759 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:11,759 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:24:11,759 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:24:11,759 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:24:11,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:24:11,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:12,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:12,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:12,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:24:12,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:24:12,164 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:12,266 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:12,274 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:12,275 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:12,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:24:12,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:12,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:24:12,294 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:12,294 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:12,294 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:24:12,303 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:12,306 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,308 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:12,310 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:12,313 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:12,316 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:12,318 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,321 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:12,324 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:12,327 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:12,329 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:12,339 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:12,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:24:12,345 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:24:12,345 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:24:12,350 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:12,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:24:12,360 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:12,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:24:12,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:12,380 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:12,387 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:24:12,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:24:12,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:12,394 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:12,394 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:12,395 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:12,395 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:12,395 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:24:12,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:12,395 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:24:12,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:12,397 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:24:12,397 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:24:12,397 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:12,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:24:12,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:12,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:12,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:12,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:24:12,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:24:12,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:24:12,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:24:12,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:24:12,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:24:12,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:24:12,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:24:12,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:24:12,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:24:12,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:24:12,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:24:12,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:12,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:24:12,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:12,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:12,406 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:12,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:24:12,406 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:24:12,406 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:24:12,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:24:12,411 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:24:12,411 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:12,413 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:12,413 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:24:12,414 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:12,415 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:12,415 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:12,416 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:12,452 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3222, Threshold=0.3242, Accuracy=0.5937, F1=0.7164, Precision=0.8558, Recall=0.6161
2025-08-04 20:24:12,452 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.5937, F1: 0.7164, Prec: 0.8558, Rec: 0.6161, Avg Anomaly Score: 0.3222
2025-08-04 20:24:23,741 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:23,741 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:24:23,741 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:24:23,741 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:24:23,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:24:23,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:24,029 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:24,029 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:24,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:24:24,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:24:24,154 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:24,272 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:24,277 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:24,278 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:24,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:24:24,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:24,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:24:24,292 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:24,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:24,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:24:24,302 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:24,305 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,308 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:24,311 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:24,313 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:24,316 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:24,319 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,322 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:24,325 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:24,327 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:24,329 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:24,339 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:24,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:24:24,345 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:24:24,345 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:24:24,350 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:24,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:24:24,361 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:24,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:24:24,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:24,377 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:24,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:24:24,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:24:24,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:24,394 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:24,395 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:24,395 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:24,395 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:24,396 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:24:24,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:24,396 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:24:24,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:24,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:24:24,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:24:24,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:24,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:24:24,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:24,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:24,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:24,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:24:24,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:24:24,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:24:24,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:24:24,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:24:24,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:24:24,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:24:24,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:24:24,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:24:24,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:24:24,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:24:24,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:24:24,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:24,402 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:24:24,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:24,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:24,403 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:24,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:24:24,403 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:24:24,403 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:24:24,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:24:24,406 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:24:24,407 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:24,408 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:24,408 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:24:24,410 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:24,410 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:24,410 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:24,411 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:24,450 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3020, Threshold=0.3066, Accuracy=0.6755, F1=0.7735, Precision=0.9240, Recall=0.6652
2025-08-04 20:24:24,450 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6755, F1: 0.7735, Prec: 0.9240, Rec: 0.6652, Avg Anomaly Score: 0.3020
2025-08-04 20:24:35,733 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:35,734 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:24:35,734 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:24:35,734 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:24:35,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:24:35,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:36,070 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:36,070 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:36,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:24:36,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:24:36,198 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:36,305 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:36,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:36,312 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:36,322 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:24:36,347 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:36,347 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:24:36,348 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:36,348 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:36,348 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:24:36,358 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:36,361 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,363 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:36,365 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:36,369 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:36,372 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:36,376 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,379 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:36,382 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:36,384 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:36,387 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:36,398 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:36,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:24:36,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:24:36,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:24:36,410 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:36,410 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:24:36,420 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:36,421 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:24:36,421 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:36,438 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:36,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:24:36,452 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:24:36,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:36,453 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:36,454 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:36,455 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:36,455 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:36,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:24:36,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:36,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:24:36,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:36,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:24:36,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:24:36,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:36,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:24:36,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:24:36,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:24:36,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:24:36,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:24:36,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:24:36,461 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:24:36,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:24:36,461 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:24:36,462 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:24:36,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:36,462 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:24:36,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:36,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:36,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:36,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:24:36,464 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:24:36,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:24:36,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:24:36,470 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:24:36,470 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:36,471 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:36,472 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:24:36,473 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:36,473 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:36,473 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:36,474 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:36,509 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3000, Threshold=0.3048, Accuracy=0.6634, F1=0.7651, Precision=0.9140, Recall=0.6579
2025-08-04 20:24:36,509 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6634, F1: 0.7651, Prec: 0.9140, Rec: 0.6579, Avg Anomaly Score: 0.3000
2025-08-04 20:24:47,806 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:47,806 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:24:47,806 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:24:47,806 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:24:47,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:24:47,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:48,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:48,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:48,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:24:48,264 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:24:48,264 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:48,364 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:48,370 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:48,370 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:48,376 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:24:48,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:48,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:24:48,384 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:48,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:48,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:24:48,393 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:48,396 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,398 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:48,400 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:48,403 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:48,405 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:48,408 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,410 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:48,413 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:48,415 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:48,418 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:48,429 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:48,429 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:24:48,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:24:48,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:24:48,440 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:48,440 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:24:48,451 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:48,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:24:48,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:48,467 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:48,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:24:48,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:24:48,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:48,477 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:48,477 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:48,478 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:48,478 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:48,478 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:24:48,478 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:48,479 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:24:48,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:48,480 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:24:48,480 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:24:48,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:24:48,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:24:48,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:24:48,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:24:48,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:24:48,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:24:48,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:24:48,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:24:48,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:24:48,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:24:48,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:24:48,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:48,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:24:48,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:48,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:48,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:48,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:24:48,485 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:24:48,485 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:24:48,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:24:48,491 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:24:48,491 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:48,492 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:48,492 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:24:48,494 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:48,494 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:48,494 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:48,495 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:48,534 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.2986, Threshold=0.3045, Accuracy=0.6634, F1=0.7651, Precision=0.9140, Recall=0.6579
2025-08-04 20:24:48,534 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6634, F1: 0.7651, Prec: 0.9140, Rec: 0.6579, Avg Anomaly Score: 0.2986
2025-08-04 20:24:59,835 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:59,836 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:24:59,836 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:24:59,836 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:24:59,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:24:59,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:00,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:00,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:00,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:25:00,287 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:25:00,288 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:00,403 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:00,410 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:00,410 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:00,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:25:00,423 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:00,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:25:00,424 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:00,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:00,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:25:00,433 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:00,436 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,438 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:00,441 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:00,443 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:00,446 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:00,448 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,451 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:00,453 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:00,455 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:00,458 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:00,468 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:00,468 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:25:00,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:25:00,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:25:00,478 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:00,478 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:25:00,489 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:00,489 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:25:00,489 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:00,506 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:00,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:25:00,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:25:00,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:00,519 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:00,520 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:00,520 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:00,520 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:00,520 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:25:00,520 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:00,521 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:25:00,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:00,522 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:25:00,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:25:00,523 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:00,523 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:25:00,523 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:00,523 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:00,523 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:00,523 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:25:00,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:25:00,524 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:25:00,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:25:00,524 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:25:00,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:25:00,524 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:25:00,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:25:00,525 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:25:00,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:25:00,525 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:25:00,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:25:00,525 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:00,526 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:25:00,526 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:00,526 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:00,526 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:00,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:25:00,527 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:25:00,527 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:25:00,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:25:00,531 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:25:00,531 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:00,533 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:00,533 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:25:00,534 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:00,534 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:00,535 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:00,535 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:00,568 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3059, Threshold=0.3148, Accuracy=0.6681, F1=0.7683, Precision=0.9178, Recall=0.6607
2025-08-04 20:25:00,569 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6681, F1: 0.7683, Prec: 0.9178, Rec: 0.6607, Avg Anomaly Score: 0.3059
2025-08-04 20:25:11,861 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:11,861 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:25:11,861 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:25:11,861 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:25:11,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:25:11,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:12,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:12,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:12,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:25:12,290 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:25:12,290 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:12,412 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:12,418 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:12,418 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:12,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:25:12,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:12,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:25:12,432 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:12,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:12,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:25:12,441 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:12,444 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,447 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:12,449 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:12,452 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:12,455 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:12,458 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,460 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:12,463 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:12,465 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:12,467 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:12,477 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:12,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:25:12,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:25:12,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:25:12,488 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:12,488 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:25:12,500 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:12,500 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:25:12,500 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:12,517 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:12,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:25:12,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:25:12,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:12,530 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:12,530 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:12,531 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:12,531 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:12,531 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:25:12,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:12,532 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:25:12,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:12,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:25:12,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:25:12,534 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:12,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:25:12,534 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:12,534 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:12,534 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:12,535 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:25:12,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:25:12,535 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:25:12,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:25:12,535 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:25:12,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:25:12,536 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:25:12,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:25:12,536 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:25:12,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:25:12,536 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:25:12,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:25:12,537 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:12,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:25:12,537 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:12,537 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:12,537 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:12,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:25:12,538 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:25:12,538 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:25:12,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:25:12,544 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:25:12,544 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:12,546 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:12,546 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:25:12,547 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:12,547 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:12,547 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:12,548 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:12,585 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3095, Threshold=0.3195, Accuracy=0.6681, F1=0.7683, Precision=0.9178, Recall=0.6607
2025-08-04 20:25:12,585 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6681, F1: 0.7683, Prec: 0.9178, Rec: 0.6607, Avg Anomaly Score: 0.3095
2025-08-04 20:25:23,885 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:23,885 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:25:23,886 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:25:23,886 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:25:23,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:25:23,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:24,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:24,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:24,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:25:24,369 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:25:24,369 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:24,478 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:24,487 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:24,487 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:24,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:25:24,504 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:24,504 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:25:24,505 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:24,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:24,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:25:24,516 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:24,519 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,521 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:24,523 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:24,527 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:24,529 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:24,532 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,535 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:24,538 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:24,540 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:24,542 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:24,553 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:24,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:25:24,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:25:24,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:25:24,564 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:24,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:25:24,577 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:24,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:25:24,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:24,596 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:24,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:25:24,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:25:24,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:24,607 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:24,607 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:24,607 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:24,607 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:24,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:25:24,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:24,608 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:25:24,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:24,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:25:24,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:25:24,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:25:24,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:25:24,611 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:25:24,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:25:24,611 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:25:24,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:25:24,612 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:25:24,612 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:25:24,612 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:25:24,612 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:25:24,612 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:24,613 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:25:24,613 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:24,613 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:24,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:24,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:25:24,614 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:25:24,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:25:24,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:25:24,618 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:25:24,618 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:24,620 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:24,620 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:25:24,621 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:24,621 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:24,622 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:24,622 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:24,659 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3217, Threshold=0.3329, Accuracy=0.6662, F1=0.7670, Precision=0.9163, Recall=0.6596
2025-08-04 20:25:24,660 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6662, F1: 0.7670, Prec: 0.9163, Rec: 0.6596, Avg Anomaly Score: 0.3217
2025-08-04 20:25:35,950 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:35,950 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:25:35,950 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:25:35,951 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:25:35,951 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:25:35,951 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:36,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:36,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:36,382 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:25:36,405 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:25:36,405 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:36,510 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:36,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:36,519 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:36,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:25:36,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:36,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:25:36,544 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:36,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:36,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:25:36,554 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:36,557 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,560 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:36,562 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:36,565 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:36,568 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:36,570 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,573 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:36,576 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:36,578 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:36,581 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:36,595 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:36,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:25:36,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:25:36,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:25:36,607 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:36,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:25:36,617 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:36,617 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:25:36,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:36,636 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:36,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:25:36,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:25:36,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:36,650 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:36,651 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:36,651 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:36,651 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:36,652 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:25:36,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:36,652 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:25:36,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:36,654 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:25:36,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:25:36,654 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:36,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:25:36,655 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:36,655 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:36,655 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:36,655 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:25:36,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:25:36,656 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:25:36,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:25:36,656 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:25:36,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:25:36,657 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:25:36,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:25:36,657 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:25:36,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:25:36,658 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:25:36,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:25:36,658 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:36,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:25:36,658 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:36,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:36,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:36,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:25:36,659 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:25:36,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:25:36,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:25:36,665 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:25:36,666 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:36,668 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:36,668 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:25:36,670 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:36,670 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:36,670 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:36,671 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:36,715 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3192, Threshold=0.3313, Accuracy=0.6671, F1=0.7677, Precision=0.9171, Recall=0.6602
2025-08-04 20:25:36,715 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6671, F1: 0.7677, Prec: 0.9171, Rec: 0.6602, Avg Anomaly Score: 0.3192
2025-08-04 20:25:41,969 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:41,970 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:25:41,970 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:25:41,970 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:25:41,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:25:41,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:42,238 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:42,238 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:42,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:25:42,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:25:42,363 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:42,455 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:42,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:42,465 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:42,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:25:42,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:42,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:25:42,482 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:42,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:42,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:25:42,491 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:42,494 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:42,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:42,499 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:42,502 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:42,505 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:42,507 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:42,509 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:42,512 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:42,514 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:42,516 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:42,526 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:42,526 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:25:42,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:25:42,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:25:42,537 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:42,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:25:42,547 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:42,548 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:25:42,548 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:42,564 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:42,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:25:42,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:25:42,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:42,578 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:42,578 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:42,579 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:42,579 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:42,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:25:42,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:42,580 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:25:42,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:42,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:25:42,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:25:42,582 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:42,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:25:42,582 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:42,582 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:42,583 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:42,583 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:25:42,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:25:42,583 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:25:42,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:25:42,584 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:25:42,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:25:42,585 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:25:42,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:25:42,585 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:25:42,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:25:42,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:25:42,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:25:42,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:42,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:25:42,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:42,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:42,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:42,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:25:42,588 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:25:42,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:25:42,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:25:42,594 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:25:42,595 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:42,596 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:42,597 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:25:42,599 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 22/400.
2025-08-04 20:25:42,700 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:42,700 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:42,702 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 9 anomalous samples to GAN training data (target: 9).
2025-08-04 20:25:42,702 - ClientAppLogger [Client 7] - INFO - [Client] Round 22: Training GAN with 39 samples (30 normal, 9 anomalous).
2025-08-04 20:25:42,702 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:42,759 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.9193
2025-08-04 20:25:42,759 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.9193
2025-08-04 20:25:42,759 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:42,799 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3160, Threshold=0.3295, Accuracy=0.6709, F1=0.7703, Precision=0.9202, Recall=0.6624
2025-08-04 20:25:42,800 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7703
2025-08-04 20:25:42,800 - ClientAppLogger [Client 7] - INFO - Fit completed for round 22. Duration: 0.20s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 22, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083351057615036, 'd_loss': 0.9192614850325462, 'post_fit_local_f1': 0.7702790395846852, 'fit_time_seconds': 0.20131802558898926, 'cpu_percent_fit': 24.375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 39}
2025-08-04 20:25:42,800 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:25:48,065 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:48,065 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:25:48,065 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:25:48,065 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:25:48,065 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:25:48,065 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:48,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:48,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:48,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:25:48,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:25:48,607 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:48,739 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:48,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:48,750 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:48,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:25:48,775 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:48,775 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:25:48,776 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:48,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:48,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:25:48,788 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:48,792 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,794 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:48,797 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:48,800 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:48,803 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:48,806 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,810 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:48,813 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:48,815 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:48,817 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:48,828 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:48,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:25:48,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:25:48,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:25:48,845 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:48,845 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:25:48,862 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:48,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:25:48,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:48,881 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:48,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:25:48,897 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:25:48,897 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:48,898 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:48,898 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:48,898 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:48,899 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:48,899 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:25:48,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:48,899 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:25:48,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:48,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:25:48,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:25:48,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:48,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:25:48,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:48,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:48,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:48,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:25:48,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:25:48,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:25:48,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:25:48,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:25:48,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:25:48,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:25:48,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:25:48,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:25:48,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:25:48,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:25:48,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:25:48,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:48,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:25:48,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:48,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:25:48,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:25:48,913 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:25:48,913 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:48,914 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:48,915 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:48,918 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:48,962 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3228, Threshold=0.3352, Accuracy=0.6774, F1=0.7748, Precision=0.9256, Recall=0.6663
2025-08-04 20:25:48,962 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6774, F1: 0.7748, Prec: 0.9256, Rec: 0.6663, Avg Anomaly Score: 0.3228
2025-08-04 20:26:03,240 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,240 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:26:03,240 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:26:03,240 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:26:03,240 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:26:03,240 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:03,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:03,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:03,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:26:03,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:26:03,825 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:03,986 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:03,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:04,000 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:04,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:26:04,031 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:04,031 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:26:04,033 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:04,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:04,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:26:04,049 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:04,053 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,056 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:04,059 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:04,064 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:04,069 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:04,073 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:04,082 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:04,085 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:04,088 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:04,101 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:04,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:26:04,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:26:04,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:26:04,115 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:04,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:26:04,133 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:04,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:26:04,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:04,153 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:04,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:26:04,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:26:04,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,177 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,177 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,178 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,178 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,179 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:26:04,179 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,179 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:26:04,179 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,181 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:26:04,182 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,182 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:26:04,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:26:04,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:26:04,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:26:04,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:26:04,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:26:04,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:26:04,185 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:26:04,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:26:04,186 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:26:04,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:26:04,186 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:26:04,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,188 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,191 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,192 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:26:04,192 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:26:04,192 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:26:04,193 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:26:04,202 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:26:04,202 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,204 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,204 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:26:04,206 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,206 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,206 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,207 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,253 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3307, Threshold=0.3445, Accuracy=0.6792, F1=0.7761, Precision=0.9271, Recall=0.6674
2025-08-04 20:26:04,254 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6792, F1: 0.7761, Prec: 0.9271, Rec: 0.6674, Avg Anomaly Score: 0.3307
2025-08-04 20:26:15,531 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:15,531 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:26:15,531 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:26:15,531 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:26:15,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:26:15,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:16,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:16,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:16,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:26:16,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:26:16,161 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,305 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,314 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,327 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:26:16,338 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,339 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,341 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:26:16,353 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,356 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,359 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,362 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,365 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,368 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,371 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,374 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,377 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,379 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,382 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,400 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:26:16,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:26:16,412 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,412 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:26:16,423 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,423 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:26:16,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,443 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,449 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:26:16,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:26:16,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,459 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,459 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,460 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,460 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:26:16,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,461 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:26:16,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:26:16,462 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:26:16,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:26:16,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:26:16,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:26:16,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:26:16,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:26:16,465 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:26:16,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:26:16,465 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:26:16,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:26:16,466 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:26:16,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:26:16,466 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:26:16,466 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,467 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,467 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:26:16,468 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:26:16,468 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:26:16,468 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:26:16,474 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:26:16,475 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,476 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,477 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:26:16,478 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,478 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,478 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,479 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,514 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3222, Threshold=0.3353, Accuracy=0.6764, F1=0.7742, Precision=0.9248, Recall=0.6657
2025-08-04 20:26:16,515 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6764, F1: 0.7742, Prec: 0.9248, Rec: 0.6657, Avg Anomaly Score: 0.3222
2025-08-04 20:26:27,802 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:27,802 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:26:27,803 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:26:27,803 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:26:27,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:26:27,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:28,278 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:28,278 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:26:28,427 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:26:28,428 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,546 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,561 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,561 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,574 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:26:28,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,591 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:26:28,602 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,606 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,608 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,611 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,614 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,616 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,619 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,621 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,624 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,626 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,629 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,645 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:26:28,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:26:28,659 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:26:28,679 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:26:28,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,699 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:26:28,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:26:28,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,717 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,717 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,719 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:26:28,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,721 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:26:28,721 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,721 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,722 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,722 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,722 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,722 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,722 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:26:28,723 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:26:28,723 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:26:28,723 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:26:28,723 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:26:28,723 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:26:28,724 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:26:28,724 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:26:28,724 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:26:28,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:26:28,725 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:26:28,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:26:28,725 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:26:28,726 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,726 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,726 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,727 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:26:28,728 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:26:28,729 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:26:28,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:26:28,735 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:26:28,735 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,737 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,737 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:26:28,739 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,739 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,739 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:28,740 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,788 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3267, Threshold=0.3414, Accuracy=0.6820, F1=0.7781, Precision=0.9295, Recall=0.6691
2025-08-04 20:26:28,788 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6820, F1: 0.7781, Prec: 0.9295, Rec: 0.6691, Avg Anomaly Score: 0.3267
2025-08-04 20:26:40,062 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,062 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:26:40,062 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:26:40,062 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:26:40,063 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:26:40,063 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,624 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:26:40,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:26:40,670 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:40,794 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:40,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:40,804 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:40,814 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:26:40,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:40,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:26:40,832 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:40,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:40,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:26:40,845 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:40,849 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,851 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:40,853 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:40,857 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:40,859 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:40,862 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,865 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:40,869 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:40,871 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:40,874 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:40,886 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:40,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:26:40,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:26:40,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:26:40,900 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:40,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:26:40,919 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:40,920 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:26:40,920 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:40,940 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:40,946 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:26:40,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:26:40,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:40,957 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:40,957 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:40,958 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:40,958 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:40,958 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:26:40,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:40,959 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:26:40,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:40,961 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:26:40,962 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:26:40,962 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:40,962 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:26:40,962 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:40,963 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:40,963 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:40,963 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:26:40,963 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:26:40,963 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:26:40,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:26:40,964 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:26:40,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:26:40,964 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:26:40,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:26:40,965 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:26:40,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:26:40,965 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:26:40,966 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:26:40,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:40,966 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:26:40,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:40,967 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:40,967 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:40,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:26:40,967 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:26:40,968 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:26:40,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:26:40,974 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:26:40,975 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:40,977 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:40,977 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:26:40,979 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:40,979 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:40,980 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:40,980 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,028 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3307, Threshold=0.3465, Accuracy=0.6857, F1=0.7807, Precision=0.9326, Recall=0.6713
2025-08-04 20:26:41,028 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6857, F1: 0.7807, Prec: 0.9326, Rec: 0.6713, Avg Anomaly Score: 0.3307
2025-08-04 20:26:52,313 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,313 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:26:52,313 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:26:52,314 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:26:52,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:26:52,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:52,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:52,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:52,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:26:52,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:26:52,928 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,060 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,071 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,071 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:26:53,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,128 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:26:53,140 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,144 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,147 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,149 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,152 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,154 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,157 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,160 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,163 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,165 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,169 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,185 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:26:53,191 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,191 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:26:53,213 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:26:53,230 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:26:53,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,252 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:26:53,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:26:53,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,282 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,283 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,283 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,284 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:26:53,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,285 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:26:53,285 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:26:53,287 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,288 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,288 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,288 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,288 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,288 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:26:53,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:26:53,289 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:26:53,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:26:53,289 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:26:53,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:26:53,290 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:26:53,290 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:26:53,291 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:26:53,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:26:53,291 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:26:53,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:26:53,291 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:26:53,292 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,292 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,296 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,297 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:26:53,297 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:26:53,297 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:26:53,298 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:26:53,309 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:26:53,310 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,311 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,312 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:26:53,314 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,314 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,314 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,315 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,362 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3331, Threshold=0.3488, Accuracy=0.6857, F1=0.7807, Precision=0.9326, Recall=0.6713
2025-08-04 20:26:53,362 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6857, F1: 0.7807, Prec: 0.9326, Rec: 0.6713, Avg Anomaly Score: 0.3331
2025-08-04 20:27:04,631 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,631 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:27:04,631 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:27:04,631 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:27:04,631 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:27:04,632 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:05,080 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:05,080 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:05,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:27:05,232 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:27:05,232 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,352 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,360 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,361 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,368 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:27:05,377 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,378 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,379 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:27:05,390 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,393 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,396 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,398 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,402 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,405 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,408 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,411 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,415 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,417 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,419 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,432 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:27:05,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:27:05,444 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:27:05,457 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:27:05,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,480 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,488 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:27:05,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:27:05,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,503 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,504 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,504 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,504 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,505 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:27:05,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,505 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:27:05,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,508 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:27:05,508 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,508 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,508 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,509 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,509 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,509 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,509 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:27:05,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:27:05,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:27:05,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:27:05,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:27:05,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:27:05,511 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:27:05,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:27:05,512 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:27:05,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:27:05,512 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:27:05,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:27:05,513 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:27:05,513 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,514 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,518 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,518 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:27:05,518 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:27:05,518 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:27:05,518 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:27:05,525 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:27:05,525 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,532 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,532 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:27:05,534 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,534 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,534 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,535 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,578 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3296, Threshold=0.3441, Accuracy=0.6848, F1=0.7800, Precision=0.9318, Recall=0.6708
2025-08-04 20:27:05,578 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6848, F1: 0.7800, Prec: 0.9318, Rec: 0.6708, Avg Anomaly Score: 0.3296
2025-08-04 20:27:16,843 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:16,844 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:27:16,844 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:27:16,844 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:27:16,844 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:27:16,844 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:17,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:17,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:17,357 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:27:17,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:27:17,380 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,512 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,525 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:27:17,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,552 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:27:17,564 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,567 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,569 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:17,572 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:17,575 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:17,577 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:17,580 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,583 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:17,586 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:17,588 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:17,590 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:17,601 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:17,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:27:17,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:27:17,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:27:17,614 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:17,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:27:17,634 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:17,635 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:27:17,635 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:17,655 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:17,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:27:17,682 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:27:17,682 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:17,682 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:17,682 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:17,683 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:17,683 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:17,683 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:27:17,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:17,684 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:27:17,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:17,686 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:27:17,686 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:27:17,686 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:17,687 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:27:17,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:17,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:17,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:17,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:27:17,687 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:27:17,688 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:27:17,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:27:17,688 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:27:17,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:27:17,689 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:27:17,689 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:27:17,689 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:27:17,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:27:17,690 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:27:17,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:27:17,690 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:17,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:27:17,691 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:17,691 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:17,691 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:17,692 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:27:17,692 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:27:17,692 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:27:17,692 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:27:17,698 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:27:17,699 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:17,700 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:17,700 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:27:17,702 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:17,702 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:17,702 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:17,703 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:17,740 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3327, Threshold=0.3474, Accuracy=0.6867, F1=0.7813, Precision=0.9333, Recall=0.6719
2025-08-04 20:27:17,741 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6867, F1: 0.7813, Prec: 0.9333, Rec: 0.6719, Avg Anomaly Score: 0.3327
2025-08-04 20:27:35,027 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:35,027 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:27:35,027 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:27:35,027 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:27:35,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:27:35,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:35,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:35,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:35,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:27:35,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:27:35,447 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:35,564 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:35,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:35,571 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:35,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:27:35,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:35,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:27:35,588 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:35,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:35,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:27:35,597 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:35,600 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,602 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:35,604 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:35,606 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:35,609 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:35,611 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,614 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:35,616 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:35,618 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:35,621 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:35,635 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:35,635 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:27:35,640 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:27:35,640 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:27:35,647 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:35,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:27:35,663 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:35,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:27:35,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:35,681 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:35,686 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:27:35,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:27:35,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:35,693 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:35,693 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:35,693 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:35,694 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:35,694 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:27:35,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:35,694 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:27:35,695 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:35,696 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:27:35,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:27:35,696 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:27:35,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:27:35,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:27:35,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:27:35,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:27:35,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:27:35,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:27:35,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:27:35,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:27:35,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:27:35,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:27:35,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:35,700 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:27:35,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:35,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:35,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:35,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:27:35,704 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:27:35,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:27:35,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:27:35,713 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:27:35,713 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:35,715 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:35,715 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:27:35,717 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:35,717 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:35,717 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:35,717 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:35,752 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3336, Threshold=0.3500, Accuracy=0.6867, F1=0.7813, Precision=0.9333, Recall=0.6719
2025-08-04 20:27:35,752 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6867, F1: 0.7813, Prec: 0.9333, Rec: 0.6719, Avg Anomaly Score: 0.3336
2025-08-04 20:27:47,035 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:47,035 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:27:47,035 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:27:47,035 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:27:47,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:27:47,036 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:47,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:47,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:47,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:27:47,488 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:27:47,489 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:47,621 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:47,633 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:47,634 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:47,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:27:47,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:47,678 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:27:47,679 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:47,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:47,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:27:47,692 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:47,695 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,698 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:47,700 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:47,703 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:47,706 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:47,708 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,711 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:47,714 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:47,717 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:47,721 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:47,734 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:47,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:27:47,740 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:27:47,740 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:27:47,750 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:47,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:27:47,778 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:47,778 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:27:47,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:47,799 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:47,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:27:47,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:27:47,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:47,815 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:47,815 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:47,816 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:47,816 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:47,816 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:27:47,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:47,816 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:27:47,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:47,818 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:27:47,819 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:27:47,820 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:47,820 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:27:47,821 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:47,821 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:47,821 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:47,821 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:27:47,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:27:47,822 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:27:47,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:27:47,822 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:27:47,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:27:47,823 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:27:47,823 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:27:47,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:27:47,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:27:47,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:27:47,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:27:47,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:47,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:27:47,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:47,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:47,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:47,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:27:47,829 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:27:47,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:27:47,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:27:47,838 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:27:47,838 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:47,840 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:47,840 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:27:47,842 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:47,842 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:47,843 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:47,844 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:47,885 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3379, Threshold=0.3555, Accuracy=0.6894, F1=0.7833, Precision=0.9357, Recall=0.6735
2025-08-04 20:27:47,885 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6894, F1: 0.7833, Prec: 0.9357, Rec: 0.6735, Avg Anomaly Score: 0.3379
2025-08-04 20:28:02,166 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:02,166 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:28:02,166 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:28:02,166 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:28:02,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:28:02,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:02,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:02,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:02,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:28:02,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:28:02,704 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:02,855 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:02,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:02,866 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:02,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:28:02,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:02,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:28:02,890 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:02,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:02,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:28:02,901 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:02,904 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,907 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:02,909 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:02,912 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:02,915 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:02,917 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,920 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:02,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:02,925 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:02,928 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:02,943 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:02,943 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:28:02,950 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:28:02,950 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:28:02,957 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:02,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:28:02,973 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:02,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:28:02,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:02,992 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:02,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:03,008 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:03,009 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:03,009 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:03,009 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:28:03,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:03,010 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:28:03,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:03,011 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:28:03,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:28:03,012 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:03,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:28:03,012 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:03,012 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:03,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:03,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:28:03,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:28:03,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:28:03,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:28:03,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:28:03,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:28:03,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:28:03,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:03,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:28:03,017 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:28:03,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:28:03,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:28:03,024 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:28:03,024 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:03,026 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:03,026 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:28:03,028 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:03,028 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:03,028 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:03,029 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:03,074 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3404, Threshold=0.3575, Accuracy=0.6876, F1=0.7820, Precision=0.9341, Recall=0.6724
2025-08-04 20:28:03,074 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6876, F1: 0.7820, Prec: 0.9341, Rec: 0.6724, Avg Anomaly Score: 0.3404
2025-08-04 20:28:17,365 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:17,365 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:28:17,365 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:28:17,365 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:28:17,366 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:28:17,366 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:17,735 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:17,735 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:17,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:28:17,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:28:17,851 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:17,959 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:17,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:17,968 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:17,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:28:17,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:17,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:28:17,985 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:17,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:17,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:28:17,996 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:18,000 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,004 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:18,010 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:18,013 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:18,015 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:18,020 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,023 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:18,026 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:18,029 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:18,031 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:18,044 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:18,045 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:28:18,051 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:28:18,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:28:18,061 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:18,061 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:28:18,077 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:18,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:28:18,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:18,094 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:18,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:28:18,109 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:28:18,109 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:18,109 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:18,109 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:18,110 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:18,110 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:18,110 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:28:18,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:18,111 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:28:18,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:18,112 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:28:18,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:28:18,113 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:18,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:28:18,113 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:18,114 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:18,114 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:18,114 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:28:18,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:28:18,114 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:28:18,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:28:18,115 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:28:18,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:28:18,116 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:28:18,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:28:18,117 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:28:18,117 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:28:18,117 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:28:18,117 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:28:18,117 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:18,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:28:18,118 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:18,118 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:18,118 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:18,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:28:18,119 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:28:18,119 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:28:18,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:28:18,123 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:28:18,123 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:18,124 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:18,124 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:28:18,126 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:18,126 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:18,126 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:18,127 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:18,168 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3390, Threshold=0.3557, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:28:18,168 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3390
2025-08-04 20:28:29,451 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,451 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:28:29,451 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:28:29,451 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:28:29,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:28:29,452 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:30,009 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:30,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:30,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:28:30,170 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:28:30,171 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:30,276 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:30,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:30,284 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:30,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:28:30,304 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:30,305 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:28:30,306 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:30,306 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:30,306 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:28:30,317 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:30,320 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,323 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:30,325 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:30,328 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:30,330 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:30,333 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,336 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:30,339 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:30,341 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:30,343 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:30,354 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:30,355 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:28:30,360 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:28:30,360 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:28:30,366 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,366 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:28:30,384 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,385 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:28:30,385 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,405 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,411 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:28:30,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:28:30,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,425 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,425 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,425 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,426 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,426 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:28:30,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,426 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:28:30,427 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,428 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:28:30,428 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,429 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,429 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,429 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,429 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,430 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,430 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:28:30,430 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:28:30,430 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:28:30,430 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:28:30,430 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:28:30,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:28:30,431 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:28:30,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:28:30,432 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:28:30,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:28:30,432 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:28:30,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:28:30,433 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,433 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:28:30,433 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:28:30,437 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:28:30,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:28:30,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:28:30,442 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:28:30,443 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,444 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,444 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:28:30,446 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,446 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,446 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,447 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,492 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3416, Threshold=0.3590, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:28:30,494 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3416
2025-08-04 20:28:41,766 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:41,766 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:28:41,766 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:28:41,766 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:28:41,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:28:41,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:42,068 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:42,068 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:42,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:28:42,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:28:42,187 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:42,305 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:42,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:42,312 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:42,319 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:28:42,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:42,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:28:42,330 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:42,330 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:42,330 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:28:42,341 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:42,344 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,347 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:42,349 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:42,352 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:42,354 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:42,356 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,359 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:42,361 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:42,364 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:42,366 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:42,379 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:42,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:28:42,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:28:42,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:28:42,393 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:42,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:28:42,407 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:42,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:28:42,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:42,426 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:42,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:28:42,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:28:42,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:42,437 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:42,438 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:42,438 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:42,438 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:42,439 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:28:42,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:42,439 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:28:42,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:42,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:28:42,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:28:42,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:42,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:28:42,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:42,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:42,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:42,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:28:42,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:28:42,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:28:42,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:28:42,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:28:42,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:28:42,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:28:42,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:28:42,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:28:42,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:28:42,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:28:42,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:28:42,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:42,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:28:42,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:42,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:42,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:42,449 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:28:42,449 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:28:42,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:28:42,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:28:42,457 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:28:42,457 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:42,459 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:42,459 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:28:42,460 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:42,460 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:42,461 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:42,461 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:42,504 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3380, Threshold=0.3557, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:28:42,504 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3380
2025-08-04 20:28:56,793 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:56,793 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:28:56,793 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:28:56,793 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:28:56,793 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:28:56,793 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:57,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:57,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:57,265 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:28:57,301 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:28:57,301 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:57,396 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:57,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:57,403 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:57,411 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:28:57,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:57,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:28:57,425 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:57,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:57,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:28:57,437 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:57,440 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,443 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:57,445 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:57,448 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:57,450 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:57,453 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,456 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:57,459 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:57,461 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:57,463 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:57,480 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:57,480 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:28:57,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:28:57,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:28:57,492 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:57,493 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:28:57,504 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:57,504 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:28:57,504 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:57,523 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:57,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:28:57,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:28:57,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:57,545 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:57,545 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:57,546 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:57,546 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:57,547 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:28:57,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:57,547 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:28:57,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:57,549 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:28:57,549 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:28:57,550 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:57,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:28:57,550 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:57,550 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:57,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:57,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:28:57,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:28:57,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:28:57,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:28:57,552 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:28:57,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:28:57,552 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:28:57,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:28:57,553 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:28:57,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:28:57,553 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:28:57,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:28:57,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:57,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:28:57,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:57,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:57,558 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:57,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:28:57,558 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:28:57,559 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:28:57,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:28:57,566 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:28:57,566 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:57,567 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:57,567 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:28:57,569 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:57,569 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:57,569 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:57,570 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:57,613 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3423, Threshold=0.3603, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:28:57,613 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3423
2025-08-04 20:29:14,902 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:14,902 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:29:14,902 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:29:14,902 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:29:14,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:29:14,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:15,243 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:15,243 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:15,331 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:29:15,369 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:29:15,369 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:15,465 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:15,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:15,473 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:15,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:29:15,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:15,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:29:15,490 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:15,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:15,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:29:15,501 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:15,504 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:15,507 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:15,509 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:15,512 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:15,514 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:15,517 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:15,519 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:15,522 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:15,524 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:15,526 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:15,536 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:15,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:29:15,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:29:15,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:29:15,545 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:15,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:29:15,556 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:15,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:29:15,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:15,572 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:15,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:29:15,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:29:15,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:15,583 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:15,583 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:15,583 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:15,583 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:15,584 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:29:15,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:15,584 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:29:15,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:15,585 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:29:15,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:29:15,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:15,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:29:15,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:15,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:15,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:15,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:29:15,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:29:15,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:29:15,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:29:15,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:29:15,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:29:15,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:29:15,589 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:29:15,589 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:29:15,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:29:15,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:29:15,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:29:15,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:15,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:29:15,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:15,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:15,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:15,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:29:15,595 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:29:15,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:29:15,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:29:15,599 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:29:15,599 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:15,600 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:15,600 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:29:15,602 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:15,602 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:15,603 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:15,603 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:15,638 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3392, Threshold=0.3578, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:29:15,638 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3392
2025-08-04 20:29:26,914 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:26,914 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:29:26,914 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:29:26,914 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:29:26,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:29:26,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:27,237 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:27,237 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:27,328 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:29:27,356 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:29:27,356 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:27,459 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:27,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:27,467 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:27,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:29:27,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:27,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:29:27,485 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:27,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:27,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:29:27,495 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:27,498 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,500 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:27,502 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:27,505 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:27,507 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:27,509 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,512 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:27,515 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:27,517 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:27,519 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:27,530 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:27,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:29:27,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:29:27,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:29:27,542 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:27,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:29:27,554 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:27,555 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:29:27,555 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:27,571 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:27,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:29:27,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:29:27,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:27,586 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:27,586 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:27,587 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:27,587 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:27,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:29:27,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:27,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:29:27,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:27,589 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:29:27,589 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:29:27,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:27,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:29:27,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:27,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:29:27,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:29:27,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:29:27,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:29:27,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:29:27,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:29:27,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:29:27,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:29:27,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:27,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:29:27,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:27,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:27,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:27,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:29:27,597 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:29:27,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:29:27,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:29:27,604 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:29:27,604 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:27,605 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:27,606 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:29:27,607 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:27,607 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:27,607 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:27,608 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:27,646 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3359, Threshold=0.3549, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:29:27,647 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3359
2025-08-04 20:29:38,916 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:38,916 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:29:38,917 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:29:38,917 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:29:38,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:29:38,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:39,347 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:39,348 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:39,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:29:39,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:29:39,476 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:39,581 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:39,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:39,588 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:39,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:29:39,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:39,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:29:39,605 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:39,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:39,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:29:39,615 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:39,619 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,621 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:39,624 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:39,627 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:39,630 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:39,632 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,635 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:39,637 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:39,639 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:39,642 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:39,651 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:39,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:29:39,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:29:39,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:29:39,664 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:39,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:29:39,676 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:39,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:29:39,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:39,692 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:39,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:29:39,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:29:39,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:39,708 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:39,708 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:39,708 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:39,708 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:39,709 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:29:39,709 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:39,709 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:29:39,709 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:39,711 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:29:39,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:29:39,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:29:39,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:29:39,715 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:29:39,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:29:39,715 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:29:39,716 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:29:39,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:29:39,716 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:29:39,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:29:39,717 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:29:39,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:29:39,717 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:39,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:29:39,717 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:39,718 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:39,722 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:39,722 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:29:39,722 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:29:39,722 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:29:39,722 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:29:39,728 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:29:39,728 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:39,730 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:39,730 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:29:39,731 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:39,731 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:39,732 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:39,732 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:39,770 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3387, Threshold=0.3570, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:29:39,770 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3387
2025-08-04 20:29:45,021 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:45,021 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:29:45,022 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:29:45,022 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:29:45,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:29:45,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:45,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:45,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:45,368 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:29:45,405 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:29:45,405 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:45,498 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:45,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:45,503 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:45,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:29:45,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:45,515 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:29:45,515 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:45,515 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:45,515 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:29:45,524 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:45,527 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:45,529 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:45,532 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:45,535 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:45,537 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:45,539 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:45,542 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:45,545 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:45,547 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:45,550 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:45,559 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:45,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:29:45,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:29:45,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:29:45,570 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:45,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:29:45,579 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:45,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:29:45,581 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:45,597 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:45,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:29:45,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:29:45,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:45,609 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:45,609 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:45,609 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:45,610 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:45,611 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:29:45,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:45,611 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:29:45,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:45,613 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:29:45,613 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:29:45,613 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:45,613 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:29:45,613 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:45,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:45,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:45,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:29:45,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:29:45,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:29:45,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:29:45,615 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:29:45,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:29:45,615 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:29:45,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:29:45,616 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:29:45,616 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:29:45,616 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:29:45,616 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:29:45,616 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:45,616 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:29:45,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:45,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:45,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:45,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:29:45,618 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:29:45,618 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:29:45,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:29:45,625 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:29:45,625 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:45,627 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:45,627 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:29:45,628 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 40/400.
2025-08-04 20:29:45,729 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:45,729 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:45,730 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 15 anomalous samples to GAN training data (target: 15).
2025-08-04 20:29:45,731 - ClientAppLogger [Client 7] - INFO - [Client] Round 40: Training GAN with 66 samples (51 normal, 15 anomalous).
2025-08-04 20:29:45,731 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:45,809 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0856, Avg D Loss: 0.8990
2025-08-04 20:29:45,809 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0856, Avg D Loss: 0.8990
2025-08-04 20:29:45,809 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:45,851 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3473, Threshold=0.3678, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:29:45,851 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7839
2025-08-04 20:29:45,852 - ClientAppLogger [Client 7] - INFO - Fit completed for round 40. Duration: 0.22s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 40, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.085623915267713, 'd_loss': 0.8990208325964032, 'post_fit_local_f1': 0.7839065541855937, 'fit_time_seconds': 0.22352242469787598, 'cpu_percent_fit': 24.3875, 'ram_mb_fit': 3.11328125, 'accumulated_train_samples_this_round': 66}
2025-08-04 20:29:45,852 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:29:54,117 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:54,117 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:29:54,117 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:29:54,117 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:29:54,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:29:54,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:54,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:54,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:54,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:29:54,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:29:54,604 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:54,706 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:54,712 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:54,712 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:54,720 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:29:54,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:54,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:29:54,731 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:54,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:54,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:29:54,740 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:54,743 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,745 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:54,748 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:54,751 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:54,753 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:54,756 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,758 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:54,761 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:54,763 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:54,766 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:54,777 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:54,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:29:54,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:29:54,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:29:54,787 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:54,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:29:54,797 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:54,798 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:29:54,798 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:54,816 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:54,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:29:54,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:29:54,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:54,831 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:54,831 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:54,831 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:54,832 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:54,832 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:29:54,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:54,832 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:29:54,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:54,834 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:29:54,834 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:29:54,834 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:29:54,835 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:29:54,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:29:54,836 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:29:54,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:29:54,836 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:29:54,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:29:54,837 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:29:54,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:29:54,837 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:29:54,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:29:54,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:54,838 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:29:54,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:54,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:54,839 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:54,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:29:54,839 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:29:54,839 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:29:54,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:29:54,843 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:29:54,843 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:54,844 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:54,845 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:29:54,846 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:54,846 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:54,846 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:54,847 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:54,886 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3455, Threshold=0.3645, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:29:54,886 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3455
