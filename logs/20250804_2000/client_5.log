2025-08-04 20:21:12,238 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:12,238 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:12,243 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:12,244 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:12,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:12,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:13,254 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:13,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:13,372 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:13,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:13,409 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:13,667 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:13,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:13,681 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:13,690 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:13,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:13,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:13,701 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:13,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:13,701 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:13,713 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:13,716 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,719 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:13,723 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:13,728 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:13,731 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:13,735 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:13,743 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:13,748 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:13,751 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:13,768 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:13,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:13,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:13,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:13,786 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:13,787 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:13,806 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:13,807 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:13,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:13,832 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:13,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:13,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:13,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:13,870 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:13,871 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:13,872 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:13,873 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:13,873 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:13,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:13,875 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:13,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:13,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:13,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:13,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:13,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:13,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:13,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:13,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:13,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:13,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:13,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:13,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:13,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:13,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:13,885 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:13,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:13,886 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:13,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:13,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:13,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:13,889 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:13,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:13,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:13,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:13,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:13,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:13,893 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:13,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:13,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:13,907 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:13,908 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:13,910 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:13,911 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:13,913 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:13,914 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:13,914 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:13,915 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:13,955 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5013, Accuracy=0.5274, F1=0.6697, Precision=0.7984, Recall=0.5767
2025-08-04 20:21:13,955 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5274, F1: 0.6697, Prec: 0.7984, Rec: 0.5767, Avg Anomaly Score: 0.5017
2025-08-04 20:21:22,274 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:22,274 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:22,274 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:22,274 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:22,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:22,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:22,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:22,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:22,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:22,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:22,764 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:22,910 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:22,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:22,916 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:22,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:22,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:22,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:22,927 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:22,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:22,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:22,937 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:22,939 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:22,942 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:22,944 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:22,946 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:22,948 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:22,951 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:22,954 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:22,957 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:22,959 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:22,961 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:22,971 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:22,971 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:22,976 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:22,976 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:22,981 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:22,981 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:22,991 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:22,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:22,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:23,008 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:23,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:23,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:23,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:23,020 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:23,020 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:23,021 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:23,021 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:23,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:23,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:23,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:23,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:23,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:23,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:23,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:23,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:23,024 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:23,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:23,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:23,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:23,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:23,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:23,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:23,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:23,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:23,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:23,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:23,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:23,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:23,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:23,027 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:23,027 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:23,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:23,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:23,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:23,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:23,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:23,029 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:23,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:23,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:23,034 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:23,034 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:23,036 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:23,036 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:23,037 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 2/400.
2025-08-04 20:21:23,138 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:23,138 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:23,139 - ClientAppLogger [Client 5] - INFO - [Client] Round 2: No training samples to include (0 calculated). Skipping GAN training logic.
2025-08-04 20:21:23,140 - ClientAppLogger [Client 5] - INFO - Fit completed for round 2. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 2, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10222864151000977, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:21:23,140 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:21:28,443 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:28,443 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:28,444 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:28,444 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:28,444 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:28,444 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:29,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:29,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:29,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:29,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:29,672 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:29,890 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:29,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:29,904 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:29,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:30,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:30,054 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:30,055 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:30,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:30,055 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:30,067 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:30,071 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,074 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:30,077 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:30,081 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:30,084 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:30,089 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,092 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:30,097 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:30,100 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:30,104 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:30,118 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:30,118 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:30,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:30,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:30,134 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:30,149 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,149 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:30,150 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,166 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:30,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:30,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,182 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,183 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,183 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,183 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,184 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:30,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,184 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:30,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,186 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:30,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,186 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,187 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,187 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,187 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,187 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:30,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:30,188 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:30,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:30,188 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:30,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:30,188 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:30,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:30,189 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:30,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:30,189 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:30,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:30,189 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:30,190 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,190 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,190 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,190 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:30,190 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:30,191 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:30,191 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:30,196 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:30,197 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,198 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,198 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:30,200 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,200 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,202 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,204 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,227 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5013, Accuracy=0.5274, F1=0.6697, Precision=0.7984, Recall=0.5767
2025-08-04 20:21:30,228 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5274, F1: 0.6697, Prec: 0.7984, Rec: 0.5767, Avg Anomaly Score: 0.5017
2025-08-04 20:21:35,487 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:35,487 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:35,487 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:35,487 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:35,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:35,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:35,741 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:35,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:35,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:35,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:35,869 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:35,977 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:35,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:35,983 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:35,988 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:35,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:35,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:35,997 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:35,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:35,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:36,006 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:36,008 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:36,010 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:36,013 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:36,015 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:36,017 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:36,020 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:36,022 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:36,025 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:36,027 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:36,029 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:36,038 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:36,039 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:36,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:36,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:36,049 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:36,049 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:36,059 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:36,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:36,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:36,074 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:36,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:36,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:36,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:36,084 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:36,084 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:36,084 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:36,085 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:36,085 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:36,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:36,085 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:36,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:36,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:36,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:36,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:36,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:36,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:36,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:36,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:36,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:36,090 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:36,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:36,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:36,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:36,091 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:36,091 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:36,091 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:36,091 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:36,097 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:36,097 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:36,099 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:36,099 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:36,100 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 3/400.
2025-08-04 20:21:36,201 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:36,201 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:36,202 - ClientAppLogger [Client 5] - INFO - [Client] Round 3: No NORMAL samples found in the 1 cumulative samples. Skipping GAN training logic.
2025-08-04 20:21:36,202 - ClientAppLogger [Client 5] - INFO - Fit completed for round 3. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 3, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10197710990905762, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.62109375, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:21:36,202 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:21:41,498 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,498 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:41,498 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:41,498 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:41,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:41,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:42,112 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:42,112 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:42,233 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:42,284 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:42,284 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,423 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,436 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:42,460 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,460 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,461 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,461 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:42,474 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,478 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,481 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,484 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,488 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,490 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,498 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,502 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,506 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,508 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,511 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,525 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:42,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:42,542 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,543 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:42,573 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:42,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,599 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:42,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:42,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,624 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,624 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,624 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,624 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:42,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,625 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:42,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,627 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:42,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:42,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:42,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:42,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:42,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:42,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:42,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:42,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:42,631 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:42,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:42,631 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:42,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,633 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:42,633 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:42,633 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:42,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:42,636 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:42,636 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,638 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,638 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:42,640 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,641 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,641 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,642 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,672 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5077, Accuracy=0.5339, F1=0.6742, Precision=0.8038, Recall=0.5806
2025-08-04 20:21:42,672 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5339, F1: 0.6742, Prec: 0.8038, Rec: 0.5806, Avg Anomaly Score: 0.5078
2025-08-04 20:21:47,929 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:47,929 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:47,929 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:47,930 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:47,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:47,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:48,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:48,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:48,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:48,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:48,346 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:48,472 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:48,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:48,479 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:48,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:48,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:48,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:48,496 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:48,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:48,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:48,505 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:48,508 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:48,511 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:48,513 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:48,515 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:48,518 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:48,521 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:48,523 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:48,526 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:48,528 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:48,531 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:48,542 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:48,542 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:48,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:48,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:48,555 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:48,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:48,570 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:48,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:48,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:48,584 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:48,589 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:48,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:48,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:48,594 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:48,594 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:48,595 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:48,595 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:48,595 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:48,595 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:48,595 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:48,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:48,597 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:48,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:48,597 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:48,597 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:48,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:48,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:48,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:48,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:48,598 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:48,598 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:48,599 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:48,599 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:48,599 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:48,599 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:48,599 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:48,599 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:48,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:48,600 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:48,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:48,600 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:48,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:48,600 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:48,601 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:48,601 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:48,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:48,601 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:48,601 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:48,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:48,608 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:48,608 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:48,609 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:48,609 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:48,611 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 4/400.
2025-08-04 20:21:48,712 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:48,712 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:48,713 - ClientAppLogger [Client 5] - INFO - [Client] Round 4: No NORMAL samples found in the 1 cumulative samples. Skipping GAN training logic.
2025-08-04 20:21:48,713 - ClientAppLogger [Client 5] - INFO - Fit completed for round 4. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 4, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10222053527832031, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:21:48,713 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:21:53,992 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:53,993 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:21:53,993 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:21:53,993 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:21:53,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:21:53,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:21:54,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:21:54,771 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:54,934 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:54,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:54,946 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:54,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:21:54,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:54,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:21:54,966 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:54,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:54,967 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:21:54,980 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:54,985 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,989 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:54,992 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:54,996 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:54,998 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:55,001 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,005 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:55,008 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:55,011 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:55,014 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:55,029 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:55,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:21:55,036 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:21:55,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:21:55,046 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:55,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:21:55,081 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:55,082 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:21:55,082 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:55,115 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:55,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:21:55,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:21:55,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:55,128 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:55,128 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:55,129 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:55,129 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:55,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:21:55,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:55,130 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:21:55,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:55,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:21:55,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:21:55,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:55,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:21:55,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:55,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:55,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:55,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:21:55,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:21:55,135 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:21:55,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:21:55,135 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:21:55,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:21:55,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:21:55,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:21:55,136 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:21:55,136 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:21:55,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:21:55,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:21:55,137 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:55,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:21:55,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:55,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:55,138 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:55,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:21:55,139 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:21:55,139 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:21:55,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:21:55,144 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:21:55,144 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:55,146 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:55,146 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:21:55,147 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:55,148 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:55,148 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:55,149 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:55,171 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.4919, F1=0.6449, Precision=0.7688, Recall=0.5553
2025-08-04 20:21:55,172 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.4919, F1: 0.6449, Prec: 0.7688, Rec: 0.5553, Avg Anomaly Score: 0.5085
2025-08-04 20:22:03,436 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:03,436 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:03,436 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:03,436 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:03,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:03,436 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:03,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:03,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:03,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:03,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:03,882 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:04,009 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:04,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:04,015 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:04,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:04,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:04,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:04,031 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:04,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:04,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:04,040 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:04,044 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:04,046 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:04,048 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:04,051 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:04,053 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:04,056 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:04,058 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:04,061 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:04,063 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:04,065 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:04,074 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:04,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:04,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:04,080 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:04,085 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:04,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:04,098 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:04,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:04,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:04,114 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:04,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:04,124 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:04,124 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:04,124 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:04,125 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:04,125 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:04,125 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:04,126 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:04,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:04,126 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:04,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:04,128 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:04,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:04,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:04,129 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:04,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:04,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:04,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:04,129 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:04,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:04,130 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:04,130 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:04,130 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:04,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:04,131 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:04,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:04,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:04,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:04,132 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:04,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:04,133 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:04,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:04,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:04,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:04,134 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:04,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:04,135 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:04,135 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:04,135 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:04,145 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:04,145 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:04,147 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:04,148 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:04,150 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 5/400.
2025-08-04 20:22:04,251 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:04,251 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:04,252 - ClientAppLogger [Client 5] - INFO - [Client] Round 5: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:04,252 - ClientAppLogger [Client 5] - INFO - Fit completed for round 5. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 5, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10244917869567871, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:04,252 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:22:09,550 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,550 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:09,550 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:09,550 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:09,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:09,551 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:10,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:10,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:10,119 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:10,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:10,174 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:10,325 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:10,334 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:10,334 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:10,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:10,349 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:10,349 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:10,350 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:10,350 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:10,350 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:10,360 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:10,363 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,366 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:10,368 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:10,370 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:10,373 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:10,375 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,378 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:10,381 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:10,383 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:10,386 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:10,401 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:10,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:10,407 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:10,407 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:10,417 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:10,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:10,442 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:10,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:10,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:10,469 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:10,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:10,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:10,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:10,487 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:10,488 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:10,488 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:10,488 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:10,489 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:10,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:10,489 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:10,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:10,491 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:10,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:10,492 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:10,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:10,492 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:10,493 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:10,493 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:10,493 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:10,493 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:10,494 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:10,494 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:10,494 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:10,494 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:10,495 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:10,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:10,495 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:10,495 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:10,496 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:10,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:10,496 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:10,496 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:10,497 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:10,497 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:10,497 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:10,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:10,498 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:10,498 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:10,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:10,506 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:10,507 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,509 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,509 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:10,511 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,512 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,512 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,513 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,530 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.4758, F1=0.6336, Precision=0.7554, Recall=0.5456
2025-08-04 20:22:10,530 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.4758, F1: 0.6336, Prec: 0.7554, Rec: 0.5456, Avg Anomaly Score: 0.5085
2025-08-04 20:22:18,809 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:18,809 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:18,809 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:18,809 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:18,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:18,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:19,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:19,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:19,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:19,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:19,212 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:19,325 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:19,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:19,331 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:19,337 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:19,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:19,345 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:19,346 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:19,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:19,346 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:19,354 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:19,357 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:19,359 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:19,361 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:19,364 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:19,366 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:19,369 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:19,371 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:19,374 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:19,376 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:19,378 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:19,387 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:19,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:19,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:19,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:19,397 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:19,397 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:19,408 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:19,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:19,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:19,423 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:19,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:19,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:19,434 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:19,434 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:19,434 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:19,434 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:19,434 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:19,435 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:19,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:19,435 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:19,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:19,437 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:19,438 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:19,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:19,439 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:19,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:19,439 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:19,439 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:19,439 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:19,440 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:19,440 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:19,440 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:19,440 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:19,440 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:19,441 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:19,450 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:19,450 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:19,451 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:19,451 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:19,452 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 6/400.
2025-08-04 20:22:19,554 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:19,554 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:19,555 - ClientAppLogger [Client 5] - INFO - [Client] Round 6: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:19,555 - ClientAppLogger [Client 5] - INFO - Fit completed for round 6. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 6, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10256695747375488, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:19,555 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:22:24,865 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,865 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:24,865 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:24,866 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:24,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:24,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:25,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:25,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:25,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:25,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:25,394 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:25,494 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:25,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:25,502 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:25,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:25,515 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:25,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:25,516 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:25,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:25,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:25,526 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:25,529 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,531 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:25,533 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:25,536 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:25,538 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:25,541 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,544 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:25,547 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:25,550 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:25,553 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:25,564 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:25,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:25,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:25,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:25,574 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:25,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:25,586 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:25,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:25,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:25,607 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:25,614 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:25,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:25,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:25,624 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:25,625 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:25,625 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:25,625 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:25,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:25,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:25,626 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:25,627 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:25,628 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:25,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:25,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:25,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:25,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:25,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:25,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:25,630 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:25,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:25,631 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:25,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:25,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:25,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:25,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:25,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:25,633 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:25,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:25,634 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:25,634 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:25,634 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:25,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:25,636 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:25,636 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:25,637 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:25,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:25,638 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:25,639 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:25,639 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:25,644 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:25,645 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:25,647 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:25,647 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:25,649 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:25,649 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:25,649 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:25,650 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:25,678 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.4790, F1=0.6359, Precision=0.7581, Recall=0.5476
2025-08-04 20:22:25,678 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.4790, F1: 0.6359, Prec: 0.7581, Rec: 0.5476, Avg Anomaly Score: 0.5053
2025-08-04 20:22:33,955 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:33,955 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:33,955 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:33,955 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:33,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:33,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:34,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:34,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:34,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:34,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:34,360 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:34,492 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:34,498 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:34,499 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:34,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:34,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:34,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:34,522 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:34,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:34,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:34,532 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:34,535 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:34,537 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:34,540 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:34,543 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:34,545 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:34,547 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:34,550 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:34,553 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:34,555 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:34,558 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:34,567 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:34,567 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:34,572 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:34,572 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:34,577 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:34,577 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:34,587 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:34,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:34,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:34,605 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:34,610 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:34,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:34,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:34,615 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:34,616 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:34,616 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:34,616 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:34,617 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:34,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:34,617 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:34,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:34,619 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:34,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:34,619 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:34,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:34,620 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:34,621 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:34,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:34,621 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:34,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:34,621 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:34,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:34,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:34,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:34,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:34,622 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:34,622 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:34,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:34,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:34,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:34,623 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:34,623 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:34,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:34,631 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:34,631 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:34,632 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:34,632 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:34,634 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 7/400.
2025-08-04 20:22:34,734 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:34,735 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:34,736 - ClientAppLogger [Client 5] - INFO - [Client] Round 7: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:34,736 - ClientAppLogger [Client 5] - INFO - Fit completed for round 7. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 7, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10249876976013184, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:34,737 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:22:40,030 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:40,030 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:40,031 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:40,031 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:40,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:40,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:40,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:40,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:40,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:40,766 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,923 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,934 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:40,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,960 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,960 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,960 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:40,971 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,974 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,977 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:40,979 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:40,983 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:40,985 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:40,988 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,991 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:40,994 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:40,996 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:40,998 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:41,011 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:41,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:41,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:41,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:41,024 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:41,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:41,036 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:41,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:41,037 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:41,055 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:41,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:41,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:41,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:41,069 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:41,069 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:41,069 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:41,069 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:41,070 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:41,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:41,070 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:41,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:41,072 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:41,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:41,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:41,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:41,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:41,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:41,073 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:41,074 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:41,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:41,074 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:41,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:41,078 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:41,078 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:41,079 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:41,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:41,079 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:41,079 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:41,079 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:41,080 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:41,080 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:41,080 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:41,080 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:41,080 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:41,081 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:41,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:41,081 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:41,081 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:41,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:41,085 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:41,085 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:41,087 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:41,087 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:41,089 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:41,089 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:41,089 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:41,090 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:41,110 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4971, Threshold=0.4943, Accuracy=0.4758, F1=0.6336, Precision=0.7554, Recall=0.5456
2025-08-04 20:22:41,110 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.4758, F1: 0.6336, Prec: 0.7554, Rec: 0.5456, Avg Anomaly Score: 0.4971
2025-08-04 20:22:46,363 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:46,364 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:46,364 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:46,364 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:46,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:46,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:46,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:46,618 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:46,707 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:46,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:46,719 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:46,805 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:46,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:46,810 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:46,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:46,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:46,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:46,821 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:46,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:46,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:46,830 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:46,833 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:46,835 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:46,837 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:46,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:46,842 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:46,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:46,847 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:46,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:46,852 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:46,855 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:46,864 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:46,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:46,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:46,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:46,874 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:46,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:46,882 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:46,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:46,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:46,899 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:46,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:46,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:46,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:46,909 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:46,909 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:46,909 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:46,910 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:46,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:46,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:46,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:46,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:46,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:46,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:46,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:46,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:46,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:46,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:46,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:46,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:46,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:46,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:46,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:46,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:46,915 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:46,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:46,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:46,917 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:46,918 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:46,919 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:46,919 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:46,920 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 8/400.
2025-08-04 20:22:47,021 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:47,021 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:47,022 - ClientAppLogger [Client 5] - INFO - [Client] Round 8: No NORMAL samples found in the 3 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:47,022 - ClientAppLogger [Client 5] - INFO - Fit completed for round 8. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 8, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10226225852966309, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:47,023 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:22:52,274 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:52,274 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:52,274 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:52,274 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:52,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:52,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:52,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:52,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:52,698 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:52,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:52,748 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:52,884 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:52,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:52,894 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:52,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:52,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:52,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:52,924 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:52,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:52,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:52,935 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:52,940 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:52,942 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:52,944 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:52,947 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:52,950 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:52,952 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:52,955 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:52,958 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:52,960 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:52,962 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:52,977 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:52,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:52,982 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:52,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:52,993 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:52,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:53,008 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:53,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:53,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:53,025 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:53,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:53,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:53,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:53,038 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:53,039 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:53,039 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:53,039 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:53,040 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:53,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:53,040 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:53,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:53,042 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:53,043 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:53,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:53,044 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:53,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:53,044 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:53,044 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:53,044 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:53,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:53,045 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:53,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:53,045 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:53,045 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:53,046 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:53,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:53,046 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:53,046 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:53,046 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:53,050 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:53,051 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:53,052 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:53,052 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:53,054 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:53,054 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:53,054 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:53,055 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:53,071 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4817, Threshold=0.4777, Accuracy=0.4823, F1=0.6381, Precision=0.7608, Recall=0.5495
2025-08-04 20:22:53,072 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.4823, F1: 0.6381, Prec: 0.7608, Rec: 0.5495, Avg Anomaly Score: 0.4817
2025-08-04 20:22:58,322 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:58,322 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:22:58,322 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:22:58,323 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:22:58,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:22:58,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:58,577 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:58,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:58,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:22:58,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:22:58,681 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:58,772 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:58,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:58,777 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:58,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:22:58,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:58,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:22:58,790 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:58,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:58,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:22:58,798 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:58,801 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:58,804 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:58,806 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:58,809 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:58,811 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:58,813 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:58,816 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:58,819 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:58,821 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:58,823 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:58,833 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:58,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:22:58,838 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:22:58,838 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:22:58,843 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:58,843 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:22:58,851 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:58,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:22:58,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:58,866 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:58,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:22:58,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:22:58,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:58,875 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:58,875 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:58,876 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:58,876 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:58,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:22:58,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:58,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:22:58,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:58,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:22:58,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:22:58,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:58,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:22:58,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:22:58,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:22:58,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:22:58,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:22:58,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:22:58,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:22:58,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:22:58,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:58,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:22:58,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:58,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:58,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:58,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:22:58,882 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:22:58,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:22:58,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:22:58,886 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:22:58,886 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:58,887 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:58,888 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:22:58,889 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 9/400.
2025-08-04 20:22:58,990 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:58,990 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:58,991 - ClientAppLogger [Client 5] - INFO - [Client] Round 9: No NORMAL samples found in the 3 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:58,992 - ClientAppLogger [Client 5] - INFO - Fit completed for round 9. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 9, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10280776023864746, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:58,992 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:23:04,245 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:04,245 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:04,245 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:04,245 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:04,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:04,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:04,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:04,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:04,611 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:04,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:04,663 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:04,782 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:04,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:04,789 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:04,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:04,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:04,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:04,803 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:04,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:04,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:04,812 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:04,815 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:04,818 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:04,820 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:04,823 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:04,825 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:04,828 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:04,831 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:04,834 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:04,836 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:04,839 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:04,848 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:04,848 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:04,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:04,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:04,862 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:04,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:04,875 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:04,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:04,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:04,893 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:04,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:04,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:04,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:04,909 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:04,909 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:04,909 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:04,910 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:04,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:04,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:04,910 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:04,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:04,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:04,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:04,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:04,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:04,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:04,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:04,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:04,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:04,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:04,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:04,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:04,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:04,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:04,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:04,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:04,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:04,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:04,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:04,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:04,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:04,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:04,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:04,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:04,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:04,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:04,917 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:04,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:04,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:04,921 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:04,921 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:04,923 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:04,923 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:04,925 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:04,925 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:04,925 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:04,926 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:04,947 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4584, Threshold=0.4523, Accuracy=0.5081, F1=0.6561, Precision=0.7823, Recall=0.5650
2025-08-04 20:23:04,947 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5081, F1: 0.6561, Prec: 0.7823, Rec: 0.5650, Avg Anomaly Score: 0.4584
2025-08-04 20:23:13,225 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:13,225 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:13,225 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:13,225 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:13,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:13,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:13,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:13,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:13,561 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:13,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:13,575 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:13,658 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:13,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:13,664 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:13,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:13,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:13,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:13,674 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:13,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:13,674 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:13,682 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:13,685 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:13,687 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:13,689 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:13,692 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:13,695 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:13,697 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:13,700 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:13,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:13,705 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:13,707 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:13,716 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:13,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:13,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:13,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:13,727 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:13,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:13,736 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:13,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:13,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:13,751 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:13,756 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:13,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:13,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:13,760 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:13,760 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:13,761 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:13,761 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:13,761 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:13,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:13,762 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:13,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:13,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:13,763 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:13,763 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:13,763 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:13,764 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:13,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:13,765 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:13,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:13,765 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:13,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:13,766 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:13,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:13,767 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:13,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:13,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:13,769 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:13,769 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:13,770 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:13,770 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:13,771 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 10/400.
2025-08-04 20:23:13,872 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:13,873 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:13,874 - ClientAppLogger [Client 5] - INFO - [Client] Round 10: No NORMAL samples found in the 4 cumulative samples. Skipping GAN training logic.
2025-08-04 20:23:13,874 - ClientAppLogger [Client 5] - INFO - Fit completed for round 10. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 10, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.1022348403930664, 'cpu_percent_fit': 42.85625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:23:13,874 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:23:19,151 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:19,152 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:19,152 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:19,152 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:19,152 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:19,152 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,549 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,549 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:19,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:19,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:19,687 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:19,867 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:19,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:19,875 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:19,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:19,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:19,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:19,896 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:19,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:19,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:19,907 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:19,910 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,913 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:19,915 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:19,918 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:19,921 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:19,923 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,926 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:19,929 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:19,932 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:19,934 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:19,946 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:19,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:19,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:19,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:19,957 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:19,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:19,972 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:19,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:19,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:19,991 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:19,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:20,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:20,005 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:20,006 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:20,006 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:20,006 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:20,007 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:20,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:20,007 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:20,007 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:20,008 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:20,009 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:20,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:20,010 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:20,011 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:20,011 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:20,011 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:20,011 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:20,011 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:20,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:20,012 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:20,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:20,012 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:20,012 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:20,013 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:20,013 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:20,014 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:20,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:20,014 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:20,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:20,014 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:20,014 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:20,015 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:20,015 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:20,015 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:20,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:20,016 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:20,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:20,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:20,023 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:20,023 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:20,024 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:20,025 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:20,027 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:20,027 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:20,027 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:20,028 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:20,046 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4200, Threshold=0.4109, Accuracy=0.5081, F1=0.6561, Precision=0.7823, Recall=0.5650
2025-08-04 20:23:20,047 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5081, F1: 0.6561, Prec: 0.7823, Rec: 0.5650, Avg Anomaly Score: 0.4200
2025-08-04 20:23:25,323 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:25,323 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:25,323 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:25,323 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:25,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:25,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:25,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:25,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:25,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:25,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:25,719 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:25,808 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:25,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:25,815 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:25,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:25,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:25,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:25,829 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:25,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:25,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:25,837 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:25,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:25,843 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:25,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:25,847 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:25,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:25,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:25,855 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:25,858 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:25,860 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:25,862 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:25,870 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:25,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:25,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:25,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:25,880 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:25,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:25,888 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:25,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:25,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:25,904 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:25,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:25,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:25,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:25,914 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:25,914 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:25,914 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:25,915 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:25,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:25,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:25,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:25,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:25,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:25,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:25,918 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:25,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:25,918 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:25,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:25,918 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:25,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:25,919 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:25,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:25,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:25,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:25,920 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:25,920 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:25,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:25,924 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:25,924 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:25,925 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:25,926 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:25,927 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 11/400.
2025-08-04 20:23:26,028 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:26,029 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:26,030 - ClientAppLogger [Client 5] - INFO - [Client] Round 11: No NORMAL samples found in the 4 cumulative samples. Skipping GAN training logic.
2025-08-04 20:23:26,030 - ClientAppLogger [Client 5] - INFO - Fit completed for round 11. Duration: 0.10s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 11, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.1029517650604248, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:23:26,030 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:23:31,307 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:31,307 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:31,308 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:31,308 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:31,308 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:31,308 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:31,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:31,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:31,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:31,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:31,863 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:32,032 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:32,040 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:32,040 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:32,047 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:32,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:32,068 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:32,069 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:32,069 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:32,070 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:32,079 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:32,083 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,086 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:32,090 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:32,092 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:32,095 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:32,098 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,100 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:32,103 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:32,105 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:32,107 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:32,122 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:32,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:32,127 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:32,127 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:32,134 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:32,134 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:32,147 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:32,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:32,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:32,167 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:32,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:32,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:32,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:32,181 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:32,182 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:32,182 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:32,182 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:32,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:32,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:32,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:32,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:32,185 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:32,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:32,185 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:32,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:32,186 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:32,186 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:32,186 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:32,187 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:32,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:32,187 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:32,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:32,188 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:32,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:32,188 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:32,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:32,189 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:32,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:32,189 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:32,189 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:32,189 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:32,190 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:32,190 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:32,190 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:32,190 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:32,191 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:32,191 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:32,191 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:32,191 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:32,200 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:32,200 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:32,201 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:32,201 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:32,203 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:32,203 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:32,203 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:32,203 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:32,220 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3637, Threshold=0.3516, Accuracy=0.5048, F1=0.6539, Precision=0.7796, Recall=0.5631
2025-08-04 20:23:32,220 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5048, F1: 0.6539, Prec: 0.7796, Rec: 0.5631, Avg Anomaly Score: 0.3637
2025-08-04 20:23:46,583 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:46,583 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:46,583 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:46,583 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:46,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:46,584 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:46,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:46,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:47,091 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:47,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:47,125 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:47,248 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:47,256 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:47,256 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:47,265 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:47,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:47,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:47,277 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:47,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:47,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:47,288 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:47,291 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,294 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:47,297 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:47,300 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:47,302 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:47,305 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,307 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:47,310 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:47,312 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:47,314 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:47,326 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:47,326 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:47,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:47,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:47,339 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:47,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:47,352 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:47,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:47,353 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:47,369 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:47,375 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:47,384 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:47,384 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:47,384 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:47,385 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:47,385 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:47,385 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:47,385 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:47,386 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:47,386 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:47,386 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:47,387 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:47,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:47,388 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:47,388 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:47,388 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:47,388 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:47,389 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:47,389 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:47,389 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:47,389 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:47,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:47,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:47,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:47,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:47,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:47,390 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:47,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:47,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:47,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:47,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:47,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:47,391 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:47,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:47,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:47,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:47,392 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:47,393 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:47,393 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:47,397 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:47,397 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:47,399 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:47,399 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:47,400 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:47,400 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:47,401 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:47,401 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:47,418 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3028, Threshold=0.2956, Accuracy=0.5145, F1=0.6607, Precision=0.7876, Recall=0.5689
2025-08-04 20:23:47,418 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5145, F1: 0.6607, Prec: 0.7876, Rec: 0.5689, Avg Anomaly Score: 0.3028
2025-08-04 20:23:52,670 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:52,670 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:23:52,670 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:23:52,671 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:23:52,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:23:52,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:52,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:52,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:53,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:23:53,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:23:53,029 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:53,110 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:53,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:53,117 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:53,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:23:53,127 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:53,127 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:23:53,128 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:53,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:53,128 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:23:53,136 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:53,139 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:53,141 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:53,143 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:53,146 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:53,148 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:53,151 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:53,153 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:53,156 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:53,158 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:53,160 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:53,169 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:53,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:23:53,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:23:53,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:23:53,179 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:53,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:23:53,188 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:53,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:23:53,188 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:53,202 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:53,207 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:23:53,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:23:53,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:53,212 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:53,212 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:53,212 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:53,213 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:53,213 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:23:53,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:53,213 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:23:53,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:53,215 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:23:53,215 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:23:53,215 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:23:53,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:23:53,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:23:53,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:23:53,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:23:53,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:23:53,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:23:53,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:23:53,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:23:53,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:23:53,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:23:53,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:53,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:23:53,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:53,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:53,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:53,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:23:53,219 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:23:53,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:23:53,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:23:53,222 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:23:53,222 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:53,223 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:53,223 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:23:53,225 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 13/400.
2025-08-04 20:23:53,325 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:53,326 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:53,327 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 4, target: 0). GAN training with normal data only.
2025-08-04 20:23:53,328 - ClientAppLogger [Client 5] - INFO - [Client] Round 13: Training GAN with 1 samples (1 normal, 0 anomalous).
2025-08-04 20:23:53,328 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:55,012 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0689, Avg D Loss: 0.7988
2025-08-04 20:23:55,012 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0689, Avg D Loss: 0.7988
2025-08-04 20:23:55,013 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:55,027 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2937, Threshold=0.2864, Accuracy=0.5145, F1=0.6607, Precision=0.7876, Recall=0.5689
2025-08-04 20:23:55,027 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.6607
2025-08-04 20:23:55,028 - ClientAppLogger [Client 5] - INFO - Fit completed for round 13. Duration: 1.80s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 13, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0688678503036497, 'd_loss': 0.7987780809402466, 'post_fit_local_f1': 0.6606538895152199, 'fit_time_seconds': 1.8028032779693604, 'cpu_percent_fit': 5.9875, 'ram_mb_fit': 117.875, 'accumulated_train_samples_this_round': 1}
2025-08-04 20:23:55,028 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:24:00,308 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:00,308 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:00,308 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:00,308 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:00,308 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:00,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:00,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:00,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:00,751 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:00,800 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:00,800 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:00,915 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:00,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:00,921 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:00,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:00,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:00,931 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:00,932 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:00,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:00,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:00,940 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:00,943 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,945 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:00,947 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:00,949 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:00,951 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:00,954 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,956 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:00,959 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:00,961 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:00,963 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:00,972 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:00,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:00,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:00,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:00,981 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:00,981 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:00,990 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:00,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:00,990 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:01,004 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:01,009 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:01,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:01,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:01,015 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:01,015 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:01,016 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:01,016 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:01,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:01,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:01,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:01,017 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:01,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:01,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:01,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:01,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:01,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:01,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:01,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:01,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:01,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:01,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:01,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:01,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:01,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:01,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:01,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:01,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:01,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:01,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:01,022 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:01,022 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:01,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:01,025 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:01,026 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:01,027 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:01,027 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:01,028 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:01,029 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:01,029 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:01,029 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:01,045 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3047, Threshold=0.3025, Accuracy=0.5500, F1=0.6855, Precision=0.8172, Recall=0.5903
2025-08-04 20:24:01,045 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.5500, F1: 0.6855, Prec: 0.8172, Rec: 0.5903, Avg Anomaly Score: 0.3047
2025-08-04 20:24:06,300 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:06,301 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:06,301 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:06,301 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:06,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:06,301 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:06,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:06,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:06,659 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:06,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:06,695 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:06,787 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:06,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:06,792 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:06,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:06,803 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:06,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:06,812 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:06,815 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:06,817 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:06,819 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:06,822 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:06,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:06,826 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:06,829 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:06,832 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:06,834 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:06,836 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:06,844 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:06,844 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:06,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:06,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:06,854 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:06,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:06,862 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:06,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:06,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:06,880 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:06,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:06,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:06,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:06,890 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:06,890 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:06,890 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:06,891 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:06,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:06,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:06,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:06,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:06,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:06,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:06,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:06,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:06,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:06,896 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:06,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:06,896 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:06,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:06,896 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:06,897 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:06,897 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:06,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:06,897 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:06,897 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:06,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:06,901 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:06,901 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:06,902 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:06,903 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:06,904 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 14/400.
2025-08-04 20:24:07,005 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:07,005 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:07,006 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 4, target: 0). GAN training with normal data only.
2025-08-04 20:24:07,006 - ClientAppLogger [Client 5] - INFO - [Client] Round 14: Training GAN with 1 samples (1 normal, 0 anomalous).
2025-08-04 20:24:07,006 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:07,028 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0675, Avg D Loss: 0.7868
2025-08-04 20:24:07,028 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0675, Avg D Loss: 0.7868
2025-08-04 20:24:07,028 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:07,042 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2957, Threshold=0.2933, Accuracy=0.5500, F1=0.6855, Precision=0.8172, Recall=0.5903
2025-08-04 20:24:07,042 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.6855
2025-08-04 20:24:07,043 - ClientAppLogger [Client 5] - INFO - Fit completed for round 14. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 14, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0674916982650755, 'd_loss': 0.7867570340633392, 'post_fit_local_f1': 0.685456595264938, 'fit_time_seconds': 0.13849949836730957, 'cpu_percent_fit': 44.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1}
2025-08-04 20:24:07,043 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:24:12,325 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:12,325 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:12,325 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:12,325 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:12,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:12,326 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:12,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:12,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:12,743 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:12,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:12,777 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:12,862 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:12,868 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:12,868 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:12,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:12,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:12,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:12,883 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:12,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:12,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:12,892 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:12,895 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,898 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:12,900 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:12,903 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:12,905 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:12,908 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,910 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:12,913 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:12,915 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:12,917 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:12,927 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:12,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:12,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:12,932 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:12,937 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:12,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:12,946 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:12,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:12,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:12,961 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:12,966 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:12,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:12,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:12,972 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:12,973 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:12,973 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:12,973 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:12,973 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:12,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:12,974 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:12,974 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:12,975 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:12,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:12,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:12,976 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:12,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:12,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:12,976 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:12,977 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:12,978 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:12,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:12,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:12,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:12,979 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:12,979 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:12,979 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:12,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:12,983 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:12,983 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:12,985 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:12,985 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:12,986 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:12,987 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:12,987 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:12,987 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:13,002 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3223, Threshold=0.3240, Accuracy=0.6081, F1=0.7260, Precision=0.8656, Recall=0.6252
2025-08-04 20:24:13,002 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6081, F1: 0.7260, Prec: 0.8656, Rec: 0.6252, Avg Anomaly Score: 0.3223
2025-08-04 20:24:18,271 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:18,271 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:18,271 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:18,271 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:18,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:18,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:18,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:18,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:18,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:18,708 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:18,708 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:18,826 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:18,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:18,831 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:18,837 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:18,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:18,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:18,843 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:18,843 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:18,843 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:18,851 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:18,854 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:18,857 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:18,859 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:18,862 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:18,864 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:18,866 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:18,869 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:18,871 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:18,873 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:18,875 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:18,884 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:18,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:18,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:18,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:18,894 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:18,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:18,903 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:18,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:18,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:18,920 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:18,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:18,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:18,933 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:18,933 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:18,933 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:18,934 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:18,934 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:18,934 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:18,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:18,935 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:18,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:18,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:18,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:18,936 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:18,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:18,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:18,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:18,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:18,938 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:18,938 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:18,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:18,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:18,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:18,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:18,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:18,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:18,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:18,947 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:18,948 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:18,949 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:18,949 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:18,951 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 15/400.
2025-08-04 20:24:19,052 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:19,052 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:19,053 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 4, target: 0). GAN training with normal data only.
2025-08-04 20:24:19,053 - ClientAppLogger [Client 5] - INFO - [Client] Round 15: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:24:19,053 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:19,077 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0671, Avg D Loss: 0.7898
2025-08-04 20:24:19,077 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0671, Avg D Loss: 0.7898
2025-08-04 20:24:19,077 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:19,092 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3114, Threshold=0.3125, Accuracy=0.6081, F1=0.7260, Precision=0.8656, Recall=0.6252
2025-08-04 20:24:19,092 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7260
2025-08-04 20:24:19,092 - ClientAppLogger [Client 5] - INFO - Fit completed for round 15. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 15, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.067074203491211, 'd_loss': 0.7897975206375122, 'post_fit_local_f1': 0.7260428410372041, 'fit_time_seconds': 0.1415722370147705, 'cpu_percent_fit': 46.11875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:24:19,093 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:24:24,373 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:24,373 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:24,373 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:24,374 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:24,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:24,374 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:24,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:24,688 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:24,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:24,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:24,805 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:24,892 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:24,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:24,898 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:24,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:24,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:24,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:24,908 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:24,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:24,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:24,917 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:24,919 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,921 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:24,923 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:24,926 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:24,928 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:24,931 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,933 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:24,935 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:24,937 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:24,939 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:24,948 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:24,948 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:24,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:24,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:24,957 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:24,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:24,965 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:24,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:24,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:24,980 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:24,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:24,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:24,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:24,992 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:24,992 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:24,992 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:24,992 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:24,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:24,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:24,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:24,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:24,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:24,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:24,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:24,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:24,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:24,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:24,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:24,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:24,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:24,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:24,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:24,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:24,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:24,998 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:24,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:24,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:25,003 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:25,004 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:25,005 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:25,005 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:25,006 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:25,006 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:25,006 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:25,007 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:25,021 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3020, Threshold=0.3055, Accuracy=0.6984, F1=0.7892, Precision=0.9409, Recall=0.6796
2025-08-04 20:24:25,021 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6984, F1: 0.7892, Prec: 0.9409, Rec: 0.6796, Avg Anomaly Score: 0.3020
2025-08-04 20:24:30,287 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:30,288 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:30,288 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:30,288 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:30,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:30,288 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:30,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:30,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:30,621 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:30,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:30,666 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:30,777 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:30,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:30,783 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:30,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:30,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:30,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:30,794 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:30,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:30,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:30,802 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:30,805 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:30,807 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:30,809 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:30,812 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:30,815 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:30,817 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:30,820 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:30,823 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:30,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:30,827 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:30,836 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:30,836 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:30,841 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:30,841 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:30,846 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:30,846 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:30,854 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:30,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:30,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:30,869 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:30,874 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:30,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:30,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:30,881 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:30,881 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:30,882 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:30,882 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:30,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:30,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:30,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:30,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:30,884 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:30,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:30,884 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:30,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:30,885 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:30,885 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:30,885 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:30,885 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:30,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:30,886 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:30,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:30,886 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:30,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:30,886 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:30,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:30,887 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:30,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:30,887 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:30,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:30,887 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:30,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:30,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:30,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:30,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:30,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:30,888 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:30,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:30,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:30,895 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:30,895 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:30,896 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:30,896 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:30,898 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 16/400.
2025-08-04 20:24:30,999 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:30,999 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:31,000 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 4, target: 0). GAN training with normal data only.
2025-08-04 20:24:31,000 - ClientAppLogger [Client 5] - INFO - [Client] Round 16: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:24:31,000 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:31,024 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0703, Avg D Loss: 0.7649
2025-08-04 20:24:31,024 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0703, Avg D Loss: 0.7649
2025-08-04 20:24:31,024 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:31,039 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2908, Threshold=0.2933, Accuracy=0.6952, F1=0.7869, Precision=0.9382, Recall=0.6777
2025-08-04 20:24:31,040 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7869
2025-08-04 20:24:31,040 - ClientAppLogger [Client 5] - INFO - Fit completed for round 16. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 16, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.070269513130188, 'd_loss': 0.7648943543434144, 'post_fit_local_f1': 0.7869222096956031, 'fit_time_seconds': 0.14232420921325684, 'cpu_percent_fit': 45.4, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:24:31,040 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:24:36,322 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:36,323 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:36,323 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:36,323 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:36,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:36,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:36,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:36,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:36,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:36,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:36,733 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:36,846 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:36,852 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:36,852 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:36,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:36,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:36,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:36,863 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:36,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:36,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:36,873 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:36,876 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,878 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:36,881 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:36,883 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:36,886 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:36,888 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,891 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:36,893 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:36,896 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:36,898 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:36,906 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:36,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:36,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:36,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:36,916 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:36,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:36,925 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:36,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:36,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:36,941 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:36,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:36,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:36,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:36,950 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:36,951 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:36,951 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:36,951 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:36,951 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:36,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:36,952 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:36,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:36,953 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:36,953 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:36,954 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:36,954 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:36,954 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:36,954 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:36,955 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:36,955 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:36,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:36,955 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:36,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:36,955 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:36,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:36,957 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:36,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:36,957 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:36,957 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:36,957 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:36,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:36,958 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:36,958 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:36,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:36,961 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:36,961 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:36,963 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:36,963 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:36,964 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:36,964 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:36,964 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:36,965 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:36,979 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3000, Threshold=0.3043, Accuracy=0.6758, F1=0.7734, Precision=0.9220, Recall=0.6660
2025-08-04 20:24:36,980 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6758, F1: 0.7734, Prec: 0.9220, Rec: 0.6660, Avg Anomaly Score: 0.3000
2025-08-04 20:24:42,241 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:42,241 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:42,241 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:42,241 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:42,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:42,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:42,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:42,492 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:42,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:42,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:42,619 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:42,727 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:42,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:42,732 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:42,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:42,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:42,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:42,745 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:42,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:42,745 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:42,753 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:42,756 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:42,758 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:42,760 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:42,763 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:42,765 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:42,767 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:42,770 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:42,773 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:42,775 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:42,777 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:42,785 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:42,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:42,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:42,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:42,794 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:42,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:42,803 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:42,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:42,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:42,818 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:42,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:42,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:42,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:42,827 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:42,827 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:42,828 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:42,828 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:42,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:42,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:42,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:42,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:42,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:42,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:42,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:42,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:42,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:42,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:42,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:42,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:42,833 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:42,833 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:42,833 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:42,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:42,833 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:42,834 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:42,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:42,837 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:42,837 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:42,838 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:42,838 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:42,840 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 17/400.
2025-08-04 20:24:42,941 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:42,941 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:42,942 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:24:42,942 - ClientAppLogger [Client 5] - INFO - [Client] Round 17: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:24:42,942 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:42,966 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0723, Avg D Loss: 0.7556
2025-08-04 20:24:42,966 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0723, Avg D Loss: 0.7556
2025-08-04 20:24:42,967 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:42,982 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2882, Threshold=0.2929, Accuracy=0.6758, F1=0.7734, Precision=0.9220, Recall=0.6660
2025-08-04 20:24:42,982 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7734
2025-08-04 20:24:42,982 - ClientAppLogger [Client 5] - INFO - Fit completed for round 17. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 17, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0723382472991942, 'd_loss': 0.7555897891521454, 'post_fit_local_f1': 0.7733934611048479, 'fit_time_seconds': 0.14212250709533691, 'cpu_percent_fit': 47.00625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:24:42,982 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:24:48,291 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:48,291 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:48,291 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:48,291 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:48,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:48,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:48,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:48,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:48,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:48,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:48,720 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:48,805 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:48,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:48,811 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:48,815 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:48,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:48,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:48,821 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:48,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:48,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:48,830 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:48,833 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,835 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:48,838 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:48,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:48,842 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:48,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:48,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:48,852 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:48,855 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:48,865 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:48,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:48,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:48,870 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:48,875 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:48,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:48,884 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:48,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:48,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:48,900 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:48,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:48,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:48,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:48,911 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:48,911 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:48,911 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:48,912 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:48,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:48,912 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:48,912 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:48,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:48,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:48,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:48,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:48,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:48,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:48,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:48,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:48,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:48,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:48,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:48,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:48,917 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:48,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:48,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:48,923 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:48,923 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:48,924 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:48,924 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:48,925 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:48,925 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:48,925 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:48,926 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:48,940 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2985, Threshold=0.3043, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:24:48,940 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6790, F1: 0.7756, Prec: 0.9247, Rec: 0.6680, Avg Anomaly Score: 0.2985
2025-08-04 20:24:54,193 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:54,194 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:24:54,194 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:24:54,194 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:24:54,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:24:54,194 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:54,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:54,435 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:54,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:24:54,555 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:24:54,555 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:54,664 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:54,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:54,670 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:54,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:24:54,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:54,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:24:54,681 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:54,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:54,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:24:54,689 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:54,692 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:54,694 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:54,697 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:54,699 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:54,702 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:54,704 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:54,707 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:54,710 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:54,711 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:54,714 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:54,722 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:54,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:24:54,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:24:54,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:24:54,731 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:54,731 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:24:54,740 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:54,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:24:54,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:54,755 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:54,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:24:54,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:24:54,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:54,766 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:54,766 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:54,766 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:54,767 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:54,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:24:54,767 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:54,767 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:24:54,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:54,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:24:54,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:24:54,769 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:54,769 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:24:54,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:24:54,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:24:54,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:24:54,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:24:54,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:24:54,771 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:24:54,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:24:54,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:54,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:24:54,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:54,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:54,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:54,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:24:54,773 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:24:54,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:24:54,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:24:54,779 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:24:54,779 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:54,781 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:54,781 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:24:54,782 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 18/400.
2025-08-04 20:24:54,884 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:54,884 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:54,885 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:24:54,885 - ClientAppLogger [Client 5] - INFO - [Client] Round 18: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:24:54,886 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:54,911 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0665, Avg D Loss: 0.7471
2025-08-04 20:24:54,911 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0665, Avg D Loss: 0.7471
2025-08-04 20:24:54,911 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:54,925 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2864, Threshold=0.2913, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:24:54,925 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7756
2025-08-04 20:24:54,925 - ClientAppLogger [Client 5] - INFO - Fit completed for round 18. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 18, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0664653539657594, 'd_loss': 0.7470836818218232, 'post_fit_local_f1': 0.7756482525366404, 'fit_time_seconds': 0.14263916015625, 'cpu_percent_fit': 46.83125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:24:54,926 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:25:00,202 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:00,202 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:00,203 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:00,203 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:00,203 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:00,203 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:00,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:00,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:00,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:00,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:00,676 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:00,791 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:00,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:00,797 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:00,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:00,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:00,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:00,808 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:00,808 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:00,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:00,817 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:00,820 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,822 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:00,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:00,827 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:00,830 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:00,832 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,835 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:00,837 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:00,839 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:00,841 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:00,851 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:00,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:00,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:00,856 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:00,860 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:00,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:00,869 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:00,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:00,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:00,884 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:00,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:00,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:00,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:00,894 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:00,894 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:00,895 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:00,895 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:00,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:00,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:00,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:00,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:00,897 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:00,897 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:00,897 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:00,898 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:00,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:00,899 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:00,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:00,899 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:00,899 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:00,899 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:00,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:00,900 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:00,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:00,900 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:00,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:00,900 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:00,901 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:00,901 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:00,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:00,901 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:00,901 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:00,901 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:00,909 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:00,909 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:00,910 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:00,910 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:00,912 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:00,912 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:00,912 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:00,913 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:00,928 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3057, Threshold=0.3143, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:00,928 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6790, F1: 0.7756, Prec: 0.9247, Rec: 0.6680, Avg Anomaly Score: 0.3057
2025-08-04 20:25:06,178 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:06,178 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:06,178 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:06,178 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:06,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:06,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:06,461 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:06,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:06,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:06,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:06,583 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:06,695 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:06,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:06,700 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:06,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:06,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:06,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:06,713 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:06,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:06,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:06,722 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:06,725 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:06,727 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:06,729 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:06,732 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:06,734 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:06,737 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:06,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:06,742 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:06,744 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:06,746 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:06,756 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:06,756 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:06,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:06,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:06,765 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:06,765 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:06,773 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:06,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:06,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:06,788 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:06,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:06,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:06,798 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:06,798 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:06,798 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:06,798 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:06,799 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:06,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:06,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:06,799 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:06,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:06,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:06,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:06,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:06,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:06,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:06,801 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:06,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:06,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:06,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:06,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:06,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:06,802 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:06,803 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:06,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:06,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:06,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:06,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:06,804 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:06,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:06,805 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:06,805 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:06,805 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:06,808 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:06,808 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:06,809 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:06,810 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:06,811 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 19/400.
2025-08-04 20:25:06,912 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:06,912 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:06,914 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:25:06,914 - ClientAppLogger [Client 5] - INFO - [Client] Round 19: Training GAN with 3 samples (3 normal, 0 anomalous).
2025-08-04 20:25:06,914 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:06,939 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0715, Avg D Loss: 0.7666
2025-08-04 20:25:06,939 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0715, Avg D Loss: 0.7666
2025-08-04 20:25:06,939 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:06,955 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2929, Threshold=0.3014, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:06,955 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7756
2025-08-04 20:25:06,955 - ClientAppLogger [Client 5] - INFO - Fit completed for round 19. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 19, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.071495532989502, 'd_loss': 0.7666115283966064, 'post_fit_local_f1': 0.7756482525366404, 'fit_time_seconds': 0.14432096481323242, 'cpu_percent_fit': 46.15625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3}
2025-08-04 20:25:06,955 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:25:12,217 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:12,217 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:12,218 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:12,218 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:12,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:12,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:12,529 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:12,529 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:12,623 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:12,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:12,670 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:12,793 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:12,799 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:12,799 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:12,804 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:12,809 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:12,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:12,810 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:12,810 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:12,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:12,820 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:12,822 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:12,826 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:12,829 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:12,831 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:12,834 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,836 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:12,839 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:12,841 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:12,844 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:12,853 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:12,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:12,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:12,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:12,863 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:12,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:12,873 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:12,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:12,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:12,890 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:12,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:12,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:12,900 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:12,901 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:12,901 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:12,901 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:12,902 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:12,902 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:12,902 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:12,902 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:12,902 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:12,904 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:12,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:12,905 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:12,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:12,905 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:12,905 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:12,905 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:12,906 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:12,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:12,907 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:12,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:12,907 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:12,907 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:12,907 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:12,908 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:12,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:12,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:12,908 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:12,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:12,909 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:12,909 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:12,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:12,917 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:12,918 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:12,919 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:12,919 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:12,921 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:12,921 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:12,921 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:12,922 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:12,937 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3092, Threshold=0.3188, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:12,937 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6790, F1: 0.7756, Prec: 0.9247, Rec: 0.6680, Avg Anomaly Score: 0.3092
2025-08-04 20:25:18,185 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:18,185 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:18,185 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:18,185 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:18,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:18,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:18,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:18,391 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:18,470 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:18,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:18,513 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:18,623 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:18,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:18,628 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:18,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:18,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:18,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:18,638 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:18,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:18,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:18,646 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:18,649 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:18,651 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:18,653 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:18,656 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:18,658 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:18,660 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:18,663 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:18,666 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:18,667 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:18,670 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:18,678 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:18,678 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:18,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:18,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:18,687 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:18,687 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:18,695 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:18,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:18,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:18,712 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:18,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:18,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:18,722 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:18,722 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:18,722 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:18,723 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:18,723 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:18,723 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:18,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:18,723 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:18,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:18,725 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:18,725 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:18,725 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:18,726 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:18,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:18,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:18,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:18,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:18,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:18,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:18,729 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:18,729 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:18,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:18,729 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:18,730 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:18,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:18,737 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:18,737 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:18,738 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:18,738 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:18,739 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 20/400.
2025-08-04 20:25:18,840 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:18,840 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:18,841 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:25:18,841 - ClientAppLogger [Client 5] - INFO - [Client] Round 20: Training GAN with 3 samples (3 normal, 0 anomalous).
2025-08-04 20:25:18,841 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:18,868 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0557, Avg D Loss: 0.7703
2025-08-04 20:25:18,868 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0557, Avg D Loss: 0.7703
2025-08-04 20:25:18,871 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:18,886 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.2961, Threshold=0.3054, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:18,886 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7756
2025-08-04 20:25:18,886 - ClientAppLogger [Client 5] - INFO - Fit completed for round 20. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 20, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.055746519565582, 'd_loss': 0.7702858448028564, 'post_fit_local_f1': 0.7756482525366404, 'fit_time_seconds': 0.14681386947631836, 'cpu_percent_fit': 47.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3}
2025-08-04 20:25:18,886 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:25:24,146 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:24,146 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:24,146 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:24,146 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:24,147 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:24,147 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:24,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:24,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:24,565 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:24,612 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:24,613 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:24,709 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:24,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:24,714 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:24,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:24,726 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:24,726 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:24,726 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:24,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:24,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:24,735 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:24,738 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,740 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:24,742 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:24,745 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:24,748 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:24,751 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,753 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:24,756 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:24,758 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:24,760 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:24,770 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:24,771 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:24,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:24,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:24,781 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:24,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:24,795 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:24,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:24,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:24,813 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:24,818 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:24,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:24,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:24,824 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:24,824 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:24,824 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:24,824 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:24,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:24,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:24,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:24,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:24,827 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:24,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:24,827 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:24,827 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:24,828 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:24,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:24,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:24,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:24,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:24,829 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:24,829 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:24,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:24,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:24,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:24,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:24,830 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:24,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:24,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:24,831 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:24,831 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:24,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:24,835 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:24,835 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:24,837 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:24,837 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:24,838 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:24,838 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:24,839 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:24,839 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:24,856 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3213, Threshold=0.3319, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:24,856 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6790, F1: 0.7756, Prec: 0.9247, Rec: 0.6680, Avg Anomaly Score: 0.3213
2025-08-04 20:25:30,121 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:30,121 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:30,121 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:30,121 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:30,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:30,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:30,348 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:30,349 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:30,432 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:30,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:30,474 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:30,584 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:30,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:30,590 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:30,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:30,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:30,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:30,600 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:30,600 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:30,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:30,609 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:30,611 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:30,614 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:30,616 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:30,619 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:30,621 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:30,623 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:30,626 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:30,629 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:30,630 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:30,633 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:30,642 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:30,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:30,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:30,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:30,653 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:30,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:30,664 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:30,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:30,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:30,680 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:30,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:30,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:30,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:30,690 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:30,690 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:30,690 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:30,690 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:30,691 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:30,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:30,691 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:30,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:30,692 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:30,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:30,693 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:30,693 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:30,693 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:30,693 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:30,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:30,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:30,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:30,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:30,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:30,695 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:30,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:30,696 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:30,696 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:30,696 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:30,696 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:30,696 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:30,697 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:30,697 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:30,704 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:30,704 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:30,705 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:30,705 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:30,706 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 21/400.
2025-08-04 20:25:30,807 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:30,807 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:30,808 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:25:30,808 - ClientAppLogger [Client 5] - INFO - [Client] Round 21: Training GAN with 3 samples (3 normal, 0 anomalous).
2025-08-04 20:25:30,808 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:30,832 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0688, Avg D Loss: 0.7819
2025-08-04 20:25:30,833 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0688, Avg D Loss: 0.7819
2025-08-04 20:25:30,833 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:30,848 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3077, Threshold=0.3180, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:30,848 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7756
2025-08-04 20:25:30,848 - ClientAppLogger [Client 5] - INFO - Fit completed for round 21. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 21, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0687634229660032, 'd_loss': 0.781919527053833, 'post_fit_local_f1': 0.7756482525366404, 'fit_time_seconds': 0.14167022705078125, 'cpu_percent_fit': 47.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3}
2025-08-04 20:25:30,848 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:25:36,122 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:36,122 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:36,122 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:36,122 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:36,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:36,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:36,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:36,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:36,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:36,579 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:36,579 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:36,699 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:36,706 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:36,706 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:36,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:36,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:36,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:36,724 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:36,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:36,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:36,736 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:36,739 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,742 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:36,745 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:36,748 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:36,750 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:36,753 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,756 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:36,758 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:36,761 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:36,763 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:36,773 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:36,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:36,778 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:36,778 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:36,782 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:36,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:36,791 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:36,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:36,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:36,807 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:36,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:36,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:36,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:36,818 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:36,818 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:36,818 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:36,818 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:36,818 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:36,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:36,819 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:36,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:36,821 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:36,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:36,821 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:36,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:36,821 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:36,822 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:36,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:36,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:36,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:36,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:36,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:36,823 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:36,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:36,825 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:36,825 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:36,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:36,828 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:36,829 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:36,830 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:36,830 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:36,831 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:36,831 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:36,832 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:36,833 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:36,852 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3187, Threshold=0.3301, Accuracy=0.6790, F1=0.7756, Precision=0.9247, Recall=0.6680
2025-08-04 20:25:36,852 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6790, F1: 0.7756, Prec: 0.9247, Rec: 0.6680, Avg Anomaly Score: 0.3187
2025-08-04 20:25:48,137 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:48,137 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:48,137 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:48,137 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:48,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:48,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:48,547 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:48,548 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:48,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:48,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:48,686 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:48,857 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:48,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:48,866 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:48,873 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:48,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:48,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:48,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:48,918 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:48,930 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:48,934 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,937 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:48,941 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:48,946 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:48,950 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:48,954 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,957 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:48,960 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:48,963 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:48,966 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:48,975 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:48,975 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:48,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:48,981 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:48,985 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:48,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:48,995 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:48,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:48,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:49,013 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:49,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:49,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:49,024 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:49,024 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:49,025 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:49,025 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:49,025 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:49,025 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:49,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:49,026 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:49,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:49,028 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:49,028 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:49,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:49,029 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:49,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:49,029 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:49,030 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:49,031 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:49,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:49,031 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:49,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:49,031 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:49,031 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:49,032 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:49,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:49,032 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:49,032 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:49,032 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:49,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:49,033 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:49,033 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:49,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:49,042 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:49,042 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:49,043 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:49,043 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:49,044 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:49,044 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:49,045 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:49,045 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:49,060 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3222, Threshold=0.3340, Accuracy=0.6823, F1=0.7779, Precision=0.9274, Recall=0.6699
2025-08-04 20:25:49,060 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6823, F1: 0.7779, Prec: 0.9274, Rec: 0.6699, Avg Anomaly Score: 0.3222
2025-08-04 20:25:54,310 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:54,311 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:25:54,311 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:25:54,311 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:25:54,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:25:54,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:54,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:54,554 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:54,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:25:54,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:25:54,682 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:54,786 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:54,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:54,792 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:54,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:25:54,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:54,801 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:25:54,802 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:54,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:54,802 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:25:54,810 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:54,813 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:54,815 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:54,817 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:54,820 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:54,822 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:54,824 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:54,827 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:54,829 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:54,831 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:54,834 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:54,842 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:54,842 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:25:54,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:25:54,847 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:25:54,851 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:54,851 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:25:54,860 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:54,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:25:54,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:54,875 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:54,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:25:54,886 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:25:54,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:54,887 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:54,887 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:54,887 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:54,887 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:54,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:25:54,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:54,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:25:54,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:54,889 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:25:54,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:25:54,889 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:25:54,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:25:54,891 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:54,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:25:54,893 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:25:54,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:25:54,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:25:54,897 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:25:54,897 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:54,898 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:54,898 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:25:54,900 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 23/400.
2025-08-04 20:25:55,001 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:55,001 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:55,003 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:25:55,003 - ClientAppLogger [Client 5] - INFO - [Client] Round 23: Training GAN with 5 samples (4 normal, 1 anomalous).
2025-08-04 20:25:55,003 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:55,029 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0756, Avg D Loss: 0.8738
2025-08-04 20:25:55,030 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0756, Avg D Loss: 0.8738
2025-08-04 20:25:55,030 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:55,044 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3100, Threshold=0.3210, Accuracy=0.6855, F1=0.7802, Precision=0.9301, Recall=0.6718
2025-08-04 20:25:55,044 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7802
2025-08-04 20:25:55,044 - ClientAppLogger [Client 5] - INFO - Fit completed for round 23. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 23, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.075598359107971, 'd_loss': 0.8737539887428284, 'post_fit_local_f1': 0.7801578354002254, 'fit_time_seconds': 0.14470744132995605, 'cpu_percent_fit': 46.1625, 'ram_mb_fit': 0.125, 'accumulated_train_samples_this_round': 5}
2025-08-04 20:25:55,045 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:26:03,314 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,314 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:03,314 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:03,314 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:03,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:03,314 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:03,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:03,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:03,986 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:04,041 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:04,042 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:04,206 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:04,215 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:04,216 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:04,232 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:04,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:04,249 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:04,249 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:04,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:04,250 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:04,261 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:04,264 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,266 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:04,268 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:04,271 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:04,274 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:04,276 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,279 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:04,282 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:04,284 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:04,286 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:04,299 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:04,299 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:04,305 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:04,305 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:04,311 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:04,312 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:04,324 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:04,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:04,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:04,345 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:04,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:04,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:04,358 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,358 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,358 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,359 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,359 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,359 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:04,359 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,360 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:04,360 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,361 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:04,361 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,362 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,362 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,362 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,362 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,362 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:04,363 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:04,364 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:04,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:04,364 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:04,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:04,364 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,364 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:04,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,365 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:04,366 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:04,366 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:04,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:04,372 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:04,372 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,374 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,374 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:04,375 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,376 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,376 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,376 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,393 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3300, Threshold=0.3430, Accuracy=0.6855, F1=0.7802, Precision=0.9301, Recall=0.6718
2025-08-04 20:26:04,393 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6855, F1: 0.7802, Prec: 0.9301, Rec: 0.6718, Avg Anomaly Score: 0.3300
2025-08-04 20:26:09,647 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:09,647 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:09,648 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:09,648 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:09,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:09,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:09,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:09,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:10,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:10,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:10,052 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:10,166 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:10,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:10,172 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:10,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:10,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:10,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:10,185 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:10,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:10,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:10,193 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:10,196 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:10,198 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:10,200 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:10,203 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:10,205 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:10,208 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:10,211 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:10,214 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:10,216 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:10,218 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:10,226 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:10,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:10,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:10,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:10,236 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:10,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:10,244 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:10,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:10,245 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:10,260 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:10,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:10,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:10,271 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:10,271 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:10,271 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:10,271 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:10,272 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:10,272 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:10,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:10,272 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:10,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:10,273 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:10,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:10,274 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:10,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:10,274 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:10,274 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:10,274 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:10,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:10,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:10,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:10,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:10,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:10,276 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:10,276 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:10,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:10,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:10,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:10,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:10,277 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:10,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:10,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:10,284 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:10,284 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:10,285 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:10,285 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:10,286 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 24/400.
2025-08-04 20:26:10,387 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:10,387 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:10,388 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:26:10,389 - ClientAppLogger [Client 5] - INFO - [Client] Round 24: Training GAN with 6 samples (5 normal, 1 anomalous).
2025-08-04 20:26:10,389 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:10,414 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0709, Avg D Loss: 0.8626
2025-08-04 20:26:10,414 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0709, Avg D Loss: 0.8626
2025-08-04 20:26:10,416 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:10,430 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3158, Threshold=0.3285, Accuracy=0.6887, F1=0.7824, Precision=0.9328, Recall=0.6738
2025-08-04 20:26:10,431 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7824
2025-08-04 20:26:10,431 - ClientAppLogger [Client 5] - INFO - Fit completed for round 24. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 24, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.070873475074768, 'd_loss': 0.8625674903392792, 'post_fit_local_f1': 0.7824126268320181, 'fit_time_seconds': 0.14450740814208984, 'cpu_percent_fit': 45.94375, 'ram_mb_fit': 3.03515625, 'accumulated_train_samples_this_round': 6}
2025-08-04 20:26:10,431 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:26:15,715 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:15,715 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:15,715 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:15,715 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:15,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:15,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:16,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:16,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:16,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:16,455 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:16,455 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,596 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,603 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:16,618 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,619 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,619 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:16,628 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,631 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,633 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,636 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,639 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,642 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,645 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,647 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,650 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,652 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,654 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,667 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:16,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:16,679 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,679 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:16,689 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:16,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,704 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,709 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:16,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:16,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,714 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,714 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,714 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,715 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:16,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:16,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:16,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:16,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:16,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:16,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:16,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:16,719 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:16,719 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:16,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:16,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,720 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:16,720 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,721 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,721 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:16,721 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:16,721 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:16,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:16,725 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:16,725 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,726 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,727 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:16,728 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,728 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,728 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,729 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,744 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3213, Threshold=0.3336, Accuracy=0.6823, F1=0.7779, Precision=0.9274, Recall=0.6699
2025-08-04 20:26:16,744 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.6823, F1: 0.7779, Prec: 0.9274, Rec: 0.6699, Avg Anomaly Score: 0.3213
2025-08-04 20:26:28,065 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:28,065 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:28,066 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:28,066 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:28,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:28,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:28,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:28,413 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:28,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:28,592 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,731 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,739 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,739 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,746 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:28,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,758 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:28,769 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,772 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,777 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,781 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,785 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,787 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,791 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,797 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,799 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,801 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,813 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:28,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,820 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:28,826 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:28,840 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:28,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,862 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,872 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:28,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:28,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,883 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,884 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,884 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,884 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,884 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:28,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,885 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:28,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,886 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:28,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,887 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,887 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,888 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:28,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:28,889 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:28,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:28,889 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:28,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:28,889 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:28,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:28,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:28,890 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:28,890 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:28,891 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:28,893 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,894 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:28,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,894 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:28,895 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:28,895 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:28,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:28,900 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:28,900 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,902 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,904 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:28,906 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,906 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,906 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:28,907 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,926 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3257, Threshold=0.3386, Accuracy=0.7016, F1=0.7914, Precision=0.9435, Recall=0.6816
2025-08-04 20:26:28,926 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7016, F1: 0.7914, Prec: 0.9435, Rec: 0.6816, Avg Anomaly Score: 0.3257
2025-08-04 20:26:34,176 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:34,176 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:34,176 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:34,177 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:34,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:34,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:34,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:34,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:34,525 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:34,567 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:34,567 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:34,680 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:34,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:34,685 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:34,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:34,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:34,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:34,695 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:34,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:34,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:34,703 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:34,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:34,708 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:34,710 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:34,714 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:34,716 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:34,718 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:34,721 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:34,724 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:34,726 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:34,728 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:34,737 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:34,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:34,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:34,742 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:34,748 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:34,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:34,759 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:34,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:34,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:34,775 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:34,780 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:34,787 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:34,787 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:34,787 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:34,787 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:34,788 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:34,788 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:34,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:34,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:34,789 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:34,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:34,790 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:34,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:34,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:34,792 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:34,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:34,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:34,794 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:34,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:34,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:34,801 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:34,801 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:34,802 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:34,803 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:34,804 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 26/400.
2025-08-04 20:26:34,905 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:34,905 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:34,906 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:26:34,907 - ClientAppLogger [Client 5] - INFO - [Client] Round 26: Training GAN with 6 samples (5 normal, 1 anomalous).
2025-08-04 20:26:34,907 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:34,930 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0723, Avg D Loss: 0.8596
2025-08-04 20:26:34,930 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0723, Avg D Loss: 0.8596
2025-08-04 20:26:34,930 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:34,944 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3101, Threshold=0.3218, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:26:34,945 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7959
2025-08-04 20:26:34,945 - ClientAppLogger [Client 5] - INFO - Fit completed for round 26. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 26, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0722954511642455, 'd_loss': 0.8595738530158996, 'post_fit_local_f1': 0.7959413754227734, 'fit_time_seconds': 0.1404860019683838, 'cpu_percent_fit': 45.73125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 6}
2025-08-04 20:26:34,945 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:26:40,241 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,241 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:40,241 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:40,241 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:40,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:40,241 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:40,934 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:40,935 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:41,144 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:41,153 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:41,153 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:41,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:41,168 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:41,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:41,170 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:41,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:41,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:41,180 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:41,183 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,185 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:41,188 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:41,191 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:41,195 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:41,197 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,202 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:41,205 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:41,207 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:41,211 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:41,222 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:41,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:41,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:41,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:41,235 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:41,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:41,247 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:41,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:41,248 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:41,264 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:41,269 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:41,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:41,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:41,274 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:41,274 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:41,274 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:41,275 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:41,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:41,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:41,275 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:41,275 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:41,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:41,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:41,277 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:41,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:41,278 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:41,279 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:41,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:41,279 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:41,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:41,279 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:41,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:41,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:41,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:41,280 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:41,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:41,281 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:41,281 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:41,281 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:41,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:41,281 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:41,281 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:41,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:41,286 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:41,286 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:41,287 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:41,288 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:41,289 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:41,289 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:41,289 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:41,290 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,304 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3297, Threshold=0.3435, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:26:41,304 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7081, F1: 0.7959, Prec: 0.9489, Rec: 0.6854, Avg Anomaly Score: 0.3297
2025-08-04 20:26:46,557 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:46,557 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:46,557 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:46,557 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:46,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:46,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:46,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:46,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:46,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:46,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:46,913 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:46,998 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:47,004 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:47,004 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:47,010 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:47,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:47,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:47,016 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:47,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:47,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:47,024 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:47,027 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:47,029 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:47,031 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:47,034 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:47,036 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:47,038 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:47,041 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:47,043 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:47,045 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:47,047 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:47,056 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:47,056 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:47,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:47,061 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:47,065 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:47,066 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:47,073 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:47,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:47,074 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:47,088 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:47,093 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:47,099 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:47,100 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:47,100 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:47,100 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:47,100 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:47,100 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:47,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:47,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:47,101 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:47,101 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:47,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:47,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:47,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:47,103 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:47,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:47,103 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:47,104 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:47,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:47,106 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:47,106 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:47,106 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:47,106 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:47,106 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:47,106 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:47,107 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:47,110 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:47,110 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:47,112 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:47,112 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:47,113 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 27/400.
2025-08-04 20:26:47,214 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:47,214 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:47,215 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:26:47,216 - ClientAppLogger [Client 5] - INFO - [Client] Round 27: Training GAN with 7 samples (6 normal, 1 anomalous).
2025-08-04 20:26:47,216 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:47,240 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0707, Avg D Loss: 0.8366
2025-08-04 20:26:47,240 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0707, Avg D Loss: 0.8366
2025-08-04 20:26:47,240 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:47,255 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3137, Threshold=0.3270, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:26:47,255 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7959
2025-08-04 20:26:47,255 - ClientAppLogger [Client 5] - INFO - Fit completed for round 27. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 27, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0706934928894043, 'd_loss': 0.8366140007972718, 'post_fit_local_f1': 0.7959413754227734, 'fit_time_seconds': 0.1422572135925293, 'cpu_percent_fit': 47.0375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7}
2025-08-04 20:26:47,256 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:26:52,545 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,546 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:52,546 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:52,546 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:52,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:52,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:53,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:53,032 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:53,139 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:53,198 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:53,198 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,398 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,405 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,411 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:53,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,421 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,422 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,423 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:53,434 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,438 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,442 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,445 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,449 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,452 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,456 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,458 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,462 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,464 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,466 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,478 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:53,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,483 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:53,488 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:53,500 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:53,501 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,519 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,524 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:53,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:53,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,532 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,532 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,532 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,533 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,533 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:53,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,533 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:53,533 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:53,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:53,536 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:53,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:53,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:53,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:53,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:53,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:53,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:53,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:53,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:53,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,539 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:53,539 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:53,539 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:53,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:53,545 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:53,545 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,547 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,547 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:53,548 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,548 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,549 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,549 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,566 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3320, Threshold=0.3457, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:26:53,567 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7081, F1: 0.7959, Prec: 0.9489, Rec: 0.6854, Avg Anomaly Score: 0.3320
2025-08-04 20:26:58,832 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:58,832 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:26:58,832 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:26:58,832 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:26:58,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:26:58,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:59,160 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:59,160 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:59,244 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:26:59,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:26:59,286 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:59,397 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:59,402 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:59,402 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:59,408 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:26:59,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:59,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:26:59,417 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:59,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:59,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:26:59,425 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:59,428 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:59,430 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:59,432 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:59,435 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:59,437 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:59,440 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:59,442 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:59,445 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:59,447 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:59,449 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:59,457 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:59,457 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:26:59,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:26:59,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:26:59,468 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:59,468 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:26:59,480 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:59,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:26:59,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:59,495 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:59,499 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:26:59,504 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:26:59,504 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:59,504 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:59,504 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:59,504 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:59,505 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:59,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:26:59,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:59,505 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:26:59,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:59,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:26:59,507 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:26:59,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:59,507 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:26:59,507 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:59,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:59,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:59,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:26:59,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:26:59,508 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:26:59,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:26:59,509 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:26:59,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:26:59,510 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:59,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:26:59,510 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:59,510 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:59,510 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:59,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:26:59,511 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:26:59,511 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:26:59,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:26:59,519 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:26:59,519 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:59,520 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:59,520 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:26:59,521 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 28/400.
2025-08-04 20:26:59,622 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:59,622 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:59,623 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:26:59,624 - ClientAppLogger [Client 5] - INFO - [Client] Round 28: Training GAN with 7 samples (6 normal, 1 anomalous).
2025-08-04 20:26:59,624 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:59,648 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0653, Avg D Loss: 0.8364
2025-08-04 20:26:59,648 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0653, Avg D Loss: 0.8364
2025-08-04 20:26:59,648 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:59,663 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3160, Threshold=0.3292, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:26:59,663 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7959
2025-08-04 20:26:59,663 - ClientAppLogger [Client 5] - INFO - Fit completed for round 28. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 28, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.065258836746216, 'd_loss': 0.8364358425140381, 'post_fit_local_f1': 0.7959413754227734, 'fit_time_seconds': 0.14178681373596191, 'cpu_percent_fit': 45.6375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7}
2025-08-04 20:26:59,663 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:27:04,949 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,950 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:27:04,950 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:27:04,950 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:27:04,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:27:04,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:05,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:05,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:05,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:27:05,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:27:05,558 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,669 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,677 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,683 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:27:05,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,691 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,691 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:27:05,700 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,708 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,711 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,713 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,717 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,719 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,722 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,724 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,727 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,738 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:27:05,743 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,743 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:27:05,748 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:27:05,762 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:27:05,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,779 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,784 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:27:05,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:27:05,790 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,790 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,790 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,790 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,790 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:27:05,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,791 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:27:05,791 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:27:05,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,793 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,793 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:27:05,794 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:27:05,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:27:05,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:27:05,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:27:05,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:27:05,795 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:27:05,795 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:27:05,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:27:05,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,796 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:27:05,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,796 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:27:05,797 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:27:05,797 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:27:05,797 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:27:05,801 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:27:05,801 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,803 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,803 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:27:05,804 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,804 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,804 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,805 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,821 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3284, Threshold=0.3403, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:27:05,821 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7081, F1: 0.7959, Prec: 0.9489, Rec: 0.6854, Avg Anomaly Score: 0.3284
2025-08-04 20:27:17,096 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:17,097 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:27:17,097 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:27:17,097 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:27:17,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:27:17,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:17,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:17,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:17,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:27:17,725 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:27:17,726 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,841 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,850 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,850 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:27:17,887 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,888 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,888 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,889 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:27:17,898 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,901 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,904 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:17,906 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:17,909 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:17,912 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:17,914 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,917 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:17,920 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:17,922 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:17,924 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:17,935 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:17,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:27:17,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:27:17,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:27:17,946 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:17,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:27:17,956 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:17,956 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:27:17,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:17,975 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:17,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:27:17,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:27:17,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:17,991 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:17,991 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:17,992 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:17,992 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:17,992 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:27:17,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:17,993 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:27:17,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:17,994 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:27:17,994 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:27:17,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:27:17,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:27:17,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:27:17,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:27:17,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:27:17,996 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:27:17,996 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:27:17,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:27:17,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:27:17,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:27:17,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:27:17,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:17,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:27:17,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:17,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:17,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:17,998 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:27:17,998 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:27:17,998 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:27:17,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:27:18,002 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:27:18,002 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:18,003 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:18,003 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:27:18,005 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:18,005 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:18,005 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:18,005 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:18,021 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3315, Threshold=0.3438, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:27:18,022 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3315
2025-08-04 20:27:26,269 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:26,269 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:27:26,270 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:27:26,270 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:27:26,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:27:26,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:26,568 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:26,568 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:26,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:27:26,695 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:27:26,696 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:26,808 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:26,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:26,814 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:26,819 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:27:26,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:26,824 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:27:26,825 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:26,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:26,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:27:26,833 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:26,836 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:26,838 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:26,840 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:26,843 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:26,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:26,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:26,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:26,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:26,855 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:26,857 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:26,866 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:26,866 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:27:26,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:27:26,871 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:27:26,875 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:26,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:27:26,883 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:26,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:27:26,884 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:26,898 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:26,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:27:26,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:27:26,909 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:26,910 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:26,910 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:26,910 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:26,910 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:26,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:27:26,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:26,911 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:27:26,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:26,913 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:26,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:27:26,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:27:26,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:27:26,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:27:26,914 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:27:26,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:27:26,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:27:26,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:27:26,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:27:26,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:27:26,915 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:27:26,915 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:27:26,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:26,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:27:26,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:26,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:26,916 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:26,916 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:27:26,917 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:27:26,917 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:27:26,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:27:26,923 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:27:26,923 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:26,925 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:26,925 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:27:26,927 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 30/400.
2025-08-04 20:27:27,027 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:27,028 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:27,029 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:27:27,029 - ClientAppLogger [Client 5] - INFO - [Client] Round 30: Training GAN with 9 samples (7 normal, 2 anomalous).
2025-08-04 20:27:27,029 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:27,053 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.8869
2025-08-04 20:27:27,053 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.8869
2025-08-04 20:27:27,053 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:27,067 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3287, Threshold=0.3401, Accuracy=0.7081, F1=0.7959, Precision=0.9489, Recall=0.6854
2025-08-04 20:27:27,068 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.7959
2025-08-04 20:27:27,068 - ClientAppLogger [Client 5] - INFO - Fit completed for round 30. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 30, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0825846672058104, 'd_loss': 0.8869017958641052, 'post_fit_local_f1': 0.7959413754227734, 'fit_time_seconds': 0.14119601249694824, 'cpu_percent_fit': 46.4375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9}
2025-08-04 20:27:27,068 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:27:32,327 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:32,328 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:27:32,328 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:27:32,328 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:27:32,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:27:32,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:32,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:32,665 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:32,750 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:27:32,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:27:32,788 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:32,887 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:32,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:32,893 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:32,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:27:32,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:32,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:27:32,906 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:32,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:32,906 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:27:32,915 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:32,918 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:32,921 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:32,923 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:32,926 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:32,928 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:32,931 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:32,933 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:32,936 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:32,938 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:32,940 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:32,952 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:32,952 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:27:32,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:27:32,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:27:32,965 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:32,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:27:32,979 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:32,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:27:32,980 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:32,997 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:33,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:27:33,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:27:33,015 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:33,015 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:33,015 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:33,015 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:33,016 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:33,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:27:33,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:33,016 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:27:33,016 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:33,018 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:27:33,018 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:27:33,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:33,019 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:27:33,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:33,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:33,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:33,019 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:27:33,020 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:27:33,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:27:33,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:27:33,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:27:33,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:27:33,021 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:33,021 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:27:33,022 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:33,022 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:33,022 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:33,022 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:27:33,022 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:27:33,023 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:27:33,023 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:27:33,029 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:27:33,029 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:33,031 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:33,031 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:27:33,032 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:33,033 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:33,033 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:33,033 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:33,053 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3323, Threshold=0.3469, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:27:33,053 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3323
2025-08-04 20:27:47,355 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:47,355 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:27:47,355 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:27:47,355 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:27:47,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:27:47,355 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:47,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:47,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:47,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:27:47,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:27:47,965 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:48,103 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:48,109 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:48,109 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:48,115 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:27:48,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:48,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:27:48,122 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:48,122 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:48,123 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:27:48,131 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:48,134 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:48,137 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:48,140 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:48,143 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:48,147 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:48,150 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:48,153 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:48,158 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:48,160 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:48,162 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:48,172 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:48,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:27:48,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:27:48,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:27:48,183 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:48,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:27:48,193 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:48,193 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:27:48,193 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:48,209 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:48,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:27:48,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:27:48,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:48,221 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:48,221 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:48,221 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:48,221 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:48,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:27:48,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:48,222 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:27:48,222 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:48,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:27:48,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:27:48,224 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:27:48,225 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:27:48,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:27:48,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:27:48,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:27:48,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:27:48,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:27:48,226 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:27:48,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:27:48,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:27:48,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:27:48,227 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:48,227 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:27:48,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:48,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:48,228 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:48,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:27:48,229 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:27:48,229 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:27:48,229 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:27:48,233 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:27:48,233 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:48,234 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:48,235 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:27:48,236 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:48,236 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:48,236 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:48,237 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:48,251 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3365, Threshold=0.3526, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:27:48,251 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3365
2025-08-04 20:27:53,510 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:53,510 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:27:53,510 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:27:53,510 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:27:53,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:27:53,511 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:53,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:53,762 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:53,849 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:27:53,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:27:53,883 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:53,976 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:53,981 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:53,981 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:53,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:27:53,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:53,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:27:53,991 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:53,991 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:53,992 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:27:53,999 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:54,002 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:54,005 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:54,007 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:54,010 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:54,012 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:54,015 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:54,017 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:54,020 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:54,022 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:54,024 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:54,033 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:54,033 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:27:54,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:27:54,038 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:27:54,044 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:54,048 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:27:54,058 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:54,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:27:54,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:54,073 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:54,078 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:27:54,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:27:54,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:54,084 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:54,084 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:54,085 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:54,085 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:54,085 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:27:54,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:54,086 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:27:54,086 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:54,087 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:27:54,087 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:27:54,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:54,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:27:54,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:54,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:54,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:54,088 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:27:54,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:27:54,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:27:54,090 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:27:54,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:54,090 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:27:54,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:54,090 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:54,091 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:54,091 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:27:54,091 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:27:54,091 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:27:54,091 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:27:54,097 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:27:54,097 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:54,098 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:54,099 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:27:54,100 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 32/400.
2025-08-04 20:27:54,201 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:54,201 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:54,202 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:27:54,202 - ClientAppLogger [Client 5] - INFO - [Client] Round 32: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:27:54,202 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:54,227 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0785, Avg D Loss: 0.8668
2025-08-04 20:27:54,227 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0785, Avg D Loss: 0.8668
2025-08-04 20:27:54,229 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:54,243 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3306, Threshold=0.3458, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:27:54,243 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:27:54,243 - ClientAppLogger [Client 5] - INFO - Fit completed for round 32. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 32, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0785165548324587, 'd_loss': 0.8667783200740814, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14306116104125977, 'cpu_percent_fit': 45.84375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:27:54,243 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:28:02,527 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:02,527 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:02,527 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:02,527 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:02,527 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:02,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:02,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:02,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:03,045 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:03,098 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:03,098 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:03,220 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:03,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:03,225 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:03,230 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:03,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:03,235 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:03,235 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:03,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:03,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:03,244 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:03,247 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:03,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:03,251 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:03,254 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:03,256 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:03,259 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:03,261 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:03,264 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:03,266 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:03,268 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:03,277 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:03,277 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:03,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:03,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:03,286 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:03,286 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:03,295 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:03,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:03,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:03,311 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:03,316 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:03,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:03,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:03,324 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:03,324 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:03,324 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:03,324 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:03,324 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:03,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:03,325 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:03,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:03,326 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:03,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:03,327 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:03,327 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:03,327 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:03,328 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:03,329 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:03,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:03,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:03,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:03,330 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:03,330 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:03,330 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:03,331 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:03,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:03,337 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:03,337 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:03,338 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:03,339 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:03,340 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:03,340 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:03,340 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:03,341 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:03,357 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3390, Threshold=0.3546, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:28:03,358 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7145, F1: 0.8005, Prec: 0.9543, Rec: 0.6893, Avg Anomaly Score: 0.3390
2025-08-04 20:28:08,605 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:08,605 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:08,605 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:08,606 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:08,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:08,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:08,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:08,869 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:08,951 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:08,984 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:08,985 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:09,071 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:09,076 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:09,076 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:09,082 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:09,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:09,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:09,089 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:09,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:09,089 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:09,098 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:09,100 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:09,103 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:09,105 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:09,108 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:09,110 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:09,114 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:09,116 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:09,119 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:09,121 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:09,124 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:09,133 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:09,133 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:09,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:09,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:09,142 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:09,142 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:09,151 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:09,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:09,151 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:09,166 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:09,170 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:09,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:09,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:09,177 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:09,177 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:09,177 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:09,177 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:09,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:09,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:09,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:09,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:09,180 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:09,180 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:09,180 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:09,180 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:09,180 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:09,181 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:09,182 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:09,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:09,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:09,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:09,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:09,183 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:09,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:09,184 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:09,184 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:09,184 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:09,187 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:09,187 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:09,189 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:09,189 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:09,190 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 33/400.
2025-08-04 20:28:09,291 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:09,291 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:09,292 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:28:09,292 - ClientAppLogger [Client 5] - INFO - [Client] Round 33: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:28:09,292 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:09,317 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.8686
2025-08-04 20:28:09,317 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.8686
2025-08-04 20:28:09,319 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:09,333 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3319, Threshold=0.3464, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:28:09,333 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:28:09,333 - ClientAppLogger [Client 5] - INFO - Fit completed for round 33. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 33, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084392786026001, 'd_loss': 0.8686022758483887, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14287209510803223, 'cpu_percent_fit': 45.81875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:28:09,333 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:28:14,585 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:14,585 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:14,585 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:14,585 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:14,585 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:14,586 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:14,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:14,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:14,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:14,983 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:14,983 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:15,100 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:15,107 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:15,107 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:15,114 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:15,120 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:15,120 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:15,121 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:15,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:15,121 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:15,129 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:15,132 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:15,135 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:15,137 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:15,140 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:15,142 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:15,145 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:15,147 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:15,150 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:15,152 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:15,154 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:15,164 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:15,164 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:15,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:15,169 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:15,174 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:15,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:15,182 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:15,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:15,183 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:15,200 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:15,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:15,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:15,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:15,212 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:15,212 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:15,212 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:15,213 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:15,213 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:15,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:15,213 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:15,213 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:15,215 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:15,215 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:15,216 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:15,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:15,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:15,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:15,217 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:15,217 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:15,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:15,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:15,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:15,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:15,218 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:15,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:15,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:15,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:15,219 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:15,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:15,219 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:15,220 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:15,220 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:15,223 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:15,223 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:15,224 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:15,224 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:15,225 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:15,225 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:15,226 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:15,226 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:15,243 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3375, Threshold=0.3525, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:28:15,243 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3375
2025-08-04 20:28:23,522 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:23,523 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:23,523 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:23,523 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:23,523 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:23,523 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:23,854 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:23,855 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:23,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:23,977 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:23,977 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:24,067 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:24,073 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:24,073 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:24,077 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:24,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:24,083 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:24,083 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:24,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:24,084 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:24,092 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:24,095 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:24,097 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:24,099 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:24,102 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:24,104 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:24,106 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:24,109 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:24,112 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:24,114 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:24,116 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:24,125 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:24,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:24,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:24,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:24,136 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:24,137 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:24,147 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:24,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:24,148 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:24,161 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:24,167 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:24,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:24,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:24,173 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:24,173 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:24,173 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:24,173 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:24,173 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:24,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:24,174 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:24,174 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:24,175 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:24,175 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:24,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:24,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:24,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:24,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:24,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:24,176 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:24,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:24,177 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:24,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:24,177 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:24,177 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:24,178 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:24,179 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:24,179 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:24,179 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:24,179 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:24,180 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:24,180 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:24,180 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:24,180 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:24,186 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:24,186 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:24,187 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:24,188 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:24,189 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 34/400.
2025-08-04 20:28:24,290 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:24,290 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:24,291 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:28:24,291 - ClientAppLogger [Client 5] - INFO - [Client] Round 34: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:28:24,291 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:24,317 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0801, Avg D Loss: 0.8687
2025-08-04 20:28:24,317 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0801, Avg D Loss: 0.8687
2025-08-04 20:28:24,317 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:24,332 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3322, Threshold=0.3465, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:28:24,332 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:28:24,333 - ClientAppLogger [Client 5] - INFO - Fit completed for round 34. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 34, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080133557319641, 'd_loss': 0.868730902671814, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.1437070369720459, 'cpu_percent_fit': 46.89375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:28:24,333 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:28:29,648 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,648 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:29,648 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:29,649 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:29,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:29,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:30,125 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:30,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:30,225 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:30,270 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:30,270 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:30,450 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:30,458 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:30,458 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:30,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:30,472 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:30,472 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:30,473 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:30,473 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:30,473 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:30,484 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:30,488 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,491 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:30,493 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:30,497 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:30,499 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:30,503 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,505 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:30,508 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:30,511 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:30,513 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:30,524 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:30,524 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:30,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:30,530 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:30,537 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:30,549 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:30,550 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,570 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:30,582 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:30,586 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,586 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,586 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,587 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,587 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,587 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:30,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,588 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:30,588 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,590 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:30,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,590 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,590 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,590 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:30,591 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:30,591 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:30,591 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:30,592 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:30,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:30,592 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:30,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:30,592 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:30,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:30,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:30,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:30,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:30,593 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:30,594 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:30,594 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:30,594 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:30,602 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:30,602 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,604 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,604 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:30,605 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,605 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,605 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,606 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,623 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3401, Threshold=0.3556, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:28:30,624 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3401
2025-08-04 20:28:35,878 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:35,878 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:35,879 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:35,879 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:35,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:35,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:36,104 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:36,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:36,186 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:36,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:36,220 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:36,307 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:36,313 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:36,314 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:36,318 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:36,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:36,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:36,324 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:36,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:36,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:36,333 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:36,335 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:36,338 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:36,340 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:36,342 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:36,345 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:36,347 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:36,350 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:36,353 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:36,355 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:36,357 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:36,366 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:36,366 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:36,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:36,370 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:36,376 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:36,376 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:36,386 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:36,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:36,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:36,401 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:36,405 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:36,411 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:36,411 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:36,411 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:36,411 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:36,411 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:36,412 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:36,412 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:36,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:36,412 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:36,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:36,414 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:36,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:36,414 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:36,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:36,414 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:36,414 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:36,415 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:36,416 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:36,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:36,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:36,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:36,417 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:36,417 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:36,417 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:36,418 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:36,423 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:36,423 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:36,425 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:36,425 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:36,426 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 35/400.
2025-08-04 20:28:36,527 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:36,527 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:36,528 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:28:36,528 - ClientAppLogger [Client 5] - INFO - [Client] Round 35: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:28:36,529 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:36,553 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0791, Avg D Loss: 0.8694
2025-08-04 20:28:36,553 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0791, Avg D Loss: 0.8694
2025-08-04 20:28:36,554 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:36,569 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3340, Threshold=0.3487, Accuracy=0.7145, F1=0.8005, Precision=0.9543, Recall=0.6893
2025-08-04 20:28:36,569 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8005
2025-08-04 20:28:36,569 - ClientAppLogger [Client 5] - INFO - Fit completed for round 35. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 35, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.079133677482605, 'd_loss': 0.8694077134132385, 'post_fit_local_f1': 0.8004509582863585, 'fit_time_seconds': 0.14346790313720703, 'cpu_percent_fit': 47.23125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:28:36,570 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:28:41,825 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:41,825 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:41,826 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:41,826 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:41,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:41,826 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:42,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:42,221 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:42,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:42,362 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:42,363 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:42,498 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:42,505 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:42,505 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:42,513 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:42,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:42,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:42,521 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:42,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:42,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:42,531 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:42,534 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,536 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:42,539 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:42,542 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:42,545 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:42,547 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,550 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:42,553 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:42,555 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:42,558 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:42,569 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:42,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:42,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:42,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:42,581 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:42,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:42,592 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:42,609 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:42,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:42,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:42,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:42,628 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:42,628 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:42,629 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:42,629 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:42,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:42,629 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:42,629 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:42,630 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:42,631 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:42,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:42,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:42,632 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:42,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:42,634 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:42,634 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:42,634 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:42,634 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:42,634 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:42,634 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:42,635 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:42,635 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:42,635 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:42,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:42,635 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:42,636 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:42,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:42,642 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:42,642 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:42,644 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:42,644 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:42,645 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:42,645 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:42,646 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:42,646 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:42,663 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3365, Threshold=0.3524, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:28:42,663 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3365
2025-08-04 20:28:47,919 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:47,919 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:47,919 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:47,919 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:47,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:47,919 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:48,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:48,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:48,304 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:48,340 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:48,340 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:48,427 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:48,433 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:48,433 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:48,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:48,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:48,443 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:48,444 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:48,444 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:48,444 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:48,453 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:48,456 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:48,458 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:48,460 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:48,463 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:48,465 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:48,468 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:48,470 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:48,473 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:48,475 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:48,477 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:48,486 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:48,486 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:48,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:48,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:48,497 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:48,497 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:48,508 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:48,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:48,508 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:48,522 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:48,526 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:48,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:48,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:48,534 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:48,534 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:48,534 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:48,535 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:48,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:48,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:48,535 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:48,536 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:48,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:48,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:48,537 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:48,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:48,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:48,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:48,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:48,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:48,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:48,538 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:48,539 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:48,540 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:48,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:48,540 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:48,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:48,540 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:48,540 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:48,541 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:48,541 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:48,541 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:48,541 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:48,541 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:48,548 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:48,548 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:48,549 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:48,549 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:48,550 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 36/400.
2025-08-04 20:28:48,651 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:48,651 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:48,652 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:28:48,653 - ClientAppLogger [Client 5] - INFO - [Client] Round 36: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:28:48,653 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:48,676 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0783, Avg D Loss: 0.8434
2025-08-04 20:28:48,676 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0783, Avg D Loss: 0.8434
2025-08-04 20:28:48,677 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:48,690 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3279, Threshold=0.3426, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:28:48,690 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:28:48,691 - ClientAppLogger [Client 5] - INFO - Fit completed for round 36. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 36, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.078278684616089, 'd_loss': 0.8433998823165894, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14026880264282227, 'cpu_percent_fit': 45.875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:28:48,691 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:28:53,945 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:53,945 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:28:53,946 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:28:53,946 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:28:53,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:28:53,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:54,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:54,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:54,368 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:28:54,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:28:54,409 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:54,534 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:54,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:54,540 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:54,549 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:28:54,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:54,557 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:28:54,558 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:54,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:54,558 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:28:54,567 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:54,570 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:54,572 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:54,575 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:54,578 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:54,580 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:54,583 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:54,586 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:54,589 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:54,592 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:54,594 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:54,604 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:54,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:28:54,609 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:28:54,609 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:28:54,614 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:54,614 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:28:54,625 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:54,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:28:54,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:54,643 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:54,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:28:54,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:28:54,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:54,662 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:54,662 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:54,662 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:54,663 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:54,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:28:54,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:54,664 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:28:54,664 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:54,665 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:28:54,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:28:54,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:54,666 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:28:54,666 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:54,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:54,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:54,667 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:28:54,667 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:28:54,668 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:28:54,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:28:54,668 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:28:54,668 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:28:54,669 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:28:54,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:28:54,669 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:28:54,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:28:54,669 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:28:54,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:28:54,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:54,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:28:54,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:54,670 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:54,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:54,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:28:54,671 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:28:54,671 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:28:54,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:28:54,675 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:28:54,675 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:54,677 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:54,677 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:28:54,678 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:54,678 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:54,679 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:54,679 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:54,694 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3405, Threshold=0.3567, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:28:54,694 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3405
2025-08-04 20:29:02,957 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:02,957 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:02,957 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:02,957 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:02,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:02,957 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:03,208 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:03,209 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:03,291 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:03,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:03,325 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:03,408 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:03,414 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:03,414 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:03,419 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:03,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:03,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:03,426 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:03,426 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:03,427 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:03,435 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:03,438 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:03,440 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:03,442 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:03,445 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:03,447 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:03,450 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:03,452 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:03,455 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:03,457 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:03,459 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:03,468 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:03,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:03,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:03,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:03,480 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:03,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:03,491 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:03,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:03,491 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:03,505 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:03,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:03,515 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:03,515 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:03,515 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:03,515 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:03,516 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:03,516 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:03,516 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:03,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:03,516 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:03,517 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:03,518 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:03,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:03,518 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:03,518 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:03,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:03,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:03,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:03,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:03,519 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:03,519 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:03,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:03,520 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:03,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:03,520 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:03,520 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:03,520 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:03,521 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:03,522 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:03,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:03,522 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:03,522 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:03,522 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:03,528 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:03,528 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:03,529 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:03,529 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:03,531 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 37/400.
2025-08-04 20:29:03,632 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:03,632 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:03,633 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:29:03,634 - ClientAppLogger [Client 5] - INFO - [Client] Round 37: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:29:03,634 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:03,658 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0806, Avg D Loss: 0.8403
2025-08-04 20:29:03,658 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0806, Avg D Loss: 0.8403
2025-08-04 20:29:03,659 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:03,676 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3303, Threshold=0.3451, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:03,676 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:29:03,676 - ClientAppLogger [Client 5] - INFO - Fit completed for round 37. Duration: 0.15s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 37, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0806055545806883, 'd_loss': 0.8402674078941346, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14528250694274902, 'cpu_percent_fit': 45.3625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:29:03,676 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:29:11,942 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:11,942 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:11,942 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:11,942 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:11,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:11,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:12,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:12,255 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:12,339 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:12,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:12,387 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:12,598 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:12,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:12,607 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:12,615 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:12,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:12,631 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:12,632 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:12,632 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:12,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:12,647 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:12,650 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:12,652 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:12,655 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:12,659 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:12,663 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:12,666 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:12,669 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:12,672 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:12,674 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:12,677 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:12,689 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:12,689 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:12,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:12,694 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:12,700 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:12,700 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:12,711 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:12,711 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:12,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:12,727 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:12,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:12,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:12,748 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:12,751 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:12,751 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:12,752 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:12,752 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:12,752 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:12,752 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:12,753 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:12,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:12,754 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:12,755 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:12,755 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:12,756 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:12,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:12,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:12,756 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:12,757 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:12,757 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:12,758 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:12,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:12,758 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:12,758 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:12,759 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:12,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:12,759 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:12,759 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:12,760 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:12,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:12,760 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:12,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:12,760 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:12,761 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:12,761 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:12,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:12,761 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:12,761 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:12,761 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:12,773 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:12,773 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:12,775 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:12,775 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:12,776 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:12,777 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:12,777 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:12,778 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:12,798 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3374, Threshold=0.3546, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:12,798 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3374
2025-08-04 20:29:18,064 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:18,064 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:18,064 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:18,064 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:18,065 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:18,065 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:18,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:18,310 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:18,393 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:18,430 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:18,430 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:18,528 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:18,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:18,535 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:18,540 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:18,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:18,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:18,546 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:18,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:18,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:18,555 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:18,557 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:18,560 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:18,562 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:18,565 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:18,567 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:18,570 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:18,573 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:18,576 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:18,578 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:18,580 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:18,591 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:18,591 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:18,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:18,596 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:18,603 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:18,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:18,615 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:18,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:18,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:18,631 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:18,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:18,641 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:18,641 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:18,642 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:18,642 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:18,642 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:18,642 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:18,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:18,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:18,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:18,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:18,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:18,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:18,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:18,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:18,646 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:18,647 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:18,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:18,647 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:18,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:18,647 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:18,647 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:18,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:18,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:18,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:18,648 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:18,648 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:18,649 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:18,649 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:18,649 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:18,649 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:18,649 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:18,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:18,655 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:18,656 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:18,657 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:18,657 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:18,659 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 38/400.
2025-08-04 20:29:18,760 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:18,760 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:18,762 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:29:18,762 - ClientAppLogger [Client 5] - INFO - [Client] Round 38: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:29:18,762 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:18,787 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.8395
2025-08-04 20:29:18,787 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.8395
2025-08-04 20:29:18,788 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:18,803 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3276, Threshold=0.3433, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:18,803 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:29:18,803 - ClientAppLogger [Client 5] - INFO - Fit completed for round 38. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 38, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0836129426956176, 'd_loss': 0.8395074546337128, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.1444563865661621, 'cpu_percent_fit': 46.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:29:18,804 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:29:24,057 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:24,057 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:24,057 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:24,058 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:24,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:24,058 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:24,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:24,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:24,428 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:24,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:24,471 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:24,600 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:24,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:24,608 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:24,617 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:24,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:24,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:24,625 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:24,625 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:24,626 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:24,634 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:24,637 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:24,639 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:24,642 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:24,644 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:24,646 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:24,649 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:24,652 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:24,655 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:24,657 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:24,659 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:24,670 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:24,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:24,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:24,675 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:24,680 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:24,680 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:24,692 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:24,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:24,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:24,709 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:24,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:24,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:24,724 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:24,724 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:24,724 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:24,724 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:24,724 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:24,725 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:24,725 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:24,725 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:24,725 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:24,727 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:24,727 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:24,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:24,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:24,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:24,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:24,728 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:24,729 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:24,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:24,729 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:24,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:24,729 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:24,729 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:24,730 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:24,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:24,730 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:24,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:24,730 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:24,731 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:24,731 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:24,731 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:24,732 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:24,732 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:24,732 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:24,732 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:24,732 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:24,732 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:24,733 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:24,737 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:24,738 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:24,739 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:24,739 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:24,741 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:24,741 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:24,741 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:24,742 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:24,759 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3342, Threshold=0.3518, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:24,759 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3342
2025-08-04 20:29:33,025 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:33,025 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:33,025 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:33,026 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:33,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:33,026 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:33,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:33,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:33,347 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:33,382 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:33,382 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:33,471 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:33,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:33,477 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:33,482 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:33,487 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:33,488 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:33,488 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:33,488 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:33,488 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:33,496 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:33,499 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:33,501 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:33,503 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:33,506 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:33,508 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:33,511 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:33,513 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:33,515 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:33,517 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:33,519 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:33,528 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:33,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:33,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:33,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:33,537 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:33,537 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:33,545 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:33,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:33,545 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:33,559 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:33,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:33,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:33,570 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:33,571 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:33,571 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:33,571 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:33,571 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:33,571 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:33,572 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:33,572 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:33,572 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:33,573 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:33,573 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:33,574 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:33,575 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:33,576 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:33,576 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:33,576 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:33,576 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:33,576 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:33,576 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:33,577 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:33,577 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:33,577 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:33,577 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:33,577 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:33,578 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:33,584 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:33,584 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:33,585 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:33,585 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:33,586 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 39/400.
2025-08-04 20:29:33,688 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:33,688 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:33,689 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:29:33,689 - ClientAppLogger [Client 5] - INFO - [Client] Round 39: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:29:33,689 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:33,714 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0723, Avg D Loss: 0.8410
2025-08-04 20:29:33,714 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0723, Avg D Loss: 0.8410
2025-08-04 20:29:33,715 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:33,728 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3251, Threshold=0.3412, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:33,728 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:29:33,729 - ClientAppLogger [Client 5] - INFO - Fit completed for round 39. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 39, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.072264075279236, 'd_loss': 0.8409816801548005, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14241671562194824, 'cpu_percent_fit': 47.1375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:29:33,729 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:29:38,994 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:38,995 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:38,995 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:38,995 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:38,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:38,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:39,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:39,448 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:39,553 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:39,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:39,604 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:39,741 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:39,747 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:39,748 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:39,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:39,763 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:39,763 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:39,764 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:39,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:39,764 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:39,773 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:39,776 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,779 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:39,781 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:39,783 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:39,785 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:39,788 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,790 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:39,793 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:39,795 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:39,797 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:39,806 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:39,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:39,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:39,813 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:39,820 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:39,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:39,833 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:39,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:39,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:39,848 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:39,853 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:39,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:39,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:39,858 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:39,858 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:39,858 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:39,859 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:39,859 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:39,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:39,859 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:39,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:39,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:39,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:39,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:39,861 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:39,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:39,861 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:39,862 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:39,863 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:39,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:39,863 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:39,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:39,863 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:39,863 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:39,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:39,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:39,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:39,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:39,864 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:39,864 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:39,865 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:39,873 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:39,873 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:39,874 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:39,874 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:39,875 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:39,875 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:39,876 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:39,876 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:39,890 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3369, Threshold=0.3538, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:39,890 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3369
2025-08-04 20:29:45,152 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:45,152 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:45,152 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:45,152 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:45,153 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:45,153 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:45,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:45,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:45,532 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:45,569 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:45,569 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:45,665 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:45,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:45,671 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:45,676 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:45,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:45,681 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:45,682 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:45,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:45,682 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:45,690 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:45,693 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:45,696 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:45,698 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:45,701 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:45,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:45,706 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:45,709 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:45,712 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:45,714 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:45,716 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:45,725 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:45,725 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:45,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:45,730 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:45,738 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:45,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:45,748 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:45,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:45,749 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:45,765 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:45,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:45,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:45,777 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:45,777 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:45,777 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:45,778 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:45,778 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:45,778 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:45,779 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:45,779 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:45,779 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:45,781 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:45,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:45,781 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:45,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:45,782 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:45,782 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:45,782 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:45,782 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:45,782 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:45,783 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:45,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:45,783 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:45,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:45,783 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:45,784 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:45,784 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:45,784 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:45,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:45,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:45,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:45,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:45,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:45,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:45,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:45,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:45,786 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:45,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:45,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:45,792 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:45,792 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:45,793 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:45,793 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:45,795 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 40/400.
2025-08-04 20:29:45,896 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:45,896 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:45,897 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 2 anomalous samples to GAN training data (target: 2).
2025-08-04 20:29:45,897 - ClientAppLogger [Client 5] - INFO - [Client] Round 40: Training GAN with 10 samples (8 normal, 2 anomalous).
2025-08-04 20:29:45,897 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:45,921 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0788, Avg D Loss: 0.8403
2025-08-04 20:29:45,921 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0788, Avg D Loss: 0.8403
2025-08-04 20:29:45,921 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:45,935 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3273, Threshold=0.3428, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:45,935 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8027
2025-08-04 20:29:45,936 - ClientAppLogger [Client 5] - INFO - Fit completed for round 40. Duration: 0.14s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 40, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0788252353668213, 'd_loss': 0.8402816534042359, 'post_fit_local_f1': 0.8027057497181511, 'fit_time_seconds': 0.14048409461975098, 'cpu_percent_fit': 46.8625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10}
2025-08-04 20:29:45,936 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 20:29:51,186 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:51,186 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 20:29:51,187 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 20:29:51,187 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 20:29:51,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 20:29:51,187 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:51,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:51,425 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:51,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 20:29:51,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 20:29:51,538 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:51,639 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:51,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:51,645 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:51,651 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 20:29:51,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:51,671 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 20:29:51,672 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:51,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:51,672 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 20:29:51,681 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:51,684 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:51,686 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:51,688 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:51,691 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:51,693 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:51,696 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:51,698 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:51,701 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:51,703 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:51,705 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:51,716 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:51,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 20:29:51,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 20:29:51,721 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 20:29:51,726 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:51,726 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 20:29:51,737 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:51,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 20:29:51,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:51,754 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:51,760 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 20:29:51,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 20:29:51,768 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:51,768 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:51,769 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:51,769 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:51,769 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:51,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 20:29:51,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:51,770 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 20:29:51,770 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:51,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 20:29:51,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 20:29:51,772 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:51,772 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 20:29:51,773 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 20:29:51,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 20:29:51,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 20:29:51,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 20:29:51,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 20:29:51,774 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 20:29:51,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 20:29:51,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 20:29:51,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 20:29:51,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:51,775 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 20:29:51,775 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:51,776 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:51,776 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:51,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 20:29:51,776 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 20:29:51,776 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 20:29:51,776 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 20:29:51,780 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 20:29:51,780 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:51,781 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:51,781 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 20:29:51,783 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:51,783 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:51,783 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:51,783 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:51,800 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.3436, Threshold=0.3616, Accuracy=0.7177, F1=0.8027, Precision=0.9570, Recall=0.6913
2025-08-04 20:29:51,800 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7177, F1: 0.8027, Prec: 0.9570, Rec: 0.6913, Avg Anomaly Score: 0.3436
