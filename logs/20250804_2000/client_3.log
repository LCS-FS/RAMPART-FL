2025-08-04 20:21:12,240 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:12,242 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:12,243 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:12,245 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:21:12,247 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:21:12,249 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:13,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:13,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:13,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:21:13,365 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:21:13,365 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:13,569 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:13,577 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:13,577 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:13,584 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:21:13,592 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:13,592 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:21:13,593 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:13,593 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:13,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:21:13,607 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:13,611 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,614 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:13,617 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:13,621 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:13,623 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:13,627 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,631 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:13,634 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:13,640 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:13,645 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:13,668 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:13,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:21:13,676 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:21:13,677 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:21:13,692 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:13,693 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:21:13,716 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:13,717 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:21:13,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:13,742 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:13,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:21:13,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:21:13,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:13,778 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:13,778 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:13,779 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:13,779 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:13,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:21:13,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:13,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:21:13,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:13,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:21:13,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:21:13,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:13,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:21:13,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:13,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:13,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:13,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:21:13,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:21:13,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:21:13,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:21:13,789 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:21:13,791 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:21:13,792 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:21:13,792 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:21:13,793 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:21:13,793 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:21:13,794 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:21:13,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:21:13,795 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:13,795 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:21:13,805 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:13,806 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:13,807 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:13,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:21:13,808 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:21:13,809 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:21:13,810 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:21:13,817 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:21:13,818 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:13,828 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:13,828 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:13,834 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:13,834 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:13,834 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:13,836 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:13,922 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5013, Accuracy=0.5152, F1=0.6667, Precision=0.8101, Recall=0.5664
2025-08-04 20:21:13,923 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5152, F1: 0.6667, Prec: 0.8101, Rec: 0.5664, Avg Anomaly Score: 0.5018
2025-08-04 20:21:28,285 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:28,286 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:28,286 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:28,286 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:21:28,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:21:28,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:29,445 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:29,446 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:29,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:21:29,592 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:21:29,593 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:29,839 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:29,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:29,851 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:29,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:21:29,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:29,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:21:29,877 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:29,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:29,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:21:29,896 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:29,900 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,908 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:29,913 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:29,918 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:29,922 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:29,927 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,931 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:29,934 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:29,937 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:29,940 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:29,953 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:29,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:21:29,959 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:21:29,959 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:21:29,970 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:29,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:21:29,995 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:29,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:21:29,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,019 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,103 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,104 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,104 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,104 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:21:30,104 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,105 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:21:30,105 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,106 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:21:30,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,107 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,107 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,107 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,107 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,108 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,108 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:21:30,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:21:30,109 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:21:30,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:21:30,109 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:21:30,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:21:30,110 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:21:30,110 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:21:30,111 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:21:30,111 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:21:30,111 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:21:30,112 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:21:30,112 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,112 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:21:30,113 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,113 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,113 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,114 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:21:30,114 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:21:30,114 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:21:30,114 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:21:30,121 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:21:30,121 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,123 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,123 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:30,125 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,126 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,126 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,127 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,138 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5013, Accuracy=0.5152, F1=0.6667, Precision=0.8101, Recall=0.5664
2025-08-04 20:21:30,139 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5152, F1: 0.6667, Prec: 0.8101, Rec: 0.5664, Avg Anomaly Score: 0.5018
2025-08-04 20:21:41,437 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,437 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:41,437 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:41,438 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:21:41,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:21:41,439 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:41,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:41,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:41,984 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:21:42,023 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:21:42,023 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,217 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,235 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,255 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:21:42,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,295 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:21:42,307 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,310 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,313 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,316 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,320 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,324 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,327 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,331 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,335 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,337 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,340 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,356 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,357 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:21:42,362 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,363 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:21:42,372 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,372 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:21:42,397 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:21:42,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,424 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:21:42,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:21:42,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,451 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,451 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,452 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,452 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,452 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:21:42,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,453 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:21:42,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,455 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:21:42,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,456 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,456 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,457 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,457 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,458 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:21:42,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:21:42,458 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:21:42,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:21:42,459 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:21:42,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:21:42,460 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:21:42,461 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:21:42,461 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:21:42,461 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,463 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:21:42,463 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,463 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,464 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,464 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:21:42,465 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:21:42,465 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:21:42,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:21:42,475 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:21:42,475 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,476 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,477 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:42,478 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,478 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,479 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,480 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,491 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5077, Accuracy=0.5606, F1=0.6979, Precision=0.8481, Recall=0.5929
2025-08-04 20:21:42,494 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5606, F1: 0.6979, Prec: 0.8481, Rec: 0.5929, Avg Anomaly Score: 0.5078
2025-08-04 20:21:53,775 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:53,775 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:53,775 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:53,775 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:21:53,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:21:53,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:21:54,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:21:54,323 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:54,479 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:54,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:54,496 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:54,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:21:54,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:54,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:21:54,574 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:54,574 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:54,575 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:21:54,590 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:54,596 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,599 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:54,602 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:54,606 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:54,609 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:54,612 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,614 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:54,618 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:54,620 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:54,623 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:54,640 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:54,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:21:54,646 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:21:54,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:21:54,661 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:54,661 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:21:54,694 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:54,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:21:54,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:54,721 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:54,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:21:54,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:21:54,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:54,742 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:54,742 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:54,743 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:54,743 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:54,743 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:21:54,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:54,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:21:54,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:54,745 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:21:54,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:21:54,746 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:54,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:21:54,746 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:54,747 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:54,747 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:54,747 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:21:54,747 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:21:54,748 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:21:54,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:21:54,748 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:21:54,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:21:54,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:21:54,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:21:54,750 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:21:54,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:21:54,751 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:21:54,752 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:21:54,752 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:54,753 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:21:54,753 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:54,754 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:54,754 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:54,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:21:54,755 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:21:54,755 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:21:54,755 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:21:54,762 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:21:54,762 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:54,764 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:54,764 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:54,766 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:54,766 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:54,766 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:54,768 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:54,779 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.5152, F1=0.6667, Precision=0.8101, Recall=0.5664
2025-08-04 20:21:54,779 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5152, F1: 0.6667, Prec: 0.8101, Rec: 0.5664, Avg Anomaly Score: 0.5085
2025-08-04 20:22:09,055 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,055 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:09,055 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:09,055 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:22:09,055 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:22:09,055 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:09,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:09,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:09,481 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:22:09,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:22:09,512 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:09,658 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:09,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:09,672 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:09,683 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:22:09,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:09,699 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:22:09,699 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:09,700 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:09,700 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:22:09,711 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:09,715 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:09,717 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:09,720 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:09,724 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:09,728 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:09,731 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:09,734 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:09,737 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:09,739 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:09,742 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:09,757 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:09,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:22:09,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:22:09,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:22:09,772 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:09,773 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:22:09,794 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:09,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:22:09,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:09,817 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:09,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:22:09,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:22:09,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:09,842 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:09,842 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:09,842 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:09,843 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:09,844 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:22:09,844 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:09,844 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:22:09,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:09,847 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:22:09,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:22:09,848 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:09,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:22:09,848 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:09,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:09,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:09,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:22:09,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:22:09,850 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:22:09,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:22:09,850 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:22:09,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:22:09,851 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:22:09,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:22:09,852 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:22:09,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:22:09,853 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:22:09,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:22:09,853 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:09,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:22:09,854 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:09,854 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:09,854 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:09,855 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:22:09,855 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:22:09,856 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:22:09,856 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:22:09,861 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:22:09,862 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:09,863 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:09,863 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:09,865 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:09,865 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:09,865 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:09,866 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:09,876 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5076, Accuracy=0.5000, F1=0.6562, Precision=0.7975, Recall=0.5575
2025-08-04 20:22:09,876 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5000, F1: 0.6562, Prec: 0.7975, Rec: 0.5575, Avg Anomaly Score: 0.5085
2025-08-04 20:22:24,145 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,146 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:24,146 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:24,146 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:22:24,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:22:24,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:24,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:24,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:24,491 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:22:24,519 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:22:24,519 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:24,623 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:24,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:24,629 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:24,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:22:24,650 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:24,650 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:22:24,651 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:24,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:24,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:22:24,665 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:24,669 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:24,671 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:24,673 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:24,678 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:24,680 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:24,683 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:24,685 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:24,688 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:24,690 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:24,693 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:24,704 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:24,704 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:22:24,709 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:22:24,709 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:22:24,714 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:24,714 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:22:24,725 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:24,726 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:22:24,726 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:24,744 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:24,752 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:22:24,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:22:24,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:24,770 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:24,770 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:24,771 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:24,771 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:24,771 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:22:24,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:24,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:22:24,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:24,773 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:22:24,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:22:24,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:24,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:22:24,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:24,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:24,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:24,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:22:24,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:22:24,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:22:24,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:22:24,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:22:24,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:22:24,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:22:24,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:22:24,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:22:24,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:22:24,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:22:24,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:22:24,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:24,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:22:24,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:24,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:24,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:24,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:22:24,781 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:22:24,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:22:24,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:22:24,786 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:22:24,787 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:24,788 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:24,788 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:24,789 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:24,790 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:24,790 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:24,791 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:24,799 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.5000, F1=0.6562, Precision=0.7975, Recall=0.5575
2025-08-04 20:22:24,800 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5000, F1: 0.6562, Prec: 0.7975, Rec: 0.5575, Avg Anomaly Score: 0.5053
2025-08-04 20:22:39,075 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:39,075 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:39,075 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:39,075 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:22:39,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:22:39,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:39,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:39,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:39,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:22:39,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:22:39,438 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:39,534 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:39,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:39,540 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:39,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:22:39,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:39,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:22:39,553 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:39,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:39,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:22:39,562 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:39,565 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:39,567 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:39,569 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:39,573 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:39,575 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:39,577 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:39,580 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:39,583 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:39,584 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:39,586 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:39,596 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:39,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:22:39,602 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:22:39,602 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:22:39,607 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:39,607 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:22:39,616 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:39,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:22:39,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:39,633 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:39,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:22:39,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:22:39,646 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:39,646 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:39,646 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:39,646 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:39,647 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:39,647 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:22:39,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:39,647 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:22:39,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:39,649 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:22:39,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:22:39,650 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:39,650 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:22:39,650 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:39,650 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:39,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:39,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:22:39,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:22:39,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:22:39,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:22:39,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:22:39,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:22:39,652 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:22:39,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:22:39,652 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:22:39,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:22:39,653 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:22:39,653 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:22:39,653 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:39,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:22:39,654 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:39,654 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:39,655 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:39,655 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:22:39,655 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:22:39,656 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:22:39,656 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:22:39,660 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:22:39,660 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:39,661 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:39,662 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:39,664 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:39,664 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:39,664 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:39,665 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:39,673 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4971, Threshold=0.4943, Accuracy=0.4848, F1=0.6458, Precision=0.7848, Recall=0.5487
2025-08-04 20:22:39,673 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.4848, F1: 0.6458, Prec: 0.7848, Rec: 0.5487, Avg Anomaly Score: 0.4971
2025-08-04 20:22:53,958 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:53,958 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:53,958 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:53,958 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:22:53,958 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:22:53,958 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:54,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:54,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:54,320 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:22:54,341 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:22:54,341 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:54,438 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:54,444 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:54,445 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:54,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:22:54,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:54,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:22:54,458 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:54,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:54,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:22:54,467 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:54,470 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:54,472 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:54,474 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:54,477 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:54,480 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:54,482 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:54,485 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:54,488 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:54,490 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:54,492 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:54,502 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:54,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:22:54,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:22:54,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:22:54,513 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:54,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:22:54,522 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:54,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:22:54,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:54,538 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:54,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:22:54,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:22:54,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:54,550 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:54,550 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:54,551 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:54,551 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:54,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:22:54,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:54,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:22:54,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:54,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:22:54,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:22:54,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:54,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:22:54,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:54,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:54,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:54,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:22:54,555 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:22:54,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:22:54,559 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:22:54,559 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:22:54,559 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:22:54,560 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:22:54,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:22:54,560 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:22:54,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:22:54,561 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:22:54,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:22:54,562 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:54,562 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:22:54,562 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:54,563 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:54,563 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:54,563 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:22:54,563 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:22:54,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:22:54,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:22:54,568 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:22:54,568 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:54,570 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:54,570 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:54,571 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:54,572 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:54,572 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:54,573 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:54,581 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4817, Threshold=0.4777, Accuracy=0.4848, F1=0.6458, Precision=0.7848, Recall=0.5487
2025-08-04 20:22:54,581 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.4848, F1: 0.6458, Prec: 0.7848, Rec: 0.5487, Avg Anomaly Score: 0.4817
2025-08-04 20:23:05,861 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:05,862 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:05,862 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:05,862 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:23:05,862 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:23:05,862 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:06,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:06,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:06,216 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:23:06,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:23:06,239 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:06,330 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:06,337 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:06,337 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:06,342 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:23:06,347 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:06,348 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:23:06,348 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:06,348 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:06,348 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:23:06,358 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:06,360 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:06,363 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:06,365 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:06,367 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:06,370 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:06,372 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:06,375 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:06,378 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:06,380 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:06,382 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:06,392 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:06,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:23:06,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:23:06,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:23:06,402 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:06,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:23:06,410 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:06,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:23:06,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:06,427 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:06,432 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:23:06,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:23:06,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:06,439 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:06,439 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:06,439 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:06,439 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:06,439 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:23:06,440 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:06,440 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:23:06,440 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:06,441 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:23:06,441 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:23:06,442 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:06,442 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:23:06,442 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:06,442 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:06,442 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:06,442 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:23:06,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:23:06,444 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:23:06,444 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:23:06,444 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:23:06,444 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:23:06,444 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:06,444 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:23:06,445 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:06,445 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:06,445 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:06,445 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:23:06,446 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:23:06,446 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:23:06,446 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:23:06,449 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:23:06,450 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:06,451 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:06,451 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:06,452 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:06,452 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:06,452 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:06,453 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:06,462 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4586, Threshold=0.4525, Accuracy=0.4848, F1=0.6458, Precision=0.7848, Recall=0.5487
2025-08-04 20:23:06,462 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.4848, F1: 0.6458, Prec: 0.7848, Rec: 0.5487, Avg Anomaly Score: 0.4586
2025-08-04 20:23:20,764 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:20,764 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:20,764 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:20,764 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:23:20,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:23:20,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:21,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:21,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:21,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:23:21,168 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:23:21,169 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:21,262 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:21,268 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:21,269 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:21,275 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:23:21,284 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:21,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:23:21,285 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:21,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:21,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:23:21,294 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:21,297 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:21,300 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:21,302 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:21,305 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:21,307 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:21,309 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:21,312 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:21,314 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:21,316 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:21,319 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:21,328 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:21,328 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:23:21,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:23:21,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:23:21,338 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:21,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:23:21,347 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:21,348 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:23:21,348 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:21,365 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:21,370 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:23:21,375 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:23:21,375 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:21,376 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:21,376 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:21,376 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:21,376 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:21,376 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:23:21,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:21,377 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:23:21,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:21,378 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:23:21,379 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:23:21,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:21,379 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:23:21,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:21,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:21,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:21,380 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:23:21,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:23:21,380 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:23:21,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:23:21,380 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:23:21,381 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:23:21,381 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:23:21,381 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:23:21,381 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:23:21,381 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:23:21,382 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:23:21,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:23:21,382 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:21,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:23:21,383 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:21,383 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:21,384 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:21,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:23:21,384 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:23:21,384 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:23:21,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:23:21,389 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:23:21,389 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:21,390 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:21,391 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:21,392 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:21,392 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:21,392 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:21,393 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:21,402 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4205, Threshold=0.4118, Accuracy=0.5000, F1=0.6562, Precision=0.7975, Recall=0.5575
2025-08-04 20:23:21,402 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5000, F1: 0.6562, Prec: 0.7975, Rec: 0.5575, Avg Anomaly Score: 0.4205
2025-08-04 20:23:32,687 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:32,688 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:32,688 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:32,688 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:23:32,688 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:23:32,688 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:32,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:32,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:33,024 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:23:33,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:23:33,046 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:33,138 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:33,143 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:33,143 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:33,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:23:33,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:33,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:23:33,153 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:33,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:33,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:23:33,162 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:33,165 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:33,167 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:33,169 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:33,172 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:33,174 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:33,176 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:33,179 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:33,182 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:33,184 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:33,186 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:33,195 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:33,195 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:23:33,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:23:33,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:23:33,206 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:33,206 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:23:33,217 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:33,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:23:33,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:33,233 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:33,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:23:33,242 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:23:33,242 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:33,242 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:33,243 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:33,243 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:33,243 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:33,243 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:23:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:33,244 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:23:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:33,245 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:23:33,246 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:23:33,246 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:33,246 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:23:33,246 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:33,246 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:23:33,247 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:23:33,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:23:33,248 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:23:33,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:23:33,248 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:23:33,249 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:23:33,249 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:33,249 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:23:33,249 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:33,249 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:33,250 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:33,250 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:23:33,250 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:23:33,250 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:23:33,250 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:23:33,254 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:23:33,254 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:33,255 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:33,255 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:33,257 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:33,257 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:33,257 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:33,258 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:33,266 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3647, Threshold=0.3534, Accuracy=0.5000, F1=0.6562, Precision=0.7975, Recall=0.5575
2025-08-04 20:23:33,266 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5000, F1: 0.6562, Prec: 0.7975, Rec: 0.5575, Avg Anomaly Score: 0.3647
2025-08-04 20:23:38,529 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:38,529 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:38,529 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:38,529 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:23:38,530 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:23:38,530 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:38,816 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:38,816 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:38,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:23:38,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:23:38,924 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:39,020 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:39,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:39,026 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:39,031 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:23:39,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:39,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:23:39,041 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:39,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:39,042 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:23:39,051 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:39,054 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:39,059 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:39,061 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:39,064 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:39,066 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:39,068 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:39,071 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:39,073 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:39,075 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:39,078 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:39,087 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:39,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:23:39,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:23:39,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:23:39,097 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:39,097 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:23:39,109 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:39,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:23:39,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:39,127 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:39,132 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:23:39,139 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:23:39,139 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:39,140 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:39,140 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:39,140 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:39,140 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:39,141 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:23:39,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:39,141 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:23:39,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:39,143 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:23:39,143 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:23:39,144 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:39,144 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:23:39,145 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:39,145 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:39,145 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:39,145 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:23:39,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:23:39,146 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:23:39,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:23:39,146 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:23:39,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:23:39,146 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:23:39,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:23:39,147 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:23:39,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:23:39,148 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:23:39,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:23:39,148 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:39,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:23:39,148 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:39,149 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:39,149 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:39,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:23:39,149 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:23:39,150 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:23:39,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:23:39,154 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:23:39,156 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:39,158 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:39,158 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:39,160 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 12/400.
2025-08-04 20:23:39,265 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:39,265 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:39,267 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:23:39,270 - ClientAppLogger [Client 3] - INFO - [Client] Round 12: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:23:39,271 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:40,924 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0521, Avg D Loss: 0.9310
2025-08-04 20:23:40,924 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0521, Avg D Loss: 0.9310
2025-08-04 20:23:40,924 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:40,934 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3547, Threshold=0.3429, Accuracy=0.5000, F1=0.6562, Precision=0.7975, Recall=0.5575
2025-08-04 20:23:40,934 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.6562
2025-08-04 20:23:40,934 - ClientAppLogger [Client 3] - INFO - Fit completed for round 12. Duration: 1.77s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 12, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0520784139633177, 'd_loss': 0.9310412228107452, 'post_fit_local_f1': 0.65625, 'fit_time_seconds': 1.7719533443450928, 'cpu_percent_fit': 5.275, 'ram_mb_fit': 124.75, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:23:40,935 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:23:46,218 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:46,218 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:46,218 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:46,218 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:23:46,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:23:46,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:46,688 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:46,689 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:46,793 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:23:46,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:23:46,830 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:47,016 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:47,024 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:47,024 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:47,031 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:23:47,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:47,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:23:47,042 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:47,042 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:47,042 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:23:47,052 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:47,055 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,057 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:47,059 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:47,062 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:47,064 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:47,067 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,069 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:47,072 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:47,074 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:47,076 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:47,088 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:47,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:23:47,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:23:47,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:23:47,103 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:47,103 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:23:47,115 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:47,116 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:23:47,116 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:47,133 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:47,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:23:47,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:23:47,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:47,147 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:47,148 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:47,148 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:47,148 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:47,148 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:23:47,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:47,149 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:23:47,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:47,150 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:23:47,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:23:47,151 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:47,151 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:23:47,151 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:47,151 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:47,151 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:47,152 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:23:47,152 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:23:47,152 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:23:47,152 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:23:47,152 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:23:47,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:23:47,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:23:47,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:23:47,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:23:47,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:23:47,154 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:23:47,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:23:47,154 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:47,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:23:47,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:47,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:47,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:47,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:23:47,155 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:23:47,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:23:47,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:23:47,161 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:23:47,161 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:47,162 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:47,163 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:47,164 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:47,164 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:47,164 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:47,165 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:47,175 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3037, Threshold=0.2978, Accuracy=0.5000, F1=0.6562, Precision=0.7975, Recall=0.5575
2025-08-04 20:23:47,175 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5000, F1: 0.6562, Prec: 0.7975, Rec: 0.5575, Avg Anomaly Score: 0.3037
2025-08-04 20:23:58,442 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:58,443 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:58,443 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:58,443 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:23:58,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:23:58,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:58,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:58,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:58,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:23:58,889 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:23:58,889 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:59,057 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:59,064 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:59,065 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:59,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:23:59,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:59,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:23:59,107 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:59,107 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:59,107 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:23:59,116 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:59,119 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,122 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:59,124 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:59,127 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:59,129 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:59,131 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,134 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:59,137 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:59,139 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:59,142 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:59,152 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:59,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:23:59,157 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:23:59,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:23:59,165 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:59,165 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:23:59,177 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:59,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:23:59,178 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:59,197 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:59,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:23:59,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:23:59,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:59,209 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:59,209 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:59,210 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:59,210 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:59,210 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:23:59,210 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:59,210 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:23:59,211 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:59,212 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:23:59,212 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:23:59,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:59,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:23:59,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:59,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:59,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:59,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:23:59,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:23:59,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:23:59,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:23:59,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:23:59,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:23:59,215 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:23:59,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:23:59,215 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:23:59,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:23:59,216 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:23:59,216 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:23:59,216 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:59,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:23:59,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:59,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:59,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:59,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:23:59,218 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:23:59,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:23:59,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:23:59,229 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:23:59,229 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:59,230 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:59,231 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:59,232 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:59,232 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:59,233 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:59,233 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:59,244 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3053, Threshold=0.3027, Accuracy=0.5758, F1=0.7083, Precision=0.8608, Recall=0.6018
2025-08-04 20:23:59,244 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5758, F1: 0.7083, Prec: 0.8608, Rec: 0.6018, Avg Anomaly Score: 0.3053
2025-08-04 20:24:10,510 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:10,510 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:10,510 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:10,510 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:24:10,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:24:10,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:10,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:10,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:10,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:24:10,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:24:10,926 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:11,042 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:11,048 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:11,048 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:11,054 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:24:11,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:11,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:24:11,087 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:11,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:11,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:24:11,097 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:11,100 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,102 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:11,104 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:11,107 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:11,109 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:11,112 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,114 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:11,117 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:11,118 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:11,121 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:11,131 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:11,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:24:11,136 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:24:11,136 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:24:11,142 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:11,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:24:11,153 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:11,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:24:11,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:11,169 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:11,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:24:11,179 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:24:11,179 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:11,179 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:11,179 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:11,179 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:11,180 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:11,180 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:24:11,180 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:11,180 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:24:11,180 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:11,182 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:24:11,182 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:24:11,182 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:11,182 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:24:11,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:11,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:11,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:11,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:24:11,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:24:11,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:24:11,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:24:11,184 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:24:11,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:24:11,184 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:24:11,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:24:11,185 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:24:11,185 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:24:11,185 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:24:11,186 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:24:11,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:11,186 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:24:11,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:11,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:11,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:11,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:24:11,187 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:24:11,187 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:24:11,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:24:11,194 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:24:11,194 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:11,195 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:11,196 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:11,197 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:11,197 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:11,197 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:11,198 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:11,206 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3226, Threshold=0.3244, Accuracy=0.5909, F1=0.7188, Precision=0.8734, Recall=0.6106
2025-08-04 20:24:11,207 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.5909, F1: 0.7188, Prec: 0.8734, Rec: 0.6106, Avg Anomaly Score: 0.3226
2025-08-04 20:24:22,469 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:22,470 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:22,470 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:22,470 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:24:22,470 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:24:22,470 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:22,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:22,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:22,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:24:22,927 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:24:22,927 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:23,085 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:23,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:23,093 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:23,100 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:24:23,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:23,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:24:23,109 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:23,110 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:23,110 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:24:23,120 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:23,123 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,126 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:23,129 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:23,136 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:23,139 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:23,142 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,145 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:23,148 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:23,150 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:23,152 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:23,162 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:23,162 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:24:23,168 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:24:23,168 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:24:23,173 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:23,174 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:24:23,183 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:23,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:24:23,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:23,201 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:23,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:24:23,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:24:23,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:23,213 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:23,213 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:23,214 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:23,214 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:23,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:24:23,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:23,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:24:23,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:23,216 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:24:23,216 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:24:23,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:23,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:24:23,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:23,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:23,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:23,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:24:23,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:24:23,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:24:23,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:24:23,219 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:24:23,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:24:23,219 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:24:23,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:24:23,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:24:23,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:24:23,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:24:23,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:24:23,221 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:23,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:24:23,221 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:23,222 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:23,222 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:23,223 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:24:23,223 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:24:23,223 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:24:23,223 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:24:23,229 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:24:23,229 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:23,231 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:23,231 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:23,233 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:23,233 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:23,233 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:23,234 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:23,243 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3020, Threshold=0.3066, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:24:23,243 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3020
2025-08-04 20:24:34,513 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:34,513 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:34,513 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:34,513 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:24:34,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:24:34,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:34,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:34,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:34,874 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:24:34,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:24:34,901 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:34,990 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:34,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:34,997 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:35,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:24:35,008 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:35,009 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:24:35,009 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:35,009 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:35,009 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:24:35,019 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:35,022 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,024 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:35,026 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:35,029 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:35,032 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:35,035 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,037 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:35,040 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:35,042 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:35,044 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:35,057 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:35,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:24:35,062 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:24:35,062 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:24:35,069 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:35,069 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:24:35,083 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:35,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:24:35,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:35,101 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:35,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:24:35,116 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:24:35,116 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:35,116 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:35,116 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:35,117 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:35,117 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:35,117 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:24:35,117 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:35,118 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:24:35,118 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:35,119 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:24:35,120 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:24:35,120 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:35,120 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:24:35,120 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:35,121 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:35,121 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:35,121 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:24:35,121 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:24:35,121 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:24:35,122 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:24:35,122 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:24:35,122 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:24:35,123 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:24:35,123 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:24:35,123 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:24:35,123 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:24:35,124 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:24:35,124 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:24:35,125 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:35,125 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:24:35,125 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:35,125 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:35,126 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:35,126 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:24:35,126 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:24:35,127 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:24:35,127 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:24:35,131 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:24:35,131 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:35,132 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:35,132 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:35,134 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:35,134 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:35,134 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:35,135 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:35,144 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.2994, Threshold=0.3044, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:24:35,144 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.2994
2025-08-04 20:24:46,413 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:46,413 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:46,413 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:46,413 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:24:46,413 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:24:46,413 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:46,680 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:46,681 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:46,762 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:24:46,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:24:46,781 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:46,882 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:46,889 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:46,890 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:46,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:24:46,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:46,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:24:46,902 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:46,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:46,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:24:46,911 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:46,914 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:46,916 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:46,919 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:46,921 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:46,924 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:46,926 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:46,928 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:46,931 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:46,933 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:46,935 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:46,944 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:46,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:24:46,949 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:24:46,949 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:24:46,954 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:46,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:24:46,964 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:46,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:24:46,965 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:46,981 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:46,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:24:46,991 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:24:46,991 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:46,992 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:46,992 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:46,992 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:46,993 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:46,993 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:24:46,993 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:46,993 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:24:46,993 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:46,995 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:24:46,995 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:24:46,995 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:24:46,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:24:46,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:24:46,997 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:24:46,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:24:46,997 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:24:46,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:24:46,997 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:24:46,998 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:24:46,998 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:24:46,998 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:24:46,998 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:46,998 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:24:46,998 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:46,999 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:46,999 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:46,999 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:24:46,999 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:24:46,999 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:24:46,999 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:24:47,003 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:24:47,004 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:47,005 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:47,005 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:47,006 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:47,007 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:47,007 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:47,007 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:47,017 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.2973, Threshold=0.3039, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:24:47,017 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.2973
2025-08-04 20:25:01,286 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:01,286 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:01,286 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:01,286 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:25:01,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:25:01,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:01,530 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:01,531 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:01,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:25:01,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:25:01,642 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:01,727 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:01,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:01,732 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:01,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:25:01,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:01,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:25:01,745 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:01,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:01,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:25:01,754 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:01,756 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:01,759 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:01,761 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:01,763 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:01,766 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:01,768 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:01,771 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:01,773 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:01,775 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:01,778 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:01,786 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:01,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:25:01,791 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:25:01,791 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:25:01,796 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:01,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:25:01,805 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:01,805 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:25:01,805 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:01,820 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:01,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:25:01,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:25:01,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:01,829 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:01,829 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:01,830 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:01,830 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:01,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:25:01,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:01,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:25:01,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:01,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:25:01,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:25:01,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:01,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:25:01,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:25:01,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:25:01,834 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:25:01,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:25:01,834 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:25:01,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:25:01,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:25:01,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:25:01,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:01,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:25:01,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:01,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:01,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:01,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:25:01,836 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:25:01,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:25:01,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:25:01,840 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:25:01,840 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:01,841 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:01,841 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:01,843 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:01,843 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:01,843 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:01,843 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:01,851 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3040, Threshold=0.3106, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:25:01,852 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3040
2025-08-04 20:25:13,123 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:13,123 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:13,123 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:13,123 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:25:13,124 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:25:13,124 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:13,376 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:13,376 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:13,467 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:25:13,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:25:13,505 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:13,623 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:13,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:13,630 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:13,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:25:13,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:13,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:25:13,642 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:13,643 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:13,643 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:25:13,651 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:13,654 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:13,656 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:13,659 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:13,662 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:13,664 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:13,667 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:13,670 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:13,672 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:13,674 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:13,677 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:13,686 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:13,686 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:25:13,691 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:25:13,691 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:25:13,696 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:13,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:25:13,706 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:13,706 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:25:13,706 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:13,721 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:13,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:25:13,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:25:13,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:13,732 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:13,732 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:13,733 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:13,733 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:13,733 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:25:13,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:13,734 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:25:13,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:13,736 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:25:13,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:25:13,736 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:13,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:25:13,737 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:13,737 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:13,737 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:13,737 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:25:13,737 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:25:13,738 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:25:13,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:25:13,738 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:25:13,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:25:13,738 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:25:13,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:25:13,739 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:25:13,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:25:13,739 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:25:13,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:25:13,739 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:13,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:25:13,740 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:13,740 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:13,740 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:13,740 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:25:13,741 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:25:13,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:25:13,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:25:13,747 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:25:13,747 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:13,748 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:13,748 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:13,749 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:13,750 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:13,750 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:13,750 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:13,759 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3072, Threshold=0.3142, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:25:13,759 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3072
2025-08-04 20:25:25,041 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:25,041 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:25,041 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:25,042 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:25:25,042 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:25:25,042 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:25,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:25,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:25,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:25:25,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:25:25,433 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:25,517 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:25,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:25,523 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:25,529 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:25:25,536 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:25,536 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:25:25,537 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:25,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:25,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:25:25,546 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:25,548 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:25,551 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:25,553 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:25,557 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:25,560 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:25,563 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:25,565 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:25,569 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:25,572 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:25,574 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:25,583 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:25,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:25:25,588 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:25:25,588 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:25:25,594 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:25,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:25:25,605 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:25,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:25:25,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:25,619 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:25,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:25:25,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:25:25,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:25,629 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:25,629 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:25,630 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:25,630 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:25,630 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:25:25,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:25,630 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:25:25,631 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:25,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:25:25,632 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:25:25,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:25,632 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:25:25,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:25,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:25:25,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:25:25,634 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:25:25,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:25:25,634 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:25:25,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:25:25,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:25:25,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:25:25,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:25,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:25:25,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:25,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:25,636 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:25,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:25:25,636 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:25:25,636 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:25:25,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:25:25,643 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:25:25,643 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:25,644 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:25,644 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:25,646 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:25,646 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:25,646 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:25,647 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:25,654 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3189, Threshold=0.3260, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:25:25,655 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3189
2025-08-04 20:25:36,952 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:36,952 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:36,952 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:36,953 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:25:36,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:25:36,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:37,211 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:37,212 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:37,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:25:37,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:25:37,335 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:37,443 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:37,449 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:37,449 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:37,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:25:37,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:37,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:25:37,459 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:37,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:37,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:25:37,468 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:37,471 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:37,473 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:37,475 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:37,478 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:37,480 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:37,483 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:37,485 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:37,488 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:37,490 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:37,492 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:37,500 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:37,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:25:37,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:25:37,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:25:37,510 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:37,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:25:37,518 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:37,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:25:37,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:37,532 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:37,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:25:37,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:25:37,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:37,542 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:37,542 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:37,542 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:37,542 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:37,543 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:25:37,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:37,543 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:25:37,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:37,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:25:37,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:25:37,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:37,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:25:37,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:37,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:25:37,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:25:37,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:25:37,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:25:37,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:25:37,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:25:37,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:25:37,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:25:37,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:37,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:25:37,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:37,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:37,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:37,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:25:37,549 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:25:37,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:25:37,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:25:37,553 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:25:37,553 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:37,554 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:37,554 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:37,555 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:37,555 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:37,556 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:37,556 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:37,564 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3162, Threshold=0.3239, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:25:37,564 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3162
2025-08-04 20:25:42,846 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:42,846 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:42,846 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:42,847 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:25:42,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:25:42,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:43,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:43,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:43,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:25:43,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:25:43,200 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:43,288 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:43,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:43,294 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:43,299 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:25:43,306 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:43,307 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:25:43,307 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:43,307 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:43,308 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:25:43,316 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:43,319 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:43,321 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:43,323 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:43,326 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:43,328 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:43,330 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:43,333 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:43,336 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:43,338 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:43,340 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:43,348 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:43,348 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:25:43,353 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:25:43,353 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:25:43,358 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:43,358 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:25:43,367 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:43,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:25:43,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:43,382 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:43,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:25:43,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:25:43,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:43,392 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:43,392 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:43,393 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:43,393 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:43,393 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:25:43,393 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:43,393 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:25:43,394 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:43,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:25:43,395 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:25:43,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:43,395 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:25:43,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:43,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:43,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:43,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:25:43,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:25:43,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:25:43,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:25:43,397 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:25:43,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:25:43,397 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:25:43,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:25:43,398 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:25:43,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:25:43,398 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:25:43,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:25:43,399 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:43,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:25:43,399 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:43,399 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:43,399 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:43,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:25:43,400 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:25:43,400 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:25:43,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:25:43,406 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:25:43,406 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:43,407 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:43,407 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:43,409 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 22/400.
2025-08-04 20:25:43,510 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:43,510 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:43,511 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 11 anomalous samples to GAN training data (target: 11).
2025-08-04 20:25:43,512 - ClientAppLogger [Client 3] - INFO - [Client] Round 22: Training GAN with 50 samples (39 normal, 11 anomalous).
2025-08-04 20:25:43,512 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:43,561 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0820, Avg D Loss: 0.8910
2025-08-04 20:25:43,561 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0820, Avg D Loss: 0.8910
2025-08-04 20:25:43,562 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:43,570 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3113, Threshold=0.3197, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:25:43,570 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.7917
2025-08-04 20:25:43,570 - ClientAppLogger [Client 3] - INFO - Fit completed for round 22. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 22, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082046117782593, 'd_loss': 0.8910389654636383, 'post_fit_local_f1': 0.7916666666666666, 'fit_time_seconds': 0.16092681884765625, 'cpu_percent_fit': 12.48125, 'ram_mb_fit': 0.125, 'accumulated_train_samples_this_round': 50}
2025-08-04 20:25:43,570 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:25:48,891 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:48,891 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:48,891 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:48,891 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:25:48,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:25:48,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:49,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:49,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:49,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:25:49,268 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:25:49,269 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:49,366 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:49,371 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:49,371 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:49,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:25:49,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:49,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:25:49,384 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:49,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:49,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:25:49,393 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:49,396 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:49,398 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:49,400 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:49,403 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:49,406 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:49,408 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:49,410 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:49,414 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:49,416 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:49,418 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:49,427 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:49,427 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:25:49,432 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:25:49,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:25:49,437 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:49,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:25:49,447 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:49,447 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:25:49,447 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:49,463 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:49,469 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:25:49,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:25:49,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:49,477 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:49,478 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:49,478 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:49,478 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:49,478 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:25:49,478 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:49,479 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:25:49,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:49,480 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:25:49,480 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:25:49,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:49,481 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:25:49,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:49,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:49,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:25:49,482 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:25:49,483 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:25:49,483 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:25:49,483 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:25:49,483 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:25:49,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:25:49,484 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:49,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:25:49,484 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:49,484 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:49,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:49,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:25:49,485 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:25:49,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:25:49,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:25:49,490 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:25:49,490 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:49,491 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:49,492 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:49,493 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:49,493 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:49,493 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:49,494 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:49,502 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3202, Threshold=0.3286, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:25:49,502 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3202
2025-08-04 20:26:03,873 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,873 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:03,874 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:03,874 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:26:03,874 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:26:03,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:04,317 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:04,317 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:04,417 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:26:04,444 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:26:04,444 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:04,533 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:04,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:04,540 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:04,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:26:04,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:04,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:26:04,553 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:04,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:04,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:26:04,562 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:04,565 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,567 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:04,569 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:04,572 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:04,574 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:04,576 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,578 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:04,581 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:04,583 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:04,585 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:04,594 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:04,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:26:04,599 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:26:04,599 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:26:04,603 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:04,603 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:26:04,612 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:04,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:26:04,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:04,628 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:04,632 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:26:04,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:26:04,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,638 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,638 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,638 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,638 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:26:04,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:26:04,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:26:04,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:26:04,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:26:04,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:26:04,643 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:26:04,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:26:04,643 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:26:04,644 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,644 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:26:04,644 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,644 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,644 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:26:04,645 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:26:04,645 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:26:04,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:26:04,649 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:26:04,649 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,650 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,650 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:04,651 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,652 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,652 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,652 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,660 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3280, Threshold=0.3378, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:26:04,660 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3280
2025-08-04 20:26:16,002 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:16,002 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:16,002 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:16,002 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:26:16,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:26:16,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:16,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:16,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:16,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:26:16,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:26:16,547 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,649 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,655 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,655 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:26:16,668 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,669 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:26:16,678 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,681 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,685 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,687 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,690 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,693 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,695 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,697 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,700 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,702 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,704 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,714 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,714 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:26:16,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:26:16,725 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:26:16,734 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:26:16,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,751 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:26:16,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:26:16,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,765 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,765 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,766 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,766 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:26:16,766 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,767 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:26:16,767 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,768 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:26:16,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,768 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:26:16,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:26:16,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:26:16,770 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:26:16,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:26:16,770 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:26:16,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:26:16,771 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:26:16,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:26:16,771 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:26:16,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:26:16,773 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:26:16,773 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:26:16,773 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:26:16,780 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:26:16,780 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,781 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,781 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:16,783 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,783 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,783 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,784 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,793 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3190, Threshold=0.3273, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:26:16,794 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3190
2025-08-04 20:26:28,113 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:28,113 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:28,114 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:28,114 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:26:28,114 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:26:28,114 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:28,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:28,515 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:26:28,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:26:28,642 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,769 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,778 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:26:28,793 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,794 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,795 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,795 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:26:28,805 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,808 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,810 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,813 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,816 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,819 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,822 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,825 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,828 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,831 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,833 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,844 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,844 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:26:28,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:26:28,858 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:26:28,875 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:26:28,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,895 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:26:28,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:26:28,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,907 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,910 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,910 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,911 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,911 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:26:28,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:26:28,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,914 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:26:28,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:26:28,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:26:28,919 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:26:28,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:26:28,920 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:26:28,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:26:28,920 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:26:28,921 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:26:28,921 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:26:28,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:26:28,925 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:26:28,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:26:28,925 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:26:28,926 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,926 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,926 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:26:28,926 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:26:28,927 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:26:28,927 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:26:28,930 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:26:28,931 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,932 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,932 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:28,934 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,936 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,936 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:28,937 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,946 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3236, Threshold=0.3338, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:26:28,947 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3236
2025-08-04 20:26:40,235 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,236 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:40,236 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:40,236 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:26:40,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:26:40,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,668 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,767 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:26:40,816 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:26:40,816 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:40,973 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:40,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:40,987 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:40,994 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:26:41,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:41,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:26:41,004 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:41,004 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:41,004 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:26:41,015 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:41,019 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,021 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:41,024 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:41,027 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:41,030 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:41,034 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,037 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:41,040 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:41,043 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:41,045 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:41,059 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:41,062 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:26:41,068 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:26:41,069 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:26:41,076 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:41,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:26:41,096 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:41,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:26:41,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:41,120 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:41,129 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:26:41,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:26:41,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:41,158 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:41,158 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:41,159 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:41,159 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:41,159 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:26:41,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:41,160 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:26:41,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:41,161 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:26:41,162 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:26:41,162 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:41,162 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:26:41,162 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:41,162 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:41,162 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:41,163 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:26:41,163 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:26:41,163 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:26:41,163 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:26:41,163 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:26:41,164 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:26:41,164 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:26:41,164 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:26:41,164 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:26:41,165 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:26:41,165 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:26:41,165 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:26:41,166 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:41,166 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:26:41,166 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:41,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:41,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:41,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:26:41,170 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:26:41,170 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:26:41,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:26:41,181 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:26:41,182 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:41,183 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:41,183 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:41,185 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:41,185 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:41,185 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:41,186 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,195 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3276, Threshold=0.3392, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:26:41,199 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3276
2025-08-04 20:26:52,483 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,483 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:52,483 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:52,483 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:26:52,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:26:52,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:52,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:52,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:53,042 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:26:53,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:26:53,085 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,252 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,266 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,279 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:26:53,301 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,301 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,302 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:26:53,317 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,324 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,327 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,330 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,336 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,339 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,342 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,345 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,348 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,350 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,353 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,365 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,365 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:26:53,370 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,371 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:26:53,378 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:26:53,392 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:26:53,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,410 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:26:53,428 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:26:53,429 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,429 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,429 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,429 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,432 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:26:53,432 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:26:53,434 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:26:53,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:26:53,434 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:26:53,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:26:53,434 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:26:53,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:26:53,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:26:53,435 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:26:53,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:26:53,436 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:26:53,436 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:26:53,436 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,436 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:26:53,436 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,437 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,437 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,437 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:26:53,437 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:26:53,437 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:26:53,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:26:53,445 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:26:53,445 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,447 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,447 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:53,449 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,449 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,449 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,450 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,461 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3299, Threshold=0.3414, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:26:53,461 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3299
2025-08-04 20:27:04,734 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,734 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:04,734 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:04,734 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:27:04,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:27:04,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:05,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:05,203 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:05,306 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:27:05,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:27:05,352 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,480 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,490 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,490 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:27:05,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,511 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:27:05,523 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,526 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,533 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,536 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,540 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,543 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,547 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,550 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,553 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,556 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,559 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,570 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,570 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:27:05,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:27:05,584 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,585 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:27:05,599 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:27:05,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,617 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,635 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,635 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,635 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:27:05,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,636 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:27:05,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,638 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:27:05,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,638 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:27:05,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:27:05,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:27:05,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:27:05,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:27:05,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:27:05,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:27:05,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:27:05,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:27:05,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:27:05,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:27:05,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:27:05,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:27:05,650 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:27:05,651 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,653 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,653 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:05,655 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,655 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,655 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,656 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,665 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3262, Threshold=0.3357, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:27:05,666 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3262
2025-08-04 20:27:16,945 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:16,945 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:16,945 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:16,945 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:27:16,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:27:16,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:17,345 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:17,346 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:17,448 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:27:17,474 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:27:17,474 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,611 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,619 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,619 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,637 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:27:17,659 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,659 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,660 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:27:17,672 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,675 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,677 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:17,680 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:17,682 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:17,685 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:17,689 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,693 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:17,696 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:17,698 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:17,701 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:17,716 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:17,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:27:17,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:27:17,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:27:17,729 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:17,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:27:17,741 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:17,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:27:17,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:17,759 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:17,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:27:17,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:27:17,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:17,772 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:17,773 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:17,773 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:17,773 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:17,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:27:17,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:17,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:27:17,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:17,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:27:17,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:27:17,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:17,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:27:17,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:17,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:17,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:17,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:27:17,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:27:17,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:27:17,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:27:17,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:27:17,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:27:17,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:27:17,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:27:17,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:27:17,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:27:17,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:27:17,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:27:17,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:17,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:27:17,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:17,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:17,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:17,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:27:17,781 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:27:17,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:27:17,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:27:17,789 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:27:17,789 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:17,791 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:17,791 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:17,793 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:17,793 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:17,793 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:17,794 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:17,804 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3294, Threshold=0.3394, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:27:17,804 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3294
2025-08-04 20:27:35,084 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:35,084 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:35,084 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:35,085 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:27:35,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:27:35,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:35,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:35,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:35,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:27:35,529 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:27:35,529 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:35,635 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:35,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:35,642 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:35,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:27:35,661 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:35,661 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:27:35,662 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:35,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:35,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:27:35,671 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:35,674 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,676 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:35,679 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:35,682 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:35,684 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:35,686 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,689 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:35,691 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:35,693 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:35,696 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:35,707 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:35,707 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:27:35,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:27:35,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:27:35,718 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:35,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:27:35,727 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:35,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:27:35,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:35,744 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:35,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:27:35,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:27:35,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:35,758 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:35,758 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:35,758 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:35,759 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:35,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:27:35,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:35,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:27:35,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:35,761 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:27:35,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:27:35,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:35,762 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:27:35,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:35,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:35,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:35,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:27:35,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:27:35,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:27:35,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:27:35,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:27:35,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:27:35,764 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:27:35,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:27:35,764 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:27:35,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:27:35,765 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:27:35,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:27:35,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:35,766 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:27:35,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:35,767 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:35,767 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:35,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:27:35,768 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:27:35,768 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:27:35,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:27:35,774 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:27:35,774 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:35,776 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:35,776 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:35,778 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:35,778 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:35,778 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:35,779 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:35,790 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3303, Threshold=0.3422, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:27:35,790 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3303
2025-08-04 20:27:47,078 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:47,078 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:47,079 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:47,079 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:27:47,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:27:47,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:47,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:47,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:47,491 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:27:47,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:27:47,535 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:47,670 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:47,679 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:47,680 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:47,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:27:47,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:47,699 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:27:47,699 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:47,700 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:47,700 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:27:47,710 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:47,713 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,716 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:47,721 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:47,724 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:47,727 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:47,729 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,732 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:47,735 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:47,737 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:47,739 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:47,755 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:47,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:27:47,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:27:47,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:27:47,771 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:47,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:27:47,797 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:47,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:27:47,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:47,817 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:47,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:27:47,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:27:47,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:47,831 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:47,831 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:47,831 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:47,832 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:47,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:27:47,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:47,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:27:47,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:47,834 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:27:47,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:27:47,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:47,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:27:47,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:47,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:47,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:47,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:27:47,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:27:47,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:27:47,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:27:47,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:27:47,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:27:47,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:27:47,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:27:47,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:27:47,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:27:47,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:27:47,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:27:47,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:47,839 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:27:47,839 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:47,839 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:47,840 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:47,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:27:47,840 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:27:47,840 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:27:47,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:27:47,846 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:27:47,849 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:47,850 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:47,850 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:47,852 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:47,852 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:47,852 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:47,853 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:47,862 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3345, Threshold=0.3482, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:27:47,862 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3345
2025-08-04 20:28:02,145 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:02,145 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:02,145 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:02,145 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:28:02,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:28:02,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:02,425 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:02,426 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:02,516 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:28:02,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:28:02,565 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:02,681 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:02,689 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:02,689 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:02,706 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:28:02,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:02,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:28:02,720 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:02,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:02,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:28:02,730 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:02,733 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,735 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:02,737 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:02,740 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:02,743 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:02,745 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,748 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:02,751 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:02,753 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:02,756 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:02,770 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:02,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:28:02,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:28:02,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:28:02,783 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:02,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:28:02,798 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:02,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:28:02,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:02,821 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:02,827 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:28:02,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:28:02,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:02,837 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:02,837 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:02,837 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:02,838 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:02,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:28:02,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:02,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:28:02,839 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:02,840 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:28:02,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:28:02,841 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:02,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:28:02,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:02,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:02,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:02,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:28:02,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:28:02,843 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:28:02,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:28:02,843 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:28:02,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:28:02,844 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:28:02,844 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:28:02,844 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:28:02,844 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:28:02,845 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:28:02,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:28:02,845 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:02,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:28:02,846 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:02,846 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:02,847 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:02,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:28:02,847 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:28:02,847 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:28:02,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:28:02,852 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:28:02,853 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:02,855 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:02,855 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:02,856 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:02,857 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:02,857 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:02,858 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:02,869 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3372, Threshold=0.3503, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:28:02,869 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3372
2025-08-04 20:28:17,172 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:17,173 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:17,173 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:17,173 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:28:17,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:28:17,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:17,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:17,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:17,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:28:17,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:28:17,615 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:17,751 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:17,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:17,763 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:17,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:28:17,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:17,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:28:17,800 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:17,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:17,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:28:17,810 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:17,814 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:17,816 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:17,819 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:17,822 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:17,824 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:17,827 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:17,830 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:17,833 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:17,835 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:17,838 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:17,855 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:17,855 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:28:17,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:28:17,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:28:17,871 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:17,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:28:17,890 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:17,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:28:17,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:17,909 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:17,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:28:17,922 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:28:17,922 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:17,922 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:17,922 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:17,923 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:17,923 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:17,923 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:28:17,923 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:17,924 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:28:17,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:17,925 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:28:17,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:28:17,926 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:17,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:28:17,926 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:17,927 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:17,927 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:17,927 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:28:17,927 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:28:17,927 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:28:17,927 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:28:17,928 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:28:17,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:28:17,928 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:28:17,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:28:17,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:28:17,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:28:17,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:28:17,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:28:17,930 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:17,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:28:17,930 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:17,930 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:17,931 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:17,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:28:17,931 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:28:17,931 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:28:17,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:28:17,940 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:28:17,940 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:17,942 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:17,942 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:17,943 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:17,943 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:17,943 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:17,944 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:17,953 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3356, Threshold=0.3479, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:28:17,954 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3356
2025-08-04 20:28:29,229 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,230 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:29,230 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:29,230 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:28:29,230 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:28:29,230 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:29,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:29,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:29,717 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:28:29,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:28:29,764 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:29,897 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:29,906 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:29,907 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:29,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:28:29,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:29,932 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:28:29,933 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:29,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:29,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:28:29,946 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:29,949 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:29,952 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:29,954 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:29,957 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:29,959 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:29,962 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:29,965 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:29,968 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:29,970 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:29,973 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:29,989 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:29,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:28:29,995 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:28:29,995 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:28:30,005 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,005 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:28:30,024 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:28:30,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,045 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,052 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:28:30,068 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:28:30,069 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,069 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,069 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,070 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,070 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,070 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:28:30,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,070 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:28:30,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,072 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:28:30,073 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,073 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,074 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,074 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,074 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,074 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:28:30,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:28:30,075 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:28:30,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:28:30,075 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:28:30,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:28:30,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:28:30,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:28:30,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:28:30,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:28:30,077 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:28:30,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:28:30,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:28:30,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:28:30,083 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:28:30,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:28:30,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:28:30,089 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:28:30,089 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,091 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,091 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:30,093 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,093 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,093 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,094 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,104 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3382, Threshold=0.3512, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:28:30,105 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3382
2025-08-04 20:28:44,389 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:44,389 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:44,390 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:44,390 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:28:44,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:28:44,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:44,709 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:44,710 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:44,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:28:44,813 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:28:44,814 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:44,962 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:44,968 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:44,970 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:44,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:28:44,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:44,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:28:44,989 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:44,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:44,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:28:44,999 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:45,002 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:45,004 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:45,006 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:45,009 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:45,012 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:45,015 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:45,017 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:45,020 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:45,022 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:45,024 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:45,035 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:45,035 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:28:45,039 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:28:45,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:28:45,045 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:45,045 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:28:45,057 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:45,058 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:28:45,058 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:45,077 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:45,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:28:45,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:28:45,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:45,090 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:45,090 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:45,090 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:45,090 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:45,091 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:28:45,091 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:45,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:28:45,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:45,094 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:28:45,094 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:28:45,094 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:45,094 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:28:45,095 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:28:45,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:28:45,096 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:28:45,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:28:45,096 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:28:45,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:28:45,097 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:28:45,097 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:28:45,097 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:28:45,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:45,098 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:28:45,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:45,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:45,099 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:45,102 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:28:45,102 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:28:45,102 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:28:45,102 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:28:45,109 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:28:45,109 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:45,111 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:45,111 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:45,113 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:45,113 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:45,113 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:45,114 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:45,122 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3347, Threshold=0.3482, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:28:45,122 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3347
2025-08-04 20:28:56,382 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:56,383 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:56,383 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:56,383 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:28:56,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:28:56,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:56,664 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:56,664 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:56,753 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:28:56,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:28:56,797 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:56,943 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:56,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:56,953 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:56,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:28:56,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:56,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:28:56,977 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:56,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:56,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:28:56,988 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:56,991 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:56,993 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:56,995 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:56,998 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:57,001 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:57,003 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,006 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:57,009 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:57,010 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:57,013 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:57,023 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:57,023 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:28:57,028 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:28:57,028 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:28:57,032 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:57,033 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:28:57,042 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:57,043 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:28:57,043 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:57,060 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:57,066 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:28:57,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:28:57,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:57,074 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:57,075 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:57,075 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:57,075 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:57,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:28:57,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:57,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:28:57,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:57,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:28:57,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:28:57,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:57,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:28:57,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:57,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:57,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:57,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:28:57,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:28:57,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:28:57,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:28:57,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:28:57,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:28:57,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:28:57,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:28:57,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:28:57,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:28:57,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:28:57,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:28:57,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:57,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:28:57,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:57,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:57,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:57,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:28:57,089 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:28:57,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:28:57,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:28:57,095 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:28:57,095 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:57,097 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:57,097 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:57,099 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:57,099 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:57,099 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:57,100 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:57,108 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3385, Threshold=0.3520, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:28:57,109 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3385
2025-08-04 20:29:14,402 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:14,402 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:14,402 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:14,402 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:29:14,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:29:14,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:14,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:14,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:14,737 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:29:14,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:29:14,767 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:14,863 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:14,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:14,869 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:14,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:29:14,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:14,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:29:14,884 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:14,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:14,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:29:14,894 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:14,897 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:14,899 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:14,901 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:14,904 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:14,907 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:14,910 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:14,912 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:14,915 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:14,917 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:14,920 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:14,931 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:14,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:29:14,936 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:29:14,936 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:29:14,942 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:14,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:29:14,953 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:14,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:29:14,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:14,971 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:14,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:29:14,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:29:14,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:14,982 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:14,982 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:14,982 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:14,982 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:14,983 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:29:14,983 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:14,983 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:29:14,983 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:14,985 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:29:14,985 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:29:14,985 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:14,985 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:29:14,985 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:14,985 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:29:14,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:29:14,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:29:14,987 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:29:14,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:29:14,987 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:29:14,988 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:29:14,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:29:14,988 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:14,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:29:14,988 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:14,989 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:14,989 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:14,992 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:29:14,992 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:29:14,992 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:29:14,992 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:29:14,997 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:29:14,997 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:14,999 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:14,999 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:15,000 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:15,001 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:15,001 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:15,002 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:15,010 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3355, Threshold=0.3500, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:29:15,010 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3355
2025-08-04 20:29:26,285 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:26,285 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:26,285 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:26,286 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:29:26,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:29:26,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:26,529 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:26,529 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:26,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:29:26,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:29:26,646 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:26,739 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:26,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:26,746 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:26,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:29:26,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:26,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:29:26,758 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:26,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:26,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:29:26,766 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:26,769 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:26,771 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:26,774 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:26,777 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:26,779 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:26,782 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:26,785 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:26,788 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:26,790 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:26,793 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:26,803 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:26,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:29:26,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:29:26,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:29:26,813 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:26,813 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:29:26,822 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:26,823 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:29:26,823 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:26,840 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:26,846 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:29:26,854 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:29:26,854 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:26,855 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:26,855 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:26,855 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:26,855 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:26,856 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:29:26,856 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:26,856 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:29:26,856 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:26,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:29:26,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:29:26,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:26,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:29:26,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:26,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:26,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:26,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:29:26,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:29:26,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:29:26,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:29:26,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:29:26,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:29:26,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:29:26,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:29:26,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:29:26,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:29:26,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:29:26,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:29:26,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:26,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:29:26,862 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:26,862 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:26,862 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:26,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:29:26,866 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:29:26,866 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:29:26,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:29:26,871 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:29:26,871 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:26,872 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:26,872 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:26,874 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:26,874 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:26,874 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:26,875 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:26,883 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3325, Threshold=0.3475, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:29:26,883 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3325
2025-08-04 20:29:38,166 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:38,166 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:38,166 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:38,166 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:29:38,166 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:38,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:38,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:38,480 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:29:38,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:29:38,503 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:38,590 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:38,595 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:38,596 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:38,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:29:38,607 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:38,607 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:29:38,608 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:38,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:38,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:29:38,616 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:38,619 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:38,621 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:38,623 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:38,626 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:38,628 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:38,630 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:38,633 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:38,635 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:38,637 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:38,639 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:38,648 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:38,648 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:29:38,653 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:29:38,653 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:29:38,658 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:38,658 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:29:38,666 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:38,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:29:38,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:38,684 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:38,689 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:29:38,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:29:38,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:38,696 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:38,696 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:38,697 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:38,697 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:38,697 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:29:38,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:38,697 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:29:38,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:38,699 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:29:38,699 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:29:38,700 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:38,700 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:29:38,700 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:38,700 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:38,700 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:38,700 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:29:38,701 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:29:38,701 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:29:38,701 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:29:38,701 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:29:38,701 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:29:38,702 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:29:38,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:29:38,702 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:29:38,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:29:38,703 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:29:38,703 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:29:38,703 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:38,703 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:29:38,704 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:38,704 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:38,704 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:38,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:29:38,708 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:29:38,708 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:29:38,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:29:38,712 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:29:38,712 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:38,714 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:38,714 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:38,716 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:38,716 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:38,716 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:38,717 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:38,726 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3353, Threshold=0.3494, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:29:38,726 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3353
2025-08-04 20:29:53,016 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:53,016 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:53,016 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:53,016 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:29:53,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:29:53,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:53,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:53,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:53,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:29:53,423 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:29:53,424 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:53,532 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:53,538 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:53,538 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:53,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:29:53,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:53,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:29:53,549 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:53,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:53,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:29:53,558 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:53,560 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:53,563 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:53,565 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:53,568 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:53,570 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:53,573 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:53,576 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:53,578 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:53,580 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:53,583 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:53,592 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:53,592 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:29:53,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:29:53,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:29:53,602 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:53,602 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:29:53,611 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:53,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:29:53,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:53,627 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:53,631 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:29:53,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:29:53,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:53,636 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:53,637 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:53,637 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:53,637 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:53,637 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:29:53,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:53,638 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:29:53,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:53,639 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:29:53,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:29:53,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:53,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:29:53,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:53,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:53,640 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:29:53,641 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:53,642 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:29:53,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:53,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:53,643 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:53,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:29:53,647 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:29:53,647 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:29:53,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:29:53,651 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:29:53,651 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:53,652 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:53,652 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:53,654 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:53,654 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:53,654 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:53,654 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:53,662 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3423, Threshold=0.3573, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:29:53,662 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3423
