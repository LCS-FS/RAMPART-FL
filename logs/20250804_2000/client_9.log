2025-08-04 20:21:12,260 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:12,260 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:12,260 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:12,261 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:21:12,261 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:21:12,261 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:13,248 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:13,248 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:13,370 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:21:13,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:21:13,406 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:13,629 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:13,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:13,643 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:13,655 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:21:13,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:13,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:21:13,675 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:13,675 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:13,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:21:13,690 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:13,694 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,698 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:13,701 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:13,706 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:13,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:13,713 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,717 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:13,721 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:13,724 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:13,728 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:13,744 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:13,745 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:21:13,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:21:13,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:21:13,764 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:13,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:21:13,783 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:13,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:21:13,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:13,807 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:13,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:21:13,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:21:13,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:13,829 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:13,829 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:13,830 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:13,831 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:13,831 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:21:13,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:13,832 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:21:13,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:13,834 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:21:13,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:21:13,835 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:13,836 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:21:13,836 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:13,836 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:13,837 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:13,837 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:21:13,837 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:21:13,838 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:21:13,838 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:21:13,838 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:21:13,839 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:21:13,841 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:21:13,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:21:13,843 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:21:13,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:21:13,845 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:21:13,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:21:13,846 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:13,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:21:13,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:13,848 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:13,849 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:13,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:21:13,849 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:21:13,850 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:21:13,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:21:13,860 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:21:13,861 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:13,864 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:13,866 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:13,871 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:13,872 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:13,873 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:13,874 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:13,920 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5019, Threshold=0.5013, Accuracy=0.5191, F1=0.6667, Precision=0.8029, Recall=0.5700
2025-08-04 20:21:13,923 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5191, F1: 0.6667, Prec: 0.8029, Rec: 0.5700, Avg Anomaly Score: 0.5019
2025-08-04 20:21:28,284 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:28,284 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:28,284 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:28,284 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:21:28,284 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:21:28,284 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:29,433 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:29,434 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:29,544 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:21:29,581 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:21:29,581 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:29,776 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:29,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:29,787 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:29,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:21:29,919 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:29,919 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:21:29,921 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:29,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:29,922 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:21:29,937 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:29,941 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,944 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:29,949 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:29,954 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:29,957 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:29,960 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,964 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:29,967 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:29,970 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:29,975 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:29,993 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:29,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:21:30,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:21:30,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:21:30,011 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:21:30,038 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:21:30,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,068 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:21:30,088 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:21:30,088 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,088 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,089 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,089 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,089 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,090 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:21:30,090 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,090 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:21:30,091 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,092 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:21:30,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,093 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,093 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,093 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,094 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,094 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:21:30,094 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:21:30,094 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:21:30,095 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:21:30,095 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:21:30,095 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:21:30,098 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:21:30,099 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:21:30,099 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:21:30,099 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:21:30,100 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:21:30,100 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:21:30,100 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,101 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:21:30,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:21:30,103 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:21:30,109 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:21:30,109 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,114 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,115 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:30,117 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,118 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,118 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,119 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,138 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5019, Threshold=0.5013, Accuracy=0.5191, F1=0.6667, Precision=0.8029, Recall=0.5700
2025-08-04 20:21:30,138 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5191, F1: 0.6667, Prec: 0.8029, Rec: 0.5700, Avg Anomaly Score: 0.5019
2025-08-04 20:21:41,436 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,436 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:41,436 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:41,437 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:21:41,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:21:41,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:41,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:41,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:41,932 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:21:41,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:21:41,970 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,134 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,150 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,151 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:21:42,224 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,225 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,227 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,227 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,227 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:21:42,245 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,249 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,252 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,256 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,260 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,264 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,269 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,273 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,277 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,280 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,283 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,299 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,299 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:21:42,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:21:42,317 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,317 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:21:42,345 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:21:42,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,370 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:21:42,388 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:21:42,388 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,388 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,389 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,389 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,389 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,390 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:21:42,390 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,390 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:21:42,391 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,392 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:21:42,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,393 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,394 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,394 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,394 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,394 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:21:42,394 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:21:42,395 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:21:42,395 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:21:42,395 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:21:42,395 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:21:42,399 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:21:42,399 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:21:42,399 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:21:42,400 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:21:42,400 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:21:42,401 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:21:42,401 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,401 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:21:42,401 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,402 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,402 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,402 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:21:42,403 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:21:42,403 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:21:42,403 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:21:42,411 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:21:42,411 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,413 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,413 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:42,415 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,415 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,415 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,416 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,433 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5079, Threshold=0.5077, Accuracy=0.5156, F1=0.6643, Precision=0.8000, Recall=0.5679
2025-08-04 20:21:42,433 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5156, F1: 0.6643, Prec: 0.8000, Rec: 0.5679, Avg Anomaly Score: 0.5079
2025-08-04 20:21:53,706 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:53,706 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:53,706 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:53,707 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:21:53,707 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:21:53,707 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:53,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:53,972 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:21:54,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:21:54,126 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:54,327 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:54,343 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:54,344 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:54,389 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:21:54,446 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:54,447 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:21:54,449 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:54,449 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:54,450 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:21:54,463 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:54,469 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,473 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:54,477 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:54,481 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:54,484 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:54,488 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,494 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:54,500 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:54,505 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:54,508 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:54,528 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:54,530 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:21:54,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:21:54,539 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:21:54,560 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:54,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:21:54,588 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:54,588 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:21:54,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:54,616 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:54,624 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:21:54,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:21:54,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:54,637 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:54,637 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:54,638 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:54,638 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:54,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:21:54,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:54,639 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:21:54,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:54,640 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:21:54,641 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:21:54,641 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:54,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:21:54,642 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:54,642 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:54,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:54,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:21:54,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:21:54,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:21:54,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:21:54,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:21:54,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:21:54,648 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:21:54,648 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:21:54,649 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:21:54,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:21:54,650 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:21:54,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:21:54,650 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:54,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:21:54,651 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:54,651 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:54,651 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:54,652 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:21:54,652 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:21:54,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:21:54,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:21:54,665 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:21:54,665 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:54,667 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:54,667 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:54,669 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:54,669 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:54,669 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:54,670 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:54,690 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5080, Accuracy=0.4878, F1=0.6450, Precision=0.7768, Recall=0.5514
2025-08-04 20:21:54,690 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.4878, F1: 0.6450, Prec: 0.7768, Rec: 0.5514, Avg Anomaly Score: 0.5085
2025-08-04 20:22:08,961 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:08,961 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:08,961 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:08,961 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:22:08,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:22:08,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:09,198 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:09,198 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:09,284 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:22:09,319 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:22:09,320 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:09,428 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:09,434 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:09,434 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:09,441 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:22:09,451 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:09,451 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:22:09,452 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:09,452 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:09,453 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:22:09,463 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:09,467 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:09,470 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:09,473 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:09,478 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:09,482 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:09,485 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:09,488 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:09,492 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:09,495 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:09,502 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:09,516 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:09,516 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:22:09,521 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:22:09,521 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:22:09,527 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:09,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:22:09,541 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:09,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:22:09,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:09,561 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:09,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:22:09,574 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:22:09,575 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:09,575 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:09,575 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:09,575 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:09,576 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:09,577 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:22:09,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:09,577 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:22:09,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:09,579 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:22:09,579 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:22:09,579 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:09,579 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:22:09,580 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:09,580 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:09,580 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:09,580 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:22:09,580 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:22:09,581 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:22:09,581 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:22:09,581 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:22:09,581 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:22:09,583 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:22:09,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:22:09,584 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:22:09,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:22:09,585 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:22:09,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:22:09,585 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:09,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:22:09,587 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:09,587 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:09,587 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:09,587 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:22:09,588 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:22:09,588 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:22:09,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:22:09,591 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:22:09,591 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:09,593 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:09,593 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:09,595 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:09,595 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:09,596 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:09,597 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:09,614 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5076, Accuracy=0.4844, F1=0.6426, Precision=0.7739, Recall=0.5494
2025-08-04 20:22:09,614 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.4844, F1: 0.6426, Prec: 0.7739, Rec: 0.5494, Avg Anomaly Score: 0.5085
2025-08-04 20:22:23,900 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:23,900 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:23,900 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:23,900 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:22:23,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:22:23,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:24,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:24,110 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:24,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:22:24,220 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:22:24,220 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:24,320 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:24,328 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:24,328 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:24,336 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:22:24,361 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:24,362 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:22:24,362 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:24,362 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:24,362 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:22:24,373 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:24,377 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:24,379 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:24,382 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:24,385 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:24,387 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:24,389 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:24,392 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:24,395 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:24,397 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:24,400 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:24,412 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:24,412 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:22:24,417 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:22:24,417 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:22:24,423 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:24,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:22:24,435 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:24,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:22:24,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:24,453 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:24,457 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:22:24,463 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:22:24,463 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:24,463 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:24,463 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:24,464 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:24,464 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:24,464 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:22:24,465 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:24,465 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:22:24,465 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:24,466 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:22:24,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:22:24,467 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:24,467 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:22:24,467 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:24,467 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:22:24,468 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:22:24,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:22:24,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:22:24,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:22:24,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:22:24,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:22:24,471 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:22:24,471 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:24,471 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:22:24,471 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:24,471 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:24,472 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:24,472 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:22:24,472 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:22:24,472 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:22:24,472 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:22:24,479 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:22:24,479 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:24,480 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:24,480 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:24,482 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:24,482 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:24,482 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:24,483 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:24,497 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.4844, F1=0.6426, Precision=0.7739, Recall=0.5494
2025-08-04 20:22:24,497 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.4844, F1: 0.6426, Prec: 0.7739, Rec: 0.5494, Avg Anomaly Score: 0.5053
2025-08-04 20:22:38,763 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:38,763 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:38,763 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:38,763 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:22:38,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:22:38,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:38,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:38,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:39,048 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:22:39,073 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:22:39,073 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:39,171 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:39,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:39,178 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:39,183 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:22:39,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:39,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:22:39,204 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:39,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:39,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:22:39,213 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:39,216 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:39,218 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:39,220 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:39,223 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:39,225 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:39,228 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:39,230 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:39,233 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:39,235 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:39,237 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:39,248 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:39,248 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:22:39,253 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:22:39,253 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:22:39,258 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:39,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:22:39,271 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:39,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:22:39,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:39,288 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:39,293 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:22:39,300 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:22:39,300 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:39,301 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:39,301 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:39,301 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:39,302 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:39,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:22:39,302 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:39,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:22:39,302 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:39,304 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:22:39,304 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:22:39,304 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:39,304 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:22:39,304 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:39,304 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:39,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:39,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:22:39,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:22:39,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:22:39,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:22:39,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:22:39,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:22:39,307 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:22:39,307 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:22:39,308 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:22:39,308 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:22:39,308 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:22:39,308 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:22:39,308 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:39,308 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:22:39,309 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:39,309 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:39,309 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:39,309 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:22:39,309 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:22:39,309 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:22:39,310 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:22:39,314 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:22:39,314 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:39,315 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:39,316 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:39,317 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:39,317 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:39,318 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:39,318 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:39,332 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4970, Threshold=0.4943, Accuracy=0.4844, F1=0.6426, Precision=0.7739, Recall=0.5494
2025-08-04 20:22:39,332 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.4844, F1: 0.6426, Prec: 0.7739, Rec: 0.5494, Avg Anomaly Score: 0.4970
2025-08-04 20:22:53,595 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:53,595 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:53,595 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:53,595 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:22:53,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:22:53,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:53,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:53,811 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:53,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:22:53,924 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:22:53,924 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:54,023 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:54,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:54,029 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:54,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:22:54,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:54,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:22:54,044 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:54,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:54,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:22:54,055 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:54,058 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:54,060 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:54,062 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:54,065 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:54,067 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:54,070 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:54,072 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:54,075 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:54,077 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:54,079 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:54,089 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:54,090 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:22:54,094 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:22:54,094 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:22:54,099 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:54,100 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:22:54,108 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:54,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:22:54,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:54,124 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:54,128 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:22:54,133 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:22:54,133 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:54,133 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:54,134 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:54,134 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:54,134 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:54,134 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:22:54,134 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:54,135 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:22:54,135 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:54,136 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:22:54,136 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:22:54,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:22:54,138 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:22:54,138 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:22:54,138 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:22:54,138 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:22:54,139 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:22:54,139 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:22:54,139 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:22:54,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:22:54,140 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:22:54,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:22:54,140 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:54,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:22:54,141 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:54,141 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:54,141 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:54,141 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:22:54,142 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:22:54,142 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:22:54,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:22:54,146 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:22:54,147 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:54,148 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:54,149 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:54,150 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:54,150 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:54,150 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:54,151 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:54,163 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4815, Threshold=0.4776, Accuracy=0.4809, F1=0.6402, Precision=0.7710, Recall=0.5473
2025-08-04 20:22:54,163 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.4809, F1: 0.6402, Prec: 0.7710, Rec: 0.5473, Avg Anomaly Score: 0.4815
2025-08-04 20:23:05,431 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:05,431 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:05,431 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:05,431 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:23:05,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:23:05,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:05,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:05,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:05,781 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:23:05,808 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:23:05,808 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:05,903 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:05,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:05,911 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:05,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:23:05,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:05,930 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:23:05,930 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:05,930 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:05,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:23:05,941 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:05,944 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:05,946 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:05,948 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:05,951 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:05,953 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:05,956 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:05,959 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:05,961 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:05,963 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:05,966 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:05,977 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:05,977 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:23:05,982 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:23:05,982 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:23:05,987 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:05,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:23:05,996 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:05,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:23:05,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:06,012 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:06,017 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:23:06,023 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:23:06,024 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:06,024 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:06,024 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:06,024 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:06,024 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:06,025 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:23:06,025 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:06,025 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:23:06,025 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:06,026 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:23:06,027 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:23:06,027 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:06,027 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:23:06,027 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:23:06,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:23:06,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:23:06,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:23:06,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:23:06,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:23:06,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:23:06,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:23:06,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:23:06,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:06,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:23:06,032 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:06,032 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:06,032 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:06,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:23:06,032 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:23:06,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:23:06,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:23:06,037 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:23:06,037 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:06,039 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:06,039 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:06,040 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:06,040 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:06,040 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:06,041 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:06,055 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4583, Threshold=0.4523, Accuracy=0.5087, F1=0.6594, Precision=0.7942, Recall=0.5638
2025-08-04 20:23:06,055 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5087, F1: 0.6594, Prec: 0.7942, Rec: 0.5638, Avg Anomaly Score: 0.4583
2025-08-04 20:23:20,351 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:20,351 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:20,351 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:20,352 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:23:20,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:23:20,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:20,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:20,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:20,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:23:20,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:23:20,711 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:20,815 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:20,824 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:20,824 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:20,834 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:23:20,842 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:20,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:23:20,843 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:20,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:20,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:23:20,852 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:20,855 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,857 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:20,860 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:20,862 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:20,865 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:20,867 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,870 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:20,873 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:20,875 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:20,877 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:20,888 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:20,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:23:20,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:23:20,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:23:20,897 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:20,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:23:20,907 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:20,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:23:20,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:20,926 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:20,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:23:20,940 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:23:20,940 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:20,940 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:20,940 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:20,941 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:20,941 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:20,941 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:23:20,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:20,941 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:23:20,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:20,943 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:23:20,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:23:20,944 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:20,944 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:23:20,944 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:20,944 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:20,944 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:20,945 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:23:20,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:23:20,945 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:23:20,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:23:20,945 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:23:20,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:23:20,947 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:23:20,947 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:23:20,948 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:23:20,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:23:20,948 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:23:20,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:23:20,948 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:20,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:23:20,949 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:20,949 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:20,949 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:20,949 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:23:20,950 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:23:20,950 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:23:20,950 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:23:20,955 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:23:20,955 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:20,956 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:20,956 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:20,958 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:20,958 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:20,958 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:20,959 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:20,972 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4199, Threshold=0.4113, Accuracy=0.5017, F1=0.6546, Precision=0.7884, Recall=0.5597
2025-08-04 20:23:20,972 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5017, F1: 0.6546, Prec: 0.7884, Rec: 0.5597, Avg Anomaly Score: 0.4199
2025-08-04 20:23:32,279 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:32,279 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:32,280 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:32,280 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:23:32,280 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:23:32,280 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:32,567 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:32,568 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:32,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:23:32,681 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:23:32,682 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:32,778 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:32,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:32,784 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:32,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:23:32,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:32,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:23:32,812 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:32,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:32,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:23:32,822 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:32,825 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,827 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:32,829 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:32,832 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:32,834 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:32,836 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,839 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:32,842 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:32,844 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:32,846 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:32,856 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:32,856 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:23:32,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:23:32,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:23:32,866 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:32,866 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:23:32,876 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:32,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:23:32,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:32,894 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:32,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:23:32,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:23:32,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:32,906 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:32,906 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:32,907 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:32,907 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:32,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:23:32,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:32,908 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:23:32,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:32,909 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:23:32,909 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:23:32,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:23:32,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:23:32,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:23:32,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:23:32,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:23:32,913 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:23:32,913 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:23:32,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:23:32,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:23:32,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:23:32,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:23:32,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:32,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:23:32,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:32,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:32,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:32,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:23:32,915 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:23:32,916 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:23:32,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:23:32,922 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:23:32,922 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:32,924 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:32,924 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:32,925 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:32,925 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:32,925 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:32,926 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:32,939 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3637, Threshold=0.3523, Accuracy=0.5052, F1=0.6570, Precision=0.7913, Recall=0.5617
2025-08-04 20:23:32,939 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5052, F1: 0.6570, Prec: 0.7913, Rec: 0.5617, Avg Anomaly Score: 0.3637
2025-08-04 20:23:38,205 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:38,205 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:38,205 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:38,205 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:23:38,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:23:38,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:38,446 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:38,446 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:38,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:23:38,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:23:38,543 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:38,633 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:38,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:38,639 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:38,684 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:23:38,704 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:38,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:23:38,705 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:38,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:38,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:23:38,715 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:38,718 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:38,720 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:38,722 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:38,725 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:38,727 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:38,730 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:38,732 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:38,735 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:38,737 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:38,739 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:38,751 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:38,751 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:23:38,756 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:23:38,756 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:23:38,762 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:38,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:23:38,775 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:38,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:23:38,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:38,792 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:38,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:23:38,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:23:38,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:38,804 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:38,804 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:38,805 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:38,805 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:38,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:23:38,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:38,806 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:23:38,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:38,807 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:23:38,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:23:38,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:38,808 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:23:38,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:38,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:38,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:38,809 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:23:38,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:23:38,809 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:23:38,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:23:38,810 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:23:38,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:23:38,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:23:38,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:23:38,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:23:38,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:23:38,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:23:38,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:23:38,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:38,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:23:38,814 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:38,814 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:38,814 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:38,814 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:23:38,815 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:23:38,815 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:23:38,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:23:38,820 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:23:38,820 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:38,822 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:38,822 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:38,824 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 12/400.
2025-08-04 20:23:38,926 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:38,926 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:38,928 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 87 anomalous samples to GAN training data (target: 87).
2025-08-04 20:23:38,929 - ClientAppLogger [Client 9] - INFO - [Client] Round 12: Training GAN with 377 samples (290 normal, 87 anomalous).
2025-08-04 20:23:38,929 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:40,674 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0671, Avg D Loss: 0.9422
2025-08-04 20:23:40,674 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0671, Avg D Loss: 0.9422
2025-08-04 20:23:40,675 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:40,689 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3115, Threshold=0.3027, Accuracy=0.5156, F1=0.6643, Precision=0.8000, Recall=0.5679
2025-08-04 20:23:40,689 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.6643
2025-08-04 20:23:40,689 - ClientAppLogger [Client 9] - INFO - Fit completed for round 12. Duration: 1.87s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 12, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0671041257817806, 'd_loss': 0.9421953393862796, 'post_fit_local_f1': 0.6642599277978339, 'fit_time_seconds': 1.8653478622436523, 'cpu_percent_fit': 5.53125, 'ram_mb_fit': 113.5234375, 'accumulated_train_samples_this_round': 377}
2025-08-04 20:23:40,689 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:23:45,953 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:45,953 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:45,953 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:45,953 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:23:45,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:23:45,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:46,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:46,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:46,499 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:23:46,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:23:46,540 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:46,720 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:46,727 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:46,728 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:46,737 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:23:46,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:46,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:23:46,747 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:46,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:46,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:23:46,756 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:46,759 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:46,762 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:46,764 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:46,767 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:46,769 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:46,772 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:46,774 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:46,777 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:46,780 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:46,782 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:46,794 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:46,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:23:46,799 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:23:46,799 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:23:46,807 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:46,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:23:46,828 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:46,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:23:46,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:46,853 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:46,858 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:23:46,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:23:46,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:46,878 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:46,878 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:46,879 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:46,879 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:46,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:23:46,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:46,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:23:46,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:46,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:23:46,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:23:46,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:46,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:23:46,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:46,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:46,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:46,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:23:46,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:23:46,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:23:46,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:23:46,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:23:46,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:23:46,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:23:46,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:23:46,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:23:46,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:23:46,887 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:23:46,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:23:46,887 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:46,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:23:46,888 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:46,888 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:46,888 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:46,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:23:46,889 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:23:46,889 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:23:46,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:23:46,896 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:23:46,896 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:46,898 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:46,898 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:46,900 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:46,900 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:46,900 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:46,901 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:46,916 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3033, Threshold=0.2966, Accuracy=0.5191, F1=0.6667, Precision=0.8029, Recall=0.5700
2025-08-04 20:23:46,916 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5191, F1: 0.6667, Prec: 0.8029, Rec: 0.5700, Avg Anomaly Score: 0.3033
2025-08-04 20:23:58,176 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:58,176 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:58,176 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:58,176 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:23:58,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:23:58,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:58,532 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:58,532 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:58,626 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:23:58,662 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:23:58,662 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:58,812 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:58,820 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:58,820 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:58,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:23:58,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:58,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:23:58,849 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:58,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:58,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:23:58,859 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:58,862 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:58,864 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:58,866 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:58,869 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:58,872 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:58,875 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:58,877 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:58,880 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:58,883 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:58,886 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:58,897 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:58,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:23:58,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:23:58,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:23:58,908 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:58,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:23:58,919 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:58,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:23:58,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:58,939 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:58,947 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:23:58,956 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:23:58,958 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:58,959 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:58,959 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:58,959 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:58,960 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:58,960 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:23:58,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:58,962 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:23:58,962 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:58,963 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:23:58,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:23:58,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:58,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:23:58,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:58,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:58,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:58,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:23:58,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:23:58,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:23:58,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:23:58,966 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:23:58,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:23:58,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:23:58,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:23:58,969 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:23:58,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:23:58,969 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:23:58,970 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:23:58,970 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:58,970 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:23:58,970 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:58,971 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:58,971 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:58,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:23:58,971 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:23:58,971 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:23:58,972 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:23:58,977 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:23:58,977 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:58,978 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:58,979 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:58,980 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:58,980 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:58,980 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:58,981 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:58,995 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3054, Threshold=0.3027, Accuracy=0.5503, F1=0.6883, Precision=0.8290, Recall=0.5885
2025-08-04 20:23:58,996 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5503, F1: 0.6883, Prec: 0.8290, Rec: 0.5885, Avg Anomaly Score: 0.3054
2025-08-04 20:24:10,260 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:10,260 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:10,260 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:10,260 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:24:10,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:24:10,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:10,495 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:10,495 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:10,582 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:24:10,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:24:10,617 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:10,741 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:10,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:10,749 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:10,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:24:10,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:10,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:24:10,788 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:10,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:10,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:24:10,799 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:10,802 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:10,804 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:10,807 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:10,810 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:10,812 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:10,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:10,817 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:10,820 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:10,822 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:10,825 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:10,836 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:10,836 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:24:10,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:24:10,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:24:10,848 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:10,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:24:10,858 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:10,859 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:24:10,859 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:10,876 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:10,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:24:10,890 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:24:10,890 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:10,890 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:10,890 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:10,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:24:10,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:24:10,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:24:10,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:24:10,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:24:10,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:24:10,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:24:10,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:24:10,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:24:10,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:24:10,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:24:10,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:24:10,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:24:10,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:10,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:24:10,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:10,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:10,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:10,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:24:10,899 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:24:10,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:24:10,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:24:10,907 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:24:10,907 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:10,909 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:10,909 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:10,911 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:10,911 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:10,911 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:10,912 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:10,929 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3230, Threshold=0.3244, Accuracy=0.5885, F1=0.7148, Precision=0.8609, Recall=0.6111
2025-08-04 20:24:10,929 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.5885, F1: 0.7148, Prec: 0.8609, Rec: 0.6111, Avg Anomaly Score: 0.3230
2025-08-04 20:24:22,199 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:22,200 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:22,200 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:22,200 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:24:22,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:24:22,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:22,481 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:22,481 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:22,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:24:22,604 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:24:22,604 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:22,729 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:22,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:22,736 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:22,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:24:22,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:22,751 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:24:22,751 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:22,751 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:22,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:24:22,761 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:22,764 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:22,766 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:22,768 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:22,771 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:22,773 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:22,776 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:22,779 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:22,781 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:22,784 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:22,786 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:22,797 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:22,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:24:22,802 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:24:22,802 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:24:22,808 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:22,808 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:24:22,824 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:22,824 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:24:22,825 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:22,841 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:22,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:24:22,852 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:24:22,852 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:22,853 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:22,853 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:22,853 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:22,854 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:22,854 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:24:22,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:22,854 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:24:22,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:22,856 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:24:22,856 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:24:22,857 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:24:22,858 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:24:22,858 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:24:22,858 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:24:22,858 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:24:22,859 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:24:22,859 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:24:22,859 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:24:22,860 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:24:22,860 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:24:22,860 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:24:22,860 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:22,860 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:24:22,860 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:22,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:22,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:22,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:24:22,861 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:24:22,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:24:22,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:24:22,869 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:24:22,870 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:22,871 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:22,871 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:22,872 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:22,873 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:22,873 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:22,873 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:22,889 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3030, Threshold=0.3067, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:24:22,889 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3030
2025-08-04 20:24:34,149 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:34,149 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:34,149 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:34,150 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:24:34,150 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:24:34,150 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:34,391 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:34,391 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:34,477 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:24:34,501 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:24:34,501 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:34,644 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:34,651 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:34,652 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:34,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:24:34,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:34,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:24:34,687 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:34,687 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:34,688 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:24:34,697 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:34,700 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:34,702 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:34,704 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:34,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:34,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:34,712 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:34,714 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:34,717 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:34,719 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:34,721 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:34,731 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:34,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:24:34,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:24:34,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:24:34,743 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:34,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:24:34,755 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:34,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:24:34,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:34,773 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:34,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:24:34,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:24:34,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:34,788 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:34,788 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:34,789 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:34,789 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:34,789 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:24:34,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:34,790 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:24:34,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:34,791 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:24:34,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:24:34,792 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:24:34,793 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:24:34,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:24:34,793 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:24:34,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:24:34,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:24:34,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:24:34,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:24:34,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:24:34,796 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:24:34,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:24:34,796 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:34,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:24:34,796 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:34,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:34,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:34,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:24:34,797 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:24:34,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:24:34,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:24:34,800 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:24:34,800 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:34,801 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:34,802 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:34,803 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:34,803 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:34,803 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:34,804 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:34,817 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3011, Threshold=0.3052, Accuracy=0.6649, F1=0.7677, Precision=0.9246, Recall=0.6564
2025-08-04 20:24:34,817 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6649, F1: 0.7677, Prec: 0.9246, Rec: 0.6564, Avg Anomaly Score: 0.3011
2025-08-04 20:24:49,085 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:49,085 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:49,085 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:49,085 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:24:49,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:24:49,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:49,331 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:49,331 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:49,413 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:24:49,450 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:24:49,450 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:49,536 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:49,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:49,542 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:49,547 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:24:49,552 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:49,552 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:24:49,553 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:49,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:49,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:24:49,561 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:49,563 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:49,566 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:49,568 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:49,570 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:49,572 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:49,575 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:49,577 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:49,580 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:49,582 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:49,584 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:49,592 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:49,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:24:49,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:24:49,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:24:49,603 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:49,603 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:24:49,615 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:49,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:24:49,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:49,630 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:49,635 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:24:49,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:24:49,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:49,640 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:49,640 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:49,641 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:49,641 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:49,641 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:24:49,641 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:49,641 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:24:49,641 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:49,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:24:49,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:24:49,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:49,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:24:49,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:24:49,645 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:24:49,645 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:24:49,645 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:49,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:24:49,647 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:49,647 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:49,647 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:49,647 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:24:49,647 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:24:49,648 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:24:49,648 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:24:49,649 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:24:49,649 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:49,651 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:49,651 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:49,652 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:49,652 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:49,652 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:49,653 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:49,666 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.2998, Threshold=0.3046, Accuracy=0.6649, F1=0.7677, Precision=0.9246, Recall=0.6564
2025-08-04 20:24:49,666 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6649, F1: 0.7677, Prec: 0.9246, Rec: 0.6564, Avg Anomaly Score: 0.2998
2025-08-04 20:25:00,949 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:00,950 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:00,950 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:00,950 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:25:00,950 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:25:00,950 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:01,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:01,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:01,251 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:25:01,274 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:25:01,274 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:01,382 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:01,388 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:01,388 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:01,394 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:25:01,400 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:01,400 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:25:01,401 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:01,401 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:01,401 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:25:01,410 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:01,413 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:01,415 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:01,417 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:01,420 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:01,422 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:01,425 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:01,427 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:01,430 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:01,432 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:01,434 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:01,444 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:01,445 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:25:01,450 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:25:01,450 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:25:01,456 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:01,456 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:25:01,469 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:01,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:25:01,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:01,487 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:01,492 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:25:01,500 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:25:01,500 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:01,500 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:01,500 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:01,501 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:01,501 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:01,501 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:25:01,501 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:01,501 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:25:01,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:01,503 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:25:01,503 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:25:01,503 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:01,503 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:25:01,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:25:01,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:25:01,506 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:25:01,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:25:01,507 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:25:01,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:25:01,507 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:25:01,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:25:01,507 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:01,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:25:01,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:01,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:01,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:01,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:25:01,509 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:25:01,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:25:01,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:25:01,510 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:25:01,511 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:01,512 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:01,512 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:01,513 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:01,513 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:01,513 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:01,514 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:01,527 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3071, Threshold=0.3156, Accuracy=0.6684, F1=0.7702, Precision=0.9275, Recall=0.6584
2025-08-04 20:25:01,528 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6684, F1: 0.7702, Prec: 0.9275, Rec: 0.6584, Avg Anomaly Score: 0.3071
2025-08-04 20:25:12,817 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:12,818 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:12,818 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:12,818 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:25:12,818 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:25:12,818 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:13,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:13,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:13,139 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:25:13,183 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:25:13,184 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:13,304 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:13,311 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:13,311 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:13,319 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:25:13,327 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:13,328 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:25:13,328 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:13,328 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:13,328 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:25:13,338 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:13,341 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:13,343 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:13,345 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:13,348 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:13,350 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:13,352 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:13,355 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:13,358 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:13,360 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:13,362 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:13,372 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:13,372 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:25:13,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:25:13,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:25:13,384 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:13,384 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:25:13,393 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:13,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:25:13,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:13,410 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:13,415 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:25:13,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:25:13,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:13,422 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:13,422 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:13,423 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:13,423 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:13,423 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:25:13,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:13,424 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:25:13,424 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:13,425 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:25:13,426 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:25:13,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:13,426 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:25:13,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:13,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:25:13,427 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:25:13,429 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:25:13,429 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:25:13,429 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:25:13,429 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:25:13,430 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:25:13,430 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:25:13,430 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:13,430 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:25:13,430 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:13,431 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:13,431 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:13,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:25:13,431 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:25:13,431 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:25:13,432 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:25:13,435 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:25:13,435 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:13,437 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:13,437 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:13,438 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:13,438 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:13,439 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:13,439 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:13,452 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3108, Threshold=0.3205, Accuracy=0.6684, F1=0.7702, Precision=0.9275, Recall=0.6584
2025-08-04 20:25:13,453 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6684, F1: 0.7702, Prec: 0.9275, Rec: 0.6584, Avg Anomaly Score: 0.3108
2025-08-04 20:25:24,746 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:24,746 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:24,746 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:24,746 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:25:24,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:25:24,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:25,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:25,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:25,090 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:25:25,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:25:25,128 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:25,218 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:25,224 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:25,224 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:25,230 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:25:25,250 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:25,250 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:25:25,251 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:25,251 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:25,251 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:25:25,260 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:25,263 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:25,265 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:25,267 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:25,270 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:25,272 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:25,275 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:25,277 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:25,280 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:25,282 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:25,284 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:25,294 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:25,294 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:25:25,299 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:25:25,299 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:25:25,305 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:25,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:25:25,317 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:25,318 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:25:25,318 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:25,332 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:25,337 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:25:25,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:25:25,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:25,342 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:25,342 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:25,343 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:25,343 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:25,343 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:25:25,343 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:25,343 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:25:25,344 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:25,345 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:25:25,345 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:25:25,345 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:25,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:25:25,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:25,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:25,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:25,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:25:25,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:25:25,347 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:25:25,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:25:25,347 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:25:25,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:25:25,349 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:25:25,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:25:25,349 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:25:25,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:25:25,349 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:25:25,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:25:25,350 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:25,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:25:25,350 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:25,350 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:25,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:25,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:25:25,351 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:25:25,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:25:25,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:25:25,356 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:25:25,357 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:25,358 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:25,358 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:25,359 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:25,359 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:25,359 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:25,360 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:25,372 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3230, Threshold=0.3341, Accuracy=0.6684, F1=0.7702, Precision=0.9275, Recall=0.6584
2025-08-04 20:25:25,373 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6684, F1: 0.7702, Prec: 0.9275, Rec: 0.6584, Avg Anomaly Score: 0.3230
2025-08-04 20:25:36,667 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:36,667 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:36,667 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:36,667 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:25:36,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:25:36,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:36,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:36,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:36,999 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:25:37,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:25:37,022 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:37,120 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:37,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:37,126 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:37,130 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:25:37,138 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:37,138 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:25:37,138 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:37,139 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:37,139 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:25:37,147 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:37,150 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:37,152 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:37,154 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:37,157 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:37,159 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:37,162 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:37,164 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:37,167 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:37,169 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:37,172 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:37,182 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:37,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:25:37,187 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:25:37,187 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:25:37,193 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:37,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:25:37,205 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:37,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:25:37,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:37,221 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:37,226 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:25:37,230 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:25:37,230 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:37,230 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:37,231 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:37,231 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:37,231 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:37,231 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:25:37,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:37,232 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:25:37,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:37,233 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:25:37,233 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:25:37,234 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:25:37,235 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:25:37,235 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:25:37,235 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:25:37,235 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:25:37,236 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:25:37,236 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:25:37,236 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:25:37,236 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:25:37,237 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:25:37,237 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:25:37,237 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:37,237 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:25:37,237 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:37,237 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:37,238 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:37,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:25:37,238 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:25:37,238 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:25:37,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:25:37,239 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:25:37,239 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:37,240 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:37,241 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:37,242 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:37,242 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:37,242 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:37,243 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:37,255 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3206, Threshold=0.3326, Accuracy=0.6684, F1=0.7702, Precision=0.9275, Recall=0.6584
2025-08-04 20:25:37,255 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6684, F1: 0.7702, Prec: 0.9275, Rec: 0.6584, Avg Anomaly Score: 0.3206
2025-08-04 20:25:42,524 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:42,525 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:42,525 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:42,525 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:25:42,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:25:42,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:42,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:42,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:42,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:25:42,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:25:42,945 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:43,065 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:43,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:43,072 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:43,079 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:25:43,086 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:43,087 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:25:43,087 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:43,087 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:43,088 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:25:43,097 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:43,100 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:43,102 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:43,104 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:43,107 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:43,109 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:43,111 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:43,114 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:43,117 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:43,119 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:43,121 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:43,130 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:43,130 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:25:43,135 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:25:43,135 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:25:43,140 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:43,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:25:43,148 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:43,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:25:43,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:43,163 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:43,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:25:43,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:25:43,173 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:43,173 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:43,173 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:43,173 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:43,174 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:43,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:25:43,174 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:43,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:25:43,174 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:43,176 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:25:43,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:25:43,176 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:25:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:25:43,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:25:43,178 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:25:43,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:25:43,179 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:25:43,179 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:25:43,180 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:25:43,180 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:25:43,180 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:25:43,180 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:25:43,180 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:43,180 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:25:43,181 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:43,181 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:43,181 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:43,181 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:25:43,182 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:25:43,182 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:25:43,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:25:43,186 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:25:43,186 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:43,187 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:43,187 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:43,189 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 22/400.
2025-08-04 20:25:43,289 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:43,289 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:43,291 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 160 anomalous samples to GAN training data (target: 160).
2025-08-04 20:25:43,292 - ClientAppLogger [Client 9] - INFO - [Client] Round 22: Training GAN with 695 samples (535 normal, 160 anomalous).
2025-08-04 20:25:43,292 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:43,792 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8915
2025-08-04 20:25:43,792 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8915
2025-08-04 20:25:43,793 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:43,806 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3315, Threshold=0.3421, Accuracy=0.6719, F1=0.7726, Precision=0.9304, Recall=0.6605
2025-08-04 20:25:43,806 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.7726
2025-08-04 20:25:43,807 - ClientAppLogger [Client 9] - INFO - Fit completed for round 22. Duration: 0.62s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 22, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0841362376178765, 'd_loss': 0.891508337568036, 'post_fit_local_f1': 0.7725631768953068, 'fit_time_seconds': 0.6180193424224854, 'cpu_percent_fit': 6.28125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 695}
2025-08-04 20:25:43,807 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:25:49,115 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:49,116 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:49,116 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:49,116 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:25:49,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:25:49,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:49,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:49,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:49,428 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:25:49,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:25:49,466 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:49,560 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:49,565 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:49,565 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:49,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:25:49,575 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:49,575 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:25:49,575 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:49,576 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:49,576 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:25:49,584 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:49,586 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:49,589 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:49,591 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:49,593 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:49,595 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:49,598 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:49,600 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:49,603 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:49,605 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:49,607 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:49,616 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:49,616 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:25:49,621 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:25:49,621 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:25:49,627 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:49,627 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:25:49,638 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:49,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:25:49,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:49,653 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:49,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:25:49,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:25:49,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:49,664 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:49,664 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:49,664 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:49,665 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:49,665 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:25:49,665 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:49,665 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:25:49,665 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:49,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:49,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:25:49,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:25:49,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:25:49,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:25:49,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:25:49,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:25:49,669 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:25:49,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:25:49,669 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:25:49,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:25:49,670 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:25:49,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:25:49,670 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:49,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:25:49,670 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:49,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:49,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:49,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:25:49,671 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:25:49,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:25:49,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:25:49,673 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:25:49,673 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:49,674 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:49,674 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:49,675 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:49,675 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:49,676 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:49,676 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:49,689 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3243, Threshold=0.3365, Accuracy=0.6788, F1=0.7774, Precision=0.9362, Recall=0.6646
2025-08-04 20:25:49,689 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6788, F1: 0.7774, Prec: 0.9362, Rec: 0.6646, Avg Anomaly Score: 0.3243
2025-08-04 20:26:04,061 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:04,061 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:04,061 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:04,062 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:26:04,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:26:04,068 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:04,447 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:04,447 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:04,535 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:26:04,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:26:04,562 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:04,656 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:04,661 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:04,661 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:04,666 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:26:04,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:04,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:26:04,672 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:04,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:04,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:26:04,681 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:04,684 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,686 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:04,688 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:04,692 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:04,695 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:04,698 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,700 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:04,703 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:04,705 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:04,707 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:04,716 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:04,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:26:04,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:26:04,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:26:04,726 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:04,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:26:04,734 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:04,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:26:04,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:04,750 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:04,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:26:04,758 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:26:04,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,759 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,759 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,759 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,759 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,760 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:26:04,760 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,760 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:26:04,760 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,761 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:26:04,761 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,763 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:26:04,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:26:04,763 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:26:04,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:26:04,763 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:26:04,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:26:04,764 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:26:04,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:26:04,764 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:26:04,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:26:04,765 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:26:04,765 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:26:04,765 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,765 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:26:04,765 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,765 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,766 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:26:04,766 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:26:04,766 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:26:04,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:26:04,767 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:26:04,768 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,769 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,769 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:04,770 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,770 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,770 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,771 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,783 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3324, Threshold=0.3456, Accuracy=0.6858, F1=0.7822, Precision=0.9420, Recall=0.6687
2025-08-04 20:26:04,783 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6858, F1: 0.7822, Prec: 0.9420, Rec: 0.6687, Avg Anomaly Score: 0.3324
2025-08-04 20:26:16,118 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:16,118 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:16,118 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:16,118 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:26:16,119 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:26:16,119 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:16,547 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:16,547 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:16,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:26:16,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:26:16,679 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,785 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,791 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:26:16,803 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,803 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,803 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,803 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:26:16,813 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,816 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,818 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,820 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,823 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,825 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,828 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,831 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,833 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,835 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,838 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,846 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:26:16,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:26:16,856 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,856 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:26:16,864 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:26:16,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,882 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:26:16,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:26:16,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,892 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,892 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,892 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,893 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:26:16,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:26:16,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:26:16,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:26:16,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:26:16,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:26:16,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:26:16,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:26:16,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:26:16,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:26:16,900 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:26:16,900 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:26:16,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:26:16,903 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:26:16,904 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,905 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,905 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:16,906 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,906 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,906 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,907 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,919 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3238, Threshold=0.3368, Accuracy=0.6840, F1=0.7807, Precision=0.9419, Recall=0.6667
2025-08-04 20:26:16,919 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6840, F1: 0.7807, Prec: 0.9419, Rec: 0.6667, Avg Anomaly Score: 0.3238
2025-08-04 20:26:28,221 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:28,221 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:28,221 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:28,222 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:26:28,222 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:26:28,222 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:28,565 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:28,565 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:26:28,722 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:26:28,723 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,853 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,861 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,868 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:26:28,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,879 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:26:28,890 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,893 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,897 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,899 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,902 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,904 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,907 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,910 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,915 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,917 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,921 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,933 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,933 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:26:28,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:26:28,943 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:26:28,953 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:26:28,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,971 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,978 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:26:28,985 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:26:28,985 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,985 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,985 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,985 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,986 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,986 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:26:28,986 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,987 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:26:28,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:26:28,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:26:28,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:26:28,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:26:28,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:26:28,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:26:28,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:26:28,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:26:28,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:26:28,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:26:28,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:26:28,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,993 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:26:28,993 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:26:28,993 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:26:28,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:26:28,997 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:26:28,997 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,998 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,998 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:28,999 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,999 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,999 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:29,000 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:29,013 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3284, Threshold=0.3407, Accuracy=0.6892, F1=0.7846, Precision=0.9449, Recall=0.6708
2025-08-04 20:26:29,013 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6892, F1: 0.7846, Prec: 0.9449, Rec: 0.6708, Avg Anomaly Score: 0.3284
2025-08-04 20:26:40,300 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,300 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:40,300 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:40,300 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:26:40,300 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:26:40,300 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:26:40,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:26:40,911 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:41,058 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:41,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:41,065 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:41,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:26:41,080 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:41,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:26:41,081 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:41,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:41,082 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:26:41,091 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:41,095 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,098 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:41,101 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:41,104 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:41,107 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:41,110 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,114 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:41,117 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:41,120 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:41,123 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:41,136 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:41,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:26:41,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:26:41,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:26:41,148 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:41,148 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:26:41,165 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:41,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:26:41,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:41,190 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:41,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:26:41,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:26:41,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:41,205 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:41,205 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:41,206 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:41,206 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:41,206 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:26:41,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:41,206 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:26:41,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:41,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:26:41,208 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:26:41,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:41,208 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:26:41,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:26:41,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:26:41,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:26:41,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:26:41,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:26:41,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:26:41,212 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:26:41,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:26:41,212 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:41,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:26:41,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:41,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:41,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:41,213 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:26:41,213 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:26:41,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:26:41,214 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:26:41,219 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:26:41,219 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:41,220 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:41,220 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:41,222 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:41,222 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:41,222 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:41,223 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,239 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3326, Threshold=0.3462, Accuracy=0.6892, F1=0.7846, Precision=0.9449, Recall=0.6708
2025-08-04 20:26:41,239 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6892, F1: 0.7846, Prec: 0.9449, Rec: 0.6708, Avg Anomaly Score: 0.3326
2025-08-04 20:26:52,535 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,535 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:52,535 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:52,535 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:26:52,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:26:52,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:52,952 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:52,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:53,053 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:26:53,091 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:26:53,091 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,252 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,266 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,280 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:26:53,301 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,301 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,302 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,302 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,303 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:26:53,317 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,324 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,328 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,331 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,337 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,341 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,345 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,348 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,351 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,354 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,357 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,370 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,370 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:26:53,375 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,376 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:26:53,383 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,383 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:26:53,396 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,396 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:26:53,396 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,414 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:26:53,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:26:53,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,431 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,432 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,432 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,432 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,433 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:26:53,433 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,433 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:26:53,433 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,436 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,436 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,436 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,436 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:26:53,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:26:53,437 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:26:53,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:26:53,437 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:26:53,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:26:53,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:26:53,440 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:26:53,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:26:53,440 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:26:53,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:26:53,440 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:26:53,441 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,441 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:26:53,441 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,441 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:26:53,442 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:26:53,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:26:53,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:26:53,450 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:26:53,451 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,452 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,452 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:53,454 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,454 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,454 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,455 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,471 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3349, Threshold=0.3485, Accuracy=0.6892, F1=0.7846, Precision=0.9449, Recall=0.6708
2025-08-04 20:26:53,472 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6892, F1: 0.7846, Prec: 0.9449, Rec: 0.6708, Avg Anomaly Score: 0.3349
2025-08-04 20:27:04,748 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,748 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:04,749 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:04,749 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:27:04,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:27:04,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:05,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:05,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:05,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:27:05,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:27:05,291 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,473 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,482 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,483 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,493 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:27:05,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,506 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:27:05,518 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,522 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,524 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,527 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,534 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,537 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,541 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,543 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,547 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,549 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,552 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,566 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:27:05,572 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,573 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:27:05,583 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,583 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:27:05,598 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,599 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:27:05,599 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,616 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,622 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:27:05,632 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:27:05,633 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,633 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,633 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,633 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:27:05,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,636 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:27:05,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:27:05,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:27:05,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:27:05,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:27:05,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:27:05,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:27:05,641 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:27:05,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:27:05,642 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:27:05,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:27:05,642 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:27:05,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:27:05,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,643 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:27:05,644 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:27:05,644 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:27:05,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:27:05,652 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:27:05,652 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,653 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,653 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:05,655 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,655 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,655 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,656 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,671 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3312, Threshold=0.3441, Accuracy=0.6892, F1=0.7846, Precision=0.9449, Recall=0.6708
2025-08-04 20:27:05,671 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6892, F1: 0.7846, Prec: 0.9449, Rec: 0.6708, Avg Anomaly Score: 0.3312
2025-08-04 20:27:16,936 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:16,937 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:16,937 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:16,937 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:27:16,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:27:16,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:17,389 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:17,389 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:17,498 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:27:17,552 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:27:17,553 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,701 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,710 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,717 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:27:17,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,743 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,744 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,744 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:27:17,753 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,756 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,758 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:17,761 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:17,764 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:17,767 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:17,770 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,773 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:17,776 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:17,779 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:17,783 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:17,795 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:17,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:27:17,800 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:27:17,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:27:17,809 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:17,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:27:17,822 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:17,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:27:17,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:17,844 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:17,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:27:17,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:27:17,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:17,862 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:17,862 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:17,862 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:17,863 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:17,863 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:27:17,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:17,863 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:27:17,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:17,865 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:27:17,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:27:17,865 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:27:17,866 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:27:17,867 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:27:17,867 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:27:17,867 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:27:17,871 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:27:17,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:27:17,872 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:27:17,872 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:27:17,872 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:27:17,872 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:27:17,872 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:17,873 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:27:17,873 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:17,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:17,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:17,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:27:17,874 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:27:17,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:27:17,875 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:27:17,886 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:27:17,887 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:17,888 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:17,889 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:17,891 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:17,891 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:17,891 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:17,892 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:17,908 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3342, Threshold=0.3467, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:27:17,908 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3342
2025-08-04 20:27:35,189 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:35,190 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:35,190 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:35,190 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:27:35,190 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:27:35,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:35,519 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:35,519 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:35,609 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:27:35,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:27:35,656 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:35,762 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:35,770 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:35,770 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:35,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:27:35,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:35,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:27:35,786 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:35,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:35,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:27:35,796 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:35,799 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,802 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:35,804 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:35,807 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:35,809 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:35,812 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:35,817 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:35,819 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:35,821 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:35,831 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:35,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:27:35,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:27:35,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:27:35,840 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:35,840 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:27:35,850 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:35,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:27:35,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:35,866 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:35,872 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:27:35,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:27:35,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:35,879 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:35,879 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:35,879 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:35,879 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:35,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:27:35,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:35,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:27:35,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:35,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:27:35,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:27:35,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:27:35,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:27:35,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:27:35,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:27:35,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:27:35,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:27:35,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:27:35,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:27:35,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:27:35,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:27:35,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:27:35,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:35,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:27:35,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:35,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:35,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:35,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:27:35,887 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:27:35,887 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:27:35,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:27:35,891 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:27:35,891 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:35,892 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:35,892 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:35,894 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:35,894 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:35,894 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:35,894 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:35,907 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3353, Threshold=0.3495, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:27:35,907 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3353
2025-08-04 20:27:47,191 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:47,191 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:47,191 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:47,191 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:27:47,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:27:47,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:47,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:47,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:47,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:27:47,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:27:47,643 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:47,771 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:47,780 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:47,780 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:47,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:27:47,799 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:47,800 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:27:47,800 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:47,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:47,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:27:47,812 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:47,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,818 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:47,820 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:47,824 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:47,827 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:47,832 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,836 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:47,840 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:47,843 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:47,846 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:47,859 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:47,859 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:27:47,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:27:47,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:27:47,871 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:47,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:27:47,883 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:47,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:27:47,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:47,902 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:47,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:27:47,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:27:47,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:47,916 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:47,916 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:47,917 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:47,917 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:47,917 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:27:47,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:47,917 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:27:47,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:47,919 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:27:47,919 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:27:47,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:47,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:27:47,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:47,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:47,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:47,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:27:47,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:27:47,921 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:27:47,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:27:47,921 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:27:47,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:27:47,923 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:27:47,923 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:27:47,923 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:27:47,923 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:27:47,924 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:27:47,924 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:27:47,924 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:47,924 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:27:47,925 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:47,925 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:47,925 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:47,925 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:27:47,925 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:27:47,926 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:27:47,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:27:47,927 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:27:47,927 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:47,928 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:47,929 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:47,930 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:47,930 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:47,930 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:47,931 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:47,944 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3397, Threshold=0.3547, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:27:47,944 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3397
2025-08-04 20:28:02,231 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:02,231 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:02,231 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:02,231 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:28:02,231 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:28:02,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:02,565 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:02,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:02,660 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:28:02,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:28:02,713 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:02,857 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:02,868 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:02,868 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:02,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:28:02,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:02,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:28:02,890 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:02,890 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:02,890 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:28:02,901 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:02,905 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,907 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:02,910 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:02,913 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:02,915 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:02,918 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,921 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:02,924 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:02,926 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:02,928 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:02,945 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:02,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:28:02,951 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:28:02,951 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:28:02,957 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:02,957 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:28:02,973 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:02,973 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:28:02,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:02,992 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:02,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:28:03,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:28:03,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:03,007 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:03,007 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:28:03,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:03,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:28:03,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:28:03,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:28:03,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:28:03,012 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:28:03,012 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:28:03,012 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:28:03,013 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:28:03,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:28:03,014 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:28:03,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:28:03,014 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:28:03,015 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:03,015 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:28:03,015 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:28:03,016 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:28:03,016 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:28:03,023 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:28:03,023 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:03,025 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:03,025 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:03,027 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:03,027 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:03,028 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:03,028 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:03,044 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3421, Threshold=0.3572, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:28:03,044 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3421
2025-08-04 20:28:17,334 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:17,342 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:17,342 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:17,342 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:28:17,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:28:17,343 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:17,757 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:17,758 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:17,860 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:28:17,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:28:17,900 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:18,045 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:18,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:18,052 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:18,059 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:28:18,070 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:18,070 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:28:18,071 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:18,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:18,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:28:18,081 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:18,084 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,087 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:18,089 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:18,092 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:18,095 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:18,098 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,101 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:18,105 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:18,107 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:18,111 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:18,124 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:18,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:28:18,130 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:28:18,132 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:28:18,137 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:18,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:28:18,153 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:18,153 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:28:18,153 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:18,174 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:18,181 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:28:18,187 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:28:18,188 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:18,188 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:18,188 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:18,188 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:18,188 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:18,189 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:28:18,189 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:18,189 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:28:18,189 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:18,191 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:28:18,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:28:18,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:18,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:28:18,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:18,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:18,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:18,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:28:18,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:28:18,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:28:18,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:28:18,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:28:18,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:28:18,194 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:28:18,194 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:28:18,194 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:28:18,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:28:18,195 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:28:18,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:28:18,195 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:18,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:28:18,195 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:18,196 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:18,196 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:18,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:28:18,196 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:28:18,196 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:28:18,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:28:18,201 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:28:18,201 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:18,202 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:18,202 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:18,203 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:18,204 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:18,204 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:18,204 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:18,218 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3406, Threshold=0.3553, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:28:18,218 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3406
2025-08-04 20:28:29,517 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,517 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:29,517 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:29,517 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:28:29,518 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:28:29,518 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:30,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:30,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:30,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:28:30,223 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:28:30,224 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:30,368 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:30,377 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:30,377 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:30,384 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:28:30,395 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:30,396 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:28:30,396 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:30,396 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:30,397 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:28:30,407 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:30,410 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,413 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:30,415 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:30,419 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:30,422 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:30,425 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,428 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:30,432 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:30,435 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:30,440 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:30,455 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:30,455 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:28:30,468 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,468 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:28:30,483 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,484 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:28:30,484 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,505 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,511 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:28:30,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:28:30,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,520 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,520 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,522 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:28:30,522 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,523 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:28:30,523 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,524 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,524 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,524 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,524 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:28:30,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:28:30,528 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:28:30,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:28:30,529 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:28:30,529 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:28:30,529 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:28:30,529 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:28:30,529 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,530 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:28:30,530 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,530 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,530 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,531 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:28:30,531 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:28:30,531 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:28:30,531 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:28:30,535 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:28:30,536 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,538 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,538 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:30,540 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,540 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,540 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,541 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,558 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3433, Threshold=0.3586, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:28:30,558 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3433
2025-08-04 20:28:41,824 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:41,824 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:41,824 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:41,824 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:28:41,824 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:28:41,824 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:42,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:42,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:42,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:28:42,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:28:42,258 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:42,367 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:42,374 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:42,374 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:42,379 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:28:42,386 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:42,386 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:28:42,387 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:42,387 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:42,387 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:28:42,397 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:42,400 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,402 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:42,404 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:42,407 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:42,409 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:42,412 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,414 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:42,417 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:42,419 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:42,421 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:42,431 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:42,432 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:28:42,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:28:42,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:28:42,446 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:42,449 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:28:42,466 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:42,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:28:42,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:42,486 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:42,493 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:28:42,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:28:42,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:42,502 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:42,502 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:42,503 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:42,503 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:42,503 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:28:42,503 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:42,504 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:28:42,504 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:42,506 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:28:42,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:28:42,507 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:42,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:28:42,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:42,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:42,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:42,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:28:42,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:28:42,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:28:42,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:28:42,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:28:42,510 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:28:42,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:28:42,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:28:42,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:28:42,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:28:42,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:28:42,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:28:42,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:42,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:28:42,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:42,514 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:42,514 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:42,514 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:28:42,514 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:28:42,514 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:28:42,514 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:28:42,516 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:28:42,516 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:42,517 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:42,518 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:42,519 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:42,519 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:42,520 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:42,520 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:42,536 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3397, Threshold=0.3553, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:28:42,537 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3397
2025-08-04 20:28:56,839 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:56,839 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:56,839 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:56,840 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:28:56,840 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:28:56,840 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:57,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:57,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:57,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:28:57,334 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:28:57,334 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:57,447 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:57,458 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:57,458 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:57,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:28:57,483 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:57,483 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:28:57,484 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:57,484 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:57,484 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:28:57,494 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:57,498 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,500 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:57,502 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:57,506 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:57,508 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:57,511 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,513 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:57,516 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:57,518 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:57,520 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:57,531 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:57,531 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:28:57,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:28:57,537 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:28:57,543 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:57,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:28:57,558 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:57,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:28:57,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:57,576 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:57,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:28:57,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:28:57,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:57,593 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:57,593 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:57,594 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:57,595 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:57,595 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:28:57,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:57,596 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:28:57,596 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:57,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:28:57,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:28:57,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:57,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:28:57,599 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:28:57,600 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:28:57,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:28:57,602 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:28:57,602 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:28:57,603 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:28:57,603 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:28:57,603 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:28:57,603 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:28:57,604 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:57,604 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:28:57,604 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:57,605 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:57,605 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:57,605 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:28:57,605 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:28:57,606 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:28:57,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:28:57,610 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:28:57,610 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:57,612 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:57,612 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:57,614 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:57,614 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:57,614 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:57,615 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:57,631 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3440, Threshold=0.3599, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:28:57,631 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3440
2025-08-04 20:29:14,920 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:14,921 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:14,921 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:14,921 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:29:14,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:29:14,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:15,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:15,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:15,326 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:29:15,376 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:29:15,376 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:15,501 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:15,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:15,508 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:15,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:29:15,519 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:15,519 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:29:15,520 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:15,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:15,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:29:15,528 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:15,531 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:15,533 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:15,535 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:15,538 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:15,541 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:15,543 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:15,546 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:15,549 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:15,551 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:15,553 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:15,563 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:15,563 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:29:15,568 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:29:15,568 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:29:15,574 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:15,574 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:29:15,586 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:15,587 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:29:15,587 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:15,604 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:15,608 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:29:15,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:29:15,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:15,615 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:15,615 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:15,616 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:15,616 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:15,617 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:29:15,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:15,617 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:29:15,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:15,619 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:29:15,619 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:29:15,619 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:15,619 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:29:15,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:15,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:15,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:15,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:29:15,620 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:29:15,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:29:15,621 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:29:15,621 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:29:15,621 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:29:15,622 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:29:15,622 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:29:15,622 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:29:15,622 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:29:15,623 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:29:15,623 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:29:15,623 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:15,623 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:29:15,623 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:15,623 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:15,624 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:15,624 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:29:15,624 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:29:15,624 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:29:15,624 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:29:15,631 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:29:15,631 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:15,632 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:15,632 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:15,634 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:15,634 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:15,634 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:15,634 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:15,649 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3410, Threshold=0.3568, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:29:15,649 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3410
2025-08-04 20:29:26,926 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:26,927 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:26,927 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:26,927 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:29:26,927 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:29:26,927 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:27,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:27,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:27,359 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:29:27,398 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:29:27,398 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:27,508 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:27,514 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:27,514 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:27,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:29:27,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:27,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:29:27,528 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:27,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:27,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:29:27,537 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:27,540 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,542 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:27,545 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:27,547 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:27,549 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:27,552 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,555 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:27,558 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:27,560 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:27,562 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:27,573 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:27,574 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:29:27,579 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:29:27,580 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:29:27,586 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:27,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:29:27,600 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:27,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:29:27,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:27,618 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:27,623 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:29:27,628 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:29:27,628 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:27,629 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:27,629 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:27,629 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:27,629 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:27,629 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:29:27,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:27,630 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:29:27,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:27,632 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:29:27,632 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:29:27,632 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:27,633 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:29:27,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:27,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:27,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:27,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:29:27,633 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:29:27,634 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:29:27,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:29:27,634 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:29:27,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:29:27,636 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:29:27,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:29:27,636 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:29:27,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:29:27,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:29:27,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:29:27,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:27,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:29:27,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:27,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:27,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:27,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:29:27,639 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:29:27,639 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:29:27,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:29:27,643 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:29:27,643 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:27,644 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:27,644 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:27,645 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:27,645 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:27,646 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:27,646 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:27,661 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3377, Threshold=0.3542, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:29:27,661 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3377
2025-08-04 20:29:38,930 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:38,930 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:38,931 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:38,931 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:29:38,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:29:38,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:39,256 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:39,256 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:39,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:29:39,369 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:29:39,369 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:39,484 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:39,493 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:39,493 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:39,498 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:29:39,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:39,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:29:39,507 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:39,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:39,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:29:39,517 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:39,520 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,523 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:39,525 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:39,528 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:39,531 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:39,533 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,536 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:39,539 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:39,542 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:39,544 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:39,555 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:39,556 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:29:39,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:29:39,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:29:39,567 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:39,567 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:29:39,581 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:39,582 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:29:39,583 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:39,601 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:39,607 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:29:39,613 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:29:39,614 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:39,614 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:39,614 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:39,614 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:39,615 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:39,615 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:29:39,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:39,615 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:29:39,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:39,617 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:29:39,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:29:39,617 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:39,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:29:39,617 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:39,617 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:29:39,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:29:39,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:29:39,620 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:29:39,620 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:29:39,620 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:29:39,621 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:29:39,621 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:29:39,621 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:39,621 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:29:39,622 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:39,622 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:39,622 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:39,622 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:29:39,622 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:29:39,622 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:29:39,623 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:29:39,624 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:29:39,624 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:39,625 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:39,625 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:39,627 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:39,627 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:39,627 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:39,628 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:39,642 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3405, Threshold=0.3566, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:29:39,642 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3405
2025-08-04 20:29:53,925 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:53,925 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:53,925 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:53,926 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:29:53,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:29:53,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:54,244 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:54,244 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:54,338 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:29:54,389 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:29:54,389 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:54,587 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:54,594 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:54,594 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:54,604 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:29:54,612 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:54,612 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:29:54,612 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:54,613 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:54,613 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:29:54,622 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:54,624 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,626 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:54,629 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:54,631 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:54,634 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:54,636 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,639 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:54,642 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:54,644 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:54,646 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:54,656 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:54,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:29:54,662 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:29:54,662 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:29:54,667 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:54,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:29:54,677 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:54,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:29:54,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:54,696 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:54,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:29:54,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:29:54,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:54,710 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:54,711 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:54,711 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:54,711 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:54,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:29:54,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:54,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:29:54,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:54,713 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:29:54,714 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:29:54,714 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:54,714 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:29:54,714 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:54,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:54,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:54,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:29:54,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:29:54,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:29:54,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:29:54,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:29:54,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:29:54,718 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:54,719 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:29:54,720 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:54,720 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:54,720 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:54,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:29:54,721 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:29:54,721 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:29:54,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:29:54,727 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:29:54,727 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:54,729 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:54,729 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:54,730 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:54,731 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:54,731 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:54,731 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:54,746 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3474, Threshold=0.3622, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:29:54,746 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3474
