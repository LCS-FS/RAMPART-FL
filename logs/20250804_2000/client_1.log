2025-08-04 20:21:12,238 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:12,240 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:12,243 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:12,245 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:21:12,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:21:12,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:13,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:13,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:13,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:21:13,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:21:13,399 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:13,622 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:13,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:13,634 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:13,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:21:13,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:13,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:21:13,672 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:13,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:13,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:21:13,687 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:13,692 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,696 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:13,698 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:13,703 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:13,707 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:13,712 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,717 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:13,721 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:13,725 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:13,729 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:13,745 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:13,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:21:13,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:21:13,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:21:13,764 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:13,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:21:13,788 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:13,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:21:13,790 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:13,817 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:13,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:21:13,851 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:21:13,851 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:13,851 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:13,851 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:13,852 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:13,852 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:13,853 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:21:13,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:13,854 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:21:13,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:13,856 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:21:13,859 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:21:13,860 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:13,861 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:21:13,862 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:13,863 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:13,863 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:13,866 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:21:13,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:21:13,870 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:21:13,871 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:21:13,871 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:21:13,872 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:21:13,879 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:21:13,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:21:13,879 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:21:13,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:21:13,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:21:13,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:21:13,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:13,881 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:21:13,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:13,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:13,884 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:13,884 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:21:13,884 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:21:13,884 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:21:13,884 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:21:13,894 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:21:13,894 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:13,897 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:13,897 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:13,901 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:13,902 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:13,902 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:13,903 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:13,932 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5013, Accuracy=0.5396, F1=0.6832, Precision=0.8280, Recall=0.5815
2025-08-04 20:21:13,935 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5396, F1: 0.6832, Prec: 0.8280, Rec: 0.5815, Avg Anomaly Score: 0.5017
2025-08-04 20:21:28,299 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:28,299 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:28,299 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:28,300 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:21:28,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:21:28,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:29,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:29,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:29,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:21:29,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:21:29,612 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:29,862 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:29,877 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:29,878 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:29,899 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:21:29,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:29,927 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:21:29,928 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:29,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:29,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:21:29,940 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:29,944 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,947 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:29,949 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:29,952 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:29,955 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:29,959 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,962 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:29,965 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:29,968 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:29,972 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:29,991 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:29,992 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:21:29,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:21:29,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:21:30,009 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,010 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:21:30,034 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:21:30,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,057 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:21:30,077 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:21:30,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,078 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,079 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,079 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,079 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,080 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:21:30,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,080 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:21:30,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,082 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:21:30,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,083 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:21:30,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:21:30,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:21:30,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:21:30,086 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:21:30,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:21:30,092 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:21:30,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:21:30,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:21:30,093 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:21:30,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:21:30,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:21:30,094 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:21:30,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:21:30,095 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:21:30,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:21:30,096 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:21:30,101 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:21:30,102 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,103 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,103 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:30,105 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,105 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,105 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,107 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,124 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5013, Accuracy=0.5396, F1=0.6832, Precision=0.8280, Recall=0.5815
2025-08-04 20:21:30,124 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5396, F1: 0.6832, Prec: 0.8280, Rec: 0.5815, Avg Anomaly Score: 0.5017
2025-08-04 20:21:41,431 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,431 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:41,431 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:41,431 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:21:41,432 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:21:41,432 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:41,844 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:41,844 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:41,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:21:42,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:21:42,003 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,211 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,223 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,224 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:21:42,271 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,272 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,273 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:21:42,287 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,290 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,294 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,297 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,301 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,304 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,308 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,312 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,315 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,322 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,344 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:21:42,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,353 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:21:42,362 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:21:42,382 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:21:42,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,412 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,422 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:21:42,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:21:42,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,445 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,445 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,446 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,446 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,446 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:21:42,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,447 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:21:42,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,449 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:21:42,449 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,450 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,451 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,452 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,452 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,452 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:21:42,452 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:21:42,453 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:21:42,453 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:21:42,453 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:21:42,453 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:21:42,461 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:21:42,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:21:42,463 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:21:42,463 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,463 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:21:42,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:21:42,466 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:21:42,467 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:21:42,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:21:42,475 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:21:42,475 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,477 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,478 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:42,479 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,480 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,480 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,481 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,498 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5076, Accuracy=0.5396, F1=0.6832, Precision=0.8280, Recall=0.5815
2025-08-04 20:21:42,499 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5396, F1: 0.6832, Prec: 0.8280, Rec: 0.5815, Avg Anomaly Score: 0.5078
2025-08-04 20:21:53,777 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:53,778 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:53,778 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:53,778 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:21:53,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:21:53,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,276 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:21:54,320 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:21:54,322 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:54,594 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:54,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:54,605 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:54,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:21:54,625 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:54,625 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:21:54,626 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:54,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:54,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:21:54,638 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:54,642 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,646 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:54,649 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:54,654 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:54,657 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:54,662 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,666 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:54,671 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:54,674 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:54,678 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:54,699 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:54,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:21:54,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:21:54,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:21:54,722 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:54,723 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:21:54,749 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:54,750 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:21:54,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:54,785 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:54,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:21:54,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:21:54,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:54,809 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:54,809 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:54,810 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:54,810 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:54,811 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:21:54,811 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:54,812 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:21:54,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:54,813 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:21:54,813 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:21:54,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:54,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:21:54,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:54,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:54,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:54,815 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:21:54,815 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:21:54,815 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:21:54,815 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:21:54,815 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:21:54,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:21:54,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:21:54,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:21:54,823 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:21:54,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:21:54,823 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:21:54,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:21:54,823 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:54,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:21:54,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:54,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:54,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:54,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:21:54,825 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:21:54,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:21:54,826 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:21:54,834 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:21:54,834 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:54,836 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:54,837 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:54,839 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:54,839 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:54,839 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:54,840 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:54,854 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.5204, F1=0.6700, Precision=0.8120, Recall=0.5702
2025-08-04 20:21:54,854 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5204, F1: 0.6700, Prec: 0.8120, Rec: 0.5702, Avg Anomaly Score: 0.5085
2025-08-04 20:22:09,127 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,127 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:09,127 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:09,128 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:22:09,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:22:09,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:09,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:09,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:09,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:22:09,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:22:09,554 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:09,755 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:09,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:09,765 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:09,797 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:22:09,836 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:09,836 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:22:09,837 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:09,838 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:09,838 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:22:09,850 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:09,854 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:09,858 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:09,862 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:09,866 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:09,868 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:09,871 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:09,874 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:09,877 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:09,881 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:09,884 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:09,897 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:09,897 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:22:09,903 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:22:09,903 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:22:09,910 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:09,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:22:09,928 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:09,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:22:09,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:09,950 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:09,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:22:09,974 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:22:09,974 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:09,974 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:09,974 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:09,975 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:09,975 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:09,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:22:09,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:09,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:22:09,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:09,978 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:22:09,981 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:22:09,982 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:09,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:22:09,983 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:09,983 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:09,983 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:09,984 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:22:09,984 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:22:09,984 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:22:09,985 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:22:09,985 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:22:09,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:22:09,994 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:22:09,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:22:09,995 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:22:09,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:22:09,996 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:22:09,996 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:22:09,996 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:09,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:22:09,997 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:09,998 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:09,998 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:09,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:22:09,999 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:22:10,000 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:22:10,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:22:10,008 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:22:10,008 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,010 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,010 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:10,012 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,012 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,012 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,013 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,027 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.4964, F1=0.6535, Precision=0.7920, Recall=0.5562
2025-08-04 20:22:10,028 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.4964, F1: 0.6535, Prec: 0.7920, Rec: 0.5562, Avg Anomaly Score: 0.5085
2025-08-04 20:22:24,312 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,313 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:24,313 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:24,313 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:22:24,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:22:24,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:24,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:24,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:24,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:22:24,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:22:24,669 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:24,779 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:24,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:24,786 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:24,793 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:22:24,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:24,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:22:24,811 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:24,811 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:24,811 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:22:24,820 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:24,823 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:24,826 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:24,829 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:24,832 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:24,834 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:24,837 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:24,839 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:24,843 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:24,845 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:24,848 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:24,859 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:24,859 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:22:24,865 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:22:24,865 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:22:24,871 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:24,871 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:22:24,887 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:24,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:22:24,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:24,905 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:24,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:22:24,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:22:24,924 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:24,924 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:24,924 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:24,925 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:24,925 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:24,925 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:22:24,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:24,926 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:22:24,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:24,928 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:22:24,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:22:24,928 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:24,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:22:24,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:24,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:24,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:24,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:22:24,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:22:24,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:22:24,930 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:22:24,930 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:22:24,930 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:22:24,935 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:22:24,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:22:24,935 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:22:24,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:22:24,936 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:22:24,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:22:24,936 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:24,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:22:24,937 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:24,937 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:24,937 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:24,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:22:24,938 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:22:24,938 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:22:24,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:22:24,941 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:22:24,941 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:24,943 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:24,943 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:24,945 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:24,946 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:24,946 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:24,947 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:24,960 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5052, Threshold=0.5037, Accuracy=0.4916, F1=0.6502, Precision=0.7880, Recall=0.5534
2025-08-04 20:22:24,960 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.4916, F1: 0.6502, Prec: 0.7880, Rec: 0.5534, Avg Anomaly Score: 0.5052
2025-08-04 20:22:39,240 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:39,240 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:39,240 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:39,241 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:22:39,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:22:39,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:39,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:39,480 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:39,571 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:22:39,600 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:22:39,600 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:39,696 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:39,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:39,701 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:39,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:22:39,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:39,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:22:39,717 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:39,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:39,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:22:39,726 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:39,729 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:39,731 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:39,733 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:39,736 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:39,738 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:39,741 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:39,743 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:39,746 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:39,748 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:39,751 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:39,764 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:39,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:22:39,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:22:39,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:22:39,782 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:39,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:22:39,799 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:39,800 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:22:39,800 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:39,819 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:39,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:22:39,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:22:39,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:39,836 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:39,836 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:39,836 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:39,837 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:39,837 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:22:39,837 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:39,838 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:22:39,838 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:39,840 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:22:39,840 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:22:39,840 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:39,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:22:39,841 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:39,841 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:39,841 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:39,841 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:22:39,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:22:39,842 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:22:39,842 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:22:39,842 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:22:39,842 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:22:39,845 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:22:39,845 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:22:39,846 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:22:39,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:22:39,846 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:22:39,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:22:39,846 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:39,847 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:22:39,847 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:39,847 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:39,848 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:39,848 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:22:39,848 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:22:39,848 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:22:39,848 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:22:39,853 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:22:39,853 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:39,854 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:39,854 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:39,856 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:39,856 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:39,857 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:39,858 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:39,871 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4970, Threshold=0.4943, Accuracy=0.4916, F1=0.6502, Precision=0.7880, Recall=0.5534
2025-08-04 20:22:39,871 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.4916, F1: 0.6502, Prec: 0.7880, Rec: 0.5534, Avg Anomaly Score: 0.4970
2025-08-04 20:22:54,177 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:54,177 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:54,177 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:54,177 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:22:54,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:22:54,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:54,412 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:54,412 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:54,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:22:54,510 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:22:54,511 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:54,605 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:54,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:54,611 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:54,617 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:22:54,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:54,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:22:54,625 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:54,625 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:54,625 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:22:54,634 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:54,637 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:54,639 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:54,642 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:54,644 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:54,646 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:54,649 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:54,651 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:54,654 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:54,656 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:54,658 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:54,667 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:54,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:22:54,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:22:54,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:22:54,676 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:54,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:22:54,684 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:54,685 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:22:54,685 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:54,699 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:54,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:22:54,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:22:54,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:54,709 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:54,709 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:54,709 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:54,709 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:54,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:22:54,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:54,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:22:54,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:54,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:22:54,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:22:54,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:54,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:22:54,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:54,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:54,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:54,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:22:54,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:22:54,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:22:54,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:22:54,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:22:54,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:22:54,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:22:54,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:22:54,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:22:54,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:22:54,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:22:54,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:22:54,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:54,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:22:54,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:54,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:54,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:54,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:22:54,717 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:22:54,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:22:54,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:22:54,719 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:22:54,720 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:54,721 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:54,721 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:54,722 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:54,722 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:54,723 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:54,723 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:54,734 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4816, Threshold=0.4775, Accuracy=0.4916, F1=0.6502, Precision=0.7880, Recall=0.5534
2025-08-04 20:22:54,734 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.4916, F1: 0.6502, Prec: 0.7880, Rec: 0.5534, Avg Anomaly Score: 0.4816
2025-08-04 20:23:06,015 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:06,015 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:06,015 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:06,015 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:23:06,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:23:06,016 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:06,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:06,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:06,354 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:23:06,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:23:06,379 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:06,477 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:06,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:06,483 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:06,489 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:23:06,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:06,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:23:06,495 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:06,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:06,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:23:06,505 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:06,508 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:06,510 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:06,513 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:06,515 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:06,518 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:06,520 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:06,523 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:06,526 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:06,527 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:06,530 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:06,539 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:06,539 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:23:06,544 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:23:06,544 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:23:06,549 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:06,549 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:23:06,558 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:06,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:23:06,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:06,573 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:06,578 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:23:06,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:23:06,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:06,583 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:06,583 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:06,584 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:06,584 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:06,584 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:23:06,584 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:06,584 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:23:06,584 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:06,586 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:23:06,586 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:23:06,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:23:06,588 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:23:06,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:23:06,588 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:23:06,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:23:06,591 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:23:06,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:23:06,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:23:06,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:23:06,593 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:23:06,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:23:06,593 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:06,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:23:06,594 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:06,594 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:06,594 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:06,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:23:06,594 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:23:06,595 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:23:06,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:23:06,598 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:23:06,599 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:06,600 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:06,600 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:06,602 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:06,602 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:06,602 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:06,603 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:06,616 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4582, Threshold=0.4523, Accuracy=0.5108, F1=0.6634, Precision=0.8040, Recall=0.5646
2025-08-04 20:23:06,616 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5108, F1: 0.6634, Prec: 0.8040, Rec: 0.5646, Avg Anomaly Score: 0.4582
2025-08-04 20:23:20,913 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:20,913 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:20,913 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:20,913 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:23:20,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:23:20,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:21,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:21,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:21,269 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:23:21,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:23:21,293 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:21,391 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:21,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:21,398 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:21,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:23:21,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:21,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:23:21,411 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:21,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:21,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:23:21,420 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:21,423 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:21,425 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:21,428 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:21,430 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:21,433 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:21,435 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:21,438 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:21,441 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:21,443 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:21,445 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:21,455 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:21,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:23:21,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:23:21,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:23:21,466 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:21,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:23:21,479 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:21,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:23:21,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:21,494 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:21,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:23:21,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:23:21,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:21,504 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:21,504 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:21,504 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:21,505 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:21,505 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:23:21,505 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:21,505 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:23:21,505 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:21,507 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:23:21,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:23:21,507 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:21,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:23:21,507 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:23:21,508 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:23:21,509 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:23:21,510 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:21,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:23:21,512 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:21,512 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:21,512 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:21,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:23:21,513 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:23:21,513 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:23:21,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:23:21,514 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:23:21,514 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:21,515 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:21,515 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:21,517 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:21,517 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:21,517 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:21,517 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:21,531 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4197, Threshold=0.4109, Accuracy=0.5108, F1=0.6634, Precision=0.8040, Recall=0.5646
2025-08-04 20:23:21,531 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5108, F1: 0.6634, Prec: 0.8040, Rec: 0.5646, Avg Anomaly Score: 0.4197
2025-08-04 20:23:32,816 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:32,816 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:32,816 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:32,817 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:23:32,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:23:32,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:33,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:33,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:33,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:23:33,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:23:33,182 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:33,278 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:33,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:33,284 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:33,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:23:33,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:33,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:23:33,295 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:33,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:33,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:23:33,303 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:33,306 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:33,308 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:33,310 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:33,313 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:33,315 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:33,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:33,320 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:33,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:33,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:33,327 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:33,336 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:33,336 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:23:33,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:23:33,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:23:33,345 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:33,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:23:33,353 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:33,354 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:23:33,354 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:33,368 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:33,372 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:23:33,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:23:33,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:33,379 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:33,379 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:33,379 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:33,379 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:33,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:23:33,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:33,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:23:33,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:33,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:23:33,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:23:33,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:33,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:23:33,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:33,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:23:33,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:23:33,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:23:33,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:23:33,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:23:33,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:23:33,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:23:33,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:23:33,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:33,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:23:33,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:33,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:33,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:33,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:23:33,388 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:23:33,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:23:33,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:23:33,392 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:23:33,392 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:33,393 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:33,394 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:33,395 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:33,395 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:33,395 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:33,396 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:33,407 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3633, Threshold=0.3517, Accuracy=0.5156, F1=0.6667, Precision=0.8080, Recall=0.5674
2025-08-04 20:23:33,407 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5156, F1: 0.6667, Prec: 0.8080, Rec: 0.5674, Avg Anomaly Score: 0.3633
2025-08-04 20:23:38,675 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:38,675 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:38,675 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:38,676 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:23:38,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:23:38,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:38,952 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:38,952 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:39,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:23:39,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:23:39,053 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:39,152 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:39,158 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:39,158 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:39,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:23:39,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:39,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:23:39,173 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:39,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:39,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:23:39,183 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:39,186 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:39,188 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:39,190 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:39,193 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:39,195 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:39,198 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:39,200 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:39,203 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:39,205 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:39,208 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:39,217 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:39,217 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:23:39,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:23:39,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:23:39,227 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:39,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:23:39,236 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:39,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:23:39,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:39,251 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:39,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:23:39,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:23:39,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:39,261 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:39,261 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:39,262 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:39,262 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:39,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:23:39,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:39,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:23:39,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:39,264 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:23:39,264 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:23:39,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:39,265 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:23:39,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:39,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:39,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:39,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:23:39,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:23:39,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:23:39,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:23:39,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:23:39,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:23:39,269 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:23:39,269 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:23:39,270 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:23:39,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:23:39,270 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:23:39,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:23:39,270 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:39,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:23:39,271 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:39,271 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:39,271 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:39,272 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:23:39,272 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:23:39,272 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:23:39,272 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:23:39,275 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:23:39,275 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:39,277 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:39,277 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:39,279 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 12/400.
2025-08-04 20:23:39,382 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:39,382 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:39,384 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 188 anomalous samples to GAN training data (target: 188).
2025-08-04 20:23:39,385 - ClientAppLogger [Client 1] - INFO - [Client] Round 12: Training GAN with 816 samples (628 normal, 188 anomalous).
2025-08-04 20:23:39,386 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:41,606 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0759, Avg D Loss: 0.9336
2025-08-04 20:23:41,606 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0759, Avg D Loss: 0.9336
2025-08-04 20:23:41,606 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:41,618 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.2958, Threshold=0.2899, Accuracy=0.5444, F1=0.6865, Precision=0.8320, Recall=0.5843
2025-08-04 20:23:41,619 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.6865
2025-08-04 20:23:41,619 - ClientAppLogger [Client 1] - INFO - Fit completed for round 12. Duration: 2.34s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 12, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.075936833082461, 'd_loss': 0.9336069186528523, 'post_fit_local_f1': 0.6864686468646864, 'fit_time_seconds': 2.3394007682800293, 'cpu_percent_fit': 7.18125, 'ram_mb_fit': 123.609375, 'accumulated_train_samples_this_round': 816}
2025-08-04 20:23:41,619 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:23:46,959 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:46,959 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:46,959 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:46,959 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:23:46,959 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:23:46,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:47,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:47,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:47,439 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:23:47,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:23:47,467 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:47,570 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:47,578 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:47,578 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:47,585 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:23:47,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:47,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:23:47,595 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:47,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:47,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:23:47,605 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:47,608 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,610 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:47,613 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:47,616 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:47,618 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:47,621 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,624 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:47,627 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:47,629 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:47,632 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:47,642 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:47,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:23:47,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:23:47,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:23:47,652 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:47,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:23:47,663 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:47,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:23:47,664 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:47,680 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:47,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:23:47,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:23:47,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:47,703 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:47,703 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:47,704 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:47,704 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:47,704 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:23:47,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:47,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:23:47,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:47,707 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:23:47,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:23:47,707 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:47,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:23:47,707 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:23:47,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:23:47,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:23:47,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:23:47,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:23:47,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:23:47,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:23:47,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:23:47,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:47,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:23:47,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:47,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:47,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:47,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:23:47,714 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:23:47,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:23:47,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:23:47,720 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:23:47,720 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:47,722 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:47,722 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:47,723 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:47,724 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:47,724 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:47,725 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:47,737 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3029, Threshold=0.2956, Accuracy=0.5300, F1=0.6766, Precision=0.8200, Recall=0.5758
2025-08-04 20:23:47,737 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5300, F1: 0.6766, Prec: 0.8200, Rec: 0.5758, Avg Anomaly Score: 0.3029
2025-08-04 20:23:59,051 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:59,051 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:59,051 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:59,051 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:23:59,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:23:59,052 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:59,368 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:59,368 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:59,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:23:59,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:23:59,499 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:59,603 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:59,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:59,611 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:59,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:23:59,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:59,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:23:59,647 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:59,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:59,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:23:59,656 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:59,659 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,662 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:59,664 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:59,667 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:59,669 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:59,672 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,674 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:59,677 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:59,679 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:59,681 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:59,691 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:59,691 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:23:59,697 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:23:59,697 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:23:59,701 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:59,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:23:59,711 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:59,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:23:59,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:59,727 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:59,733 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:23:59,740 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:23:59,740 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:59,740 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:59,740 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:59,741 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:59,741 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:59,741 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:23:59,741 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:59,742 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:23:59,742 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:59,743 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:23:59,743 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:23:59,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:59,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:23:59,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:59,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:59,745 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:59,745 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:23:59,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:23:59,745 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:23:59,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:23:59,746 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:23:59,746 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:23:59,751 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:23:59,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:23:59,752 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:23:59,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:23:59,752 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:23:59,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:23:59,752 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:59,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:23:59,753 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:59,753 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:59,754 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:59,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:23:59,754 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:23:59,754 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:23:59,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:23:59,760 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:23:59,760 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:59,762 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:59,762 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:59,764 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:59,764 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:59,764 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:59,765 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:59,777 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3051, Threshold=0.3024, Accuracy=0.5588, F1=0.6964, Precision=0.8440, Recall=0.5927
2025-08-04 20:23:59,778 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.5588, F1: 0.6964, Prec: 0.8440, Rec: 0.5927, Avg Anomaly Score: 0.3051
2025-08-04 20:24:11,075 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:11,075 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:11,075 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:11,075 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:24:11,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:24:11,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:11,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:11,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:11,478 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:24:11,517 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:24:11,518 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:11,620 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:11,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:11,627 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:11,633 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:24:11,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:11,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:24:11,642 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:11,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:11,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:24:11,654 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:11,657 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,660 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:11,662 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:11,665 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:11,668 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:11,671 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,673 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:11,677 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:11,678 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:11,681 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:11,691 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:11,692 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:24:11,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:24:11,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:24:11,703 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:11,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:24:11,713 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:11,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:24:11,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:11,730 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:11,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:24:11,740 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:24:11,740 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:11,740 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:11,740 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:11,741 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:11,741 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:11,741 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:24:11,741 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:11,742 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:24:11,742 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:11,743 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:24:11,743 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:24:11,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:24:11,745 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:24:11,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:24:11,745 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:24:11,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:24:11,748 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:24:11,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:24:11,748 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:24:11,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:24:11,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:24:11,749 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:24:11,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:11,749 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:24:11,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:11,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:11,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:11,750 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:24:11,750 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:24:11,751 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:24:11,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:24:11,754 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:24:11,754 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:11,755 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:11,756 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:11,757 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:11,757 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:11,757 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:11,758 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:11,772 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3229, Threshold=0.3240, Accuracy=0.6019, F1=0.7261, Precision=0.8800, Recall=0.6180
2025-08-04 20:24:11,773 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6019, F1: 0.7261, Prec: 0.8800, Rec: 0.6180, Avg Anomaly Score: 0.3229
2025-08-04 20:24:23,062 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:23,062 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:23,062 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:23,062 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:24:23,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:24:23,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:23,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:23,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:23,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:24:23,500 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:24:23,500 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:23,603 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:23,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:23,612 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:23,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:24:23,674 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:23,674 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:24:23,675 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:23,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:23,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:24:23,685 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:23,689 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,691 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:23,694 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:23,697 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:23,699 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:23,702 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,705 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:23,707 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:23,709 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:23,712 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:23,722 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:23,723 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:24:23,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:24:23,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:24:23,735 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:23,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:24:23,747 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:23,747 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:24:23,747 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:23,765 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:23,771 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:24:23,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:24:23,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:23,777 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:23,777 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:23,778 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:23,778 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:23,778 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:24:23,779 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:23,779 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:24:23,779 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:23,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:24:23,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:24:23,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:23,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:24:23,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:23,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:23,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:23,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:24:23,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:24:23,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:24:23,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:24:23,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:24:23,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:24:23,786 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:24:23,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:24:23,786 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:24:23,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:24:23,787 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:24:23,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:24:23,787 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:23,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:24:23,788 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:23,788 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:23,788 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:23,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:24:23,788 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:24:23,788 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:24:23,789 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:24:23,794 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:24:23,795 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:23,796 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:23,796 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:23,798 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:23,798 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:23,798 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:23,799 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:23,814 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3030, Threshold=0.3066, Accuracy=0.6595, F1=0.7657, Precision=0.9280, Recall=0.6517
2025-08-04 20:24:23,814 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6595, F1: 0.7657, Prec: 0.9280, Rec: 0.6517, Avg Anomaly Score: 0.3030
2025-08-04 20:24:35,097 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:35,098 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:35,098 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:35,098 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:24:35,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:24:35,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:35,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:35,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:35,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:24:35,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:24:35,532 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:35,629 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:35,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:35,636 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:35,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:24:35,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:35,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:24:35,653 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:35,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:35,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:24:35,662 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:35,665 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,668 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:35,670 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:35,673 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:35,676 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:35,678 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,681 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:35,684 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:35,686 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:35,690 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:35,704 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:35,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:24:35,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:24:35,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:24:35,720 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:35,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:24:35,733 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:35,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:24:35,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:35,752 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:35,758 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:24:35,768 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:24:35,768 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:35,768 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:35,768 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:35,768 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:35,769 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:35,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:24:35,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:35,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:24:35,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:35,771 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:24:35,772 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:24:35,772 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:35,772 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:24:35,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:35,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:35,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:35,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:24:35,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:24:35,774 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:24:35,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:24:35,774 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:24:35,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:24:35,779 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:24:35,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:24:35,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:24:35,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:24:35,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:24:35,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:24:35,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:35,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:24:35,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:35,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:35,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:35,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:24:35,783 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:24:35,783 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:24:35,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:24:35,786 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:24:35,786 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:35,788 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:35,788 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:35,789 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:35,790 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:35,790 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:35,790 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:35,803 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3013, Threshold=0.3052, Accuracy=0.6451, F1=0.7558, Precision=0.9160, Recall=0.6433
2025-08-04 20:24:35,803 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6451, F1: 0.7558, Prec: 0.9160, Rec: 0.6433, Avg Anomaly Score: 0.3013
2025-08-04 20:24:47,087 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:47,087 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:47,087 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:47,087 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:24:47,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:24:47,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:47,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:47,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:47,436 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:24:47,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:24:47,461 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:47,572 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:47,579 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:47,579 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:47,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:24:47,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:47,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:24:47,596 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:47,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:47,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:24:47,605 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:47,608 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:47,610 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:47,613 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:47,615 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:47,617 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:47,620 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:47,622 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:47,625 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:47,628 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:47,630 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:47,642 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:47,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:24:47,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:24:47,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:24:47,654 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:47,654 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:24:47,669 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:47,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:24:47,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:47,689 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:47,694 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:24:47,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:24:47,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:47,704 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:47,704 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:47,704 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:47,705 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:47,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:24:47,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:47,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:24:47,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:47,707 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:24:47,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:24:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:47,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:24:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:47,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:47,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:24:47,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:24:47,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:24:47,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:24:47,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:24:47,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:24:47,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:24:47,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:24:47,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:24:47,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:24:47,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:24:47,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:24:47,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:47,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:24:47,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:47,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:47,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:47,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:24:47,719 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:24:47,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:24:47,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:24:47,723 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:24:47,724 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:47,725 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:47,725 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:47,727 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:47,727 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:47,727 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:47,728 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:47,744 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3001, Threshold=0.3047, Accuracy=0.6499, F1=0.7591, Precision=0.9200, Recall=0.6461
2025-08-04 20:24:47,744 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6499, F1: 0.7591, Prec: 0.9200, Rec: 0.6461, Avg Anomaly Score: 0.3001
2025-08-04 20:24:59,019 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:59,019 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:59,019 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:59,019 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:24:59,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:24:59,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:59,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:59,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:59,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:24:59,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:24:59,425 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:59,525 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:59,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:59,534 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:59,543 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:24:59,552 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:59,552 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:24:59,553 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:59,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:59,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:24:59,563 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:59,566 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,569 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:59,571 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:59,574 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:59,577 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:59,580 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,582 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:59,585 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:59,587 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:59,589 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:59,605 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:59,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:24:59,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:24:59,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:24:59,616 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:59,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:24:59,626 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:59,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:24:59,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:59,643 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:59,649 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:24:59,656 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:24:59,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:59,657 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:59,657 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:59,657 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:59,658 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:59,658 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:24:59,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:59,658 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:24:59,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:59,660 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:24:59,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:24:59,660 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:59,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:24:59,660 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:24:59,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:24:59,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:24:59,665 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:24:59,665 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:24:59,665 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:24:59,666 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:24:59,666 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:24:59,666 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:24:59,666 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:59,666 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:24:59,667 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:59,667 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:59,667 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:59,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:24:59,667 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:24:59,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:24:59,668 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:24:59,673 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:24:59,673 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:59,675 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:59,675 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:59,677 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:59,677 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:59,677 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:59,678 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:59,690 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3076, Threshold=0.3145, Accuracy=0.6643, F1=0.7690, Precision=0.9320, Recall=0.6545
2025-08-04 20:24:59,691 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6643, F1: 0.7690, Prec: 0.9320, Rec: 0.6545, Avg Anomaly Score: 0.3076
2025-08-04 20:25:10,966 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:10,967 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:10,967 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:10,967 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:25:10,968 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:25:10,968 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:11,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:11,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:11,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:25:11,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:25:11,430 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:11,569 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:11,575 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:11,576 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:11,582 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:25:11,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:11,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:25:11,589 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:11,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:11,590 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:25:11,599 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:11,604 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,606 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:11,609 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:11,612 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:11,614 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:11,617 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,620 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:11,623 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:11,624 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:11,627 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:11,640 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:11,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:25:11,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:25:11,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:25:11,655 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:11,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:25:11,671 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:11,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:25:11,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:11,690 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:11,696 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:25:11,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:25:11,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:11,704 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:11,704 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:11,705 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:11,705 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:11,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:25:11,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:11,707 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:25:11,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:11,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:25:11,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:25:11,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:11,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:25:11,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:11,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:11,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:11,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:25:11,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:25:11,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:25:11,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:25:11,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:25:11,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:25:11,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:25:11,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:25:11,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:25:11,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:25:11,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:25:11,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:25:11,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:11,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:25:11,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:11,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:11,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:11,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:25:11,722 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:25:11,722 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:25:11,722 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:25:11,728 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:25:11,729 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:11,730 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:11,730 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:11,732 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:11,732 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:11,733 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:11,734 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:11,748 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3115, Threshold=0.3191, Accuracy=0.6643, F1=0.7690, Precision=0.9320, Recall=0.6545
2025-08-04 20:25:11,748 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6643, F1: 0.7690, Prec: 0.9320, Rec: 0.6545, Avg Anomaly Score: 0.3115
2025-08-04 20:25:23,016 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:23,017 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:23,017 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:23,017 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:25:23,017 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:25:23,018 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:23,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:23,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:23,416 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:25:23,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:25:23,458 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:23,567 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:23,576 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:23,576 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:23,584 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:25:23,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:23,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:25:23,594 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:23,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:23,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:25:23,605 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:23,609 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,612 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:23,614 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:23,617 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:23,619 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:23,625 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,628 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:23,631 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:23,633 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:23,635 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:23,646 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:23,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:25:23,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:25:23,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:25:23,657 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:23,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:25:23,670 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:23,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:25:23,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:23,687 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:23,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:25:23,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:25:23,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:23,701 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:23,701 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:23,701 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:23,702 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:23,702 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:25:23,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:23,702 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:25:23,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:23,704 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:25:23,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:25:23,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:23,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:25:23,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:23,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:23,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:23,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:25:23,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:25:23,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:25:23,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:25:23,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:25:23,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:25:23,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:25:23,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:25:23,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:25:23,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:25:23,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:25:23,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:25:23,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:23,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:25:23,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:23,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:23,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:23,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:25:23,712 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:25:23,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:25:23,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:25:23,717 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:25:23,718 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:23,719 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:23,719 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:23,721 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:23,721 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:23,721 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:23,722 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:23,736 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3239, Threshold=0.3321, Accuracy=0.6643, F1=0.7690, Precision=0.9320, Recall=0.6545
2025-08-04 20:25:23,737 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6643, F1: 0.7690, Prec: 0.9320, Rec: 0.6545, Avg Anomaly Score: 0.3239
2025-08-04 20:25:35,012 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:35,012 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:35,013 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:35,013 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:25:35,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:25:35,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:35,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:35,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:35,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:25:35,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:25:35,411 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:35,504 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:35,510 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:35,510 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:35,518 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:25:35,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:35,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:25:35,528 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:35,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:35,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:25:35,537 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:35,540 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,542 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:35,544 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:35,547 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:35,549 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:35,552 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,555 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:35,557 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:35,559 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:35,561 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:35,572 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:35,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:25:35,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:25:35,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:25:35,583 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:35,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:25:35,595 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:35,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:25:35,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:35,615 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:35,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:25:35,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:25:35,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:35,632 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:35,632 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:35,632 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:35,632 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:35,633 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:25:35,633 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:35,633 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:25:35,633 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:35,635 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:25:35,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:25:35,635 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:35,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:25:35,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:25:35,637 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:25:35,637 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:25:35,640 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:25:35,640 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:25:35,640 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:25:35,640 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:25:35,640 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:25:35,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:25:35,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:35,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:25:35,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:35,642 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:35,642 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:35,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:25:35,642 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:25:35,642 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:25:35,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:25:35,645 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:25:35,645 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:35,646 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:35,646 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:35,648 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:35,648 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:35,648 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:35,649 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:35,660 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3214, Threshold=0.3301, Accuracy=0.6691, F1=0.7723, Precision=0.9360, Recall=0.6573
2025-08-04 20:25:35,661 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6691, F1: 0.7723, Prec: 0.9360, Rec: 0.6573, Avg Anomaly Score: 0.3214
2025-08-04 20:25:40,918 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:40,918 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:40,918 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:40,918 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:25:40,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:25:40,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:41,194 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:41,194 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:41,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:25:41,306 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:25:41,306 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:41,391 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:41,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:41,396 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:41,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:25:41,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:41,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:25:41,410 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:41,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:41,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:25:41,419 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:41,422 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:41,424 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:41,427 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:41,429 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:41,431 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:41,434 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:41,436 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:41,439 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:41,441 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:41,443 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:41,452 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:41,452 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:25:41,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:25:41,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:25:41,461 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:41,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:25:41,469 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:41,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:25:41,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:41,485 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:41,490 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:25:41,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:25:41,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:41,495 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:41,495 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:41,495 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:41,496 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:41,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:25:41,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:41,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:25:41,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:41,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:25:41,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:25:41,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:41,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:25:41,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:25:41,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:25:41,500 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:25:41,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:25:41,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:25:41,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:25:41,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:25:41,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:25:41,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:25:41,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:41,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:25:41,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:41,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:41,504 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:41,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:25:41,504 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:25:41,504 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:25:41,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:25:41,507 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:25:41,507 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:41,509 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:41,509 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:41,510 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 22/400.
2025-08-04 20:25:41,611 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:41,611 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:41,612 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 352 anomalous samples to GAN training data (target: 352).
2025-08-04 20:25:41,613 - ClientAppLogger [Client 1] - INFO - [Client] Round 22: Training GAN with 1526 samples (1174 normal, 352 anomalous).
2025-08-04 20:25:41,613 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:42,752 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.9002
2025-08-04 20:25:42,753 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.9002
2025-08-04 20:25:42,754 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:42,774 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3227, Threshold=0.3336, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:25:42,775 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7789
2025-08-04 20:25:42,775 - ClientAppLogger [Client 1] - INFO - Fit completed for round 22. Duration: 1.26s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 22, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0839120755814315, 'd_loss': 0.9001616637719255, 'post_fit_local_f1': 0.7788778877887789, 'fit_time_seconds': 1.264514446258545, 'cpu_percent_fit': 12.4625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1526}
2025-08-04 20:25:42,775 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:25:48,057 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:48,059 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:48,059 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:48,059 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:25:48,059 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:25:48,060 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:48,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:48,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:48,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:25:48,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:25:48,610 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:48,749 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:48,761 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:48,762 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:48,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:25:48,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:48,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:25:48,787 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:48,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:48,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:25:48,798 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:48,801 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,803 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:48,806 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:48,809 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:48,812 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:48,815 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,818 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:48,822 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:48,824 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:48,827 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:48,841 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:48,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:25:48,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:25:48,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:25:48,853 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:48,853 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:25:48,870 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:48,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:25:48,871 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:48,891 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:48,898 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:25:48,906 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:25:48,907 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:48,907 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:48,907 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:25:48,908 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:48,910 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:25:48,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:25:48,911 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:48,911 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:25:48,911 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:48,911 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:48,912 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:48,912 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:25:48,912 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:25:48,913 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:25:48,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:25:48,913 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:25:48,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:25:48,919 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:25:48,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:25:48,920 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:25:48,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:25:48,920 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:25:48,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:25:48,921 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:48,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:25:48,922 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:48,922 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:48,922 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:48,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:25:48,923 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:25:48,924 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:25:48,924 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:25:48,929 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:25:48,929 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:48,930 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:48,930 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:48,932 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:48,932 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:48,932 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:48,933 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:48,947 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3251, Threshold=0.3343, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:25:48,947 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3251
2025-08-04 20:26:03,241 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,241 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:03,241 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:03,241 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:26:03,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:26:03,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:03,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:03,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:03,805 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:26:03,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:26:03,855 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:04,005 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:04,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:04,018 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:04,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:26:04,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:04,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:26:04,046 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:04,046 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:04,046 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:26:04,057 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:04,064 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,068 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:04,072 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:04,076 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:04,079 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:04,083 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:04,091 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:04,093 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:04,096 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:04,110 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:04,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:26:04,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:26:04,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:26:04,124 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:04,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:26:04,141 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:04,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:26:04,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:04,167 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:04,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:26:04,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:26:04,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,199 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,199 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,199 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,200 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,200 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:26:04,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,201 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:26:04,201 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,202 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:26:04,203 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,203 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,204 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:26:04,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:26:04,205 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:26:04,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:26:04,205 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:26:04,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:26:04,211 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:26:04,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:26:04,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:26:04,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:26:04,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:26:04,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:26:04,214 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:26:04,215 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,217 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:26:04,217 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:26:04,217 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:26:04,218 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:26:04,227 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:26:04,228 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,230 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,230 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:04,231 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,232 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,232 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,232 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,247 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3330, Threshold=0.3439, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:26:04,248 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3330
2025-08-04 20:26:15,531 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:15,531 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:15,531 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:15,532 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:26:15,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:26:15,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:16,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:16,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:16,155 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:26:16,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:26:16,197 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,362 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,372 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,372 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:26:16,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,395 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:26:16,407 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,410 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,412 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,415 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,417 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,420 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,422 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,426 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,428 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,430 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,433 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,446 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:26:16,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:26:16,459 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:26:16,479 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:26:16,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,496 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:26:16,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:26:16,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,511 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,512 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,512 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,512 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,513 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:26:16,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,514 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:26:16,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,515 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:26:16,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,516 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,517 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,517 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,517 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,517 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:26:16,518 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:26:16,518 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:26:16,518 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:26:16,518 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:26:16,519 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:26:16,523 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:26:16,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:26:16,524 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:26:16,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:26:16,524 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:26:16,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:26:16,525 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:26:16,526 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,526 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,526 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:26:16,527 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:26:16,527 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:26:16,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:26:16,533 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:26:16,533 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,535 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,535 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:16,536 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,536 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,536 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,537 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,551 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3243, Threshold=0.3343, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:26:16,552 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3243
2025-08-04 20:26:27,833 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:27,833 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:27,834 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:27,834 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:26:27,834 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:26:27,834 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:28,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:28,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:26:28,426 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:26:28,426 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,550 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,563 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,575 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:26:28,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,590 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,591 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:26:28,603 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,606 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,608 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,611 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,614 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,616 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,619 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,621 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,624 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,626 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,629 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,643 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:26:28,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:26:28,658 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:26:28,677 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:26:28,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,697 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:26:28,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:26:28,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,718 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,718 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:26:28,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:26:28,720 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:26:28,722 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,722 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,723 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:26:28,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:26:28,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:26:28,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:26:28,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:26:28,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:26:28,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:26:28,730 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:26:28,731 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:26:28,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:26:28,731 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:26:28,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:26:28,732 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:26:28,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:26:28,734 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:26:28,734 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:26:28,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:26:28,741 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:26:28,741 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,743 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,744 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:28,745 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,746 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,746 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:28,747 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,768 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3288, Threshold=0.3409, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:26:28,768 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3288
2025-08-04 20:26:40,062 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,063 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:40,063 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:40,063 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:26:40,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:26:40,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,659 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:26:40,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:26:40,701 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:40,829 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:40,839 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:40,840 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:40,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:26:40,853 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:40,853 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:26:40,854 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:40,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:40,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:26:40,864 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:40,869 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,871 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:40,874 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:40,877 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:40,879 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:40,881 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,884 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:40,887 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:40,889 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:40,892 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:40,908 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:40,908 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:26:40,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:26:40,914 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:26:40,923 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:40,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:26:40,939 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:40,940 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:26:40,940 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:40,960 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:40,968 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:26:40,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:26:40,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:40,987 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:40,987 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:40,987 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:40,988 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:40,988 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:26:40,988 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:40,989 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:26:40,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:40,991 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:26:40,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:26:40,991 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:40,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:26:40,992 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:26:40,993 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:26:40,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:26:40,999 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:26:40,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:26:40,999 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:26:40,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:26:41,000 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:26:41,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:26:41,000 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:41,001 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:26:41,001 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:41,002 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:41,002 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:41,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:26:41,002 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:26:41,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:26:41,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:26:41,009 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:26:41,009 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:41,012 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:41,012 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:41,013 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:41,014 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:41,014 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:41,015 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,030 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3328, Threshold=0.3457, Accuracy=0.6835, F1=0.7822, Precision=0.9480, Recall=0.6657
2025-08-04 20:26:41,030 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6835, F1: 0.7822, Prec: 0.9480, Rec: 0.6657, Avg Anomaly Score: 0.3328
2025-08-04 20:26:52,314 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,314 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:52,314 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:52,314 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:26:52,315 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:26:52,315 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:52,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:52,800 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:52,900 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:26:52,951 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:26:52,951 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,091 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,099 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,100 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:26:53,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,117 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:26:53,127 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,130 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,133 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,137 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,142 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,144 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,147 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,150 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,153 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,155 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,157 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,171 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:26:53,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:26:53,189 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:26:53,213 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:26:53,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,232 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:26:53,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:26:53,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,250 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,250 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,250 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,251 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,251 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:26:53,251 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,251 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:26:53,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,253 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:26:53,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,254 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:26:53,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:26:53,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:26:53,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:26:53,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:26:53,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:26:53,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:26:53,265 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:26:53,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:26:53,267 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,268 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,268 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:26:53,268 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:26:53,269 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:26:53,269 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:26:53,277 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:26:53,278 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,279 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,280 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:53,281 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,281 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,281 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,282 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,299 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3352, Threshold=0.3477, Accuracy=0.6835, F1=0.7822, Precision=0.9480, Recall=0.6657
2025-08-04 20:26:53,300 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6835, F1: 0.7822, Prec: 0.9480, Rec: 0.6657, Avg Anomaly Score: 0.3352
2025-08-04 20:27:04,577 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,577 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:04,578 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:04,578 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:27:04,578 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:27:04,578 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:04,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:04,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:04,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:27:04,994 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:27:04,994 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,131 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,147 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:27:05,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,175 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,175 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:27:05,187 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,190 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,193 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,196 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,199 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,201 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,205 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,208 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,211 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,213 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,215 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,228 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,228 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:27:05,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:27:05,243 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:27:05,260 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:27:05,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,278 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:27:05,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:27:05,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,297 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,297 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,298 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,298 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,299 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:27:05,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,299 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:27:05,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:27:05,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:27:05,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:27:05,303 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:27:05,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:27:05,303 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:27:05,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:27:05,310 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:27:05,310 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:27:05,310 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:27:05,310 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:27:05,311 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:27:05,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:27:05,311 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:27:05,312 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,313 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,313 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:27:05,313 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:27:05,314 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:27:05,314 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:27:05,318 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:27:05,318 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,320 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,320 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:05,322 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,322 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,322 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,323 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,337 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3315, Threshold=0.3420, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:27:05,337 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3315
2025-08-04 20:27:16,602 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:16,602 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:16,602 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:16,603 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:27:16,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:27:16,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:16,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:16,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:16,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:27:17,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:27:17,000 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,130 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,139 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:27:17,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,231 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:27:17,242 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,246 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,248 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:17,251 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:17,256 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:17,263 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:17,267 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,271 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:17,274 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:17,277 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:17,280 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:17,297 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:17,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:27:17,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:27:17,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:27:17,311 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:17,312 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:27:17,333 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:17,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:27:17,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:17,353 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:17,359 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:27:17,370 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:27:17,370 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:17,371 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:17,371 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:17,372 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:17,372 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:17,372 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:27:17,372 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:17,372 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:27:17,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:17,374 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:27:17,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:27:17,375 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:17,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:27:17,375 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:17,376 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:17,376 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:17,376 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:27:17,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:27:17,376 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:27:17,377 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:27:17,377 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:27:17,377 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:27:17,384 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:27:17,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:27:17,384 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:27:17,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:27:17,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:27:17,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:27:17,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:17,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:27:17,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:17,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:17,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:17,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:27:17,388 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:27:17,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:27:17,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:27:17,398 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:27:17,398 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:17,400 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:17,400 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:17,402 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:17,402 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:17,402 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:17,403 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:17,415 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3343, Threshold=0.3449, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:27:17,415 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3343
2025-08-04 20:27:34,679 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:34,680 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:34,680 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:34,680 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:27:34,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:27:34,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:34,933 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:34,933 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:35,017 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:27:35,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:27:35,055 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:35,167 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:35,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:35,174 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:35,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:27:35,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:35,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:27:35,187 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:35,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:35,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:27:35,197 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:35,200 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,202 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:35,205 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:35,207 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:35,210 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:35,212 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,215 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:35,218 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:35,220 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:35,222 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:35,235 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:35,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:27:35,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:27:35,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:27:35,246 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:35,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:27:35,260 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:35,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:27:35,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:35,277 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:35,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:27:35,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:27:35,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:35,291 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:35,291 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:35,291 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:35,292 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:35,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:27:35,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:35,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:27:35,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:35,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:27:35,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:27:35,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:27:35,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:27:35,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:27:35,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:27:35,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:27:35,300 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:27:35,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:27:35,300 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:27:35,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:27:35,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:27:35,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:27:35,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:35,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:27:35,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:35,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:35,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:35,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:27:35,303 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:27:35,303 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:27:35,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:27:35,309 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:27:35,309 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:35,310 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:35,310 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:35,312 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:35,312 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:35,312 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:35,313 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:35,326 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3353, Threshold=0.3472, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:27:35,326 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3353
2025-08-04 20:27:46,610 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:46,610 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:46,610 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:46,610 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:27:46,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:27:46,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:46,830 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:46,830 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:46,912 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:27:46,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:27:46,944 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:47,032 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:47,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:47,038 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:47,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:27:47,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:47,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:27:47,054 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:47,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:47,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:27:47,066 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:47,069 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,071 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:47,073 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:47,076 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:47,079 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:47,081 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:47,084 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:47,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:47,089 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:47,091 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:47,105 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:47,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:27:47,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:27:47,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:27:47,115 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:47,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:27:47,125 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:47,125 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:27:47,125 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:47,142 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:47,148 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:27:47,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:27:47,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:47,156 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:47,156 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:47,156 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:47,157 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:47,157 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:27:47,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:47,157 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:27:47,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:47,159 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:27:47,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:27:47,159 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:47,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:27:47,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:47,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:47,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:47,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:27:47,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:27:47,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:27:47,161 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:27:47,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:27:47,161 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:27:47,165 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:27:47,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:27:47,165 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:27:47,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:27:47,165 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:27:47,166 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:27:47,166 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:47,166 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:27:47,166 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:47,167 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:47,167 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:47,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:27:47,167 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:27:47,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:27:47,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:27:47,171 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:27:47,171 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:47,172 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:47,173 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:47,174 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:47,174 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:47,174 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:47,175 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:47,187 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3396, Threshold=0.3528, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:27:47,187 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3396
2025-08-04 20:28:01,455 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:01,455 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:01,455 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:01,455 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:28:01,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:28:01,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:01,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:01,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:01,743 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:28:01,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:28:01,764 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:01,860 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:01,866 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:01,866 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:01,871 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:28:01,876 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:01,876 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:28:01,877 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:01,877 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:01,877 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:28:01,885 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:01,887 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:01,889 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:01,892 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:01,894 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:01,897 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:01,899 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:01,902 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:01,905 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:01,907 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:01,909 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:01,919 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:01,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:28:01,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:28:01,924 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:28:01,929 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:01,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:28:01,938 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:01,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:28:01,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:01,954 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:01,959 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:28:01,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:28:01,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:01,965 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:01,965 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:01,966 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:01,966 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:01,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:28:01,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:01,967 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:28:01,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:01,968 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:28:01,968 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:28:01,969 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:28:01,970 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:28:01,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:28:01,970 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:28:01,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:28:01,972 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:01,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:28:01,974 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:01,974 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:01,974 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:01,975 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:28:01,975 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:28:01,975 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:28:01,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:28:01,980 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:28:01,981 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:01,982 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:01,983 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:01,985 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:01,985 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:01,985 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:01,986 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:01,998 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3421, Threshold=0.3548, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:28:01,999 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3421
2025-08-04 20:28:16,274 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:16,274 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:16,274 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:16,274 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:28:16,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:28:16,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:16,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:16,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:16,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:28:16,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:28:16,650 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:16,745 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:16,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:16,752 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:16,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:28:16,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:16,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:28:16,792 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:16,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:16,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:28:16,801 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:16,804 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:16,806 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:16,809 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:16,811 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:16,813 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:16,816 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:16,818 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:16,821 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:16,823 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:16,826 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:16,835 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:16,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:28:16,840 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:28:16,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:28:16,846 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:16,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:28:16,856 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:16,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:28:16,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:16,872 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:16,877 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:28:16,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:28:16,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:16,882 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:16,882 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:16,883 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:16,883 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:16,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:28:16,883 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:16,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:28:16,884 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:16,885 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:28:16,885 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:28:16,885 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:28:16,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:28:16,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:28:16,887 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:28:16,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:28:16,889 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:28:16,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:28:16,889 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:28:16,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:28:16,890 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:28:16,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:28:16,890 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:16,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:28:16,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:16,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:16,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:16,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:28:16,892 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:28:16,892 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:28:16,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:28:16,897 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:28:16,897 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:16,899 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:16,899 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:16,901 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:16,901 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:16,901 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:16,902 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:16,914 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3406, Threshold=0.3528, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:28:16,914 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3406
2025-08-04 20:28:28,187 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:28,188 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:28,188 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:28,188 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:28:28,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:28:28,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:28,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:28,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:28,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:28:28,519 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:28:28,520 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:28,603 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:28,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:28,608 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:28,613 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:28:28,618 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:28,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:28:28,619 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:28,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:28,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:28:28,628 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:28,631 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:28,633 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:28,635 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:28,638 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:28,640 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:28,642 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:28,645 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:28,648 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:28,650 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:28,653 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:28,662 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:28,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:28:28,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:28:28,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:28:28,673 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:28,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:28:28,683 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:28,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:28:28,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:28,700 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:28,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:28:28,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:28:28,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:28,710 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:28,711 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:28,711 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:28,711 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:28,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:28:28,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:28,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:28:28,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:28,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:28:28,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:28:28,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:28:28,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:28:28,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:28:28,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:28:28,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:28:28,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:28:28,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:28:28,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:28:28,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:28:28,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:28:28,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:28:28,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:28,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:28:28,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:28,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:28,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:28,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:28:28,719 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:28:28,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:28:28,720 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:28:28,723 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:28:28,724 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:28,725 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:28,725 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:28,726 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:28,726 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:28,727 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:28,727 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:28,738 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3432, Threshold=0.3560, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:28:28,739 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3432
2025-08-04 20:28:43,020 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:43,020 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:43,021 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:43,021 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:28:43,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:28:43,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:43,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:43,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:43,345 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:28:43,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:28:43,376 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:43,463 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:43,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:43,469 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:43,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:28:43,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:43,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:28:43,483 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:43,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:43,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:28:43,492 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:43,495 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:43,497 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:43,499 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:43,502 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:43,504 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:43,506 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:43,509 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:43,511 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:43,513 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:43,515 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:43,524 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:43,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:28:43,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:28:43,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:28:43,533 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:43,533 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:28:43,541 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:43,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:28:43,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:43,556 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:43,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:28:43,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:28:43,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:43,565 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:43,566 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:43,566 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:43,566 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:43,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:28:43,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:43,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:28:43,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:43,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:28:43,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:28:43,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:28:43,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:28:43,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:28:43,570 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:28:43,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:28:43,572 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:28:43,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:28:43,573 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:28:43,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:28:43,573 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:28:43,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:28:43,573 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:43,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:28:43,574 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:43,574 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:43,574 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:43,574 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:28:43,574 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:28:43,575 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:28:43,575 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:28:43,577 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:28:43,577 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:43,579 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:43,579 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:43,580 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:43,580 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:43,580 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:43,581 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:43,591 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3395, Threshold=0.3526, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:28:43,592 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3395
2025-08-04 20:28:54,865 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:54,865 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:54,865 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:54,865 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:28:54,866 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:28:54,866 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:55,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:55,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:55,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:28:55,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:28:55,249 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:55,336 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:55,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:55,341 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:55,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:28:55,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:55,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:28:55,352 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:55,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:55,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:28:55,360 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:55,363 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:55,365 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:55,367 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:55,370 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:55,372 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:55,374 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:55,377 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:55,379 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:55,381 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:55,383 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:55,392 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:55,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:28:55,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:28:55,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:28:55,401 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:55,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:28:55,410 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:55,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:28:55,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:55,424 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:55,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:28:55,434 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:28:55,434 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:55,434 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:55,434 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:55,434 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:55,435 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:55,435 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:28:55,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:55,435 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:28:55,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:55,437 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:55,438 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:28:55,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:28:55,438 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:28:55,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:28:55,438 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:28:55,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:28:55,440 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:28:55,440 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:28:55,440 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:28:55,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:28:55,441 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:28:55,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:28:55,441 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:55,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:28:55,442 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:55,442 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:55,442 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:55,442 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:28:55,442 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:28:55,442 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:28:55,443 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:28:55,446 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:28:55,446 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:55,447 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:55,447 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:55,448 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:55,449 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:55,449 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:55,449 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:55,460 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3438, Threshold=0.3570, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:28:55,460 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3438
2025-08-04 20:29:12,783 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:12,784 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:12,784 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:12,784 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:29:12,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:29:12,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:13,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:13,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:13,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:29:13,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:29:13,199 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:13,285 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:13,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:13,290 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:13,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:29:13,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:13,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:29:13,300 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:13,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:13,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:29:13,309 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:13,311 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:13,314 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:13,316 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:13,319 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:13,321 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:13,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:13,326 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:13,328 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:13,331 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:13,333 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:13,341 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:13,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:29:13,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:29:13,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:29:13,351 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:13,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:29:13,359 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:13,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:29:13,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:13,374 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:13,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:29:13,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:29:13,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:13,386 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:13,386 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:13,386 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:13,386 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:13,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:29:13,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:13,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:29:13,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:13,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:29:13,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:29:13,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:13,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:29:13,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:13,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:13,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:13,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:29:13,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:29:13,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:29:13,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:29:13,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:29:13,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:29:13,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:29:13,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:29:13,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:29:13,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:29:13,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:29:13,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:29:13,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:13,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:29:13,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:13,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:13,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:13,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:29:13,395 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:29:13,395 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:29:13,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:29:13,400 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:29:13,400 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:13,402 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:13,402 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:13,404 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:13,404 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:13,404 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:13,405 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:13,416 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3407, Threshold=0.3548, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:29:13,416 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3407
2025-08-04 20:29:24,703 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:24,703 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:24,703 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:24,703 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:29:24,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:29:24,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:25,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:25,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:25,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:29:25,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:29:25,119 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:25,215 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:25,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:25,222 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:25,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:29:25,233 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:25,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:29:25,234 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:25,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:25,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:29:25,243 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:25,246 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:25,249 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:25,251 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:25,254 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:25,256 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:25,258 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:25,261 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:25,263 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:25,265 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:25,267 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:25,280 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:25,280 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:29:25,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:29:25,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:29:25,291 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:25,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:29:25,305 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:25,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:29:25,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:25,321 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:25,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:29:25,331 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:29:25,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:25,332 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:25,332 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:25,332 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:25,333 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:25,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:29:25,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:25,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:29:25,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:25,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:29:25,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:29:25,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:25,336 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:29:25,336 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:25,336 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:25,336 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:25,336 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:29:25,336 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:29:25,337 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:29:25,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:29:25,337 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:29:25,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:29:25,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:29:25,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:29:25,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:29:25,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:29:25,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:29:25,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:29:25,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:25,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:29:25,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:25,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:25,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:25,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:29:25,344 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:29:25,344 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:29:25,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:29:25,347 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:29:25,348 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:25,349 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:25,350 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:25,351 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:25,351 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:25,351 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:25,352 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:25,364 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3372, Threshold=0.3519, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:29:25,364 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3372
2025-08-04 20:29:36,643 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:36,643 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:36,643 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:36,644 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:29:36,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:29:36,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:36,907 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:36,907 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:36,996 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:29:37,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:29:37,030 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:37,129 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:37,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:37,134 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:37,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:29:37,147 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:37,148 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:29:37,148 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:37,148 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:37,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:29:37,157 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:37,160 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:37,162 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:37,165 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:37,168 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:37,170 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:37,172 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:37,175 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:37,178 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:37,180 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:37,182 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:37,191 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:37,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:29:37,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:29:37,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:29:37,201 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:37,201 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:29:37,210 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:37,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:29:37,211 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:37,226 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:37,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:29:37,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:29:37,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:37,238 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:37,238 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:37,239 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:37,239 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:37,239 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:29:37,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:37,240 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:29:37,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:37,241 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:29:37,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:29:37,242 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:37,242 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:29:37,242 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:37,242 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:37,242 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:37,242 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:29:37,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:29:37,243 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:29:37,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:29:37,243 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:29:37,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:29:37,246 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:29:37,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:29:37,246 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:29:37,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:29:37,247 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:29:37,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:29:37,247 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:37,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:29:37,248 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:37,248 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:37,248 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:37,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:29:37,249 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:29:37,249 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:29:37,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:29:37,252 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:29:37,252 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:37,254 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:37,254 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:37,256 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:37,256 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:37,256 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:37,257 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:37,268 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3400, Threshold=0.3538, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:29:37,268 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3400
2025-08-04 20:29:51,544 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:51,545 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:51,545 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:51,545 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:29:51,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:29:51,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:51,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:51,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:51,876 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:29:51,898 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:29:51,898 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:51,991 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:51,996 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:51,996 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:52,001 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:29:52,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:52,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:29:52,007 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:52,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:52,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:29:52,015 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:52,017 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:52,019 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:52,022 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:52,024 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:52,027 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:52,029 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:52,032 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:52,034 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:52,036 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:52,039 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:52,048 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:52,048 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:29:52,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:29:52,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:29:52,057 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:52,058 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:29:52,066 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:52,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:29:52,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:52,080 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:52,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:29:52,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:29:52,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:52,089 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:52,090 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:52,090 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:52,090 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:52,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:29:52,090 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:52,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:29:52,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:52,092 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:29:52,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:29:52,092 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:52,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:29:52,093 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:29:52,094 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:29:52,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:29:52,096 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:29:52,096 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:29:52,096 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:29:52,096 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:29:52,097 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:29:52,097 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:29:52,097 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:52,097 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:29:52,098 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:52,098 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:52,098 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:52,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:29:52,099 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:29:52,099 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:29:52,099 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:29:52,102 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:29:52,103 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:52,104 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:52,104 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:52,105 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:52,105 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:52,105 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:52,106 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:52,117 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3469, Threshold=0.3615, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:29:52,118 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3469
