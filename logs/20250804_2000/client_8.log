2025-08-04 20:21:12,237 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:12,237 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:12,239 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:12,240 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:21:12,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:21:12,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:13,253 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:13,254 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:13,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:21:13,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:21:13,403 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:13,614 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:13,622 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:13,623 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:13,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:21:13,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:13,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:21:13,654 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:13,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:13,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:21:13,669 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:13,674 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,677 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:13,680 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:13,684 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:13,686 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:13,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:13,694 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:13,698 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:13,702 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:13,705 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:13,720 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:13,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:21:13,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:21:13,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:21:13,738 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:13,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:21:13,763 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:13,764 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:21:13,764 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:13,790 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:13,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:21:13,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:21:13,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:13,822 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:13,822 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:13,823 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:13,824 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:13,824 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:21:13,825 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:13,825 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:21:13,825 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:13,827 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:21:13,827 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:21:13,828 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:13,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:21:13,829 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:13,830 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:13,830 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:13,831 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:21:13,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:21:13,832 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:21:13,832 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:21:13,832 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:21:13,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:21:13,833 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:21:13,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:21:13,834 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:21:13,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:21:13,835 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:21:13,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:21:13,836 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:13,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:21:13,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:13,839 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:13,840 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:13,843 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:21:13,843 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:21:13,845 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:21:13,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:21:13,847 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:21:13,848 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:13,850 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:13,851 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:13,853 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:13,854 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:13,854 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:13,855 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:13,919 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5016, Threshold=0.5012, Accuracy=0.5360, F1=0.6803, Precision=0.8223, Recall=0.5802
2025-08-04 20:21:13,922 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5360, F1: 0.6803, Prec: 0.8223, Rec: 0.5802, Avg Anomaly Score: 0.5016
2025-08-04 20:21:28,285 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:28,285 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:28,285 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:28,286 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:21:28,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:21:28,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:29,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:29,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:29,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:21:29,509 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:21:29,509 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:29,638 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:29,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:29,646 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:29,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:21:29,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:29,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:21:29,686 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:29,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:29,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:21:29,697 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:29,700 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,703 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:29,705 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:29,708 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:29,711 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:29,714 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:29,717 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:29,720 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:29,722 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:29,724 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:29,739 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:29,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:21:29,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:21:29,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:21:29,767 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:29,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:21:29,798 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:29,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:21:29,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:29,827 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:29,834 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:21:29,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:21:29,852 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:29,853 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:29,853 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:29,854 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:29,854 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:29,855 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:21:29,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:29,856 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:21:29,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:29,858 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:21:29,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:21:29,859 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:29,860 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:21:29,860 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:29,860 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:29,860 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:29,860 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:21:29,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:21:29,861 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:21:29,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:21:29,862 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:21:29,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:21:29,863 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:21:29,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:21:29,863 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:21:29,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:21:29,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:21:29,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:21:29,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:29,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:21:29,866 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:29,866 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:29,867 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:29,870 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:21:29,870 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:21:29,870 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:21:29,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:21:29,880 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:21:29,880 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:29,884 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:29,887 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:29,890 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:29,891 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:29,891 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:29,893 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:29,915 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5016, Threshold=0.5012, Accuracy=0.5360, F1=0.6803, Precision=0.8223, Recall=0.5802
2025-08-04 20:21:29,915 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5360, F1: 0.6803, Prec: 0.8223, Rec: 0.5802, Avg Anomaly Score: 0.5016
2025-08-04 20:21:35,177 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:35,177 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:35,177 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:35,177 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:21:35,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:21:35,177 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:35,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:35,378 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:35,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:21:35,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:21:35,472 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:35,564 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:35,568 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:35,569 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:35,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:21:35,582 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:35,582 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:21:35,583 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:35,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:35,583 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:21:35,592 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:35,594 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:35,597 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:35,599 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:35,602 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:35,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:35,606 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:35,609 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:35,612 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:35,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:35,616 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:35,626 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:35,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:21:35,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:21:35,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:21:35,637 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:35,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:21:35,648 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:35,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:21:35,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:35,663 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:35,668 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:21:35,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:21:35,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:35,675 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:35,675 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:35,676 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:35,676 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:35,676 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:21:35,676 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:35,676 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:21:35,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:35,678 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:21:35,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:21:35,678 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:35,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:21:35,678 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:21:35,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:21:35,680 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:21:35,680 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:21:35,680 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:21:35,680 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:21:35,681 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:21:35,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:21:35,681 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:35,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:21:35,681 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:35,681 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:35,682 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:35,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:21:35,685 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:21:35,685 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:21:35,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:21:35,688 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:21:35,688 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:35,690 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:35,690 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:35,691 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 3/400.
2025-08-04 20:21:35,793 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:35,793 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:35,794 - ClientAppLogger [Client 8] - INFO - [Client] Round 3: No training samples to include (0 calculated). Skipping GAN training logic.
2025-08-04 20:21:35,795 - ClientAppLogger [Client 8] - INFO - Fit completed for round 3. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 3, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10292792320251465, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:21:35,795 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:21:41,048 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,048 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:41,048 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:41,049 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:21:41,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:21:41,049 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:41,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:41,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:41,381 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:21:41,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:21:41,394 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:41,527 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:41,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:41,539 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:41,547 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:21:41,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:41,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:21:41,587 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:41,588 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:41,588 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:21:41,598 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:41,602 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:41,604 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:41,607 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:41,609 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:41,612 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:41,614 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:41,617 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:41,620 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:41,623 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:41,625 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:41,636 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:41,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:21:41,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:21:41,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:21:41,648 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:41,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:21:41,663 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:41,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:21:41,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:41,697 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:41,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:21:41,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:21:41,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:41,728 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:41,728 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:41,729 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:41,729 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:41,730 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:21:41,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:41,730 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:21:41,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:41,732 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:21:41,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:21:41,733 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:41,733 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:21:41,733 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:41,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:41,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:41,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:21:41,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:21:41,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:21:41,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:21:41,735 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:21:41,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:21:41,735 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:21:41,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:21:41,736 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:21:41,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:21:41,737 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:21:41,737 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:21:41,737 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:41,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:21:41,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:41,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:41,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:41,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:21:41,742 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:21:41,742 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:21:41,743 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:21:41,750 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:21:41,750 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:41,752 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:41,752 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:41,754 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:41,755 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:41,755 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:41,756 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:41,773 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5076, Accuracy=0.5409, F1=0.6838, Precision=0.8264, Recall=0.5831
2025-08-04 20:21:41,774 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5409, F1: 0.6838, Prec: 0.8264, Rec: 0.5831, Avg Anomaly Score: 0.5078
2025-08-04 20:21:47,024 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:47,024 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:47,024 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:47,025 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:21:47,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:21:47,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:47,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:47,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:47,310 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:21:47,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:21:47,324 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:47,413 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:47,417 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:47,417 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:47,422 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:21:47,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:47,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:21:47,429 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:47,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:47,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:21:47,438 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:47,441 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:47,443 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:47,446 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:47,448 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:47,451 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:47,454 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:47,457 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:47,459 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:47,461 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:47,463 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:47,473 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:47,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:21:47,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:21:47,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:21:47,483 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:47,483 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:21:47,492 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:47,492 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:21:47,492 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:47,508 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:47,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:21:47,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:21:47,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:47,518 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:47,518 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:47,518 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:47,518 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:47,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:21:47,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:47,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:21:47,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:47,520 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:21:47,520 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:21:47,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:21:47,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:21:47,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:21:47,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:21:47,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:21:47,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:47,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:21:47,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:47,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:47,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:47,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:21:47,528 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:21:47,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:21:47,528 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:21:47,530 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:21:47,530 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:47,531 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:47,531 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:47,533 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 4/400.
2025-08-04 20:21:47,634 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:47,634 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:47,635 - ClientAppLogger [Client 8] - INFO - [Client] Round 4: No NORMAL samples found in the 1 cumulative samples. Skipping GAN training logic.
2025-08-04 20:21:47,635 - ClientAppLogger [Client 8] - INFO - Fit completed for round 4. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 4, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10234618186950684, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.46484375, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:21:47,635 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:21:52,881 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:52,882 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:52,882 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:52,882 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:21:52,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:21:52,882 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:53,097 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:53,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:53,180 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:21:53,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:21:53,194 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:53,280 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:53,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:53,284 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:53,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:21:53,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:53,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:21:53,296 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:53,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:53,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:21:53,305 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:53,308 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:53,310 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:53,313 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:53,315 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:53,318 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:53,320 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:53,323 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:53,325 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:53,327 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:53,329 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:53,338 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:53,339 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:21:53,343 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:21:53,343 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:21:53,348 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:53,348 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:21:53,357 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:53,357 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:21:53,357 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:53,374 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:53,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:21:53,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:21:53,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:53,384 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:53,384 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:53,385 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:53,385 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:53,385 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:21:53,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:53,386 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:21:53,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:53,387 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:21:53,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:21:53,388 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:53,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:21:53,388 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:53,388 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:53,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:53,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:21:53,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:21:53,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:21:53,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:21:53,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:21:53,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:21:53,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:21:53,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:21:53,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:21:53,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:21:53,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:21:53,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:21:53,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:53,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:21:53,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:53,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:53,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:53,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:21:53,396 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:21:53,396 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:21:53,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:21:53,398 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:21:53,398 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:53,400 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:53,400 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:53,401 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:53,402 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:53,402 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:53,402 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:53,414 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5084, Threshold=0.5079, Accuracy=0.5112, F1=0.6632, Precision=0.8017, Recall=0.5656
2025-08-04 20:21:53,414 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5112, F1: 0.6632, Prec: 0.8017, Rec: 0.5656, Avg Anomaly Score: 0.5084
2025-08-04 20:22:01,669 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:01,670 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:01,670 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:01,670 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:01,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:01,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:01,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:01,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:01,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:01,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:01,968 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:02,049 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:02,053 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:02,053 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:02,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:02,063 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:02,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:02,064 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:02,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:02,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:02,072 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:02,075 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:02,077 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:02,079 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:02,082 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:02,084 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:02,086 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:02,089 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:02,091 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:02,093 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:02,095 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:02,105 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:02,105 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:02,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:02,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:02,114 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:02,114 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:02,122 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:02,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:02,123 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:02,138 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:02,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:02,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:02,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:02,147 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:02,147 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:02,148 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:02,148 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:02,148 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:02,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:02,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:02,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:02,150 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:02,150 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:02,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:02,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:02,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:02,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:02,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:02,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:02,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:02,154 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:02,154 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:02,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:02,158 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:02,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:02,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:02,159 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:02,160 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:02,161 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:02,161 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:02,163 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 5/400.
2025-08-04 20:22:02,264 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:02,264 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:02,264 - ClientAppLogger [Client 8] - INFO - [Client] Round 5: No NORMAL samples found in the 1 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:02,265 - ClientAppLogger [Client 8] - INFO - Fit completed for round 5. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 5, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10194277763366699, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:02,265 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:22:07,519 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:07,519 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:07,519 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:07,519 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:07,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:07,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:07,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:07,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:07,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:07,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:07,822 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:07,899 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:07,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:07,903 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:07,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:07,914 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:07,914 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:07,915 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:07,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:07,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:07,923 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:07,926 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:07,929 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:07,931 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:07,934 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:07,936 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:07,938 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:07,941 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:07,943 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:07,945 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:07,947 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:07,956 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:07,956 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:07,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:07,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:07,965 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:07,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:07,973 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:07,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:07,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:07,987 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:07,992 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:07,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:07,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:07,996 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:07,996 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:07,996 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:07,997 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:07,997 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:07,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:07,997 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:07,997 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:07,999 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:07,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:07,999 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:07,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:08,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:08,001 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:08,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:08,001 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:08,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:08,001 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:08,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:08,002 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:08,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:08,002 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:08,002 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:08,002 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:08,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:08,006 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:08,006 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:08,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:08,008 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:08,008 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:08,009 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:08,009 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:08,010 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:08,010 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:08,011 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:08,011 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:08,022 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5084, Threshold=0.5075, Accuracy=0.4963, F1=0.6530, Precision=0.7893, Recall=0.5569
2025-08-04 20:22:08,022 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4963, F1: 0.6530, Prec: 0.7893, Rec: 0.5569, Avg Anomaly Score: 0.5084
2025-08-04 20:22:16,291 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:16,291 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:16,291 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:16,291 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:16,291 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:16,292 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:16,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:16,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:16,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:16,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:16,586 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:16,668 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:16,673 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:16,673 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:16,677 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:16,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:16,684 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:16,684 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:16,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:16,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:16,693 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:16,695 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:16,697 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:16,700 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:16,702 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:16,704 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:16,707 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:16,709 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:16,712 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:16,715 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:16,717 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:16,726 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:16,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:16,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:16,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:16,736 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:16,736 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:16,743 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:16,744 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:16,744 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:16,758 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:16,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:16,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:16,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:16,768 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:16,768 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:16,768 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:16,768 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:16,768 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:16,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:16,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:16,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:16,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:16,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:16,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:16,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:16,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:16,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:16,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:16,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:16,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:16,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:16,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:16,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:16,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:16,778 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:16,778 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:16,778 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:16,780 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:16,780 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:16,781 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:16,781 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:16,783 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 6/400.
2025-08-04 20:22:16,884 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:16,884 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:16,884 - ClientAppLogger [Client 8] - INFO - [Client] Round 6: No NORMAL samples found in the 1 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:16,885 - ClientAppLogger [Client 8] - INFO - Fit completed for round 6. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 6, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10206341743469238, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:16,885 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:22:22,156 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:22,156 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:22,156 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:22,156 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:22,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:22,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:22,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:22,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:22,497 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:22,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:22,511 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:22,612 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:22,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:22,617 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:22,621 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:22,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:22,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:22,629 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:22,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:22,629 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:22,637 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:22,640 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:22,643 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:22,645 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:22,648 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:22,650 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:22,653 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:22,655 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:22,658 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:22,660 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:22,663 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:22,674 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:22,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:22,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:22,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:22,686 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:22,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:22,701 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:22,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:22,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:22,718 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:22,724 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:22,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:22,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:22,733 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:22,733 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:22,734 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:22,734 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:22,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:22,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:22,735 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:22,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:22,737 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:22,737 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:22,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:22,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:22,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:22,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:22,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:22,739 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:22,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:22,740 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:22,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:22,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:22,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:22,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:22,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:22,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:22,741 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:22,742 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:22,745 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:22,746 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:22,746 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:22,746 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:22,748 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:22,748 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:22,750 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:22,750 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:22,751 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:22,751 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:22,752 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:22,752 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:22,765 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5052, Threshold=0.5037, Accuracy=0.4864, F1=0.6462, Precision=0.7810, Recall=0.5510
2025-08-04 20:22:22,765 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4864, F1: 0.6462, Prec: 0.7810, Rec: 0.5510, Avg Anomaly Score: 0.5052
2025-08-04 20:22:34,041 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:34,041 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:34,041 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:34,041 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:34,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:34,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:34,312 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:34,313 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:34,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:34,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:34,415 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:34,514 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:34,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:34,524 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:34,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:34,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:34,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:34,540 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:34,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:34,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:34,548 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:34,551 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:34,553 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:34,555 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:34,558 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:34,561 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:34,564 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:34,567 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:34,570 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:34,572 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:34,574 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:34,584 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:34,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:34,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:34,590 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:34,594 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:34,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:34,603 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:34,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:34,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:34,623 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:34,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:34,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:34,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:34,634 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:34,634 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:34,635 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:34,635 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:34,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:34,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:34,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:34,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:34,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:34,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:34,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:34,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:34,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:34,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:34,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:34,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:34,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:34,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:34,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:34,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:34,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:34,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:34,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:34,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:34,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:34,644 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:34,645 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:34,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:34,647 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:34,647 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:34,648 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:34,649 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:34,650 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 7/400.
2025-08-04 20:22:34,751 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:34,752 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:34,753 - ClientAppLogger [Client 8] - INFO - [Client] Round 7: No NORMAL samples found in the 1 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:34,753 - ClientAppLogger [Client 8] - INFO - Fit completed for round 7. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 7, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10260701179504395, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:34,753 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:22:40,070 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:40,070 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:40,070 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:40,071 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:40,071 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:40,071 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:40,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:40,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,577 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:40,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:40,601 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,713 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,721 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,721 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,727 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:40,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,741 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,742 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,742 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,742 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:40,752 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,755 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,757 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:40,760 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:40,763 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:40,765 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:40,768 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,771 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:40,774 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:40,775 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:40,778 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:40,794 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:40,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:40,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:40,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:40,806 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:40,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:40,817 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:40,817 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:40,818 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:40,835 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:40,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:40,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:40,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:40,863 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:40,863 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:40,864 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:40,864 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:40,864 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:40,864 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:40,865 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:40,865 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:40,867 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:40,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:40,868 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:40,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:40,871 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:40,872 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:40,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:40,873 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:40,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:40,873 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:40,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:40,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:40,874 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:40,874 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:40,874 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:40,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:40,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:40,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:40,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:40,876 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:40,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:40,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:40,878 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:40,878 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:40,880 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:40,883 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:40,885 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:40,886 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:40,888 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:40,889 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:40,905 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4969, Threshold=0.4942, Accuracy=0.4814, F1=0.6427, Precision=0.7769, Recall=0.5481
2025-08-04 20:22:40,905 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4814, F1: 0.6427, Prec: 0.7769, Rec: 0.5481, Avg Anomaly Score: 0.4969
2025-08-04 20:22:46,156 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:46,156 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:46,156 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:46,156 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:46,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:46,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:46,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:46,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:46,434 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:46,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:46,449 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:46,539 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:46,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:46,545 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:46,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:46,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:46,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:46,567 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:46,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:46,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:46,577 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:46,581 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:46,583 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:46,585 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:46,589 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:46,591 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:46,593 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:46,596 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:46,599 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:46,601 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:46,603 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:46,614 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:46,614 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:46,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:46,619 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:46,624 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:46,625 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:46,633 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:46,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:46,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:46,649 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:46,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:46,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:46,659 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:46,659 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:46,660 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:46,660 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:46,660 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:46,660 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:46,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:46,661 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:46,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:46,662 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:46,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:46,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:46,663 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:46,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:46,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:46,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:46,663 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:46,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:46,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:46,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:46,665 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:46,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:46,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:46,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:46,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:46,666 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:46,667 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:46,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:46,667 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:46,667 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:46,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:46,670 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:46,670 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:46,671 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:46,671 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:46,673 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 8/400.
2025-08-04 20:22:46,774 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:46,775 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:46,775 - ClientAppLogger [Client 8] - INFO - [Client] Round 8: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:22:46,776 - ClientAppLogger [Client 8] - INFO - Fit completed for round 8. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 8, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10258793830871582, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:22:46,776 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:22:55,038 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:55,038 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:55,038 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:55,039 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:22:55,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:22:55,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:55,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:55,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:55,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:22:55,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:22:55,442 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:55,530 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:55,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:55,536 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:55,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:22:55,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:55,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:22:55,550 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:55,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:55,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:22:55,559 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:55,562 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:55,564 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:55,567 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:55,569 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:55,571 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:55,574 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:55,576 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:55,579 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:55,581 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:55,584 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:55,593 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:55,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:22:55,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:22:55,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:22:55,602 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:55,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:22:55,612 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:55,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:22:55,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:55,629 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:55,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:22:55,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:22:55,641 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:55,641 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:55,642 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:55,642 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:55,643 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:55,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:22:55,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:55,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:22:55,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:55,645 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:22:55,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:22:55,645 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:55,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:22:55,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:55,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:55,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:55,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:22:55,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:22:55,647 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:22:55,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:22:55,647 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:22:55,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:22:55,647 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:22:55,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:22:55,648 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:22:55,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:22:55,648 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:22:55,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:22:55,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:55,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:22:55,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:55,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:55,650 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:55,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:22:55,653 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:22:55,654 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:22:55,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:22:55,656 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:22:55,656 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:55,658 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:55,658 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:55,659 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:55,659 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:55,659 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:55,660 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:55,675 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4814, Threshold=0.4774, Accuracy=0.4814, F1=0.6427, Precision=0.7769, Recall=0.5481
2025-08-04 20:22:55,675 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4814, F1: 0.6427, Prec: 0.7769, Rec: 0.5481, Avg Anomaly Score: 0.4814
2025-08-04 20:23:00,931 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:00,932 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:00,932 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:00,932 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:00,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:00,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:01,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:01,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:01,318 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:01,331 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:01,331 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:01,419 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:01,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:01,425 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:01,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:01,439 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:01,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:01,440 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:01,440 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:01,441 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:01,449 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:01,452 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:01,455 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:01,457 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:01,460 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:01,462 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:01,465 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:01,469 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:01,473 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:01,475 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:01,478 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:01,490 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:01,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:01,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:01,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:01,499 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:01,499 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:01,508 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:01,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:01,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:01,524 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:01,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:01,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:01,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:01,535 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:01,535 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:01,535 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:01,536 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:01,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:01,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:01,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:01,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:01,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:01,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:01,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:01,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:01,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:01,541 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:01,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:01,541 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:01,542 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:01,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:01,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:01,542 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:01,546 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:01,546 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:01,547 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:01,547 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:01,549 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:01,550 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:01,551 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:01,551 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:01,553 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 9/400.
2025-08-04 20:23:01,653 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:01,654 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:01,654 - ClientAppLogger [Client 8] - INFO - [Client] Round 9: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:23:01,655 - ClientAppLogger [Client 8] - INFO - Fit completed for round 9. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 9, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10184931755065918, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:23:01,655 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:23:06,921 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:06,921 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:06,922 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:06,922 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:06,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:06,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:07,183 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:07,187 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:07,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:07,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:07,297 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:07,402 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:07,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:07,408 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:07,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:07,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:07,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:07,426 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:07,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:07,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:07,437 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:07,441 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,445 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:07,449 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:07,452 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:07,454 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:07,457 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,459 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:07,462 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:07,465 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:07,467 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:07,478 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:07,478 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:07,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:07,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:07,490 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:07,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:07,503 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:07,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:07,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:07,521 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:07,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:07,532 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:07,532 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:07,532 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:07,532 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:07,533 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:07,533 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:07,533 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:07,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:07,533 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:07,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:07,535 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:07,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:07,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:07,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:07,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:07,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:07,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:07,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:07,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:07,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:07,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:07,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:07,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:07,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:07,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:07,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:07,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:07,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:07,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:07,540 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:07,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:07,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:07,542 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:07,543 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:07,544 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:07,544 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:07,545 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:07,545 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:07,546 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:07,546 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:07,559 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4580, Threshold=0.4522, Accuracy=0.4913, F1=0.6496, Precision=0.7851, Recall=0.5539
2025-08-04 20:23:07,559 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4913, F1: 0.6496, Prec: 0.7851, Rec: 0.5539, Avg Anomaly Score: 0.4580
2025-08-04 20:23:12,810 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:12,810 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:12,811 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:12,811 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:12,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:12,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:13,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:13,061 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:13,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:13,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:13,159 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:13,255 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:13,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:13,260 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:13,265 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:13,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:13,273 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:13,273 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:13,273 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:13,273 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:13,284 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:13,287 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:13,289 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:13,291 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:13,294 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:13,296 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:13,299 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:13,301 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:13,304 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:13,306 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:13,308 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:13,317 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:13,318 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:13,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:13,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:13,329 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:13,329 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:13,341 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:13,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:13,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:13,357 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:13,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:13,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:13,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:13,368 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:13,368 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:13,368 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:13,369 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:13,369 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:13,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:13,369 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:13,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:13,371 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:13,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:13,371 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:13,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:13,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:13,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:13,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:13,372 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:13,372 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:13,373 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:13,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:13,373 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:13,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:13,373 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:13,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:13,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:13,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:13,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:13,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:13,375 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:13,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:13,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:13,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:13,376 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:13,376 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:13,379 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:13,380 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:13,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:13,385 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:13,385 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:13,386 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:13,386 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:13,388 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 10/400.
2025-08-04 20:23:13,490 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:13,490 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:13,491 - ClientAppLogger [Client 8] - INFO - [Client] Round 10: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:23:13,491 - ClientAppLogger [Client 8] - INFO - Fit completed for round 10. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 10, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10303354263305664, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:23:13,492 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:23:18,750 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:18,750 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:18,750 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:18,750 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:18,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:18,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:19,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:19,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:19,110 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:19,214 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:19,225 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:19,225 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:19,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:19,248 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:19,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:19,249 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:19,250 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:19,250 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:19,259 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:19,262 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,264 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:19,267 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:19,269 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:19,272 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:19,274 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,277 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:19,279 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:19,281 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:19,284 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:19,296 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:19,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:19,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:19,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:19,309 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:19,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:19,323 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:19,324 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:19,324 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:19,343 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:19,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:19,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:19,361 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:19,361 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:19,361 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:19,361 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:19,362 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:19,362 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:19,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:19,362 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:19,363 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:19,364 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:19,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:19,365 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:19,365 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:19,365 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:19,366 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:19,366 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:19,366 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:19,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:19,366 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:19,367 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:19,367 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:19,367 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:19,367 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:19,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:19,368 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:19,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:19,369 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:19,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:19,369 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:19,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:19,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:19,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:19,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:19,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:19,374 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:19,374 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:19,374 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:19,377 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:19,377 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:19,379 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:19,379 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:19,381 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:19,381 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:19,381 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:19,382 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:19,396 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4192, Threshold=0.4107, Accuracy=0.4913, F1=0.6496, Precision=0.7851, Recall=0.5539
2025-08-04 20:23:19,396 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4913, F1: 0.6496, Prec: 0.7851, Rec: 0.5539, Avg Anomaly Score: 0.4192
2025-08-04 20:23:24,654 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:24,654 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:24,654 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:24,654 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:24,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:24,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:24,914 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:24,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:25,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:25,015 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:25,015 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:25,125 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:25,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:25,132 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:25,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:25,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:25,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:25,148 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:25,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:25,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:25,158 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:25,161 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:25,163 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:25,165 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:25,168 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:25,170 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:25,172 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:25,175 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:25,178 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:25,180 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:25,182 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:25,192 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:25,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:25,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:25,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:25,204 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:25,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:25,214 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:25,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:25,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:25,232 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:25,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:25,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:25,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:25,243 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:25,243 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:25,243 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:25,244 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:25,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:25,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:25,244 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:25,244 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:25,246 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:25,246 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:25,246 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:25,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:25,247 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:25,247 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:25,247 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:25,247 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:25,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:25,248 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:25,248 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:25,248 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:25,248 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:25,248 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:25,248 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:25,249 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:25,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:25,249 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:25,249 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:25,249 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:25,250 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:25,250 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:25,250 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:25,251 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:25,254 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:25,254 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:25,255 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:25,255 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:25,257 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:25,257 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:25,259 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:25,259 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:25,260 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 11/400.
2025-08-04 20:23:25,361 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:25,362 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:25,363 - ClientAppLogger [Client 8] - INFO - [Client] Round 11: No NORMAL samples found in the 2 cumulative samples. Skipping GAN training logic.
2025-08-04 20:23:25,363 - ClientAppLogger [Client 8] - INFO - Fit completed for round 11. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 11, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10261178016662598, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:23:25,363 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:23:30,625 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:30,625 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:30,625 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:30,625 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:30,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:30,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:30,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:30,854 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:30,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:30,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:30,950 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:31,035 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:31,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:31,041 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:31,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:31,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:31,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:31,058 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:31,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:31,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:31,067 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:31,070 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:31,072 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:31,075 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:31,078 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:31,080 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:31,083 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:31,085 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:31,088 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:31,090 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:31,092 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:31,103 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:31,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:31,108 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:31,108 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:31,113 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:31,113 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:31,122 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:31,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:31,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:31,138 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:31,143 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:31,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:31,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:31,148 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:31,148 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:31,148 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:31,149 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:31,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:31,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:31,149 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:31,149 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:31,150 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:31,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:31,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:31,151 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:31,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:31,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:31,151 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:31,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:31,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:31,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:31,152 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:31,152 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:31,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:31,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:31,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:31,153 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:31,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:31,154 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:31,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:31,154 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:31,154 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:31,154 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:31,155 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:31,155 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:31,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:31,159 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:31,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:31,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:31,160 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:31,161 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:31,162 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:31,162 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:31,164 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:31,164 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:31,164 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:31,165 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:31,177 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3625, Threshold=0.3513, Accuracy=0.4963, F1=0.6530, Precision=0.7893, Recall=0.5569
2025-08-04 20:23:31,177 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.4963, F1: 0.6530, Prec: 0.7893, Rec: 0.5569, Avg Anomaly Score: 0.3625
2025-08-04 20:23:48,471 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:48,471 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:48,471 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:48,472 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:48,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:48,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:48,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:48,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:48,819 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:48,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:48,831 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:48,910 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:48,914 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:48,914 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:48,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:48,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:48,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:48,926 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:48,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:48,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:48,935 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:48,938 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:48,940 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:48,942 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:48,945 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:48,947 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:48,950 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:48,952 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:48,955 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:48,957 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:48,959 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:48,968 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:48,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:48,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:48,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:48,977 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:48,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:48,985 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:48,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:48,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:49,000 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:49,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:49,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:49,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:49,011 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:49,012 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:49,012 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:49,012 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:49,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:49,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:49,013 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:49,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:49,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:49,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:49,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:49,015 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:49,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:49,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:49,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:49,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:49,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:49,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:49,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:49,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:49,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:49,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:49,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:49,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:49,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:49,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:49,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:49,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:49,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:49,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:49,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:49,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:49,022 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:49,023 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:49,023 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:49,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:49,025 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:49,025 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:49,026 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:49,026 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:49,028 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:49,028 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:49,028 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:49,029 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:49,040 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3019, Threshold=0.2952, Accuracy=0.5409, F1=0.6838, Precision=0.8264, Recall=0.5831
2025-08-04 20:23:49,040 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5409, F1: 0.6838, Prec: 0.8264, Rec: 0.5831, Avg Anomaly Score: 0.3019
2025-08-04 20:23:54,286 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:54,286 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:54,286 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:54,286 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:23:54,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:23:54,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:54,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:54,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:54,595 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:23:54,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:23:54,607 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:54,696 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:54,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:54,701 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:54,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:23:54,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:54,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:23:54,713 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:54,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:54,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:23:54,722 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:54,725 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:54,727 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:54,730 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:54,732 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:54,734 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:54,737 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:54,739 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:54,742 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:54,744 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:54,747 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:54,756 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:54,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:23:54,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:23:54,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:23:54,766 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:54,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:23:54,774 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:54,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:23:54,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:54,790 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:54,795 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:23:54,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:23:54,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:54,801 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:54,801 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:54,801 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:54,801 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:54,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:23:54,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:54,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:23:54,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:54,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:23:54,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:23:54,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:54,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:23:54,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:54,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:54,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:23:54,805 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:23:54,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:23:54,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:23:54,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:23:54,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:23:54,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:54,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:23:54,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:54,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:54,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:54,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:23:54,811 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:23:54,811 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:23:54,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:23:54,813 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:23:54,813 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:54,814 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:54,814 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:54,816 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 13/400.
2025-08-04 20:23:54,917 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:54,917 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:54,918 - ClientAppLogger [Client 8] - INFO - [Client] Round 13: No NORMAL samples found in the 3 cumulative samples. Skipping GAN training logic.
2025-08-04 20:23:54,918 - ClientAppLogger [Client 8] - INFO - Fit completed for round 13. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 13, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10277104377746582, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:23:54,919 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:24:00,191 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:00,192 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:00,192 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:00,192 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:00,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:00,192 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:00,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:00,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:00,580 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:00,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:00,599 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:00,690 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:00,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:00,695 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:00,699 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:00,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:00,707 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:00,708 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:00,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:00,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:00,716 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:00,719 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,721 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:00,724 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:00,726 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:00,728 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:00,731 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,734 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:00,736 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:00,738 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:00,740 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:00,749 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:00,749 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:00,754 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:00,754 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:00,759 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:00,759 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:00,769 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:00,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:00,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:00,787 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:00,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:00,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:00,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:00,798 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:00,798 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:00,799 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:00,799 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:00,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:00,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:00,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:00,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:00,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:00,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:00,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:00,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:00,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:00,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:00,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:00,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:00,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:00,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:00,805 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:00,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:00,809 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:00,809 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:00,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:00,811 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:00,811 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:00,813 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:00,813 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:00,814 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:00,814 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:00,814 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:00,815 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:00,826 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3043, Threshold=0.3023, Accuracy=0.5608, F1=0.6974, Precision=0.8430, Recall=0.5948
2025-08-04 20:24:00,827 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5608, F1: 0.6974, Prec: 0.8430, Rec: 0.5948, Avg Anomaly Score: 0.3043
2025-08-04 20:24:06,084 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:06,084 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:06,084 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:06,084 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:06,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:06,085 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:06,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:06,295 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:06,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:06,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:06,391 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:06,480 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:06,485 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:06,485 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:06,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:06,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:06,540 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:06,541 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:06,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:06,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:06,550 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:06,552 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:06,555 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:06,557 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:06,560 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:06,562 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:06,564 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:06,567 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:06,570 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:06,572 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:06,574 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:06,583 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:06,584 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:06,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:06,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:06,593 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:06,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:06,602 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:06,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:06,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:06,617 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:06,622 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:06,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:06,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:06,627 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:06,627 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:06,627 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:06,627 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:06,628 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:06,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:06,628 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:06,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:06,630 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:06,630 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:06,630 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:06,630 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:06,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:06,632 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:06,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:06,632 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:06,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:06,632 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:06,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:06,633 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:06,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:06,633 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:06,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:06,633 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:06,633 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:06,634 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:06,634 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:06,637 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:06,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:06,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:06,640 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:06,640 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:06,641 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:06,641 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:06,643 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 14/400.
2025-08-04 20:24:06,744 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:06,744 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:06,745 - ClientAppLogger [Client 8] - INFO - [Client] Round 14: No NORMAL samples found in the 3 cumulative samples. Skipping GAN training logic.
2025-08-04 20:24:06,745 - ClientAppLogger [Client 8] - INFO - Fit completed for round 14. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 14, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10252213478088379, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:24:06,746 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:24:12,016 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:12,017 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:12,017 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:12,017 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:12,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:12,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:12,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:12,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:12,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:12,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:12,387 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:12,504 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:12,510 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:12,511 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:12,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:12,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:12,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:12,555 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:12,555 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:12,555 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:12,563 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:12,566 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,569 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:12,571 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:12,574 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:12,576 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:12,579 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,581 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:12,584 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:12,586 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:12,588 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:12,598 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:12,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:12,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:12,603 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:12,607 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:12,607 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:12,618 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:12,618 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:12,618 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:12,634 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:12,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:12,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:12,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:12,645 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:12,645 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:12,645 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:12,646 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:12,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:12,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:12,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:12,647 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:12,648 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:12,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:12,648 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:12,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:12,648 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:12,649 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:12,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:12,650 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:12,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:12,650 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:12,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:12,650 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:12,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:12,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:12,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:12,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:12,651 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:12,652 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:12,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:12,655 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:12,655 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:12,655 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:12,660 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:12,660 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:12,661 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:12,662 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:12,663 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:12,663 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:12,663 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:12,664 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:12,675 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3221, Threshold=0.3241, Accuracy=0.5856, F1=0.7145, Precision=0.8636, Recall=0.6093
2025-08-04 20:24:12,676 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.5856, F1: 0.7145, Prec: 0.8636, Rec: 0.6093, Avg Anomaly Score: 0.3221
2025-08-04 20:24:17,932 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:17,932 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:17,932 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:17,932 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:17,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:17,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:18,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:18,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:18,280 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:18,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:18,295 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:18,388 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:18,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:18,394 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:18,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:18,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:18,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:18,425 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:18,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:18,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:18,434 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:18,436 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:18,439 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:18,441 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:18,443 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:18,445 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:18,448 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:18,450 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:18,453 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:18,455 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:18,457 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:18,467 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:18,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:18,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:18,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:18,477 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:18,477 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:18,487 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:18,487 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:18,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:18,502 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:18,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:18,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:18,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:18,512 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:18,512 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:18,513 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:18,513 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:18,513 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:18,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:18,514 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:18,514 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:18,515 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:18,515 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:18,516 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:18,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:18,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:18,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:18,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:18,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:18,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:18,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:18,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:18,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:18,523 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:18,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:18,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:18,526 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:18,526 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:18,528 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:18,528 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:18,529 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 15/400.
2025-08-04 20:24:18,630 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:18,630 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:18,631 - ClientAppLogger [Client 8] - INFO - [Client] Round 15: No NORMAL samples found in the 3 cumulative samples. Skipping GAN training logic.
2025-08-04 20:24:18,632 - ClientAppLogger [Client 8] - INFO - Fit completed for round 15. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 15, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10241079330444336, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:24:18,632 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:24:23,919 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:23,919 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:23,919 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:23,919 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:23,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:23,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:24,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:24,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:24,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:24,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:24,303 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:24,403 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:24,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:24,410 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:24,415 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:24,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:24,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:24,425 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:24,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:24,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:24,434 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:24,437 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,439 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:24,442 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:24,445 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:24,447 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:24,450 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,452 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:24,455 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:24,457 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:24,460 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:24,470 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:24,470 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:24,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:24,476 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:24,481 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:24,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:24,490 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:24,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:24,491 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:24,507 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:24,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:24,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:24,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:24,517 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:24,517 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:24,518 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:24,518 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:24,518 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:24,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:24,519 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:24,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:24,520 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:24,520 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:24,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:24,521 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:24,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:24,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:24,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:24,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:24,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:24,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:24,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:24,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:24,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:24,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:24,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:24,523 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:24,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:24,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:24,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:24,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:24,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:24,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:24,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:24,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:24,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:24,525 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:24,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:24,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:24,527 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:24,528 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:24,529 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:24,529 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:24,531 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:24,531 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:24,531 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:24,532 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:24,544 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3022, Threshold=0.3065, Accuracy=0.6849, F1=0.7829, Precision=0.9463, Recall=0.6676
2025-08-04 20:24:24,545 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6849, F1: 0.7829, Prec: 0.9463, Rec: 0.6676, Avg Anomaly Score: 0.3022
2025-08-04 20:24:29,803 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:29,803 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:29,803 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:29,803 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:29,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:29,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:30,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:30,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:30,102 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:30,115 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:30,115 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:30,199 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:30,203 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:30,203 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:30,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:30,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:30,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:30,215 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:30,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:30,215 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:30,223 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:30,226 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:30,229 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:30,231 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:30,233 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:30,236 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:30,238 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:30,241 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:30,243 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:30,245 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:30,248 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:30,256 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:30,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:30,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:30,261 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:30,265 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:30,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:30,274 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:30,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:30,274 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:30,289 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:30,294 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:30,298 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:30,299 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:30,299 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:30,299 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:30,299 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:30,299 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:30,300 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:30,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:30,300 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:30,300 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:30,301 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:30,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:30,302 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:30,303 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:30,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:30,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:30,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:30,304 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:30,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:30,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:30,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:30,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:30,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:30,305 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:30,305 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:30,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:30,308 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:30,308 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:30,309 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:30,309 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:30,311 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 16/400.
2025-08-04 20:24:30,412 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:30,412 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:30,413 - ClientAppLogger [Client 8] - INFO - [Client] Round 16: No NORMAL samples found in the 4 cumulative samples. Skipping GAN training logic.
2025-08-04 20:24:30,413 - ClientAppLogger [Client 8] - INFO - Fit completed for round 16. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 16, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10231208801269531, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:24:30,413 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:24:35,687 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:35,688 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:35,688 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:35,688 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:35,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:35,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:36,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:36,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:36,093 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:36,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:36,113 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:36,214 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:36,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:36,221 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:36,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:36,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:36,258 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:36,259 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:36,259 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:36,259 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:36,268 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:36,271 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,274 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:36,276 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:36,278 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:36,281 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:36,284 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,286 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:36,289 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:36,291 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:36,293 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:36,304 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:36,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:36,310 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:36,310 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:36,318 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:36,318 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:36,333 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:36,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:36,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:36,352 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:36,357 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:36,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:36,363 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:36,363 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:36,363 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:36,363 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:36,363 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:36,364 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:36,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:36,364 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:36,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:36,365 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:36,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:36,366 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:36,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:36,366 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:36,367 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:36,367 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:36,367 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:36,367 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:36,367 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:36,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:36,368 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:36,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:36,368 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:36,368 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:36,368 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:36,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:36,369 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:36,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:36,369 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:36,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:36,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:36,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:36,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:36,370 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:36,370 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:36,370 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:36,371 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:36,375 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:36,375 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:36,377 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:36,377 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:36,378 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:36,379 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:36,379 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:36,379 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:36,392 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3006, Threshold=0.3054, Accuracy=0.6799, F1=0.7795, Precision=0.9421, Recall=0.6647
2025-08-04 20:24:36,392 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6799, F1: 0.7795, Prec: 0.9421, Rec: 0.6647, Avg Anomaly Score: 0.3006
2025-08-04 20:24:41,640 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:41,640 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:41,640 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:41,640 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:41,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:41,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:41,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:41,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:41,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:41,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:41,967 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:42,053 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:42,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:42,061 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:42,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:42,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:42,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:42,073 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:42,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:42,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:42,081 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:42,084 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:42,087 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:42,089 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:42,092 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:42,094 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:42,096 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:42,099 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:42,102 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:42,104 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:42,106 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:42,115 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:42,115 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:42,119 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:42,119 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:42,124 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:42,124 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:42,133 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:42,133 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:42,133 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:42,149 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:42,153 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:42,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:42,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:42,159 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:42,159 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:42,159 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:42,160 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:42,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:42,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:42,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:42,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:42,162 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:42,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:42,162 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:42,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:42,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:42,164 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:42,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:42,164 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:42,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:42,164 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:42,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:42,165 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:42,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:42,165 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:42,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:42,165 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:42,165 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:42,166 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:42,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:42,166 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:42,166 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:42,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:42,168 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:42,168 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:42,170 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:42,170 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:42,171 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 17/400.
2025-08-04 20:24:42,272 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:42,272 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:42,273 - ClientAppLogger [Client 8] - INFO - [Client] Round 17: No NORMAL samples found in the 4 cumulative samples. Skipping GAN training logic.
2025-08-04 20:24:42,274 - ClientAppLogger [Client 8] - INFO - Fit completed for round 17. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 17, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.1022481918334961, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:24:42,274 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:24:47,537 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:47,538 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:47,538 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:47,538 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:47,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:47,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:47,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:47,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:47,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:47,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:47,940 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:48,061 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:48,068 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:48,068 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:48,074 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:48,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:48,088 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:48,089 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:48,090 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:48,090 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:48,101 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:48,104 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,107 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:48,110 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:48,113 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:48,115 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:48,118 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,121 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:48,124 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:48,126 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:48,128 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:48,139 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:48,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:48,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:48,144 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:48,150 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:48,150 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:48,165 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:48,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:48,165 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:48,183 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:48,189 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:48,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:48,194 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:48,194 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:48,195 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:48,195 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:48,196 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:48,196 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:48,196 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:48,196 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:48,197 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:48,198 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:48,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:48,199 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:48,199 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:48,199 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:48,199 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:48,199 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:48,200 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:48,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:48,200 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:48,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:48,200 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:48,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:48,201 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:48,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:48,201 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:48,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:48,201 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:48,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:48,202 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:48,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:48,202 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:48,202 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:48,203 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:48,203 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:48,203 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:48,204 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:48,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:48,207 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:48,208 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:48,209 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:48,209 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:48,211 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:48,211 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:48,211 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:48,212 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:48,228 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.2996, Threshold=0.3051, Accuracy=0.6749, F1=0.7761, Precision=0.9380, Recall=0.6618
2025-08-04 20:24:48,229 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6749, F1: 0.7761, Prec: 0.9380, Rec: 0.6618, Avg Anomaly Score: 0.2996
2025-08-04 20:24:53,480 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:53,480 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:53,480 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:53,481 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:53,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:53,481 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:53,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:53,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:53,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:53,785 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:53,785 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:53,865 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:53,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:53,869 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:53,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:53,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:53,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:53,880 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:53,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:53,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:53,889 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:53,891 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:53,893 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:53,896 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:53,898 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:53,901 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:53,903 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:53,905 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:53,908 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:53,910 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:53,912 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:53,920 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:53,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:53,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:53,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:53,930 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:53,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:53,938 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:53,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:53,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:53,952 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:53,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:53,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:53,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:53,963 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:53,964 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:53,964 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:53,964 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:53,964 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:53,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:53,965 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:53,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:53,966 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:53,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:53,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:53,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:53,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:53,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:53,967 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:53,968 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:53,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:53,968 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:53,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:53,968 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:53,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:53,969 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:53,969 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:53,969 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:53,969 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:53,969 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:53,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:53,970 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:53,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:53,970 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:53,970 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:53,970 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:53,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:53,971 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:53,971 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:53,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:53,973 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:53,973 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:53,974 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:53,975 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:53,976 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 18/400.
2025-08-04 20:24:54,077 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:54,077 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:54,078 - ClientAppLogger [Client 8] - INFO - [Client] Round 18: No NORMAL samples found in the 4 cumulative samples. Skipping GAN training logic.
2025-08-04 20:24:54,078 - ClientAppLogger [Client 8] - INFO - Fit completed for round 18. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 18, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10207009315490723, 'cpu_percent_fit': 43.73125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:24:54,078 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:24:59,346 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:59,346 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:59,347 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:59,347 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:24:59,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:24:59,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:59,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:59,595 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:59,686 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:24:59,706 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:24:59,707 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:59,814 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:59,821 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:59,822 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:59,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:24:59,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:59,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:24:59,839 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:59,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:59,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:24:59,849 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:59,852 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,854 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:59,857 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:59,860 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:59,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:59,865 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,869 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:59,872 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:59,874 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:59,877 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:59,888 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:59,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:24:59,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:24:59,894 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:24:59,899 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:59,899 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:24:59,908 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:59,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:24:59,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:59,923 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:59,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:24:59,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:24:59,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:59,933 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:59,933 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:59,934 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:59,934 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:59,934 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:24:59,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:59,935 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:24:59,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:59,936 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:24:59,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:24:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:59,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:24:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:59,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:24:59,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:24:59,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:24:59,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:24:59,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:24:59,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:24:59,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:24:59,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:24:59,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:24:59,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:24:59,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:24:59,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:24:59,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:59,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:24:59,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:59,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:59,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:59,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:24:59,942 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:24:59,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:24:59,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:24:59,945 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:24:59,946 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:59,947 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:59,947 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:59,949 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:59,950 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:59,950 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:59,950 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:59,962 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3073, Threshold=0.3147, Accuracy=0.6749, F1=0.7761, Precision=0.9380, Recall=0.6618
2025-08-04 20:24:59,963 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6749, F1: 0.7761, Prec: 0.9380, Rec: 0.6618, Avg Anomaly Score: 0.3073
2025-08-04 20:25:05,219 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:05,219 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:05,219 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:05,219 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:05,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:05,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:05,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:05,467 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:05,553 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:05,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:05,566 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:05,650 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:05,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:05,655 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:05,658 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:05,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:05,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:05,666 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:05,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:05,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:05,676 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:05,678 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:05,681 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:05,683 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:05,685 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:05,687 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:05,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:05,692 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:05,695 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:05,697 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:05,699 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:05,708 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:05,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:05,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:05,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:05,720 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:05,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:05,730 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:05,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:05,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:05,745 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:05,749 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:05,754 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:05,754 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:05,754 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:05,754 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:05,755 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:05,755 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:05,755 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:05,755 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:05,755 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:05,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:05,757 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:05,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:05,757 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:05,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:05,757 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:05,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:05,759 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:05,759 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:05,759 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:05,759 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:05,759 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:05,759 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:05,760 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:05,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:05,760 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:05,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:05,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:05,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:05,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:05,761 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:05,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:05,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:05,763 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:05,763 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:05,765 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:05,765 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:05,767 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 19/400.
2025-08-04 20:25:05,868 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:05,868 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:05,869 - ClientAppLogger [Client 8] - INFO - [Client] Round 19: No NORMAL samples found in the 4 cumulative samples. Skipping GAN training logic.
2025-08-04 20:25:05,869 - ClientAppLogger [Client 8] - INFO - Fit completed for round 19. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 19, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.1025388240814209, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:25:05,869 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:25:11,121 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:11,122 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:11,122 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:11,122 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:11,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:11,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:11,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:11,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:11,501 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:11,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:11,520 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:11,626 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:11,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:11,634 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:11,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:11,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:11,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:11,651 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:11,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:11,652 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:11,663 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:11,666 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,669 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:11,672 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:11,675 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:11,678 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:11,680 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,683 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:11,685 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:11,687 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:11,690 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:11,702 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:11,702 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:11,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:11,708 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:11,716 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:11,716 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:11,731 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:11,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:11,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:11,750 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:11,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:11,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:11,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:11,765 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:11,766 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:11,766 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:11,766 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:11,766 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:11,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:11,767 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:11,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:11,768 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:11,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:11,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:11,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:11,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:11,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:11,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:11,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:11,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:11,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:11,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:11,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:11,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:11,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:11,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:11,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:11,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:11,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:11,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:11,773 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:11,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:11,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:11,777 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:11,777 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:11,778 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:11,778 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:11,780 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:11,780 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:11,780 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:11,781 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:11,793 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3111, Threshold=0.3196, Accuracy=0.6749, F1=0.7761, Precision=0.9380, Recall=0.6618
2025-08-04 20:25:11,793 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6749, F1: 0.7761, Prec: 0.9380, Rec: 0.6618, Avg Anomaly Score: 0.3111
2025-08-04 20:25:17,055 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:17,055 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:17,055 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:17,055 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:17,056 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:17,056 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:17,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:17,305 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:17,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:17,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:17,407 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:17,489 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:17,494 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:17,495 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:17,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:17,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:17,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:17,508 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:17,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:17,508 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:17,517 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:17,520 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:17,522 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:17,525 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:17,527 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:17,530 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:17,533 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:17,536 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:17,539 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:17,541 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:17,543 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:17,552 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:17,553 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:17,557 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:17,557 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:17,562 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:17,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:17,570 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:17,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:17,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:17,586 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:17,591 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:17,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:17,596 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:17,596 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:17,596 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:17,597 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:17,597 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:17,597 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:17,597 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:17,598 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:17,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:17,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:17,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:17,599 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:17,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:17,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:17,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:17,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:17,600 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:17,600 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:17,601 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:17,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:17,602 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:17,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:17,602 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:17,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:17,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:17,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:17,603 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:17,604 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:17,604 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:17,604 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:17,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:17,607 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:17,607 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:17,609 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:17,609 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:17,610 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 20/400.
2025-08-04 20:25:17,711 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:17,711 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:17,713 - ClientAppLogger [Client 8] - INFO - [Client] Round 20: No NORMAL samples found in the 5 cumulative samples. Skipping GAN training logic.
2025-08-04 20:25:17,713 - ClientAppLogger [Client 8] - INFO - Fit completed for round 20. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 20, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10242748260498047, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:25:17,713 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:25:22,967 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:22,967 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:22,968 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:22,968 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:22,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:22,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:23,199 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:23,199 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:23,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:23,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:23,304 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:23,407 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:23,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:23,414 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:23,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:23,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:23,430 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:23,458 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:23,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:23,459 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:23,468 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:23,472 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,475 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:23,477 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:23,480 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:23,482 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:23,485 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,487 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:23,490 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:23,492 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:23,495 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:23,507 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:23,507 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:23,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:23,512 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:23,517 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:23,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:23,530 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:23,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:23,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:23,547 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:23,552 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:23,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:23,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:23,560 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:23,561 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:23,561 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:23,561 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:23,561 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:23,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:23,562 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:23,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:23,563 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:23,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:23,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:23,564 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:23,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:23,564 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:23,565 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:23,566 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:23,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:23,566 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:23,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:23,567 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:23,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:23,567 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:23,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:23,568 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:23,568 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:23,569 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:23,569 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:23,570 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:23,570 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:23,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:23,573 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:23,573 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:23,575 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:23,575 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:23,578 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:23,578 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:23,578 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:23,579 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:23,600 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3235, Threshold=0.3327, Accuracy=0.6799, F1=0.7795, Precision=0.9421, Recall=0.6647
2025-08-04 20:25:23,601 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6799, F1: 0.7795, Prec: 0.9421, Rec: 0.6647, Avg Anomaly Score: 0.3235
2025-08-04 20:25:28,858 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:28,858 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:28,859 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:28,859 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:28,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:28,859 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:29,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:29,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:29,195 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:29,207 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:29,207 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:29,299 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:29,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:29,304 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:29,308 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:29,314 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:29,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:29,315 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:29,315 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:29,316 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:29,325 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:29,328 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:29,330 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:29,332 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:29,335 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:29,337 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:29,339 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:29,343 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:29,345 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:29,347 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:29,350 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:29,358 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:29,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:29,363 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:29,363 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:29,368 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:29,369 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:29,379 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:29,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:29,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:29,395 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:29,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:29,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:29,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:29,405 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:29,405 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:29,406 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:29,406 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:29,406 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:29,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:29,407 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:29,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:29,408 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:29,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:29,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:29,409 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:29,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:29,409 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:29,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:29,411 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:29,411 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:29,411 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:29,411 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:29,411 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:29,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:29,412 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:29,412 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:29,412 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:29,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:29,413 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:29,413 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:29,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:29,415 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:29,415 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:29,417 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:29,417 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:29,418 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 21/400.
2025-08-04 20:25:29,519 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:29,519 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:29,520 - ClientAppLogger [Client 8] - INFO - [Client] Round 21: No NORMAL samples found in the 5 cumulative samples. Skipping GAN training logic.
2025-08-04 20:25:29,521 - ClientAppLogger [Client 8] - INFO - Fit completed for round 21. Duration: 0.10s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 21, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'fit_status': 'skipped_no_normal_samples_for_round', 'fit_time_seconds': 0.10218405723571777, 'cpu_percent_fit': 0.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 0}
2025-08-04 20:25:29,521 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:25:34,775 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:34,776 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:34,776 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:34,776 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:34,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:34,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:35,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:35,007 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:35,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:35,108 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:35,108 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:35,198 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:35,204 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:35,205 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:35,210 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:35,221 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:35,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:35,222 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:35,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:35,223 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:35,231 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:35,234 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,236 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:35,238 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:35,241 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:35,243 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:35,246 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,248 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:35,251 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:35,253 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:35,255 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:35,266 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:35,266 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:35,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:35,272 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:35,277 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:35,277 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:35,286 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:35,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:35,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:35,303 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:35,309 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:35,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:35,317 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:35,317 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:35,317 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:35,318 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:35,318 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:35,318 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:35,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:35,319 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:35,319 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:35,320 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:35,320 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:35,321 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:35,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:35,321 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:35,321 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:35,321 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:35,321 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:35,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:35,322 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:35,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:35,322 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:35,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:35,323 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:35,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:35,323 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:35,323 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:35,324 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:35,324 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:35,324 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:35,324 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:35,324 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:35,325 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:35,325 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:35,325 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:35,325 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:35,325 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:35,326 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:35,328 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:35,328 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:35,329 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:35,329 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:35,331 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:35,331 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:35,332 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:35,332 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:35,346 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3210, Threshold=0.3310, Accuracy=0.6799, F1=0.7795, Precision=0.9421, Recall=0.6647
2025-08-04 20:25:35,346 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6799, F1: 0.7795, Prec: 0.9421, Rec: 0.6647, Avg Anomaly Score: 0.3210
2025-08-04 20:25:46,612 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:46,612 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:46,612 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:46,612 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:46,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:46,612 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:46,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:46,869 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:46,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:46,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:46,967 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:47,053 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:47,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:47,058 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:47,062 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:47,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:47,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:47,070 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:47,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:47,070 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:47,078 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:47,081 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:47,083 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:47,085 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:47,088 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:47,090 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:47,093 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:47,095 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:47,098 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:47,100 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:47,102 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:47,111 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:47,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:47,116 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:47,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:47,121 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:47,121 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:47,130 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:47,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:47,131 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:47,146 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:47,150 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:47,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:47,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:47,155 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:47,155 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:47,155 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:47,156 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:47,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:47,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:47,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:47,156 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:47,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:47,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:47,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:47,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:47,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:47,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:47,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:47,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:47,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:47,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:47,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:47,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:47,161 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:47,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:47,161 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:47,161 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:47,161 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:47,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:47,162 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:47,162 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:47,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:47,164 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:47,165 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:47,166 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:47,166 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:47,167 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:47,168 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:47,168 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:47,168 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:47,180 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3245, Threshold=0.3351, Accuracy=0.6898, F1=0.7863, Precision=0.9504, Recall=0.6706
2025-08-04 20:25:47,180 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6898, F1: 0.7863, Prec: 0.9504, Rec: 0.6706, Avg Anomaly Score: 0.3245
2025-08-04 20:25:55,434 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:55,435 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:55,435 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:55,435 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:25:55,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:25:55,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:55,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:55,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:55,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:25:55,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:25:55,751 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:55,834 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:55,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:55,839 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:55,843 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:25:55,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:55,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:25:55,850 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:55,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:55,850 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:25:55,859 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:55,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:55,865 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:55,867 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:55,869 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:55,872 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:55,874 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:55,876 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:55,879 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:55,881 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:55,884 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:55,893 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:55,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:25:55,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:25:55,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:25:55,902 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:55,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:25:55,911 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:55,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:25:55,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:55,927 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:55,931 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:25:55,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:25:55,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:55,935 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:55,936 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:55,936 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:55,936 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:55,936 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:25:55,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:55,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:25:55,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:55,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:25:55,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:25:55,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:55,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:25:55,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:55,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:55,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:55,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:25:55,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:25:55,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:25:55,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:25:55,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:25:55,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:25:55,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:25:55,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:25:55,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:25:55,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:25:55,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:25:55,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:25:55,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:55,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:25:55,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:55,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:55,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:55,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:25:55,943 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:25:55,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:25:55,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:25:55,945 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:25:55,945 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:55,946 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:55,946 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:55,948 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 23/400.
2025-08-04 20:25:56,048 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:56,048 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:56,057 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:25:56,059 - ClientAppLogger [Client 8] - INFO - [Client] Round 23: Training GAN with 1 samples (1 normal, 0 anomalous).
2025-08-04 20:25:56,060 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:57,801 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0509, Avg D Loss: 0.7966
2025-08-04 20:25:57,801 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0509, Avg D Loss: 0.7966
2025-08-04 20:25:57,801 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:57,813 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3096, Threshold=0.3208, Accuracy=0.6898, F1=0.7863, Precision=0.9504, Recall=0.6706
2025-08-04 20:25:57,813 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7863
2025-08-04 20:25:57,813 - ClientAppLogger [Client 8] - INFO - Fit completed for round 23. Duration: 1.87s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 23, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.050898814201355, 'd_loss': 0.7966004312038422, 'post_fit_local_f1': 0.7863247863247863, 'fit_time_seconds': 1.865556240081787, 'cpu_percent_fit': 5.13125, 'ram_mb_fit': 121.3671875, 'accumulated_train_samples_this_round': 1}
2025-08-04 20:25:57,813 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:26:03,097 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,097 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:03,097 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:03,097 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:03,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:03,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:03,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:03,461 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:03,559 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:03,586 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:03,586 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:03,772 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:03,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:03,783 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:03,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:03,860 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:03,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:03,861 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:03,861 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:03,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:03,871 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:03,875 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:03,878 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:03,881 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:03,885 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:03,888 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:03,891 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:03,894 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:03,897 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:03,900 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:03,903 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:03,918 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:03,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:03,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:03,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:03,933 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:03,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:03,953 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:03,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:03,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:03,975 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:03,983 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:04,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:04,004 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,005 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,005 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,006 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,006 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,007 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:04,008 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,008 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:04,009 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,011 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:04,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,013 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:04,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:04,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:04,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:04,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:04,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:04,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:04,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:04,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:04,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:04,020 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:04,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:04,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:04,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,022 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:04,024 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:04,025 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:04,026 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:04,032 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:04,033 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,035 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,037 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:04,041 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,041 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,041 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,042 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,063 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3324, Threshold=0.3448, Accuracy=0.6898, F1=0.7863, Precision=0.9504, Recall=0.6706
2025-08-04 20:26:04,065 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6898, F1: 0.7863, Prec: 0.9504, Rec: 0.6706, Avg Anomaly Score: 0.3324
2025-08-04 20:26:09,342 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:09,342 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:09,342 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:09,342 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:09,342 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:09,342 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:09,568 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:09,568 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:09,651 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:09,667 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:09,667 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:09,764 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:09,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:09,790 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:09,795 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:09,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:09,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:09,845 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:09,845 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:09,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:09,854 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:09,857 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:09,859 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:09,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:09,864 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:09,867 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:09,869 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:09,871 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:09,874 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:09,876 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:09,878 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:09,888 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:09,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:09,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:09,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:09,898 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:09,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:09,908 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:09,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:09,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:09,924 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:09,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:09,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:09,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:09,936 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:09,936 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:09,937 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:09,937 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:09,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:09,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:09,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:09,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:09,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:09,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:09,939 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:09,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:09,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:09,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:09,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:09,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:09,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:09,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:09,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:09,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:09,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:09,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:09,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:09,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:09,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:09,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:09,944 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:09,944 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:09,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:09,947 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:09,947 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:09,948 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:09,949 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:09,950 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 24/400.
2025-08-04 20:26:10,051 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:10,052 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:10,053 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:26:10,053 - ClientAppLogger [Client 8] - INFO - [Client] Round 24: Training GAN with 1 samples (1 normal, 0 anomalous).
2025-08-04 20:26:10,053 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:10,074 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0493, Avg D Loss: 0.8019
2025-08-04 20:26:10,075 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0493, Avg D Loss: 0.8019
2025-08-04 20:26:10,075 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:10,086 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3172, Threshold=0.3295, Accuracy=0.6898, F1=0.7863, Precision=0.9504, Recall=0.6706
2025-08-04 20:26:10,086 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7863
2025-08-04 20:26:10,087 - ClientAppLogger [Client 8] - INFO - Fit completed for round 24. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 24, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.049337351322174, 'd_loss': 0.8018819510936737, 'post_fit_local_f1': 0.7863247863247863, 'fit_time_seconds': 0.13663005828857422, 'cpu_percent_fit': 26.425, 'ram_mb_fit': 3.015625, 'accumulated_train_samples_this_round': 1}
2025-08-04 20:26:10,087 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:26:15,352 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:15,352 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:15,352 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:15,352 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:15,353 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:15,353 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:15,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:15,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:15,710 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:15,733 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:15,733 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:15,868 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:15,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:15,878 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:15,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:15,899 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:15,900 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:15,901 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:15,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:15,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:15,913 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:15,916 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:15,919 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:15,922 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:15,925 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:15,927 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:15,930 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:15,933 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:15,936 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:15,938 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:15,940 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:15,953 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:15,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:15,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:15,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:15,967 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:15,968 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:15,995 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:15,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:15,996 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,018 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:16,033 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:16,033 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,033 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,033 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,034 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,034 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,034 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:16,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,035 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:16,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,036 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:16,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,037 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,038 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:16,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:16,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:16,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:16,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:16,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:16,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:16,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:16,040 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:16,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:16,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:16,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:16,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:16,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:16,043 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:16,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:16,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:16,046 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:16,046 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,049 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,049 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:16,051 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,052 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,052 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,053 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,066 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3239, Threshold=0.3353, Accuracy=0.6898, F1=0.7863, Precision=0.9504, Recall=0.6706
2025-08-04 20:26:16,067 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6898, F1: 0.7863, Prec: 0.9504, Rec: 0.6706, Avg Anomaly Score: 0.3239
2025-08-04 20:26:27,361 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:27,361 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:27,362 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:27,362 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:27,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:27,362 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:27,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:27,595 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:27,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:27,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:27,704 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:27,804 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:27,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:27,812 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:27,820 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:27,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:27,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:27,849 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:27,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:27,849 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:27,860 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:27,863 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:27,865 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:27,868 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:27,871 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:27,874 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:27,877 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:27,880 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:27,883 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:27,885 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:27,888 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:27,901 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:27,902 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:27,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:27,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:27,915 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:27,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:27,932 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:27,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:27,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:27,952 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:27,960 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:27,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:27,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:27,974 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:27,974 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:27,975 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:27,975 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:27,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:27,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:27,977 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:27,977 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:27,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:27,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:27,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:27,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:27,980 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:27,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:27,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:27,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:27,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:27,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:27,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:27,982 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:27,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:27,982 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:27,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:27,982 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:27,982 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:27,983 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:27,983 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:27,983 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:27,984 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:27,984 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:27,984 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:27,985 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:27,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:27,985 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:27,985 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:27,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:27,992 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:27,992 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:27,994 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:27,995 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:27,997 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:27,997 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:27,998 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:27,999 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,013 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3283, Threshold=0.3417, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:26:28,013 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3283
2025-08-04 20:26:33,284 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:33,284 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:33,285 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:33,285 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:33,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:33,285 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:33,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:33,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:33,599 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:33,613 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:33,613 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:33,696 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:33,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:33,701 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:33,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:33,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:33,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:33,713 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:33,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:33,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:33,721 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:33,724 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:33,726 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:33,728 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:33,731 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:33,733 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:33,736 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:33,738 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:33,740 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:33,742 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:33,744 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:33,752 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:33,752 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:33,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:33,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:33,762 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:33,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:33,772 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:33,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:33,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:33,787 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:33,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:33,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:33,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:33,797 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:33,797 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:33,797 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:33,797 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:33,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:33,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:33,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:33,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:33,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:33,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:33,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:33,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:33,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:33,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:33,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:33,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:33,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:33,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:33,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:33,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:33,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:33,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:33,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:33,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:33,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:33,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:33,803 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:33,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:33,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:33,806 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:33,806 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:33,807 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:33,807 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:33,809 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 26/400.
2025-08-04 20:26:33,909 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:33,909 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:33,910 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:26:33,910 - ClientAppLogger [Client 8] - INFO - [Client] Round 26: Training GAN with 1 samples (1 normal, 0 anomalous).
2025-08-04 20:26:33,911 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:33,933 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0621, Avg D Loss: 0.7980
2025-08-04 20:26:33,934 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0621, Avg D Loss: 0.7980
2025-08-04 20:26:33,934 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:33,947 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3120, Threshold=0.3250, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:26:33,947 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:26:33,947 - ClientAppLogger [Client 8] - INFO - Fit completed for round 26. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 26, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.06214919090271, 'd_loss': 0.7980471909046173, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.1386716365814209, 'cpu_percent_fit': 27.8875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1}
2025-08-04 20:26:33,948 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:26:39,213 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:39,213 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:39,213 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:39,214 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:39,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:39,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:39,482 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:39,482 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:39,563 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:39,576 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:39,577 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:39,661 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:39,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:39,666 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:39,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:39,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:39,681 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:39,682 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:39,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:39,682 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:39,691 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:39,693 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:39,696 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:39,698 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:39,700 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:39,702 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:39,705 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:39,708 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:39,710 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:39,712 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:39,714 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:39,723 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:39,723 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:39,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:39,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:39,732 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:39,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:39,741 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:39,742 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:39,742 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:39,756 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:39,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:39,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:39,766 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:39,766 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:39,766 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:39,767 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:39,767 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:39,767 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:39,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:39,768 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:39,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:39,769 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:39,769 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:39,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:39,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:39,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:39,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:39,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:39,770 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:39,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:39,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:39,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:39,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:39,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:39,771 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:39,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:39,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:39,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:39,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:39,772 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:39,772 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:39,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:39,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:39,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:39,773 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:39,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:39,774 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:39,774 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:39,774 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:39,776 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:39,776 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:39,778 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:39,778 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:39,780 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:39,780 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:39,780 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:39,781 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:39,792 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3323, Threshold=0.3472, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:26:39,793 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3323
2025-08-04 20:26:45,055 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:45,055 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:45,055 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:45,055 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:45,055 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:45,055 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:45,268 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:45,269 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:45,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:45,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:45,367 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:45,453 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:45,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:45,460 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:45,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:45,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:45,473 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:45,474 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:45,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:45,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:45,484 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:45,487 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:45,489 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:45,492 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:45,494 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:45,497 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:45,500 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:45,502 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:45,505 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:45,507 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:45,510 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:45,518 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:45,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:45,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:45,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:45,529 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:45,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:45,540 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:45,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:45,541 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:45,556 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:45,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:45,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:45,566 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:45,566 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:45,566 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:45,567 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:45,567 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:45,567 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:45,567 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:45,568 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:45,568 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:45,569 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:45,569 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:45,570 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:45,570 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:45,570 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:45,570 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:45,570 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:45,570 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:45,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:45,571 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:45,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:45,571 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:45,571 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:45,571 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:45,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:45,572 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:45,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:45,573 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:45,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:45,573 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:45,573 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:45,574 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:45,574 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:45,575 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:45,575 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:45,578 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:45,579 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:45,579 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:45,581 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:45,581 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:45,583 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:45,583 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:45,585 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 27/400.
2025-08-04 20:26:45,686 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:45,687 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:45,688 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:26:45,688 - ClientAppLogger [Client 8] - INFO - [Client] Round 27: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:26:45,688 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:45,712 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0681, Avg D Loss: 0.7837
2025-08-04 20:26:45,713 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0681, Avg D Loss: 0.7837
2025-08-04 20:26:45,715 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:45,728 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3153, Threshold=0.3296, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:26:45,729 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:26:45,729 - ClientAppLogger [Client 8] - INFO - Fit completed for round 27. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 27, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0681382179260255, 'd_loss': 0.7837337613105774, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.14346694946289062, 'cpu_percent_fit': 29.28125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:26:45,729 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:26:50,986 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:50,986 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:50,986 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:50,986 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:50,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:50,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:51,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:51,245 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:51,328 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:51,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:51,344 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:51,438 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:51,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:51,443 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:51,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:51,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:51,457 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:51,458 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:51,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:51,458 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:51,467 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:51,470 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:51,473 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:51,475 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:51,478 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:51,481 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:51,484 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:51,486 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:51,489 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:51,490 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:51,493 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:51,505 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:51,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:51,510 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:51,511 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:51,515 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:51,515 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:51,523 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:51,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:51,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:51,539 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:51,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:51,549 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:51,550 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:51,550 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:51,550 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:51,550 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:51,551 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:51,551 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:51,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:51,551 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:51,551 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:51,553 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:51,553 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:51,553 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:51,553 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:51,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:51,555 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:51,555 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:51,555 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:51,555 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:51,555 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:51,555 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:51,556 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:51,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:51,556 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:51,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:51,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:51,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:51,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:51,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:51,561 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:51,561 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:51,562 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:51,563 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:51,564 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:51,565 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:51,565 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:51,567 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:51,567 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:51,567 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:51,568 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:51,580 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3347, Threshold=0.3496, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:26:51,580 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3347
2025-08-04 20:26:56,835 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:56,835 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:56,836 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:56,836 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:26:56,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:26:56,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:57,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:57,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:57,168 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:26:57,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:26:57,185 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:57,278 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:57,282 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:57,282 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:57,289 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:26:57,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:57,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:26:57,297 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:57,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:57,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:26:57,305 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:57,308 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:57,310 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:57,312 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:57,315 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:57,317 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:57,320 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:57,322 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:57,325 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:57,327 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:57,330 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:57,340 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:57,340 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:26:57,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:26:57,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:26:57,350 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:57,351 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:26:57,360 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:57,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:26:57,360 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:57,377 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:57,382 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:26:57,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:26:57,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:57,387 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:57,387 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:57,387 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:57,388 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:57,388 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:26:57,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:57,388 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:26:57,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:57,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:26:57,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:26:57,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:57,390 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:26:57,391 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:26:57,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:26:57,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:26:57,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:57,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:26:57,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:57,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:57,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:57,397 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:26:57,397 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:26:57,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:26:57,398 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:26:57,399 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:26:57,400 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:57,401 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:57,401 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:57,402 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 28/400.
2025-08-04 20:26:57,503 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:57,503 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:57,505 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:26:57,506 - ClientAppLogger [Client 8] - INFO - [Client] Round 28: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:26:57,506 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:57,533 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0467, Avg D Loss: 0.7850
2025-08-04 20:26:57,533 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0467, Avg D Loss: 0.7850
2025-08-04 20:26:57,533 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:57,547 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3174, Threshold=0.3319, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:26:57,547 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7932
2025-08-04 20:26:57,548 - ClientAppLogger [Client 8] - INFO - Fit completed for round 28. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 28, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0467430353164673, 'd_loss': 0.7849843919277191, 'post_fit_local_f1': 0.7931623931623931, 'fit_time_seconds': 0.1450655460357666, 'cpu_percent_fit': 28.18125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:26:57,548 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:27:02,810 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:02,810 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:02,811 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:02,811 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:27:02,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:27:02,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:03,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:03,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:03,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:27:03,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:27:03,138 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:03,229 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:03,284 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:03,284 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:03,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:27:03,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:03,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:27:03,296 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:03,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:03,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:27:03,305 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:03,307 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:03,309 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:03,312 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:03,314 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:03,316 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:03,319 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:03,321 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:03,324 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:03,326 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:03,328 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:03,336 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:03,337 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:27:03,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:27:03,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:27:03,347 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:03,347 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:27:03,358 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:03,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:27:03,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:03,374 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:03,379 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:27:03,385 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:27:03,386 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:03,386 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:03,386 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:03,386 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:03,387 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:03,387 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:27:03,387 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:03,387 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:27:03,388 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:03,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:27:03,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:27:03,389 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:03,389 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:27:03,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:03,390 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:03,391 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:03,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:27:03,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:27:03,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:27:03,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:27:03,392 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:27:03,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:27:03,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:27:03,393 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:27:03,393 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:27:03,394 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:27:03,395 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:27:03,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:27:03,396 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:03,396 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:27:03,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:03,397 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:03,398 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:03,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:27:03,402 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:27:03,402 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:27:03,402 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:27:03,405 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:27:03,405 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:03,407 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:03,407 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:03,409 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:03,409 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:03,409 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:03,410 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:03,421 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3312, Threshold=0.3445, Accuracy=0.6998, F1=0.7932, Precision=0.9587, Recall=0.6764
2025-08-04 20:27:03,421 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.6998, F1: 0.7932, Prec: 0.9587, Rec: 0.6764, Avg Anomaly Score: 0.3312
2025-08-04 20:27:14,688 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:14,688 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:14,688 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:14,688 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:27:14,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:27:14,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:14,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:14,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:15,024 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:27:15,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:27:15,038 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:15,120 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:15,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:15,125 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:15,129 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:27:15,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:15,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:27:15,138 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:15,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:15,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:27:15,147 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:15,149 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:15,152 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:15,154 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:15,156 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:15,158 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:15,161 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:15,163 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:15,166 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:15,168 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:15,170 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:15,179 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:15,179 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:27:15,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:27:15,184 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:27:15,190 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:15,190 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:27:15,200 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:15,200 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:27:15,201 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:15,215 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:15,220 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:27:15,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:27:15,224 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:15,224 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:15,225 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:15,225 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:15,225 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:15,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:27:15,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:15,226 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:27:15,226 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:27:15,228 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:27:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:15,228 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:27:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:15,228 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:27:15,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:27:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:27:15,229 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:27:15,229 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:27:15,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:27:15,230 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:27:15,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:27:15,230 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:27:15,230 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:27:15,230 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:27:15,231 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:27:15,231 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:15,231 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:27:15,231 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:15,231 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:15,232 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:15,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:27:15,236 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:27:15,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:27:15,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:27:15,239 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:27:15,239 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:15,240 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:15,240 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:15,242 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:15,242 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:15,242 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:15,243 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:15,254 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3342, Threshold=0.3478, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:27:15,254 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3342
2025-08-04 20:27:23,522 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:23,522 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:23,522 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:23,522 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:27:23,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:27:23,523 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:23,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:23,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:23,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:27:23,860 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:27:23,860 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:23,938 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:23,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:23,943 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:23,950 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:27:23,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:23,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:27:23,958 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:23,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:23,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:27:23,967 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:23,970 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:23,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:23,974 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:23,977 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:23,979 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:23,981 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:23,984 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:23,986 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:23,988 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:23,990 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:23,999 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:23,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:27:24,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:27:24,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:27:24,008 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:24,008 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:27:24,016 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:24,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:27:24,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:24,031 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:24,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:27:24,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:27:24,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:24,040 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:24,040 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:24,040 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:24,041 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:24,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:27:24,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:24,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:27:24,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:24,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:27:24,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:27:24,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:27:24,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:27:24,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:27:24,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:27:24,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:24,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:27:24,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:24,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:24,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:24,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:27:24,046 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:27:24,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:27:24,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:27:24,049 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:27:24,049 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:24,050 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:24,050 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:24,052 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 30/400.
2025-08-04 20:27:24,153 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:24,153 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:24,154 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 5, target: 0). GAN training with normal data only.
2025-08-04 20:27:24,155 - ClientAppLogger [Client 8] - INFO - [Client] Round 30: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:27:24,155 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:24,179 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0573, Avg D Loss: 0.7849
2025-08-04 20:27:24,180 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0573, Avg D Loss: 0.7849
2025-08-04 20:27:24,180 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:24,192 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3165, Threshold=0.3296, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:27:24,192 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:27:24,193 - ClientAppLogger [Client 8] - INFO - Fit completed for round 30. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 30, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.057333028316498, 'd_loss': 0.7848836243152618, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.14060068130493164, 'cpu_percent_fit': 28.1375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:27:24,193 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:27:32,454 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:32,455 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:32,455 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:32,455 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:27:32,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:27:32,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:32,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:32,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:32,818 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:27:32,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:27:32,837 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:32,943 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:32,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:32,950 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:32,954 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:27:32,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:32,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:27:32,965 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:32,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:32,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:27:32,975 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:32,977 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:32,980 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:32,982 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:32,985 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:32,987 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:32,990 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:32,992 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:32,995 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:32,997 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:33,000 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:33,012 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:33,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:27:33,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:27:33,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:27:33,025 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:33,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:27:33,038 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:33,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:27:33,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:33,060 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:33,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:27:33,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:27:33,072 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:33,072 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:33,072 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:33,073 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:33,073 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:33,073 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:27:33,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:33,073 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:27:33,074 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:33,075 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:27:33,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:27:33,075 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:33,075 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:27:33,075 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:27:33,076 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:33,077 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:27:33,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:33,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:33,078 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:33,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:27:33,082 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:27:33,082 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:27:33,082 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:27:33,085 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:27:33,085 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:33,086 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:33,087 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:33,088 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:33,088 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:33,088 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:33,089 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:33,101 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3351, Threshold=0.3509, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:27:33,102 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3351
2025-08-04 20:27:47,391 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:47,391 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:47,391 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:47,391 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:27:47,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:27:47,392 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:47,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:47,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:47,893 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:27:47,911 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:27:47,911 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:48,010 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:48,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:48,018 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:48,022 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:27:48,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:48,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:27:48,032 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:48,032 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:48,032 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:27:48,041 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:48,044 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:48,046 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:48,049 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:48,052 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:48,054 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:48,056 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:48,059 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:48,062 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:48,064 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:48,066 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:48,078 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:48,078 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:27:48,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:27:48,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:27:48,089 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:48,089 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:27:48,102 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:48,102 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:27:48,102 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:48,121 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:48,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:27:48,133 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:27:48,133 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:48,134 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:48,134 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:48,134 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:48,135 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:48,135 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:27:48,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:48,135 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:27:48,135 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:48,137 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:27:48,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:27:48,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:48,138 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:27:48,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:48,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:48,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:48,138 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:27:48,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:27:48,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:27:48,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:27:48,139 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:27:48,139 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:27:48,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:27:48,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:27:48,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:27:48,140 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:27:48,140 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:27:48,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:27:48,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:48,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:27:48,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:48,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:48,141 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:48,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:27:48,145 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:27:48,145 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:27:48,145 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:27:48,147 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:27:48,147 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:48,149 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:48,149 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:48,150 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:48,150 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:48,150 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:48,151 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:48,163 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3394, Threshold=0.3564, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:27:48,164 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3394
2025-08-04 20:27:53,412 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:53,412 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:53,413 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:53,413 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:27:53,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:27:53,413 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:53,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:53,631 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:53,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:27:53,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:27:53,730 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:53,820 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:53,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:53,824 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:53,829 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:27:53,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:53,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:27:53,836 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:53,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:53,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:27:53,845 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:53,847 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:53,850 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:53,852 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:53,855 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:53,857 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:53,859 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:53,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:53,864 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:53,866 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:53,869 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:53,878 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:53,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:27:53,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:27:53,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:27:53,888 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:53,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:27:53,898 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:53,899 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:27:53,899 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:53,914 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:53,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:27:53,923 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:27:53,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:53,924 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:53,924 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:53,925 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:53,925 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:53,925 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:27:53,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:53,926 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:27:53,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:53,927 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:27:53,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:27:53,928 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:53,928 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:27:53,928 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:53,928 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:53,928 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:27:53,929 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:27:53,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:27:53,930 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:27:53,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:27:53,930 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:27:53,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:27:53,930 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:53,931 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:27:53,931 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:53,931 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:53,931 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:53,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:27:53,935 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:27:53,935 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:27:53,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:27:53,937 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:27:53,937 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:53,938 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:53,939 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:53,940 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 32/400.
2025-08-04 20:27:54,041 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:54,041 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:54,042 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 6, target: 0). GAN training with normal data only.
2025-08-04 20:27:54,043 - ClientAppLogger [Client 8] - INFO - [Client] Round 32: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:27:54,043 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:54,067 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0729, Avg D Loss: 0.7850
2025-08-04 20:27:54,067 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0729, Avg D Loss: 0.7850
2025-08-04 20:27:54,068 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:54,079 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3205, Threshold=0.3366, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:27:54,080 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:27:54,080 - ClientAppLogger [Client 8] - INFO - Fit completed for round 32. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 32, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.072869634628296, 'd_loss': 0.7850018739700317, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.13993501663208008, 'cpu_percent_fit': 28.80625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:27:54,080 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:28:02,365 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:02,366 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:02,366 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:02,366 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:02,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:02,366 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:02,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:02,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:02,753 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:02,773 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:02,773 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:02,913 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:02,922 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:02,922 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:02,931 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:02,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:02,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:02,947 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:02,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:02,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:02,957 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:02,960 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,962 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:02,965 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:02,967 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:02,970 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:02,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:02,975 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:02,978 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:02,980 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:02,982 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:02,994 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:02,994 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:02,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:02,999 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:03,005 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:03,005 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:03,019 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:03,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:03,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:03,038 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:03,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:03,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:03,051 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:03,051 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:03,051 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:03,052 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:03,052 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:03,052 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:03,053 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:03,053 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:03,053 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:03,055 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:03,055 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:03,055 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:03,056 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:03,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:03,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:03,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:03,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:03,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:03,057 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:03,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:03,057 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:03,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:03,057 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:03,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:03,058 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:03,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:03,058 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:03,058 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:03,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:03,059 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:03,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:03,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:03,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:03,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:03,064 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:03,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:03,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:03,070 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:03,070 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:03,072 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:03,072 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:03,074 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:03,074 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:03,074 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:03,075 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:03,088 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3419, Threshold=0.3584, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:03,089 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3419
2025-08-04 20:28:11,340 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:11,340 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:11,340 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:11,340 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:11,340 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:11,340 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:11,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:11,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:11,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:11,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:11,648 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:11,731 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:11,738 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:11,738 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:11,742 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:11,749 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:11,749 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:11,749 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:11,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:11,750 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:11,758 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:11,761 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:11,763 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:11,765 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:11,768 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:11,770 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:11,772 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:11,774 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:11,777 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:11,779 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:11,781 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:11,789 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:11,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:11,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:11,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:11,799 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:11,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:11,808 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:11,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:11,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:11,823 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:11,828 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:11,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:11,833 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:11,833 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:11,834 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:11,834 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:11,834 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:11,835 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:11,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:11,835 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:11,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:11,836 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:11,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:11,837 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:11,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:11,837 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:11,837 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:11,838 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:11,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:11,839 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:11,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:11,839 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:11,839 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:11,840 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:11,840 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:11,840 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:11,840 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:11,841 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:11,841 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:11,841 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:11,841 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:11,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:11,844 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:11,844 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:11,845 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:11,846 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:11,847 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 33/400.
2025-08-04 20:28:11,948 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:11,948 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:11,949 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 6, target: 0). GAN training with normal data only.
2025-08-04 20:28:11,949 - ClientAppLogger [Client 8] - INFO - [Client] Round 33: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:28:11,949 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:11,972 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0519, Avg D Loss: 0.7868
2025-08-04 20:28:11,972 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0519, Avg D Loss: 0.7868
2025-08-04 20:28:11,973 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:11,986 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3234, Threshold=0.3390, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:11,987 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:28:11,987 - ClientAppLogger [Client 8] - INFO - Fit completed for round 33. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 33, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0519446849823, 'd_loss': 0.7868306159973144, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.13979816436767578, 'cpu_percent_fit': 28.75625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:28:11,987 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:28:17,260 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:17,260 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:17,260 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:17,260 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:17,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:17,260 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:17,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:17,572 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:17,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:17,690 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:17,691 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:17,845 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:17,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:17,855 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:17,868 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:17,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:17,884 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:17,884 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:17,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:17,885 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:17,895 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:17,898 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:17,900 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:17,903 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:17,906 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:17,908 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:17,911 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:17,914 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:17,917 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:17,919 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:17,922 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:17,934 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:17,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:17,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:17,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:17,946 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:17,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:17,971 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:17,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:17,972 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:17,994 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:18,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:18,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:18,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:18,024 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:18,024 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:18,024 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:18,024 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:18,025 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:18,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:18,025 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:18,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:18,027 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:18,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:18,027 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:18,027 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:18,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:18,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:18,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:18,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:18,028 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:18,028 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:18,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:18,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:18,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:18,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:18,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:18,029 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:18,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:18,030 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:18,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:18,031 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:18,031 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:18,031 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:18,032 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:18,032 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:18,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:18,036 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:18,036 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:18,036 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:18,042 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:18,042 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:18,044 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:18,044 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:18,046 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:18,046 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:18,047 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:18,047 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:18,061 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3405, Threshold=0.3566, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:18,061 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3405
2025-08-04 20:28:23,321 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:23,322 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:23,322 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:23,322 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:23,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:23,322 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:23,577 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:23,578 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:23,661 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:23,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:23,674 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:23,763 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:23,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:23,771 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:23,776 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:23,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:23,784 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:23,784 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:23,785 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:23,785 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:23,793 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:23,796 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:23,798 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:23,800 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:23,803 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:23,805 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:23,808 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:23,810 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:23,813 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:23,814 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:23,817 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:23,826 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:23,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:23,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:23,831 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:23,835 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:23,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:23,846 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:23,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:23,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:23,862 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:23,867 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:23,872 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:23,872 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:23,872 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:23,872 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:23,873 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:23,873 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:23,873 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:23,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:23,873 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:23,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:23,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:23,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:23,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:23,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:23,875 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:23,876 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:23,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:23,877 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:23,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:23,877 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:23,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:23,878 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:23,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:23,878 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:23,878 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:23,879 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:23,879 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:23,879 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:23,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:23,879 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:23,880 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:23,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:23,882 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:23,882 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:23,883 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:23,883 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:23,885 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 34/400.
2025-08-04 20:28:23,986 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:23,986 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:23,987 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 6, target: 0). GAN training with normal data only.
2025-08-04 20:28:23,987 - ClientAppLogger [Client 8] - INFO - [Client] Round 34: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:28:23,987 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:24,011 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0610, Avg D Loss: 0.7833
2025-08-04 20:28:24,012 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0610, Avg D Loss: 0.7833
2025-08-04 20:28:24,012 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:24,023 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3213, Threshold=0.3366, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:24,023 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:28:24,023 - ClientAppLogger [Client 8] - INFO - Fit completed for round 34. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 34, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.060995101928711, 'd_loss': 0.7833169281482697, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.1384139060974121, 'cpu_percent_fit': 28.38125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:28:24,023 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:28:29,295 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,295 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:29,295 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:29,295 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:29,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:29,296 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:29,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:29,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:29,740 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:29,771 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:29,771 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:29,913 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:29,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:29,925 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:29,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:29,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:29,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:29,979 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:29,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:29,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:29,992 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:29,995 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:29,998 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:30,000 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:30,003 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:30,006 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:30,009 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,012 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:30,015 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:30,017 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:30,020 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:30,034 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:30,035 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:30,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:30,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:30,048 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:30,065 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:30,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,087 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,094 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:30,102 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:30,103 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,103 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,103 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,104 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,104 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,104 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:30,104 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,104 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:30,105 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,106 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:30,107 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,107 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,108 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,108 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,108 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,108 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,108 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:30,109 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:30,109 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:30,109 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:30,109 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:30,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:30,110 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:30,110 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:30,111 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:30,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:30,111 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:30,112 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:30,112 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,112 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:30,112 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,112 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,113 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,117 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:30,117 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:30,118 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:30,118 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:30,125 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:30,125 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,127 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,127 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:30,129 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,129 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,129 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,130 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,142 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3432, Threshold=0.3599, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:30,143 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3432
2025-08-04 20:28:44,404 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:44,404 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:44,404 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:44,404 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:44,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:44,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:44,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:44,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:44,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:44,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:44,802 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:44,901 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:44,907 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:44,907 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:44,924 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:44,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:44,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:44,952 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:44,952 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:44,952 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:44,963 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:44,968 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:44,973 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:44,976 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:44,978 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:44,981 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:44,985 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:44,990 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:44,993 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:44,996 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:44,998 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:45,008 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:45,008 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:45,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:45,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:45,018 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:45,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:45,029 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:45,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:45,029 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:45,046 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:45,051 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:45,059 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:45,059 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:45,059 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:45,059 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:45,059 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:45,060 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:45,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:45,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:45,060 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:45,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:45,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:45,062 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:45,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:45,062 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:45,062 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:45,063 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:45,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:45,064 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:45,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:45,064 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:45,064 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:45,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:45,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:45,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:45,065 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:45,065 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:45,066 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:45,066 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:45,066 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:45,069 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:45,069 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:45,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:45,073 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:45,074 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:45,075 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:45,075 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:45,077 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:45,077 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:45,077 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:45,077 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:45,089 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3395, Threshold=0.3566, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:45,089 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3395
2025-08-04 20:28:50,345 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:50,345 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:50,346 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:50,346 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:50,346 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:50,346 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:50,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:50,602 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:50,685 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:50,700 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:50,700 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:50,791 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:50,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:50,798 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:50,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:50,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:50,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:50,816 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:50,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:50,816 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:50,824 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:50,827 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:50,829 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:50,832 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:50,835 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:50,838 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:50,841 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:50,844 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:50,849 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:50,853 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:50,856 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:50,866 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:50,866 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:50,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:50,871 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:50,877 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:50,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:50,888 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:50,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:50,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:50,905 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:50,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:50,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:50,915 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:50,915 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:50,915 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:50,916 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:50,916 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:50,916 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:50,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:50,916 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:50,916 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:50,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:50,918 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:50,918 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:50,919 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:50,920 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:50,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:50,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:50,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:50,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:50,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:50,921 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:50,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:50,925 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:50,925 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:50,925 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:50,928 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:50,928 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:50,929 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:50,929 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:50,931 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 36/400.
2025-08-04 20:28:51,032 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:51,032 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:51,034 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 6, target: 0). GAN training with normal data only.
2025-08-04 20:28:51,035 - ClientAppLogger [Client 8] - INFO - [Client] Round 36: Training GAN with 3 samples (3 normal, 0 anomalous).
2025-08-04 20:28:51,035 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:51,061 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0567, Avg D Loss: 0.7646
2025-08-04 20:28:51,061 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0567, Avg D Loss: 0.7646
2025-08-04 20:28:51,061 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:51,072 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3203, Threshold=0.3363, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:51,073 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:28:51,073 - ClientAppLogger [Client 8] - INFO - Fit completed for round 36. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 36, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.056740975379944, 'd_loss': 0.7645585358142852, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.14189720153808594, 'cpu_percent_fit': 27.5375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3}
2025-08-04 20:28:51,073 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:28:56,335 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:56,336 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:56,336 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:56,336 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:28:56,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:28:56,336 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:56,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:56,594 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:56,679 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:28:56,697 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:28:56,697 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:56,800 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:56,807 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:56,807 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:56,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:28:56,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:56,824 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:28:56,825 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:56,825 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:56,825 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:28:56,835 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:56,838 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:56,840 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:56,843 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:56,846 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:56,849 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:56,851 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:56,854 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:56,857 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:56,858 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:56,861 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:56,875 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:56,875 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:28:56,880 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:28:56,881 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:28:56,888 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:56,889 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:28:56,909 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:56,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:28:56,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:56,928 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:56,933 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:28:56,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:28:56,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:56,939 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:56,939 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:56,940 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:56,940 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:56,940 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:28:56,940 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:56,941 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:28:56,941 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:56,942 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:28:56,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:28:56,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:56,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:28:56,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:56,943 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:56,944 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:56,944 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:28:56,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:28:56,944 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:28:56,944 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:28:56,944 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:28:56,945 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:28:56,945 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:28:56,945 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:28:56,945 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:28:56,945 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:28:56,946 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:28:56,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:28:56,946 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:56,947 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:28:56,947 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:56,947 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:56,948 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:56,951 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:28:56,951 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:28:56,952 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:28:56,952 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:28:56,954 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:28:56,955 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:56,956 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:56,957 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:56,959 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:56,959 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:56,959 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:56,960 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:56,976 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3439, Threshold=0.3613, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:28:56,976 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3439
2025-08-04 20:29:14,250 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:14,250 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:14,251 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:14,251 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:14,251 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:14,251 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:14,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:14,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:14,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:14,543 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:14,544 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:14,640 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:14,648 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:14,648 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:14,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:14,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:14,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:14,665 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:14,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:14,665 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:14,675 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:14,678 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:14,680 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:14,683 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:14,685 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:14,688 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:14,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:14,693 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:14,695 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:14,697 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:14,699 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:14,709 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:14,709 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:14,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:14,714 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:14,719 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:14,719 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:14,729 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:14,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:14,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:14,746 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:14,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:14,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:14,756 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:14,756 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:14,757 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:14,757 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:14,757 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:14,757 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:14,757 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:14,758 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:14,758 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:14,759 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:14,759 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:14,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:14,760 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:14,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:14,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:14,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:14,760 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:14,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:14,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:14,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:14,761 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:14,761 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:14,762 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:14,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:14,762 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:14,762 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:14,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:14,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:14,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:14,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:14,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:14,763 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:14,764 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:14,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:14,767 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:14,767 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:14,767 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:14,771 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:14,771 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:14,772 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:14,772 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:14,774 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:14,774 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:14,774 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:14,775 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:14,786 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3408, Threshold=0.3591, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:14,786 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3408
2025-08-04 20:29:20,037 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:20,037 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:20,037 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:20,037 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:20,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:20,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:20,254 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:20,255 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:20,335 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:20,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:20,351 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:20,433 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:20,437 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:20,438 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:20,442 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:20,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:20,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:20,450 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:20,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:20,450 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:20,458 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:20,461 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:20,463 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:20,465 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:20,467 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:20,470 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:20,472 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:20,474 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:20,477 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:20,479 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:20,481 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:20,490 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:20,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:20,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:20,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:20,500 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:20,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:20,510 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:20,510 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:20,510 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:20,525 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:20,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:20,533 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:20,534 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:20,534 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:20,534 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:20,534 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:20,534 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:20,535 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:20,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:20,535 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:20,535 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:20,536 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:20,536 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:20,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:20,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:20,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:20,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:20,537 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:20,538 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:20,539 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:20,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:20,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:20,540 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:20,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:20,544 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:20,544 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:20,544 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:20,548 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:20,548 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:20,549 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:20,549 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:20,550 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 38/400.
2025-08-04 20:29:20,651 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:20,651 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:20,652 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: No anomalies to add (available: 6, target: 0). GAN training with normal data only.
2025-08-04 20:29:20,653 - ClientAppLogger [Client 8] - INFO - [Client] Round 38: Training GAN with 3 samples (3 normal, 0 anomalous).
2025-08-04 20:29:20,653 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:20,676 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0617, Avg D Loss: 0.7604
2025-08-04 20:29:20,678 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0617, Avg D Loss: 0.7604
2025-08-04 20:29:20,678 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:20,689 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3209, Threshold=0.3376, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:20,690 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:29:20,690 - ClientAppLogger [Client 8] - INFO - Fit completed for round 38. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 38, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0617124795913697, 'd_loss': 0.7603535294532776, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.13954854011535645, 'cpu_percent_fit': 28.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3}
2025-08-04 20:29:20,690 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:29:25,937 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:25,937 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:25,937 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:25,937 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:25,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:25,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:26,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:26,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:26,228 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:26,243 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:26,243 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:26,334 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:26,345 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:26,345 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:26,350 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:26,357 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:26,357 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:26,357 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:26,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:26,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:26,367 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:26,370 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:26,372 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:26,374 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:26,377 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:26,379 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:26,381 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:26,384 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:26,386 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:26,388 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:26,390 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:26,400 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:26,400 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:26,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:26,405 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:26,410 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:26,410 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:26,422 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:26,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:26,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:26,439 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:26,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:26,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:26,449 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:26,449 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:26,450 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:26,450 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:26,450 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:26,450 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:26,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:26,451 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:26,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:26,452 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:26,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:26,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:26,453 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:26,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:26,453 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:26,454 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:26,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:26,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:26,455 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:26,455 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:26,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:26,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:26,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:26,456 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:26,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:26,456 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:26,457 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:26,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:26,460 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:26,460 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:26,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:26,463 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:26,463 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:26,464 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:26,464 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:26,466 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:26,466 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:26,466 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:26,467 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:26,479 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3374, Threshold=0.3562, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:26,479 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3374
2025-08-04 20:29:31,734 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:31,734 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:31,734 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:31,734 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:31,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:31,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:31,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:31,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:32,030 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:32,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:32,046 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:32,132 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:32,137 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:32,137 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:32,141 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:32,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:32,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:32,147 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:32,147 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:32,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:32,155 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:32,158 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:32,161 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:32,163 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:32,166 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:32,168 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:32,170 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:32,173 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:32,176 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:32,177 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:32,180 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:32,188 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:32,188 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:32,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:32,193 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:32,198 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:32,198 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:32,208 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:32,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:32,208 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:32,222 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:32,227 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:32,231 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:32,231 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:32,231 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:32,231 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:32,232 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:32,232 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:32,232 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:32,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:32,232 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:32,232 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:32,234 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:32,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:32,234 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:32,234 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:32,234 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:32,235 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:32,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:32,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:32,236 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:32,236 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:32,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:32,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:32,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:32,237 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:32,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:32,237 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:32,238 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:32,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:32,242 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:32,242 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:32,242 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:32,244 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:32,244 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:32,245 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:32,245 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:32,247 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 39/400.
2025-08-04 20:29:32,348 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:32,348 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:32,350 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:29:32,350 - ClientAppLogger [Client 8] - INFO - [Client] Round 39: Training GAN with 5 samples (4 normal, 1 anomalous).
2025-08-04 20:29:32,350 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:32,374 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0716, Avg D Loss: 0.9092
2025-08-04 20:29:32,376 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0716, Avg D Loss: 0.9092
2025-08-04 20:29:32,376 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:32,388 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3201, Threshold=0.3382, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:32,388 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:29:32,388 - ClientAppLogger [Client 8] - INFO - Fit completed for round 39. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 39, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0716296434402466, 'd_loss': 0.9091675043106079, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.1413741111755371, 'cpu_percent_fit': 29.25625, 'ram_mb_fit': 0.16015625, 'accumulated_train_samples_this_round': 5}
2025-08-04 20:29:32,388 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:29:37,648 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:37,649 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:37,649 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:37,649 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:37,649 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:37,650 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:37,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:37,879 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:37,963 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:37,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:37,978 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:38,064 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:38,069 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:38,069 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:38,073 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:38,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:38,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:38,080 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:38,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:38,080 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:38,089 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:38,092 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:38,094 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:38,097 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:38,099 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:38,102 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:38,104 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:38,106 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:38,109 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:38,111 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:38,113 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:38,122 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:38,122 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:38,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:38,127 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:38,132 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:38,132 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:38,141 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:38,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:38,142 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:38,156 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:38,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:38,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:38,166 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:38,166 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:38,166 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:38,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:38,169 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:38,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:38,169 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:38,169 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:38,170 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:38,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:38,171 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:38,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:38,171 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:38,171 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:38,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:38,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:38,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:38,172 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:38,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:38,172 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:38,173 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:38,173 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:38,176 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:38,176 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:38,176 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:38,179 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:38,179 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:38,181 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:38,181 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:38,182 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:38,183 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:38,183 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:38,183 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:38,195 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3402, Threshold=0.3583, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:38,195 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3402
2025-08-04 20:29:43,472 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:43,472 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:43,473 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:43,474 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:43,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:43,475 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:43,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:43,713 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:43,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:43,826 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:43,826 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:43,924 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:43,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:43,930 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:43,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:43,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:43,942 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:43,943 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:43,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:43,943 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:43,952 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:43,956 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:43,959 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:43,962 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:43,965 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:43,967 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:43,970 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:43,972 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:43,975 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:43,977 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:43,979 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:43,989 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:43,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:43,994 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:43,994 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:43,999 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:44,000 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:44,011 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:44,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:44,012 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:44,027 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:44,032 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:44,037 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:44,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:44,038 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:44,038 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:44,038 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:44,038 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:44,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:44,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:44,039 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:44,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:44,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:44,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:44,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:44,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:44,042 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:44,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:44,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:44,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:44,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:44,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:44,043 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:44,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:44,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:44,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:44,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:44,044 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:44,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:44,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:44,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:44,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:44,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:44,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:44,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:44,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:44,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:44,050 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:44,050 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:44,050 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:44,053 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:44,053 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:44,055 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:44,055 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:44,056 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 40/400.
2025-08-04 20:29:44,158 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:44,158 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:44,159 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:29:44,160 - ClientAppLogger [Client 8] - INFO - [Client] Round 40: Training GAN with 5 samples (4 normal, 1 anomalous).
2025-08-04 20:29:44,160 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:44,189 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0634, Avg D Loss: 0.9105
2025-08-04 20:29:44,189 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0634, Avg D Loss: 0.9105
2025-08-04 20:29:44,192 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:44,205 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3226, Threshold=0.3401, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:44,205 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:29:44,205 - ClientAppLogger [Client 8] - INFO - Fit completed for round 40. Duration: 0.15s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 40, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0634048223495483, 'd_loss': 0.9104856014251709, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.14849472045898438, 'cpu_percent_fit': 28.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 5}
2025-08-04 20:29:44,205 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 20:29:52,469 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:52,469 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:52,469 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:52,469 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:52,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:52,469 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:52,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:52,701 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:52,785 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:52,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:52,802 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:52,898 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:52,904 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:52,904 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:52,910 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:52,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:52,920 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:52,921 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:52,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:52,921 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:52,929 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:52,933 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:52,935 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:52,937 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:52,940 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:52,943 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:52,945 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:52,948 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:52,951 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:52,952 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:52,955 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:52,965 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:52,965 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:52,969 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:52,970 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:52,975 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:52,976 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:52,986 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:52,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:52,987 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:53,002 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:53,006 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:53,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:53,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:53,011 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:53,012 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:53,012 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:53,012 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:53,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:53,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:53,013 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:53,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:53,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:53,014 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:53,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:53,015 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:53,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:53,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:53,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:53,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:53,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:53,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:53,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:53,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:53,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:53,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:53,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:53,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:53,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:53,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:53,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:53,023 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:53,023 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:53,023 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:53,025 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:53,025 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:53,026 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:53,027 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:53,028 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:53,029 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:53,029 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:53,029 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:53,041 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3469, Threshold=0.3658, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:53,041 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7047, F1: 0.7966, Prec: 0.9628, Rec: 0.6793, Avg Anomaly Score: 0.3469
2025-08-04 20:29:58,292 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:58,292 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:58,292 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:58,292 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 20:29:58,292 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 20:29:58,292 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:58,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:58,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:58,592 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 20:29:58,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 20:29:58,606 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:58,684 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:58,689 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:58,689 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:58,696 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 20:29:58,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:58,704 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 20:29:58,705 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:58,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:58,705 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 20:29:58,713 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:58,716 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:58,718 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:58,720 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:58,723 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:58,725 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:58,727 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:58,730 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:58,733 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:58,735 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:58,737 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:58,746 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:58,746 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 20:29:58,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 20:29:58,751 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 20:29:58,755 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:58,755 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 20:29:58,764 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:58,764 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 20:29:58,764 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:58,779 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:58,783 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 20:29:58,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 20:29:58,788 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:58,788 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:58,788 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:58,789 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:58,789 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:58,789 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 20:29:58,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:58,789 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 20:29:58,790 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:58,791 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 20:29:58,791 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 20:29:58,791 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:58,791 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 20:29:58,792 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 20:29:58,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 20:29:58,794 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:58,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 20:29:58,794 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:58,794 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:58,794 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:58,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 20:29:58,798 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 20:29:58,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 20:29:58,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 20:29:58,800 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 20:29:58,800 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:58,802 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:58,802 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:58,803 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 41/400.
2025-08-04 20:29:58,904 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:58,904 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:58,905 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:29:58,905 - ClientAppLogger [Client 8] - INFO - [Client] Round 41: Training GAN with 5 samples (4 normal, 1 anomalous).
2025-08-04 20:29:58,906 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:58,928 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0683, Avg D Loss: 0.9098
2025-08-04 20:29:58,930 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0683, Avg D Loss: 0.9098
2025-08-04 20:29:58,930 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:58,941 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.3290, Threshold=0.3469, Accuracy=0.7047, F1=0.7966, Precision=0.9628, Recall=0.6793
2025-08-04 20:29:58,941 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.7966
2025-08-04 20:29:58,942 - ClientAppLogger [Client 8] - INFO - Fit completed for round 41. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 41, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.068290281295776, 'd_loss': 0.9098282158374786, 'post_fit_local_f1': 0.7965811965811965, 'fit_time_seconds': 0.13860845565795898, 'cpu_percent_fit': 29.5625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 5}
2025-08-04 20:29:58,942 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
