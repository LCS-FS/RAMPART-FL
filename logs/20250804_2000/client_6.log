2025-08-04 20:21:14,591 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:14,591 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:14,592 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:14,592 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:21:14,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:21:14,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:14,947 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:14,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:15,080 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:21:15,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:21:15,117 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:15,293 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:15,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:15,299 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:15,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:21:15,313 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:15,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:21:15,314 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:15,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:15,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:21:15,325 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:15,331 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:15,335 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:15,337 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:15,340 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:15,343 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:15,346 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:15,349 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:15,352 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:15,354 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:15,357 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:15,369 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:15,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:21:15,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:21:15,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:21:15,380 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:15,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:21:15,395 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:15,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:21:15,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:15,414 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:15,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:21:15,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:21:15,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:15,429 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:15,429 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:15,430 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:15,430 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:15,430 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:21:15,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:15,430 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:21:15,431 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:15,432 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:21:15,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:21:15,433 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:15,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:21:15,433 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:15,433 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:15,433 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:15,434 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:21:15,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:21:15,434 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:21:15,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:21:15,435 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:21:15,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:21:15,436 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:21:15,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:21:15,436 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:21:15,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:21:15,436 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:21:15,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:21:15,437 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:15,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:21:15,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:15,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:15,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:15,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:21:15,439 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:21:15,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:21:15,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:21:15,446 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:21:15,446 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:15,448 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:15,448 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:15,450 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:15,450 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:15,450 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:15,451 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:15,461 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5014, Threshold=0.5012, Accuracy=0.5333, F1=0.6797, Precision=0.8254, Recall=0.5778
2025-08-04 20:21:15,461 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5333, F1: 0.6797, Prec: 0.8254, Rec: 0.5778, Avg Anomaly Score: 0.5014
2025-08-04 20:21:29,851 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:29,851 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:29,851 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:29,852 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:21:29,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:21:29,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:30,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:30,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:30,345 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:21:30,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:21:30,382 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:30,477 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:30,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:30,485 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:30,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:21:30,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:30,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:21:30,498 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:30,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:30,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:21:30,507 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:30,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,511 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:30,514 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:30,516 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:30,519 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:30,521 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,524 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:30,527 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:30,528 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:30,531 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:30,540 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:30,540 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:21:30,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:21:30,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:21:30,550 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:21:30,560 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:21:30,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,580 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:21:30,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:21:30,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,593 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,593 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,594 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,594 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:21:30,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,595 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:21:30,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:21:30,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:21:30,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:21:30,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:21:30,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:21:30,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:21:30,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:21:30,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:21:30,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:21:30,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,600 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,600 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:21:30,600 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:21:30,600 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:21:30,601 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:21:30,607 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:21:30,607 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,608 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,608 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:30,609 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,610 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,610 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,610 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,618 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5014, Threshold=0.5012, Accuracy=0.5333, F1=0.6797, Precision=0.8254, Recall=0.5778
2025-08-04 20:21:30,619 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5333, F1: 0.6797, Prec: 0.8254, Rec: 0.5778, Avg Anomaly Score: 0.5014
2025-08-04 20:21:41,959 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,959 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:41,959 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:41,959 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:21:41,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:21:41,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:42,447 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:42,447 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:42,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:21:42,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:21:42,617 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,777 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,784 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:21:42,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,800 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:21:42,809 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,813 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,815 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,818 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,821 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,823 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,826 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,829 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,831 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,833 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,836 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,846 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:21:42,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:21:42,859 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:21:42,872 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:21:42,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,890 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:21:42,905 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:21:42,905 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,905 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,906 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,906 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,906 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,907 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:21:42,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,907 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:21:42,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:21:42,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:21:42,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:21:42,911 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:21:42,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:21:42,911 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:21:42,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:21:42,911 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:21:42,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:21:42,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:21:42,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:21:42,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:21:42,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:21:42,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:21:42,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:21:42,914 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:21:42,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:21:42,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:21:42,920 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:21:42,920 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,922 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,922 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:42,923 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,923 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,924 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,924 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,932 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5076, Threshold=0.5076, Accuracy=0.6095, F1=0.7320, Precision=0.8889, Recall=0.6222
2025-08-04 20:21:42,934 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6095, F1: 0.7320, Prec: 0.8889, Rec: 0.6222, Avg Anomaly Score: 0.5076
2025-08-04 20:21:54,268 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:54,268 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:21:54,268 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:21:54,268 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:21:54,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:21:54,269 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,831 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,832 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:21:54,991 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:21:54,991 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:55,145 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:55,152 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:55,154 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:55,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:21:55,173 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:55,174 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:21:55,174 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:55,175 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:55,175 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:21:55,184 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:55,188 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,190 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:55,192 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:55,196 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:55,199 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:55,202 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,204 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:55,207 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:55,209 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:55,212 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:55,222 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:55,222 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:21:55,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:21:55,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:21:55,234 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:55,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:55,272 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:55,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:21:55,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:21:55,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:55,286 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:55,287 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:55,287 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:55,288 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:55,289 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:21:55,289 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:55,289 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:21:55,289 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:55,291 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:21:55,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:21:55,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:55,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:21:55,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:55,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:55,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:55,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:21:55,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:21:55,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:21:55,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:21:55,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:21:55,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:21:55,295 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:21:55,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:21:55,296 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:21:55,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:21:55,296 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:21:55,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:21:55,296 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:55,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:21:55,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:55,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:55,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:55,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:21:55,298 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:21:55,298 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:21:55,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:21:55,306 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:21:55,306 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:55,308 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:55,308 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:21:55,309 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:55,309 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:55,310 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:55,311 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:55,321 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5082, Threshold=0.5079, Accuracy=0.5333, F1=0.6797, Precision=0.8254, Recall=0.5778
2025-08-04 20:21:55,321 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5333, F1: 0.6797, Prec: 0.8254, Rec: 0.5778, Avg Anomaly Score: 0.5082
2025-08-04 20:22:09,645 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,645 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:09,646 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:09,646 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:22:09,646 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:22:09,646 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:10,123 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:10,123 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:10,218 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:22:10,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:22:10,261 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:10,387 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:10,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:10,396 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:10,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:22:10,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:10,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:22:10,418 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:10,418 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:10,418 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:22:10,430 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:10,433 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,436 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:10,439 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:10,441 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:10,444 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:10,447 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,450 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:10,454 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:10,457 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:10,460 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:10,473 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:10,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:22:10,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:22:10,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:22:10,489 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:10,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:22:10,504 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:10,505 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:22:10,505 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:10,530 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:10,536 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:22:10,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:22:10,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:10,547 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:10,547 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:10,547 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:10,548 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:10,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:22:10,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:10,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:22:10,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:10,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:22:10,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:22:10,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:10,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:22:10,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:10,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:10,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:10,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:22:10,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:22:10,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:22:10,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:22:10,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:22:10,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:22:10,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:22:10,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:22:10,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:22:10,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:22:10,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:22:10,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:22:10,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:10,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:22:10,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:10,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:10,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:10,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:22:10,556 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:22:10,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:22:10,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:22:10,562 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:22:10,562 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,563 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,563 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:10,564 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,564 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,565 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,566 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,574 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5081, Threshold=0.5075, Accuracy=0.5333, F1=0.6797, Precision=0.8254, Recall=0.5778
2025-08-04 20:22:10,574 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5333, F1: 0.6797, Prec: 0.8254, Rec: 0.5778, Avg Anomaly Score: 0.5081
2025-08-04 20:22:24,880 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,881 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:24,881 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:24,881 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:22:24,881 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:22:24,881 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:25,311 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:25,311 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:25,408 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:22:25,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:22:25,451 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:25,589 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:25,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:25,596 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:25,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:22:25,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:25,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:22:25,612 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:25,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:25,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:22:25,622 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:25,625 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,628 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:25,631 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:25,635 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:25,639 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:25,643 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,647 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:25,651 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:25,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:25,658 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:25,671 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:25,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:22:25,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:22:25,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:22:25,682 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:25,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:22:25,694 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:25,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:22:25,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:25,713 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:25,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:22:25,726 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:22:25,727 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:25,727 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:25,727 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:25,727 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:25,728 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:25,728 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:22:25,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:25,728 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:22:25,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:25,730 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:22:25,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:22:25,730 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:25,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:22:25,731 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:22:25,732 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:22:25,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:22:25,732 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:22:25,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:22:25,732 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:22:25,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:22:25,733 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:22:25,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:22:25,733 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:25,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:22:25,733 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:25,733 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:25,734 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:25,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:22:25,734 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:22:25,734 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:22:25,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:22:25,740 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:22:25,740 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:25,741 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:25,741 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:25,743 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:25,743 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:25,743 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:25,744 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:25,752 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5047, Threshold=0.5034, Accuracy=0.5143, F1=0.6667, Precision=0.8095, Recall=0.5667
2025-08-04 20:22:25,752 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5143, F1: 0.6667, Prec: 0.8095, Rec: 0.5667, Avg Anomaly Score: 0.5047
2025-08-04 20:22:40,066 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:40,066 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:40,066 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:40,066 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:22:40,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:22:40,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:40,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:40,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,744 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:22:40,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:22:40,789 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,907 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,919 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,919 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,929 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:22:40,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,942 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,942 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,942 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:22:40,953 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,957 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,959 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:40,961 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:40,965 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:40,967 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:40,970 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,973 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:40,975 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:40,978 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:40,980 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:40,993 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:40,993 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:22:40,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:22:40,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:22:41,005 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:41,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:22:41,019 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:41,020 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:22:41,020 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:41,039 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:41,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:22:41,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:22:41,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:41,056 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:41,056 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:41,057 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:41,057 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:41,057 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:22:41,058 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:41,058 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:22:41,058 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:41,059 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:22:41,060 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:22:41,060 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:41,060 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:22:41,061 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:41,061 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:41,061 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:41,061 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:22:41,061 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:22:41,061 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:22:41,062 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:22:41,062 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:22:41,062 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:22:41,062 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:22:41,062 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:22:41,063 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:22:41,063 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:22:41,063 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:22:41,063 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:22:41,063 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:41,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:22:41,064 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:41,064 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:41,064 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:41,065 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:22:41,065 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:22:41,065 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:22:41,065 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:22:41,068 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:22:41,068 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:41,070 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:41,070 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:41,072 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:41,072 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:41,072 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:41,073 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:41,082 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4960, Threshold=0.4938, Accuracy=0.5143, F1=0.6667, Precision=0.8095, Recall=0.5667
2025-08-04 20:22:41,082 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5143, F1: 0.6667, Prec: 0.8095, Rec: 0.5667, Avg Anomaly Score: 0.4960
2025-08-04 20:22:52,353 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:52,354 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:22:52,354 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:22:52,354 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:22:52,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:22:52,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:52,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:52,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:52,795 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:22:52,834 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:22:52,835 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:52,958 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:52,966 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:52,966 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:52,974 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:22:52,986 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:52,986 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:22:52,987 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:52,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:52,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:22:52,999 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:53,002 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:53,004 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:53,006 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:53,009 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:53,012 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:53,015 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:53,017 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:53,020 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:53,022 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:53,025 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:53,036 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:53,036 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:22:53,064 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:53,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:22:53,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:53,087 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:53,093 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:22:53,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:22:53,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:53,103 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:53,103 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:53,104 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:53,107 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:53,107 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:22:53,107 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:53,108 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:22:53,108 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:53,109 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:22:53,109 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:22:53,110 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:53,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:22:53,112 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:53,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:53,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:53,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:22:53,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:22:53,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:22:53,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:22:53,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:22:53,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:22:53,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:22:53,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:22:53,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:22:53,115 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:22:53,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:22:53,115 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:22:53,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:53,115 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:22:53,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:53,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:53,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:53,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:22:53,116 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:22:53,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:22:53,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:22:53,121 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:22:53,122 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:53,123 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:53,123 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:22:53,125 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:53,128 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:53,128 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:53,129 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:53,137 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4801, Threshold=0.4766, Accuracy=0.5143, F1=0.6667, Precision=0.8095, Recall=0.5667
2025-08-04 20:22:53,137 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5143, F1: 0.6667, Prec: 0.8095, Rec: 0.5667, Avg Anomaly Score: 0.4801
2025-08-04 20:23:07,438 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:07,438 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:07,439 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:07,439 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:23:07,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:23:07,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:07,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:07,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:07,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:23:07,841 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:23:07,841 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:07,933 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:07,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:07,940 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:07,945 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:23:07,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:07,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:23:07,953 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:07,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:07,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:23:07,961 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:07,964 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,966 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:07,968 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:07,971 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:07,973 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:07,976 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,978 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:07,981 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:07,983 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:07,985 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:07,995 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:07,995 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:23:08,000 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:23:08,000 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:23:08,005 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:08,005 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:23:08,013 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:08,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:23:08,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:08,029 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:08,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:23:08,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:23:08,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:08,039 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:08,040 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:08,040 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:08,040 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:08,040 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:23:08,040 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:08,041 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:23:08,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:08,042 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:23:08,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:23:08,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:23:08,044 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:23:08,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:23:08,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:23:08,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:23:08,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:08,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:23:08,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:08,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:08,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:08,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:23:08,046 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:23:08,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:23:08,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:23:08,050 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:23:08,050 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:08,051 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:08,052 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:08,053 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:08,053 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:08,053 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:08,054 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:08,062 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4561, Threshold=0.4510, Accuracy=0.5143, F1=0.6667, Precision=0.8095, Recall=0.5667
2025-08-04 20:23:08,062 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5143, F1: 0.6667, Prec: 0.8095, Rec: 0.5667, Avg Anomaly Score: 0.4561
2025-08-04 20:23:19,374 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:19,374 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:19,374 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:19,375 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:23:19,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:23:19,376 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,827 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:19,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:23:19,979 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:23:19,979 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:20,127 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:20,137 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:20,138 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:20,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:23:20,155 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:20,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:23:20,156 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:20,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:20,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:23:20,165 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:20,168 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,170 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:20,173 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:20,176 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:20,180 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:20,183 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,186 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:20,190 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:20,191 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:20,194 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:20,204 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:20,205 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:23:20,209 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:23:20,209 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:23:20,215 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:20,215 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:23:20,228 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:20,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:23:20,229 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:20,245 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:20,251 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:23:20,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:23:20,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:20,256 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:20,256 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:20,256 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:20,257 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:20,257 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:23:20,257 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:20,257 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:23:20,257 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:20,259 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:23:20,259 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:23:20,260 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:20,260 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:23:20,260 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:20,260 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:20,260 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:20,260 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:23:20,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:23:20,261 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:23:20,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:23:20,261 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:23:20,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:23:20,261 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:20,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:23:20,263 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:20,263 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:20,263 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:20,263 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:23:20,264 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:23:20,264 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:23:20,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:23:20,273 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:23:20,273 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:20,274 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:20,274 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:20,276 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:20,276 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:20,276 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:20,277 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:20,285 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4164, Threshold=0.4094, Accuracy=0.5143, F1=0.6667, Precision=0.8095, Recall=0.5667
2025-08-04 20:23:20,286 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5143, F1: 0.6667, Prec: 0.8095, Rec: 0.5667, Avg Anomaly Score: 0.4164
2025-08-04 20:23:31,579 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:31,579 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:31,580 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:31,580 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:23:31,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:23:31,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:31,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:31,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:32,068 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:23:32,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:23:32,115 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:32,233 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:32,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:32,241 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:32,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:23:32,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:32,257 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:23:32,257 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:32,257 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:32,258 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:23:32,268 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:32,271 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,273 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:32,275 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:32,278 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:32,281 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:32,284 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,286 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:32,289 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:32,290 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:32,293 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:32,303 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:32,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:23:32,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:23:32,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:23:32,325 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:32,326 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:23:32,326 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:32,343 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:32,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:23:32,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:23:32,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:32,355 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:32,355 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:32,356 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:32,356 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:32,356 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:23:32,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:32,357 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:23:32,357 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:32,358 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:23:32,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:23:32,359 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:32,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:23:32,359 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:32,359 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:23:32,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:23:32,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:32,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:23:32,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:32,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:32,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:32,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:23:32,363 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:23:32,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:23:32,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:23:32,367 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:23:32,367 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:32,369 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:32,369 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:32,370 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:32,371 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:32,371 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:32,371 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:32,379 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3590, Threshold=0.3501, Accuracy=0.5333, F1=0.6797, Precision=0.8254, Recall=0.5778
2025-08-04 20:23:32,379 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5333, F1: 0.6797, Prec: 0.8254, Rec: 0.5778, Avg Anomaly Score: 0.3590
2025-08-04 20:23:46,705 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:46,706 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:46,706 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:46,706 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:23:46,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:23:46,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:47,132 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:47,132 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:47,227 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:23:47,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:23:47,264 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:47,371 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:47,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:47,377 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:47,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:23:47,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:47,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:23:47,412 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:47,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:47,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:23:47,422 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:47,425 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,427 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:47,429 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:47,432 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:47,434 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:47,436 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:47,439 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:47,442 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:47,444 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:47,447 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:47,457 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:47,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:23:47,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:23:47,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:23:47,468 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:47,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:23:47,480 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:47,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:23:47,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:47,497 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:47,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:23:47,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:23:47,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:47,510 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:47,511 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:47,511 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:47,511 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:47,512 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:23:47,512 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:47,512 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:23:47,512 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:47,514 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:23:47,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:23:47,514 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:23:47,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:23:47,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:23:47,516 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:23:47,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:23:47,516 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:23:47,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:23:47,516 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:23:47,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:23:47,517 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:23:47,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:23:47,517 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:47,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:23:47,518 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:23:47,523 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:23:47,523 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:47,524 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:47,524 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:47,526 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:47,526 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:47,526 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:47,527 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:47,535 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.2995, Threshold=0.2952, Accuracy=0.5524, F1=0.6928, Precision=0.8413, Recall=0.5889
2025-08-04 20:23:47,535 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.5524, F1: 0.6928, Prec: 0.8413, Rec: 0.5889, Avg Anomaly Score: 0.2995
2025-08-04 20:23:58,825 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:58,825 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:23:58,825 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:23:58,825 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:23:58,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:23:58,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:59,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:59,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:59,341 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:23:59,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:23:59,381 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:59,485 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:59,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:59,494 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:59,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:23:59,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:59,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:23:59,511 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:59,511 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:59,511 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:23:59,520 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:59,523 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,526 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:59,528 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:59,531 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:59,534 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:59,537 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:59,539 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:59,542 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:59,544 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:59,546 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:59,556 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:59,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:23:59,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:23:59,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:23:59,567 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:59,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:23:59,578 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:59,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:23:59,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:59,597 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:59,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:23:59,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:23:59,625 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:59,625 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:59,625 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:59,625 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:59,626 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:59,626 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:23:59,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:59,627 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:23:59,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:59,628 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:23:59,629 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:23:59,629 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:59,629 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:23:59,629 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:59,630 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:59,630 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:59,630 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:23:59,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:23:59,630 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:23:59,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:23:59,631 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:23:59,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:23:59,631 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:23:59,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:23:59,631 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:23:59,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:23:59,632 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:23:59,632 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:23:59,632 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:59,632 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:23:59,632 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:59,633 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:59,633 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:59,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:23:59,633 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:23:59,634 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:23:59,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:23:59,641 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:23:59,641 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:59,643 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:59,643 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:23:59,645 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:59,645 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:59,645 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:59,646 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:59,654 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3027, Threshold=0.3015, Accuracy=0.6095, F1=0.7320, Precision=0.8889, Recall=0.6222
2025-08-04 20:23:59,654 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6095, F1: 0.7320, Prec: 0.8889, Rec: 0.6222, Avg Anomaly Score: 0.3027
2025-08-04 20:24:10,954 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:10,954 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:10,955 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:10,955 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:24:10,955 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:24:10,955 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:11,328 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:11,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:11,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:24:11,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:24:11,456 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:11,561 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:11,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:11,569 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:11,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:24:11,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:11,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:24:11,584 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:11,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:11,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:24:11,593 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:11,596 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,598 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:11,600 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:11,603 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:11,605 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:11,607 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:11,609 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:11,612 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:11,614 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:11,616 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:11,629 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:11,629 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:24:11,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:24:11,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:24:11,640 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:11,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:24:11,658 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:11,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:24:11,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:11,675 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:11,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:24:11,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:24:11,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:11,689 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:11,689 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:11,690 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:11,690 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:11,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:24:11,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:11,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:24:11,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:11,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:24:11,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:24:11,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:11,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:24:11,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:11,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:11,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:11,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:24:11,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:24:11,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:24:11,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:24:11,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:24:11,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:24:11,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:24:11,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:24:11,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:24:11,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:24:11,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:24:11,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:24:11,696 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:11,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:24:11,696 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:11,697 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:11,697 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:11,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:24:11,697 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:24:11,697 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:24:11,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:24:11,702 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:24:11,702 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:11,704 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:11,704 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:11,706 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:11,706 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:11,706 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:11,707 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:11,715 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3212, Threshold=0.3239, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:24:11,715 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3212
2025-08-04 20:24:23,008 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:23,008 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:23,008 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:23,008 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:24:23,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:24:23,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:23,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:23,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:23,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:24:23,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:24:23,490 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:23,669 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:23,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:23,679 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:23,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:24:23,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:23,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:24:23,692 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:23,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:23,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:24:23,701 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:23,704 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,707 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:23,709 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:23,712 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:23,714 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:23,718 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,721 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:23,726 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:23,728 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:23,731 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:23,742 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:23,742 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:24:23,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:24:23,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:24:23,753 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:23,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:24:23,765 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:23,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:24:23,766 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:23,784 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:23,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:24:23,798 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:24:23,798 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:23,798 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:23,798 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:23,799 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:23,799 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:23,799 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:24:23,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:23,800 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:24:23,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:23,802 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:24:23,802 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:24:23,802 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:23,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:24:23,803 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:23,803 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:23,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:23,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:24:23,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:24:23,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:24:23,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:24:23,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:24:23,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:24:23,805 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:24:23,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:24:23,805 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:24:23,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:24:23,805 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:24:23,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:24:23,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:23,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:24:23,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:23,807 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:23,807 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:23,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:24:23,807 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:24:23,808 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:24:23,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:24:23,817 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:24:23,818 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:23,819 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:23,819 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:23,821 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:23,821 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:23,821 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:23,822 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:23,829 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3023, Threshold=0.3072, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:24:23,830 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3023
2025-08-04 20:24:35,108 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:35,108 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:35,108 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:35,108 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:24:35,108 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:24:35,108 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:35,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:35,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:35,519 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:24:35,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:24:35,568 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:35,673 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:35,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:35,679 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:35,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:24:35,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:35,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:24:35,701 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:35,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:35,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:24:35,712 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:35,715 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,718 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:35,720 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:35,723 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:35,726 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:35,728 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:35,734 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:35,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:35,739 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:35,752 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:35,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:24:35,757 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:24:35,757 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:24:35,765 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:35,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:24:35,781 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:35,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:24:35,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:35,800 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:35,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:24:35,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:24:35,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:35,812 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:35,812 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:35,813 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:35,813 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:35,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:24:35,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:35,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:24:35,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:35,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:24:35,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:24:35,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:35,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:24:35,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:35,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:24:35,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:24:35,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:24:35,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:24:35,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:24:35,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:24:35,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:24:35,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:24:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:35,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:24:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:35,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:24:35,820 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:24:35,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:24:35,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:24:35,826 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:24:35,826 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:35,828 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:35,828 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:35,829 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:35,830 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:35,830 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:35,830 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:35,838 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3023, Threshold=0.3079, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:24:35,838 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3023
2025-08-04 20:24:47,124 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:47,124 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:47,124 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:47,124 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:24:47,125 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:24:47,125 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:47,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:47,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:47,496 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:24:47,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:24:47,521 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:47,690 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:47,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:47,698 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:47,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:24:47,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:47,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:24:47,714 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:47,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:47,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:24:47,725 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:47,729 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:47,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:47,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:47,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:47,738 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:47,741 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:47,744 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:47,747 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:47,749 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:47,751 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:47,764 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:47,764 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:24:47,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:24:47,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:24:47,775 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:47,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:24:47,787 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:47,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:24:47,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:47,804 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:47,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:24:47,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:24:47,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:47,822 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:47,822 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:47,823 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:47,823 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:47,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:24:47,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:47,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:24:47,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:47,825 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:24:47,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:24:47,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:47,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:24:47,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:47,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:24:47,827 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:24:47,828 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:24:47,828 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:24:47,828 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:24:47,828 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:24:47,828 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:24:47,828 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:24:47,829 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:47,829 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:24:47,829 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:47,829 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:47,830 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:47,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:24:47,830 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:24:47,830 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:24:47,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:24:47,838 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:24:47,839 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:47,840 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:47,840 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:47,842 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:47,842 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:47,842 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:47,843 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:47,851 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3032, Threshold=0.3100, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:24:47,851 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3032
2025-08-04 20:24:59,130 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:59,130 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:24:59,130 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:24:59,130 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:24:59,131 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:24:59,131 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:59,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:59,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:59,533 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:24:59,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:24:59,580 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:59,731 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:59,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:59,738 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:59,743 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:24:59,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:59,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:24:59,752 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:59,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:59,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:24:59,761 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:59,765 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,767 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:59,769 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:59,772 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:59,774 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:59,776 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,779 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:59,782 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:59,784 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:59,786 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:59,797 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:59,797 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:24:59,802 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:24:59,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:24:59,808 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:59,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:24:59,823 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:59,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:24:59,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:59,845 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:59,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:24:59,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:24:59,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:59,859 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:59,859 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:59,859 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:59,860 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:59,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:24:59,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:59,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:24:59,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:59,862 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:24:59,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:24:59,862 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:59,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:24:59,863 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:24:59,864 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:24:59,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:24:59,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:59,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:24:59,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:59,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:59,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:59,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:24:59,866 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:24:59,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:24:59,867 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:24:59,874 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:24:59,874 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:59,875 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:59,876 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:24:59,877 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:59,877 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:59,878 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:59,878 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:59,886 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3125, Threshold=0.3211, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:24:59,886 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3125
2025-08-04 20:25:11,166 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:11,166 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:11,167 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:11,167 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:25:11,167 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:25:11,167 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:11,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:11,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:11,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:25:11,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:25:11,673 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:11,812 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:11,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:11,819 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:11,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:25:11,831 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:11,831 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:25:11,832 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:11,832 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:11,832 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:25:11,841 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:11,844 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,846 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:11,848 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:11,850 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:11,853 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:11,855 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,858 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:11,861 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:11,864 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:11,868 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:11,879 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:11,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:25:11,884 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:25:11,885 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:25:11,890 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:11,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:25:11,903 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:11,903 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:25:11,903 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:11,920 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:11,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:25:11,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:25:11,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:11,936 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:11,936 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:11,936 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:11,936 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:11,937 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:25:11,937 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:11,937 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:25:11,937 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:11,938 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:25:11,938 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:25:11,939 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:11,939 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:25:11,939 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:11,939 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:11,939 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:11,940 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:25:11,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:25:11,940 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:25:11,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:25:11,940 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:25:11,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:25:11,941 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:25:11,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:25:11,941 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:25:11,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:25:11,942 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:25:11,942 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:25:11,942 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:11,942 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:25:11,942 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:11,943 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:11,943 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:11,943 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:25:11,943 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:25:11,944 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:25:11,944 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:25:11,951 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:25:11,951 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:11,953 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:11,953 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:11,955 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:11,955 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:11,955 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:11,956 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:11,964 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3180, Threshold=0.3291, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:25:11,964 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3180
2025-08-04 20:25:23,235 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:23,235 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:23,235 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:23,235 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:25:23,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:25:23,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:23,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:23,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:23,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:25:23,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:25:23,660 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:23,773 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:23,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:23,780 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:23,787 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:25:23,796 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:23,796 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:25:23,797 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:23,797 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:23,797 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:25:23,806 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:23,809 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,811 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:23,813 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:23,816 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:23,818 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:23,820 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,823 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:23,826 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:23,828 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:23,830 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:23,840 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:23,840 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:25:23,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:25:23,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:25:23,850 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:23,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:25:23,858 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:23,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:25:23,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:23,874 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:23,879 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:25:23,884 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:25:23,884 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:23,885 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:23,885 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:23,885 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:23,885 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:23,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:25:23,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:23,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:25:23,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:23,888 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:25:23,889 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:25:23,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:23,889 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:25:23,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:23,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:23,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:25:23,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:23,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:25:23,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:23,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:23,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:23,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:25:23,892 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:25:23,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:25:23,893 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:25:23,896 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:25:23,896 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:23,901 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:23,901 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:23,902 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:23,902 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:23,902 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:23,903 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:23,912 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3322, Threshold=0.3444, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:25:23,912 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3322
2025-08-04 20:25:35,191 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:35,191 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:35,191 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:35,191 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:25:35,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:25:35,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:35,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:35,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:35,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:25:35,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:25:35,597 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:35,699 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:35,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:35,704 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:35,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:25:35,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:35,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:25:35,720 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:35,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:35,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:25:35,730 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:35,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:35,739 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:35,742 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:35,744 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:35,746 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,749 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:35,752 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:35,754 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:35,757 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:35,768 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:35,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:25:35,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:25:35,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:25:35,777 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:35,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:25:35,786 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:35,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:25:35,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:35,802 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:35,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:25:35,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:25:35,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:35,814 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:35,814 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:35,815 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:35,815 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:35,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:25:35,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:35,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:25:35,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:35,817 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:25:35,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:25:35,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:35,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:25:35,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:35,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:25:35,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:25:35,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:25:35,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:25:35,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:25:35,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:25:35,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:25:35,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:25:35,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:35,821 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:25:35,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:35,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:35,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:35,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:25:35,822 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:25:35,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:25:35,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:25:35,824 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:25:35,825 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:35,826 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:35,826 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:35,828 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:35,828 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:35,828 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:35,829 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:35,837 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3309, Threshold=0.3426, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:25:35,837 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3309
2025-08-04 20:25:47,113 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:47,113 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:25:47,113 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:25:47,113 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:25:47,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:25:47,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:47,413 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:47,414 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:47,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:25:47,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:25:47,542 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:47,659 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:47,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:47,666 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:47,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:25:47,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:47,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:25:47,679 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:47,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:47,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:25:47,688 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:47,691 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:47,693 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:47,695 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:47,698 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:47,700 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:47,703 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:47,705 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:47,708 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:47,710 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:47,712 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:47,723 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:47,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:25:47,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:25:47,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:25:47,733 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:47,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:25:47,747 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:47,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:25:47,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:47,763 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:47,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:25:47,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:25:47,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:47,777 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:47,777 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:47,777 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:47,777 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:47,778 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:25:47,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:47,778 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:25:47,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:47,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:25:47,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:25:47,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:47,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:25:47,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:47,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:47,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:47,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:25:47,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:25:47,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:25:47,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:25:47,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:25:47,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:25:47,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:47,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:25:47,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:47,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:47,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:47,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:25:47,784 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:25:47,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:25:47,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:25:47,788 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:25:47,788 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:47,789 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:47,789 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:25:47,790 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:47,791 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:47,791 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:47,791 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:47,800 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3353, Threshold=0.3469, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:25:47,800 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3353
2025-08-04 20:26:02,066 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:02,066 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:02,067 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:02,067 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:26:02,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:26:02,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:02,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:02,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:02,428 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:26:02,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:26:02,465 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:02,587 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:02,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:02,595 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:02,602 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:26:02,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:02,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:26:02,625 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:02,625 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:02,625 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:26:02,635 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:02,638 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:02,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:02,642 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:02,645 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:02,647 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:02,649 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:02,651 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:02,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:02,656 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:02,658 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:02,668 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:02,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:26:02,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:26:02,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:26:02,678 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:02,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:26:02,688 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:02,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:26:02,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:02,704 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:02,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:26:02,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:26:02,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:02,714 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:02,714 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:02,714 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:02,715 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:02,715 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:26:02,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:02,715 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:26:02,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:02,717 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:26:02,717 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:26:02,717 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:02,717 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:26:02,717 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:02,717 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:26:02,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:26:02,719 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:02,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:02,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:02,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:26:02,720 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:26:02,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:26:02,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:26:02,728 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:26:02,729 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:02,730 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:02,730 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:02,731 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:02,731 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:02,731 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:02,732 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:02,740 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3439, Threshold=0.3574, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:26:02,740 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3439
2025-08-04 20:26:14,009 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:14,009 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:14,009 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:14,009 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:26:14,009 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:26:14,009 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:14,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:14,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:14,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:26:14,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:26:14,407 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:14,497 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:14,502 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:14,503 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:14,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:26:14,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:14,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:26:14,514 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:14,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:14,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:26:14,523 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:14,525 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:14,527 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:14,529 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:14,532 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:14,534 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:14,537 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:14,539 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:14,542 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:14,543 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:14,546 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:14,555 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:14,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:26:14,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:26:14,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:26:14,564 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:14,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:26:14,573 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:14,574 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:26:14,574 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:14,590 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:14,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:26:14,601 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:26:14,601 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:14,601 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:14,601 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:14,601 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:14,601 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:14,602 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:26:14,602 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:14,602 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:26:14,602 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:14,604 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:26:14,604 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:26:14,604 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:14,604 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:26:14,604 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:26:14,605 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:26:14,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:26:14,606 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:26:14,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:26:14,606 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:26:14,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:26:14,606 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:26:14,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:26:14,607 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:14,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:26:14,607 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:14,607 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:14,608 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:14,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:26:14,608 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:26:14,608 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:26:14,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:26:14,613 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:26:14,613 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:14,614 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:14,614 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:14,616 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:14,616 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:14,616 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:14,617 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:14,625 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3368, Threshold=0.3500, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:26:14,625 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3368
2025-08-04 20:26:28,958 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:28,958 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:28,958 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:28,958 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:26:28,958 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:26:28,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:29,168 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:29,168 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:29,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:26:29,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:26:29,284 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:29,372 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:29,378 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:29,378 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:29,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:26:29,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:29,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:26:29,388 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:29,388 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:29,388 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:26:29,396 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:29,399 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:29,401 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:29,403 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:29,405 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:29,408 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:29,410 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:29,412 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:29,415 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:29,417 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:29,419 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:29,427 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:29,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:26:29,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:26:29,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:26:29,436 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:29,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:26:29,445 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:29,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:26:29,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:29,460 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:29,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:26:29,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:26:29,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:29,472 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:29,472 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:29,473 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:29,473 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:29,473 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:26:29,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:29,473 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:26:29,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:29,475 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:26:29,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:26:29,475 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:29,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:26:29,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:29,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:29,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:29,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:26:29,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:26:29,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:26:29,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:26:29,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:26:29,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:26:29,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:26:29,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:26:29,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:26:29,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:26:29,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:26:29,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:26:29,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:29,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:26:29,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:29,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:29,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:29,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:26:29,480 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:26:29,480 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:26:29,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:26:29,485 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:26:29,486 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:29,487 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:29,487 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:29,488 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:29,488 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:29,488 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:29,489 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:29,496 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3410, Threshold=0.3549, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:26:29,496 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3410
2025-08-04 20:26:40,821 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,821 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:40,821 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:40,821 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:26:40,821 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:26:40,821 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:41,202 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:41,202 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:41,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:26:41,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:26:41,336 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:41,437 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:41,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:41,443 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:41,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:26:41,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:41,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:26:41,458 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:41,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:41,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:26:41,467 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:41,470 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,473 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:41,475 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:41,478 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:41,480 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:41,483 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,485 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:41,488 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:41,490 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:41,492 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:41,502 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:41,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:26:41,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:26:41,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:26:41,512 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:41,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:26:41,521 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:41,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:26:41,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:41,538 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:41,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:26:41,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:26:41,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:41,550 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:41,550 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:41,550 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:41,550 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:41,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:26:41,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:41,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:26:41,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:41,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:26:41,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:26:41,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:26:41,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:26:41,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:26:41,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:26:41,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:41,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:26:41,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:41,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:41,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:41,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:26:41,556 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:26:41,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:26:41,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:26:41,561 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:26:41,561 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:41,562 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:41,562 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:41,564 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:41,564 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:41,564 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:41,565 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,572 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3456, Threshold=0.3599, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:26:41,572 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3456
2025-08-04 20:26:52,886 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,887 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:26:52,887 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:26:52,887 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:26:52,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:26:52,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:53,327 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:53,328 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:26:53,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:26:53,477 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,574 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,580 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:26:53,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,593 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:26:53,602 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,605 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,607 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,609 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,612 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,614 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,617 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,619 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,624 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,627 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,636 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:26:53,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:26:53,645 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:26:53,653 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:26:53,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,668 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:26:53,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:26:53,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,677 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,677 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,678 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,678 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,678 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:26:53,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,678 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:26:53,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,680 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:26:53,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,680 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:26:53,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:26:53,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:26:53,684 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:26:53,684 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:26:53,684 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:26:53,688 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:26:53,688 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,689 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,689 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:26:53,691 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,691 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,691 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,692 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,699 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3488, Threshold=0.3631, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:26:53,699 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3488
2025-08-04 20:27:04,983 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,983 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:04,983 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:04,984 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:27:04,984 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:27:04,984 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:05,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:05,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:05,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:27:05,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:27:05,588 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,731 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,737 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,743 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:27:05,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,751 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:27:05,761 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,765 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,767 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,770 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,772 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,774 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,777 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,780 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,783 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,785 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,788 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,799 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:27:05,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:27:05,810 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:27:05,818 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:27:05,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,834 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,838 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:27:05,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:27:05,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,844 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,844 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,845 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,845 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:27:05,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:27:05,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:27:05,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:27:05,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:27:05,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:27:05,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:27:05,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:27:05,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:27:05,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:27:05,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:27:05,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:27:05,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:27:05,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:27:05,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:27:05,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:27:05,851 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:27:05,852 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:27:05,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:27:05,857 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:27:05,857 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,858 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,859 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:05,860 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,860 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,861 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,861 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,869 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3459, Threshold=0.3601, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:27:05,869 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3459
2025-08-04 20:27:17,168 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:17,168 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:17,168 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:17,169 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:27:17,169 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:27:17,170 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:17,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:17,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:17,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:27:17,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:27:17,793 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,960 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,967 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,967 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,974 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:27:17,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,982 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:27:17,993 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,997 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:18,000 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:18,003 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:18,006 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:18,008 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:18,011 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:18,014 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:18,017 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:18,021 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:18,024 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:18,034 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:18,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:27:18,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:27:18,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:27:18,043 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:18,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:27:18,051 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:18,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:27:18,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:18,067 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:18,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:27:18,081 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:27:18,081 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:18,082 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:18,082 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:18,082 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:18,082 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:18,082 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:27:18,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:18,083 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:27:18,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:18,084 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:27:18,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:27:18,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:18,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:27:18,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:18,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:18,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:18,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:27:18,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:18,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:18,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:18,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:27:18,088 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:27:18,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:27:18,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:27:18,094 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:27:18,095 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:18,096 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:18,096 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:18,097 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:18,097 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:18,098 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:18,098 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:18,107 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3488, Threshold=0.3631, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:27:18,107 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3488
2025-08-04 20:27:32,391 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:32,391 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:32,391 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:32,391 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:27:32,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:27:32,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:32,717 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:32,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:32,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:27:32,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:27:32,852 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:32,984 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:32,990 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:32,990 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:32,997 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:27:33,003 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:33,003 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:27:33,004 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:33,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:33,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:27:33,013 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:33,017 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:33,020 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:33,022 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:33,025 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:33,027 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:33,030 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:33,032 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:33,036 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:33,038 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:33,042 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:33,054 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:33,055 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:27:33,061 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:27:33,061 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:27:33,067 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:33,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:27:33,079 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:33,082 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:27:33,082 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:33,100 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:33,105 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:27:33,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:27:33,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:33,112 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:33,112 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:33,112 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:33,113 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:33,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:27:33,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:33,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:27:33,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:33,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:27:33,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:27:33,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:33,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:27:33,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:33,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:33,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:33,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:27:33,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:27:33,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:27:33,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:27:33,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:27:33,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:27:33,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:27:33,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:27:33,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:27:33,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:27:33,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:27:33,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:27:33,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:33,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:27:33,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:33,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:33,120 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:33,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:27:33,120 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:27:33,120 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:27:33,121 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:27:33,127 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:27:33,127 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:33,128 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:33,128 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:33,130 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:33,130 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:33,130 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:33,131 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:33,139 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3502, Threshold=0.3662, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:27:33,139 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3502
2025-08-04 20:27:44,394 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:44,394 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:27:44,394 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:27:44,395 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:27:44,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:27:44,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:44,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:44,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:44,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:27:44,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:27:44,788 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:44,903 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:44,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:44,909 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:44,915 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:27:44,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:44,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:27:44,922 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:44,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:44,923 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:27:44,931 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:44,934 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:44,936 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:44,938 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:44,941 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:44,943 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:44,945 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:44,947 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:44,950 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:44,952 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:44,954 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:44,962 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:44,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:27:44,967 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:27:44,967 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:27:44,973 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:44,973 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:27:44,985 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:44,985 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:27:44,985 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:45,000 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:45,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:27:45,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:27:45,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:45,009 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:45,009 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:45,009 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:45,009 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:45,009 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:27:45,010 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:45,010 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:27:45,010 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:45,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:27:45,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:27:45,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:27:45,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:27:45,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:45,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:27:45,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:45,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:45,015 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:45,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:27:45,015 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:27:45,015 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:27:45,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:27:45,024 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:27:45,024 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:45,025 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:45,026 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:27:45,027 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:45,030 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:45,031 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:45,031 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:45,039 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3549, Threshold=0.3718, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:27:45,039 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3549
2025-08-04 20:28:02,345 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:02,345 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:02,345 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:02,346 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:28:02,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:28:02,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:02,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:02,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:02,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:28:02,964 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:28:02,964 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:03,077 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:03,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:03,084 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:03,091 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:28:03,097 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:03,097 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:28:03,098 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:03,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:03,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:28:03,108 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:03,111 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:03,113 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:03,116 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:03,118 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:03,121 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:03,123 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:03,125 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:03,128 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:03,130 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:03,133 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:03,141 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:03,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:28:03,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:28:03,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:28:03,151 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:03,151 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:28:03,160 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:03,160 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:28:03,161 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:03,178 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:03,183 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:28:03,190 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:28:03,190 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:03,190 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:03,191 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:03,191 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:03,191 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:03,191 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:28:03,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:03,192 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:28:03,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:03,193 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:28:03,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:28:03,194 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:03,194 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:28:03,194 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:28:03,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:28:03,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:03,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:28:03,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:03,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:03,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:03,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:28:03,197 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:28:03,198 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:28:03,198 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:28:03,203 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:28:03,203 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:03,205 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:03,205 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:03,207 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:03,207 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:03,207 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:03,208 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:03,216 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3572, Threshold=0.3737, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:28:03,216 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3572
2025-08-04 20:28:17,496 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:17,496 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:17,496 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:17,497 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:28:17,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:28:17,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:17,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:17,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:17,972 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:28:18,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:28:18,016 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:18,136 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:18,143 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:18,143 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:18,168 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:28:18,177 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:18,177 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:28:18,178 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:18,178 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:18,178 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:28:18,188 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:18,191 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,194 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:18,197 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:18,200 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:18,202 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:18,205 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,207 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:18,210 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:18,212 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:18,215 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:18,225 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:18,225 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:28:18,229 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:28:18,230 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:28:18,235 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:18,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:28:18,246 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:18,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:28:18,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:18,264 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:18,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:28:18,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:28:18,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:18,273 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:18,273 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:18,273 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:18,273 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:18,273 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:28:18,273 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:18,274 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:28:18,274 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:18,275 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:28:18,275 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:28:18,275 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:18,275 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:28:18,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:28:18,277 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:28:18,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:28:18,278 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:18,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:28:18,278 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:18,278 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:18,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:18,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:28:18,279 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:28:18,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:28:18,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:28:18,284 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:28:18,284 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:18,285 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:18,285 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:18,287 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:18,287 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:18,287 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:18,288 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:18,295 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3564, Threshold=0.3724, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:28:18,295 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3564
2025-08-04 20:28:29,611 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,612 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:29,612 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:29,612 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:28:29,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:28:29,613 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:30,100 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:30,100 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:30,205 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:28:30,251 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:28:30,251 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:30,409 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:30,418 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:30,418 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:30,426 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:28:30,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:30,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:28:30,437 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:30,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:30,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:28:30,449 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:30,455 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,458 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:30,461 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:30,464 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:30,468 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:30,472 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,475 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:30,479 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:30,481 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:30,484 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:30,497 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:30,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:28:30,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:28:30,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:28:30,508 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:28:30,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,543 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:28:30,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:28:30,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,558 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,558 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,559 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,559 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:28:30,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:28:30,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:28:30,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,563 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,563 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,563 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,563 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:28:30,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:28:30,564 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:28:30,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:28:30,564 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:28:30,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:28:30,564 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:28:30,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:28:30,565 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:28:30,565 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:28:30,565 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:28:30,565 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:28:30,566 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:28:30,566 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,566 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,567 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:28:30,567 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:28:30,567 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:28:30,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:28:30,574 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:28:30,575 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,576 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,576 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:30,577 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,577 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,577 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,578 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,586 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3594, Threshold=0.3757, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:28:30,587 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3594
2025-08-04 20:28:41,851 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:41,851 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:41,851 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:41,852 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:28:41,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:28:41,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:42,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:42,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:42,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:28:42,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:28:42,339 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:42,446 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:42,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:42,457 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:42,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:28:42,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:42,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:28:42,474 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:42,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:42,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:28:42,483 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:42,487 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,490 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:42,492 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:42,495 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:42,497 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:42,500 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:42,503 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:42,507 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:42,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:42,512 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:42,524 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:42,524 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:28:42,530 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:28:42,530 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:28:42,537 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:42,537 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:28:42,551 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:42,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:28:42,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:42,569 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:42,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:28:42,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:28:42,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:42,586 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:42,586 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:42,587 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:42,587 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:42,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:28:42,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:42,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:28:42,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:42,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:28:42,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:28:42,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:42,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:28:42,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:42,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:42,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:42,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:28:42,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:28:42,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:28:42,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:28:42,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:28:42,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:28:42,592 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:28:42,593 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:28:42,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:28:42,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:28:42,599 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:28:42,599 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:42,600 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:42,601 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:42,602 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:42,602 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:42,602 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:42,603 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:42,610 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3557, Threshold=0.3723, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:28:42,611 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3557
2025-08-04 20:28:53,871 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:53,872 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:28:53,872 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:28:53,872 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:28:53,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:28:53,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:54,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:54,165 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:54,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:28:54,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:28:54,294 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:54,413 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:54,419 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:54,419 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:54,426 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:28:54,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:54,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:28:54,433 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:54,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:54,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:28:54,441 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:54,444 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:54,447 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:54,448 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:54,451 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:54,453 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:54,456 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:54,459 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:54,461 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:54,463 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:54,465 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:54,476 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:54,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:28:54,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:28:54,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:28:54,486 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:54,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:28:54,495 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:54,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:28:54,496 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:54,511 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:54,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:28:54,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:28:54,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:54,521 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:54,521 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:54,521 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:54,521 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:54,522 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:28:54,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:54,522 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:28:54,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:54,523 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:28:54,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:28:54,524 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:54,524 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:28:54,524 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:54,524 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:28:54,525 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:28:54,526 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:54,527 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:54,527 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:54,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:28:54,527 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:28:54,527 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:28:54,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:28:54,531 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:28:54,531 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:54,532 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:54,532 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:28:54,533 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:54,533 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:54,533 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:54,534 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:54,543 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3615, Threshold=0.3785, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:28:54,543 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3615
2025-08-04 20:29:14,850 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:14,850 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:14,851 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:14,851 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:29:14,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:29:14,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:15,138 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:15,139 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:15,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:29:15,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:29:15,267 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:15,360 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:15,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:15,370 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:15,376 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:29:15,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:15,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:29:15,382 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:15,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:15,383 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:29:15,391 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:15,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:15,396 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:15,398 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:15,401 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:15,403 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:15,405 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:15,408 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:15,410 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:15,412 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:15,414 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:15,424 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:15,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:29:15,428 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:29:15,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:29:15,433 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:15,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:29:15,443 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:15,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:29:15,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:15,460 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:15,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:29:15,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:29:15,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:15,478 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:15,478 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:15,479 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:15,479 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:15,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:29:15,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:15,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:29:15,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:15,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:29:15,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:29:15,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:15,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:29:15,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:15,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:15,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:15,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:29:15,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:29:15,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:29:15,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:29:15,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:29:15,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:29:15,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:15,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:29:15,485 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:15,485 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:15,485 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:15,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:29:15,486 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:29:15,486 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:29:15,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:29:15,492 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:29:15,492 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:15,493 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:15,494 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:15,495 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:15,495 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:15,495 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:15,496 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:15,504 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3583, Threshold=0.3761, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:29:15,505 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3583
2025-08-04 20:29:26,781 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:26,781 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:26,781 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:26,782 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:29:26,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:29:26,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:27,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:27,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:27,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:29:27,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:29:27,198 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:27,332 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:27,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:27,340 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:27,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:29:27,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:27,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:29:27,355 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:27,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:27,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:29:27,365 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:27,368 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,370 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:27,372 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:27,375 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:27,377 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:27,380 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,382 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:27,385 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:27,387 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:27,390 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:27,401 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:27,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:29:27,406 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:29:27,406 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:29:27,411 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:27,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:29:27,422 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:27,422 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:29:27,422 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:27,439 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:27,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:29:27,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:29:27,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:27,454 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:27,454 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:27,455 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:27,455 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:27,455 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:29:27,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:27,455 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:29:27,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:27,457 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:29:27,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:29:27,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:27,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:29:27,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:27,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:27,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:27,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:29:27,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:29:27,459 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:29:27,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:29:27,459 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:29:27,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:29:27,459 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:29:27,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:29:27,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:29:27,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:29:27,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:29:27,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:29:27,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:27,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:29:27,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:27,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:27,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:27,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:29:27,462 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:29:27,462 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:29:27,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:29:27,469 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:29:27,469 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:27,471 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:27,471 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:27,473 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:27,474 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:27,474 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:27,475 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:27,483 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3541, Threshold=0.3724, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:29:27,483 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3541
2025-08-04 20:29:38,775 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:38,775 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:38,775 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:38,775 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:29:38,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:29:38,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:39,054 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:39,055 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:39,144 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:29:39,177 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:29:39,178 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:39,341 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:39,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:39,350 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:39,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:29:39,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:39,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:29:39,400 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:39,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:39,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:29:39,409 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:39,413 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,415 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:39,417 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:39,421 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:39,423 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:39,425 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,428 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:39,431 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:39,433 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:39,435 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:39,448 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:39,448 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:29:39,453 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:29:39,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:29:39,460 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:39,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:29:39,477 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:39,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:29:39,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:39,495 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:39,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:29:39,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:29:39,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:39,509 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:39,509 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:39,509 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:39,510 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:39,510 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:29:39,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:39,510 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:29:39,511 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:39,512 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:29:39,512 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:29:39,513 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:39,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:29:39,513 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:39,513 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:39,514 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:39,514 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:29:39,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:29:39,514 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:29:39,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:29:39,514 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:29:39,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:29:39,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:29:39,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:29:39,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:29:39,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:29:39,515 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:29:39,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:29:39,516 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:39,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:29:39,516 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:39,517 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:39,517 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:39,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:29:39,517 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:29:39,517 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:29:39,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:29:39,525 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:29:39,525 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:39,526 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:39,527 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:39,528 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:39,528 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:39,528 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:39,529 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:39,537 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3574, Threshold=0.3747, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:29:39,538 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3574
2025-08-04 20:29:53,813 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:53,813 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:29:53,813 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:29:53,813 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:29:53,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:29:53,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:54,089 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:54,089 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:54,182 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:29:54,230 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:29:54,231 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:54,390 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:54,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:54,398 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:54,406 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:29:54,431 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:54,431 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:29:54,432 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:54,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:54,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:29:54,442 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:54,445 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,448 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:54,450 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:54,453 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:54,455 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:54,457 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,460 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:54,462 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:54,464 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:54,467 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:54,480 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:54,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:29:54,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:29:54,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:29:54,492 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:54,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:29:54,509 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:54,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:29:54,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:54,528 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:54,534 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:29:54,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:29:54,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:54,544 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:54,545 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:54,545 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:54,545 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:54,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:29:54,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:54,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:29:54,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:54,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:29:54,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:29:54,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:54,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:29:54,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:54,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:54,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:54,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:29:54,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:29:54,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:29:54,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:29:54,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:29:54,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:29:54,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:29:54,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:29:54,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:29:54,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:29:54,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:29:54,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:29:54,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:54,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:29:54,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:54,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:54,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:54,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:29:54,553 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:29:54,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:29:54,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:29:54,564 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:29:54,564 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:54,566 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:54,566 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:29:54,567 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:54,568 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:54,568 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:54,569 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:54,576 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3643, Threshold=0.3810, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:29:54,577 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3643
