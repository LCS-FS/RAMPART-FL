2025-08-04 20:21:15,941 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:15,941 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:15,942 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:15,942 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:21:15,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:21:15,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:16,387 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:16,387 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:16,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:21:16,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:21:16,498 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:16,717 - ClientAppLogger [Client 0] - INFO - Global hold-out test set with 31657 samples saved to /app/logs/20250804_2000/holdout_test_set.csv
2025-08-04 20:21:16,806 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:16,811 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:16,811 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:16,819 - ClientAppLogger [Client 0] - INFO - Scaler object saved by client 0 to /app/logs/20250804_2000/min_max_scaler.pkl
2025-08-04 20:21:16,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:21:16,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:16,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:21:16,825 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:16,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:16,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:21:16,833 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:16,836 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:16,838 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:16,840 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:16,843 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:16,845 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:16,848 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:16,850 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:16,853 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:16,855 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:16,857 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:16,866 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:16,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:21:16,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:21:16,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:21:16,876 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:16,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:21:16,886 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:16,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:21:16,886 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:16,901 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:16,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:21:16,916 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:21:16,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:16,917 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:16,917 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:16,917 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:16,917 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:16,917 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:21:16,918 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:16,918 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:21:16,918 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:16,919 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:21:16,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:21:16,919 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:16,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:21:16,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:21:16,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:21:16,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:21:16,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:16,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:21:16,923 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:16,923 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:16,923 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:16,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:21:16,924 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:21:16,924 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:21:16,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:21:16,933 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:21:16,933 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:16,934 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:16,935 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:16,936 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:16,936 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:16,936 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:16,937 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:16,951 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5012, Accuracy=0.5252, F1=0.6738, Precision=0.8174, Recall=0.5732
2025-08-04 20:21:16,951 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5252, F1: 0.6738, Prec: 0.8174, Rec: 0.5732, Avg Anomaly Score: 0.5017
2025-08-04 20:21:28,243 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:28,244 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:28,244 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:28,244 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:21:28,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:21:28,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:29,465 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:29,466 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:29,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:21:29,617 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:21:29,617 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:29,882 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:29,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:29,903 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:29,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:21:30,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:30,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:21:30,044 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:30,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:30,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:21:30,056 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:30,060 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,063 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:30,066 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:30,069 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:30,072 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:30,075 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:30,079 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:30,083 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:30,086 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:30,090 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:30,106 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:30,106 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:21:30,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:21:30,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:21:30,121 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:30,122 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:21:30,139 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:30,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:21:30,140 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:30,158 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:30,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:21:30,170 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:21:30,171 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:30,171 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:30,172 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:30,172 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:30,172 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:30,173 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:21:30,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:30,173 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:21:30,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:30,175 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:21:30,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:21:30,176 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:30,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:21:30,176 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:21:30,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:21:30,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:21:30,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:21:30,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:21:30,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:21:30,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:21:30,179 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:21:30,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:21:30,179 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:30,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:21:30,179 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:30,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:30,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:30,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:21:30,180 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:21:30,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:21:30,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:21:30,188 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:21:30,189 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:30,190 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:30,191 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:30,192 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:30,193 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:30,193 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:30,193 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:30,210 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5012, Accuracy=0.5252, F1=0.6738, Precision=0.8174, Recall=0.5732
2025-08-04 20:21:30,213 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5252, F1: 0.6738, Prec: 0.8174, Rec: 0.5732, Avg Anomaly Score: 0.5017
2025-08-04 20:21:41,514 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,514 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:41,514 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:41,515 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:21:41,515 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:21:41,515 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:42,102 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:42,102 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:42,282 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:21:42,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:21:42,353 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,583 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,593 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,605 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:21:42,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,624 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,625 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:21:42,638 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,643 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,646 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,651 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,656 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,661 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,665 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,670 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,674 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,676 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,679 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,691 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:21:42,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:21:42,705 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,705 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:21:42,721 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:21:42,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,742 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,748 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:21:42,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:21:42,756 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,756 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,756 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,757 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,757 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,757 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:21:42,757 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,758 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:21:42,758 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:21:42,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,760 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:21:42,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:21:42,761 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:21:42,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:21:42,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:21:42,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:21:42,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:21:42,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:21:42,762 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:21:42,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:21:42,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:21:42,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:21:42,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,764 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:21:42,765 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:21:42,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:21:42,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:21:42,770 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:21:42,770 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,772 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,772 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:42,774 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,774 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,774 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,775 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,792 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5076, Accuracy=0.5252, F1=0.6738, Precision=0.8174, Recall=0.5732
2025-08-04 20:21:42,792 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5252, F1: 0.6738, Prec: 0.8174, Rec: 0.5732, Avg Anomaly Score: 0.5078
2025-08-04 20:21:54,109 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:54,110 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:21:54,110 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:21:54,111 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:21:54,111 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:21:54,111 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,830 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:21:54,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:21:54,876 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:55,059 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:55,072 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:55,073 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:55,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:21:55,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:55,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:21:55,114 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:55,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:55,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:21:55,127 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:55,131 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,134 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:55,137 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:55,141 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:55,144 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:55,147 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:55,151 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:55,155 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:55,158 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:55,163 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:55,180 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:55,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:21:55,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:21:55,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:21:55,194 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:55,194 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:21:55,208 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:55,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:21:55,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:55,225 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:55,231 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:55,241 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:55,241 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:55,242 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:21:55,243 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:55,244 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:21:55,244 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:21:55,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:55,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:21:55,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:55,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:55,245 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:21:55,246 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:55,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:55,248 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:55,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:21:55,249 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:21:55,249 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:21:55,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:21:55,259 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:21:55,259 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:55,260 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:55,261 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:21:55,262 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:55,263 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:55,263 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:55,264 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:55,278 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5084, Threshold=0.5079, Accuracy=0.5148, F1=0.6667, Precision=0.8087, Recall=0.5671
2025-08-04 20:21:55,278 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5148, F1: 0.6667, Prec: 0.8087, Rec: 0.5671, Avg Anomaly Score: 0.5084
2025-08-04 20:22:09,590 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,590 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:09,590 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:09,590 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:22:09,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:22:09,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:10,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:10,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:10,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:22:10,242 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:22:10,242 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:10,432 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:10,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:10,440 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:10,447 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:22:10,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:10,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:22:10,455 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:10,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:10,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:22:10,467 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:10,470 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,474 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:10,477 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:10,481 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:10,484 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:10,487 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,491 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:10,495 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:10,498 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:10,501 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:10,517 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:10,518 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:22:10,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:22:10,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:22:10,533 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:10,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:22:10,545 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:10,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:22:10,546 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:10,565 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:10,570 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:22:10,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:22:10,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:10,576 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:10,576 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:10,577 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:10,577 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:10,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:22:10,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:10,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:22:10,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:10,579 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:22:10,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:22:10,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:10,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:22:10,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:10,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:10,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:22:10,581 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:10,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:22:10,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:10,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:10,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:10,583 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:22:10,584 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:22:10,584 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:22:10,584 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:22:10,588 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:22:10,588 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,589 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,589 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:10,590 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,591 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,591 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,591 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,604 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.4939, F1=0.6523, Precision=0.7913, Recall=0.5549
2025-08-04 20:22:10,604 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.4939, F1: 0.6523, Prec: 0.7913, Rec: 0.5549, Avg Anomaly Score: 0.5085
2025-08-04 20:22:24,938 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,938 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:24,938 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:24,938 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:22:24,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:22:24,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:25,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:25,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:25,399 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:22:25,424 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:22:25,424 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:25,528 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:25,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:25,535 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:25,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:22:25,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:25,549 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:22:25,550 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:25,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:25,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:22:25,561 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:25,564 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,566 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:25,569 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:25,572 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:25,575 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:25,578 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,580 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:25,584 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:25,586 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:25,589 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:25,602 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:25,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:22:25,608 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:22:25,609 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:22:25,616 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:25,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:22:25,627 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:25,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:22:25,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:25,656 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:25,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:22:25,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:22:25,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:25,688 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:25,688 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:25,688 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:25,688 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:25,689 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:22:25,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:25,689 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:22:25,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:25,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:22:25,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:22:25,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:25,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:22:25,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:25,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:22:25,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:22:25,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:22:25,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:22:25,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:22:25,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:22:25,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:22:25,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:25,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:22:25,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:25,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:25,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:25,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:22:25,696 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:22:25,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:22:25,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:22:25,701 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:22:25,701 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:25,703 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:25,703 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:25,705 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:25,705 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:25,705 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:25,706 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:25,722 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.5009, F1=0.6571, Precision=0.7971, Recall=0.5589
2025-08-04 20:22:25,722 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5009, F1: 0.6571, Prec: 0.7971, Rec: 0.5589, Avg Anomaly Score: 0.5053
2025-08-04 20:22:40,034 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:40,034 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:40,034 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:40,034 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:22:40,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:22:40,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:40,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:40,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,631 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:22:40,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:22:40,688 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,842 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,850 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,850 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,858 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:22:40,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,867 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,867 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,867 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:22:40,880 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,883 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,886 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:40,888 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:40,891 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:40,894 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:40,898 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,901 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:40,905 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:40,908 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:40,912 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:40,931 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:40,932 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:22:40,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:22:40,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:22:40,948 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:40,948 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:22:40,971 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:40,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:22:40,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:40,992 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:40,997 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:22:41,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:22:41,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:41,007 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:41,008 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:41,008 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:41,009 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:41,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:22:41,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:41,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:22:41,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:41,011 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:22:41,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:22:41,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:41,012 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:22:41,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:41,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:41,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:41,012 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:22:41,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:22:41,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:22:41,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:22:41,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:22:41,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:22:41,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:22:41,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:22:41,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:22:41,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:22:41,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:22:41,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:22:41,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:41,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:22:41,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:41,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:41,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:41,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:22:41,016 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:22:41,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:22:41,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:22:41,022 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:22:41,023 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:41,024 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:41,024 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:41,026 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:41,026 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:41,026 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:41,027 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:41,042 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4971, Threshold=0.4943, Accuracy=0.5078, F1=0.6619, Precision=0.8029, Recall=0.5630
2025-08-04 20:22:41,042 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5078, F1: 0.6619, Prec: 0.8029, Rec: 0.5630, Avg Anomaly Score: 0.4971
2025-08-04 20:22:52,317 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:52,317 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:22:52,317 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:22:52,318 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:22:52,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:22:52,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:52,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:52,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:52,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:22:52,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:22:52,787 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:52,896 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:52,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:52,906 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:52,919 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:22:52,933 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:52,933 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:22:52,934 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:52,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:52,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:22:52,947 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:52,950 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:52,952 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:52,955 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:52,958 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:52,960 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:52,963 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:52,966 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:52,969 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:52,971 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:52,973 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:52,990 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:52,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:22:52,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:22:52,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:22:53,002 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:53,002 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:22:53,013 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:53,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:22:53,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:53,030 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:53,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:53,042 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:53,042 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:53,043 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:53,043 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:53,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:22:53,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:53,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:22:53,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:53,045 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:22:53,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:22:53,045 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:53,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:22:53,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:53,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:53,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:53,046 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:22:53,046 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:22:53,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:22:53,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:22:53,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:22:53,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:22:53,047 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:22:53,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:22:53,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:22:53,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:22:53,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:22:53,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:22:53,048 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:53,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:22:53,049 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:22:53,050 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:22:53,050 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:22:53,054 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:22:53,054 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:53,055 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:53,055 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:22:53,057 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:53,057 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:53,057 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:53,058 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:53,075 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4816, Threshold=0.4775, Accuracy=0.5113, F1=0.6643, Precision=0.8058, Recall=0.5650
2025-08-04 20:22:53,078 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5113, F1: 0.6643, Prec: 0.8058, Rec: 0.5650, Avg Anomaly Score: 0.4816
2025-08-04 20:23:04,345 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:04,345 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:04,345 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:04,345 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:23:04,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:23:04,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:04,633 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:04,633 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:04,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:23:04,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:23:04,763 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:04,888 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:04,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:04,896 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:04,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:23:04,911 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:04,911 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:23:04,911 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:04,911 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:04,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:23:04,922 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:04,928 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:04,934 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:04,937 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:04,941 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:04,944 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:04,948 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:04,951 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:04,954 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:04,956 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:04,959 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:04,969 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:04,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:23:04,974 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:23:04,974 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:23:04,979 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:04,979 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:23:04,987 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:04,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:23:04,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:05,002 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:05,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:23:05,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:23:05,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:05,013 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:05,013 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:05,014 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:05,014 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:05,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:23:05,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:05,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:23:05,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:05,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:23:05,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:23:05,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:05,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:23:05,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:05,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:05,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:05,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:23:05,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:23:05,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:23:05,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:23:05,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:23:05,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:23:05,019 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:23:05,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:23:05,020 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:23:05,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:23:05,020 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:23:05,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:23:05,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:05,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:23:05,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:05,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:05,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:05,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:23:05,022 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:23:05,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:23:05,023 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:23:05,028 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:23:05,028 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:05,030 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:05,030 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:05,032 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:05,032 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:05,032 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:05,033 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:05,046 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4583, Threshold=0.4522, Accuracy=0.5148, F1=0.6667, Precision=0.8087, Recall=0.5671
2025-08-04 20:23:05,046 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5148, F1: 0.6667, Prec: 0.8087, Rec: 0.5671, Avg Anomaly Score: 0.4583
2025-08-04 20:23:19,350 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:19,350 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:19,351 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:19,351 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:23:19,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:23:19,351 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:19,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:23:19,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:23:19,925 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:20,040 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:20,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:20,047 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:20,055 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:23:20,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:20,061 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:23:20,062 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:20,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:20,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:23:20,071 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:20,074 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,076 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:20,078 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:20,081 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:20,084 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:20,086 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:20,089 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:20,092 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:20,094 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:20,097 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:20,108 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:20,111 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:23:20,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:23:20,117 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:23:20,124 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:20,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:23:20,142 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:20,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:23:20,142 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:20,161 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:20,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:23:20,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:23:20,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:20,172 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:20,172 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:20,173 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:20,173 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:20,173 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:23:20,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:20,174 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:23:20,174 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:20,176 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:23:20,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:23:20,176 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:20,176 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:23:20,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:23:20,178 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:23:20,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:23:20,179 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:20,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:23:20,179 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:20,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:20,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:20,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:23:20,180 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:23:20,180 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:23:20,180 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:23:20,184 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:23:20,184 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:20,185 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:20,186 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:20,187 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:20,187 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:20,187 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:20,188 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:20,202 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4197, Threshold=0.4108, Accuracy=0.5148, F1=0.6667, Precision=0.8087, Recall=0.5671
2025-08-04 20:23:20,203 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5148, F1: 0.6667, Prec: 0.8087, Rec: 0.5671, Avg Anomaly Score: 0.4197
2025-08-04 20:23:31,497 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:31,497 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:31,497 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:31,497 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:23:31,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:23:31,498 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:31,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:31,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:31,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:23:32,033 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:23:32,033 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:32,154 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:32,163 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:32,164 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:32,170 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:23:32,201 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:32,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:23:32,202 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:32,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:32,202 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:23:32,214 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:32,218 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,222 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:32,224 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:32,227 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:32,229 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:32,231 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:32,234 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:32,238 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:32,240 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:32,242 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:32,256 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:32,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:23:32,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:23:32,262 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:23:32,268 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:32,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:23:32,277 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:32,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:23:32,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:32,295 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:32,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:23:32,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:23:32,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:32,308 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:32,308 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:32,308 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:32,308 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:32,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:23:32,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:32,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:23:32,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:32,311 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:23:32,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:23:32,311 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:32,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:23:32,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:32,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:32,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:32,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:23:32,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:23:32,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:23:32,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:23:32,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:23:32,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:23:32,313 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:23:32,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:23:32,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:23:32,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:23:32,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:23:32,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:23:32,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:32,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:23:32,315 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:23:32,316 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:23:32,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:23:32,322 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:23:32,323 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:32,324 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:32,324 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:32,327 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:32,327 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:32,327 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:32,328 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:32,341 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3633, Threshold=0.3513, Accuracy=0.5148, F1=0.6667, Precision=0.8087, Recall=0.5671
2025-08-04 20:23:32,342 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5148, F1: 0.6667, Prec: 0.8087, Rec: 0.5671, Avg Anomaly Score: 0.3633
2025-08-04 20:23:37,599 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:37,599 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:37,599 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:37,600 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:23:37,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:23:37,600 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:37,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:37,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:37,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:23:37,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:23:38,000 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:38,113 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:38,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:38,119 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:38,124 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:23:38,130 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:38,131 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:23:38,131 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:38,131 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:38,131 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:23:38,141 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:38,144 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:38,146 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:38,148 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:38,151 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:38,153 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:38,155 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:38,158 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:38,161 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:38,162 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:38,165 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:38,174 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:38,174 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:23:38,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:23:38,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:23:38,184 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:38,184 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:23:38,193 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:38,193 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:23:38,193 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:38,209 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:38,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:23:38,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:23:38,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:38,221 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:38,221 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:38,222 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:38,222 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:38,222 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:23:38,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:38,223 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:23:38,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:38,224 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:23:38,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:23:38,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:38,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:23:38,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:38,225 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:38,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:38,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:23:38,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:23:38,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:23:38,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:23:38,226 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:23:38,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:23:38,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:23:38,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:23:38,227 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:23:38,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:23:38,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:23:38,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:23:38,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:38,228 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:23:38,228 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:38,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:38,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:38,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:23:38,229 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:23:38,229 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:23:38,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:23:38,236 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:23:38,236 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:38,237 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:38,238 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:38,239 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 12/400.
2025-08-04 20:23:38,341 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:38,341 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:38,342 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: No anomalies to add (available: 1, target: 0). GAN training with normal data only.
2025-08-04 20:23:38,343 - ClientAppLogger [Client 0] - INFO - [Client] Round 12: Training GAN with 2 samples (2 normal, 0 anomalous).
2025-08-04 20:23:38,343 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:39,626 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0338, Avg D Loss: 0.8270
2025-08-04 20:23:39,626 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0338, Avg D Loss: 0.8270
2025-08-04 20:23:39,626 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:39,640 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3530, Threshold=0.3403, Accuracy=0.5183, F1=0.6691, Precision=0.8116, Recall=0.5691
2025-08-04 20:23:39,641 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.6691
2025-08-04 20:23:39,641 - ClientAppLogger [Client 0] - INFO - Fit completed for round 12. Duration: 1.40s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 12, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0338316679000856, 'd_loss': 0.826976352930069, 'post_fit_local_f1': 0.6690561529271206, 'fit_time_seconds': 1.4016408920288086, 'cpu_percent_fit': 6.29375, 'ram_mb_fit': 96.265625, 'accumulated_train_samples_this_round': 2}
2025-08-04 20:23:39,641 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:23:47,922 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:47,922 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:47,922 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:47,923 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:23:47,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:23:47,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:48,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:48,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:48,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:23:48,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:23:48,316 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:48,421 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:48,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:48,427 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:48,431 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:23:48,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:48,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:23:48,437 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:48,437 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:48,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:23:48,446 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:48,449 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:48,451 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:48,453 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:48,456 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:48,458 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:48,460 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:48,463 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:48,466 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:48,467 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:48,470 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:48,479 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:48,479 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:23:48,484 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:23:48,484 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:23:48,490 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:48,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:23:48,501 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:48,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:23:48,502 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:48,517 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:48,522 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:23:48,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:23:48,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:48,527 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:48,527 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:48,528 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:48,528 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:48,528 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:23:48,529 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:48,529 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:23:48,529 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:48,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:23:48,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:23:48,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:48,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:23:48,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:48,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:48,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:48,531 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:23:48,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:23:48,532 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:23:48,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:23:48,532 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:23:48,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:23:48,533 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:23:48,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:23:48,533 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:23:48,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:23:48,533 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:23:48,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:23:48,534 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:48,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:23:48,534 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:48,534 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:48,535 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:48,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:23:48,535 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:23:48,535 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:23:48,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:23:48,538 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:23:48,538 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:48,540 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:48,540 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:23:48,541 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:48,541 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:48,542 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:48,542 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:48,555 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3028, Threshold=0.2953, Accuracy=0.5252, F1=0.6738, Precision=0.8174, Recall=0.5732
2025-08-04 20:23:48,555 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5252, F1: 0.6738, Prec: 0.8174, Rec: 0.5732, Avg Anomaly Score: 0.3028
2025-08-04 20:23:59,851 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:59,851 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:23:59,851 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:23:59,851 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:23:59,851 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:23:59,851 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:00,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:00,158 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:00,245 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:24:00,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:24:00,300 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:00,458 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:00,465 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:00,466 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:00,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:24:00,481 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:00,481 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:24:00,482 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:00,483 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:00,483 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:24:00,494 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:00,498 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,500 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:00,502 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:00,504 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:00,507 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:00,509 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:00,512 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:00,514 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:00,516 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:00,519 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:00,529 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:00,529 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:24:00,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:24:00,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:24:00,540 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:00,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:24:00,552 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:00,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:24:00,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:00,569 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:00,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:24:00,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:24:00,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:00,579 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:00,579 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:00,579 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:00,580 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:00,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:24:00,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:00,580 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:24:00,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:00,582 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:24:00,582 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:24:00,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:00,583 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:24:00,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:00,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:00,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:00,583 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:24:00,584 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:24:00,585 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:24:00,585 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:24:00,585 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:24:00,585 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:24:00,585 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:00,585 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:24:00,586 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:00,586 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:00,586 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:00,586 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:24:00,586 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:24:00,587 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:24:00,587 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:24:00,593 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:24:00,593 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:00,595 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:00,595 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:00,596 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:00,596 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:00,597 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:00,597 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:00,612 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3050, Threshold=0.3023, Accuracy=0.5426, F1=0.6858, Precision=0.8319, Recall=0.5833
2025-08-04 20:24:00,612 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5426, F1: 0.6858, Prec: 0.8319, Rec: 0.5833, Avg Anomaly Score: 0.3050
2025-08-04 20:24:11,900 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:11,900 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:11,901 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:11,901 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:24:11,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:24:11,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:12,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:12,190 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:12,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:24:12,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:24:12,305 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:12,418 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:12,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:12,427 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:12,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:24:12,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:12,438 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:24:12,439 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:12,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:12,439 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:24:12,448 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:12,450 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,453 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:12,455 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:12,458 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:12,460 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:12,463 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:12,465 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:12,468 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:12,470 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:12,472 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:12,483 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:12,483 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:24:12,489 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:24:12,489 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:24:12,495 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:12,496 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:24:12,511 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:12,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:24:12,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:12,527 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:12,532 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:24:12,538 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:24:12,538 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:12,538 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:12,538 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:12,538 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:12,539 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:12,539 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:24:12,539 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:12,539 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:24:12,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:12,541 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:24:12,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:24:12,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:24:12,543 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:24:12,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:24:12,543 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:24:12,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:24:12,543 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:24:12,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:24:12,544 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:24:12,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:24:12,544 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:24:12,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:24:12,544 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:12,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:24:12,545 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:12,545 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:12,545 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:12,546 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:24:12,546 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:24:12,546 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:24:12,546 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:24:12,549 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:24:12,549 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:12,550 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:12,550 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:12,552 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:12,552 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:12,552 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:12,553 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:12,567 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3227, Threshold=0.3240, Accuracy=0.5878, F1=0.7168, Precision=0.8696, Recall=0.6098
2025-08-04 20:24:12,567 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.5878, F1: 0.7168, Prec: 0.8696, Rec: 0.6098, Avg Anomaly Score: 0.3227
2025-08-04 20:24:23,884 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:23,884 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:23,885 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:23,885 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:24:23,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:24:23,885 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:24,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:24,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:24,341 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:24:24,392 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:24:24,392 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:24,534 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:24,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:24,540 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:24,546 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:24:24,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:24,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:24:24,554 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:24,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:24,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:24:24,563 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:24,566 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,569 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:24,571 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:24,574 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:24,576 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:24,578 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:24,581 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:24,584 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:24,586 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:24,588 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:24,598 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:24,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:24:24,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:24:24,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:24:24,608 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:24,608 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:24:24,619 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:24,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:24:24,619 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:24,636 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:24,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:24:24,655 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:24:24,655 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:24,655 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:24,655 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:24,655 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:24,656 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:24,656 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:24:24,656 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:24,656 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:24:24,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:24,658 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:24:24,658 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:24:24,658 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:24:24,659 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:24:24,660 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:24:24,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:24:24,661 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:24,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:24:24,661 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:24,661 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:24,661 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:24,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:24:24,662 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:24:24,662 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:24:24,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:24:24,668 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:24:24,669 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:24,670 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:24,670 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:24,671 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:24,672 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:24,672 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:24,672 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:24,685 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3027, Threshold=0.3061, Accuracy=0.6678, F1=0.7718, Precision=0.9362, Recall=0.6565
2025-08-04 20:24:24,686 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6678, F1: 0.7718, Prec: 0.9362, Rec: 0.6565, Avg Anomaly Score: 0.3027
2025-08-04 20:24:35,983 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:35,984 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:35,984 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:35,984 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:24:35,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:24:35,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:36,281 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:36,281 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:36,373 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:24:36,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:24:36,422 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:36,582 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:36,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:36,590 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:36,596 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:24:36,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:36,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:24:36,604 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:36,604 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:36,604 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:24:36,613 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:36,616 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,619 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:36,621 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:36,624 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:36,626 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:36,628 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:36,631 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:36,633 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:36,636 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:36,638 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:36,648 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:36,648 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:24:36,652 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:24:36,653 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:24:36,658 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:36,658 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:24:36,667 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:36,667 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:24:36,667 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:36,682 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:36,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:24:36,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:24:36,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:36,692 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:36,692 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:36,692 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:36,692 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:36,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:24:36,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:36,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:24:36,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:36,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:24:36,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:24:36,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:36,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:24:36,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:36,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:24:36,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:24:36,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:24:36,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:24:36,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:24:36,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:24:36,698 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:24:36,698 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:24:36,698 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:36,698 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:24:36,698 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:36,699 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:36,699 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:36,699 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:24:36,699 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:24:36,700 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:24:36,700 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:24:36,709 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:24:36,710 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:36,711 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:36,711 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:36,712 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:36,712 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:36,713 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:36,713 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:36,726 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3009, Threshold=0.3045, Accuracy=0.6574, F1=0.7646, Precision=0.9275, Recall=0.6504
2025-08-04 20:24:36,726 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6574, F1: 0.7646, Prec: 0.9275, Rec: 0.6504, Avg Anomaly Score: 0.3009
2025-08-04 20:24:48,015 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:48,015 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:48,016 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:48,016 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:24:48,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:24:48,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:48,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:48,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:48,408 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:24:48,425 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:24:48,425 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:48,519 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:48,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:48,528 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:48,534 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:24:48,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:48,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:24:48,543 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:48,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:48,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:24:48,552 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:48,555 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,557 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:48,560 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:48,562 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:48,564 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:48,567 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:48,570 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:48,573 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:48,575 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:48,578 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:48,587 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:48,587 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:24:48,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:24:48,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:24:48,598 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:48,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:24:48,610 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:48,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:24:48,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:48,630 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:48,635 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:24:48,640 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:24:48,640 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:48,640 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:48,640 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:48,640 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:48,641 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:48,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:24:48,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:48,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:24:48,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:48,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:24:48,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:24:48,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:48,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:24:48,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:48,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:48,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:48,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:24:48,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:24:48,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:24:48,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:24:48,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:24:48,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:24:48,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:24:48,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:24:48,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:24:48,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:24:48,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:24:48,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:24:48,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:48,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:24:48,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:48,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:48,647 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:48,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:24:48,647 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:24:48,647 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:24:48,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:24:48,649 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:24:48,649 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:48,651 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:48,651 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:24:48,652 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:48,652 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:48,653 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:48,653 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:48,666 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.2996, Threshold=0.3042, Accuracy=0.6539, F1=0.7622, Precision=0.9246, Recall=0.6484
2025-08-04 20:24:48,667 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6539, F1: 0.7622, Prec: 0.9246, Rec: 0.6484, Avg Anomaly Score: 0.2996
2025-08-04 20:24:59,970 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:59,970 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:24:59,970 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:24:59,971 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:24:59,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:24:59,971 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:00,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:00,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:00,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:25:00,443 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:25:00,443 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:00,573 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:00,579 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:00,580 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:00,585 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:25:00,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:00,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:25:00,591 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:00,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:00,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:25:00,600 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:00,603 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,605 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:00,608 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:00,611 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:00,613 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:00,616 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:00,619 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:00,621 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:00,623 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:00,626 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:00,636 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:00,637 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:25:00,642 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:25:00,642 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:25:00,647 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:00,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:25:00,657 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:00,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:25:00,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:00,674 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:00,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:25:00,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:25:00,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:00,686 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:00,686 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:00,687 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:00,687 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:00,687 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:25:00,687 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:00,688 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:25:00,688 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:00,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:25:00,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:25:00,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:00,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:25:00,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:25:00,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:25:00,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:25:00,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:25:00,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:25:00,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:25:00,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:25:00,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:25:00,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:00,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:25:00,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:00,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:00,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:00,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:25:00,694 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:25:00,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:25:00,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:25:00,701 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:25:00,701 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:00,703 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:00,703 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:00,705 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:00,705 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:00,705 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:00,706 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:00,719 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3070, Threshold=0.3132, Accuracy=0.6609, F1=0.7670, Precision=0.9304, Recall=0.6524
2025-08-04 20:25:00,719 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6609, F1: 0.7670, Prec: 0.9304, Rec: 0.6524, Avg Anomaly Score: 0.3070
2025-08-04 20:25:12,012 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:12,013 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:12,013 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:12,013 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:25:12,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:25:12,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:12,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:12,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:12,410 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:25:12,452 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:25:12,452 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:12,549 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:12,555 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:12,555 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:12,561 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:25:12,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:12,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:25:12,569 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:12,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:12,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:25:12,579 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:12,582 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,584 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:12,587 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:12,589 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:12,592 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:12,594 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:12,597 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:12,599 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:12,601 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:12,603 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:12,613 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:12,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:25:12,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:25:12,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:25:12,623 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:12,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:25:12,633 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:12,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:25:12,634 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:12,649 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:12,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:25:12,659 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:25:12,659 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:12,659 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:12,659 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:12,660 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:12,660 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:12,660 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:25:12,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:12,661 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:25:12,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:12,662 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:25:12,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:25:12,663 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:12,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:25:12,663 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:12,663 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:25:12,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:25:12,665 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:25:12,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:25:12,665 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:25:12,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:25:12,665 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:25:12,666 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:25:12,666 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:12,666 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:25:12,666 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:12,666 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:12,667 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:12,667 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:25:12,667 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:25:12,667 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:25:12,667 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:25:12,669 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:25:12,670 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:12,671 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:12,671 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:12,672 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:12,672 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:12,672 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:12,673 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:12,688 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3107, Threshold=0.3174, Accuracy=0.6609, F1=0.7670, Precision=0.9304, Recall=0.6524
2025-08-04 20:25:12,689 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6609, F1: 0.7670, Prec: 0.9304, Rec: 0.6524, Avg Anomaly Score: 0.3107
2025-08-04 20:25:23,987 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:23,987 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:23,987 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:23,987 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:25:23,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:25:23,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:24,279 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:24,280 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:24,368 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:25:24,416 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:25:24,416 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:24,560 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:24,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:24,570 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:24,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:25:24,589 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:24,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:25:24,590 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:24,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:24,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:25:24,600 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:24,603 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,607 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:24,609 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:24,613 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:24,616 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:24,619 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:24,623 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:24,627 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:24,629 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:24,631 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:24,640 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:24,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:25:24,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:25:24,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:25:24,651 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:24,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:25:24,660 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:24,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:25:24,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:24,678 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:24,683 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:25:24,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:25:24,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:24,690 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:24,690 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:24,690 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:24,691 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:24,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:25:24,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:24,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:25:24,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:24,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:25:24,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:25:24,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:25:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:25:24,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:25:24,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:25:24,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:25:24,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:25:24,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:25:24,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:25:24,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:25:24,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:25:24,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:25:24,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:24,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:25:24,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:24,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:24,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:24,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:25:24,697 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:25:24,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:25:24,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:25:24,702 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:25:24,702 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:24,704 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:24,704 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:24,705 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:24,705 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:24,706 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:24,706 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:24,720 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3229, Threshold=0.3302, Accuracy=0.6609, F1=0.7670, Precision=0.9304, Recall=0.6524
2025-08-04 20:25:24,720 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6609, F1: 0.7670, Prec: 0.9304, Rec: 0.6524, Avg Anomaly Score: 0.3229
2025-08-04 20:25:36,014 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:36,014 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:36,014 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:36,014 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:25:36,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:25:36,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:36,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:36,344 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:36,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:25:36,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:25:36,474 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:36,580 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:36,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:36,588 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:36,595 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:25:36,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:36,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:25:36,602 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:36,602 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:36,603 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:25:36,611 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:36,615 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,617 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:36,619 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:36,622 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:36,625 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:36,627 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:36,631 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:36,634 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:36,637 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:36,639 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:36,651 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:36,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:25:36,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:25:36,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:25:36,664 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:36,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:25:36,685 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:36,685 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:25:36,686 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:36,712 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:36,718 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:25:36,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:25:36,728 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:36,728 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:36,729 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:36,729 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:36,729 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:36,729 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:25:36,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:36,730 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:25:36,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:25:36,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:25:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:36,732 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:25:36,732 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:36,733 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:25:36,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:25:36,734 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:25:36,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:25:36,734 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:25:36,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:25:36,734 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:25:36,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:25:36,735 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:25:36,735 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:25:36,735 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:25:36,736 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:25:36,736 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:36,736 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:25:36,736 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:36,736 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:36,737 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:36,737 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:25:36,737 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:25:36,737 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:25:36,737 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:25:36,739 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:25:36,740 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:36,741 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:36,742 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:36,744 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:36,744 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:36,744 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:36,745 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:36,759 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3202, Threshold=0.3283, Accuracy=0.6609, F1=0.7670, Precision=0.9304, Recall=0.6524
2025-08-04 20:25:36,759 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6609, F1: 0.7670, Prec: 0.9304, Rec: 0.6524, Avg Anomaly Score: 0.3202
2025-08-04 20:25:42,019 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:42,019 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:42,020 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:42,020 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:25:42,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:25:42,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:42,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:42,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:42,409 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:25:42,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:25:42,455 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:42,590 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:42,601 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:42,601 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:42,606 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:25:42,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:42,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:25:42,613 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:42,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:42,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:25:42,622 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:42,625 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:42,627 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:42,629 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:42,632 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:42,634 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:42,637 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:42,639 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:42,642 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:42,644 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:42,646 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:42,657 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:42,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:25:42,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:25:42,662 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:25:42,667 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:42,667 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:25:42,676 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:42,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:25:42,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:42,692 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:42,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:25:42,705 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:25:42,705 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:42,705 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:42,705 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:42,706 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:42,707 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:42,707 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:25:42,707 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:42,707 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:25:42,707 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:42,709 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:25:42,709 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:25:42,710 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:25:42,711 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:25:42,711 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:25:42,711 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:25:42,711 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:25:42,711 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:42,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:25:42,713 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:42,713 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:42,713 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:42,713 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:25:42,714 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:25:42,714 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:25:42,714 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:25:42,719 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:25:42,719 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:42,721 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:42,721 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:42,723 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 22/400.
2025-08-04 20:25:42,824 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:42,824 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:42,826 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 1 anomalous samples to GAN training data (target: 1).
2025-08-04 20:25:42,826 - ClientAppLogger [Client 0] - INFO - [Client] Round 22: Training GAN with 5 samples (4 normal, 1 anomalous).
2025-08-04 20:25:42,826 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:42,851 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0658, Avg D Loss: 0.8746
2025-08-04 20:25:42,852 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0658, Avg D Loss: 0.8746
2025-08-04 20:25:42,852 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:42,866 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3112, Threshold=0.3195, Accuracy=0.6609, F1=0.7670, Precision=0.9304, Recall=0.6524
2025-08-04 20:25:42,866 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.7670
2025-08-04 20:25:42,866 - ClientAppLogger [Client 0] - INFO - Fit completed for round 22. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 22, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.065822958946228, 'd_loss': 0.8745785653591156, 'post_fit_local_f1': 0.7670250896057348, 'fit_time_seconds': 0.14358735084533691, 'cpu_percent_fit': 7.39375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 5}
2025-08-04 20:25:42,867 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 20:25:48,138 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:48,138 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:25:48,138 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:25:48,138 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:25:48,138 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:25:48,138 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:48,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:48,508 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:48,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:25:48,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:25:48,644 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:48,757 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:48,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:48,769 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:48,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:25:48,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:48,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:25:48,796 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:48,796 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:48,797 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:25:48,806 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:48,809 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,812 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:48,814 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:48,817 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:48,820 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:48,823 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:48,825 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:48,828 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:48,830 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:48,833 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:48,848 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:48,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:25:48,854 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:25:48,854 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:25:48,863 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:48,863 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:25:48,880 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:48,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:25:48,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:48,900 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:48,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:25:48,916 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:25:48,916 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:48,916 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:48,916 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:25:48,917 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:48,919 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:25:48,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:25:48,920 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:48,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:25:48,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:48,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:48,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:48,921 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:25:48,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:25:48,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:25:48,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:25:48,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:25:48,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:25:48,922 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:25:48,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:25:48,923 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:25:48,923 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:25:48,924 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:25:48,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:25:48,924 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:48,924 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:25:48,925 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:48,925 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:48,925 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:48,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:25:48,925 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:25:48,926 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:25:48,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:25:48,934 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:25:48,934 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:48,936 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:48,936 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:25:48,937 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:48,938 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:48,938 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:48,939 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:48,956 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3238, Threshold=0.3324, Accuracy=0.6713, F1=0.7742, Precision=0.9391, Recall=0.6585
2025-08-04 20:25:48,956 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6713, F1: 0.7742, Prec: 0.9391, Rec: 0.6585, Avg Anomaly Score: 0.3238
2025-08-04 20:26:03,232 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:03,232 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:03,233 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:03,233 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:26:03,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:26:03,233 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:03,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:03,774 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:03,887 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:26:03,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:26:03,948 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:04,162 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:04,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:04,173 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:04,181 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:26:04,190 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:04,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:26:04,192 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:04,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:04,193 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:26:04,206 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:04,210 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,216 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:04,220 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:04,224 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:04,228 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:04,232 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:04,235 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:04,239 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:04,242 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:04,245 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:04,259 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:04,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:26:04,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:26:04,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:26:04,271 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:04,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:26:04,285 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:04,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:26:04,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:04,304 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:04,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:26:04,324 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:26:04,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:04,325 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:04,325 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:04,326 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:04,326 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:04,326 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:26:04,326 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:04,326 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:26:04,326 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:04,328 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:26:04,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:26:04,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:04,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:26:04,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:04,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:04,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:04,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:26:04,330 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:26:04,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:26:04,330 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:26:04,330 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:26:04,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:26:04,331 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:26:04,331 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:26:04,331 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:26:04,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:26:04,332 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:26:04,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:26:04,332 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:04,332 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:26:04,332 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:04,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:04,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:04,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:26:04,333 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:26:04,333 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:26:04,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:26:04,341 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:26:04,341 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:04,342 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:04,342 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:04,344 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:04,344 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:04,344 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:04,345 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:04,362 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3316, Threshold=0.3415, Accuracy=0.6748, F1=0.7766, Precision=0.9420, Recall=0.6606
2025-08-04 20:26:04,362 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6748, F1: 0.7766, Prec: 0.9420, Rec: 0.6606, Avg Anomaly Score: 0.3316
2025-08-04 20:26:15,641 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:15,641 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:15,641 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:15,641 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:26:15,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:26:15,642 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:16,067 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:16,068 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:16,170 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:26:16,215 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:26:16,215 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:16,360 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:16,370 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:16,370 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:16,378 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:26:16,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:16,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:26:16,391 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:16,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:16,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:26:16,403 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:16,407 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,410 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:16,413 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:16,416 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:16,418 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:16,421 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:16,424 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:16,427 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:16,429 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:16,432 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:16,444 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:16,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:26:16,449 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:26:16,450 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:26:16,457 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:16,458 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:26:16,478 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:16,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:26:16,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:16,504 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:16,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:26:16,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:26:16,521 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:16,521 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:16,522 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:16,522 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:16,522 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:16,523 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:26:16,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:16,523 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:26:16,523 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:16,525 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:26:16,525 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:26:16,525 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:16,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:26:16,526 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:16,526 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:16,526 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:16,526 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:26:16,526 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:26:16,527 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:26:16,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:26:16,527 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:26:16,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:26:16,528 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:26:16,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:26:16,528 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:26:16,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:26:16,529 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:26:16,529 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:26:16,529 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:16,529 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:26:16,529 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:16,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:16,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:16,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:26:16,530 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:26:16,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:26:16,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:26:16,534 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:26:16,534 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:16,536 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:16,536 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:16,537 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:16,537 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:16,537 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:16,538 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:16,554 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3226, Threshold=0.3320, Accuracy=0.6713, F1=0.7742, Precision=0.9391, Recall=0.6585
2025-08-04 20:26:16,554 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6713, F1: 0.7742, Prec: 0.9391, Rec: 0.6585, Avg Anomaly Score: 0.3226
2025-08-04 20:26:27,847 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:27,847 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:27,847 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:27,847 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:26:27,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:26:27,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:28,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:28,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:28,415 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:26:28,472 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:26:28,473 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:28,636 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:28,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:28,646 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:28,653 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:26:28,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:28,680 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:26:28,680 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:28,681 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:28,681 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:26:28,691 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:28,694 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,696 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:28,699 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:28,702 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:28,704 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:28,707 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:28,710 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:28,713 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:28,716 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:28,719 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:28,733 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:28,734 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:26:28,741 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:26:28,741 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:26:28,753 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:28,754 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:26:28,779 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:28,780 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:26:28,780 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:28,802 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:28,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:26:28,813 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:26:28,813 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:28,813 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:28,814 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:28,814 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:28,814 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:28,814 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:26:28,815 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:28,815 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:26:28,815 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:28,817 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:26:28,817 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:26:28,817 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:28,817 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:26:28,817 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:28,818 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:28,818 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:28,818 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:26:28,818 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:26:28,818 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:26:28,818 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:26:28,819 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:26:28,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:26:28,819 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:26:28,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:26:28,819 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:26:28,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:26:28,820 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:26:28,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:26:28,820 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:28,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:26:28,820 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:28,821 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:28,821 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:28,821 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:26:28,821 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:26:28,821 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:26:28,822 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:26:28,825 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:26:28,825 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:28,826 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:28,826 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:28,828 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:28,828 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:28,828 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:28,829 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:28,843 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3269, Threshold=0.3372, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:26:28,843 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3269
2025-08-04 20:26:40,122 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:40,123 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:40,123 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:40,123 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:26:40,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:26:40,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:40,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:40,612 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:40,708 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:26:40,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:26:40,768 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:40,947 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:40,956 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:40,956 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:40,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:26:40,975 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:40,975 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:26:40,976 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:40,976 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:40,976 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:26:40,992 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:40,995 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:40,998 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:41,001 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:41,005 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:41,008 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:41,011 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:41,014 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:41,018 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:41,020 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:41,023 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:41,035 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:41,035 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:26:41,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:26:41,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:26:41,047 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:41,047 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:26:41,061 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:41,062 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:26:41,063 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:41,083 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:41,091 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:26:41,103 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:26:41,105 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:41,105 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:41,105 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:41,105 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:41,106 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:41,106 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:26:41,106 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:41,106 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:26:41,106 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:41,108 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:26:41,110 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:26:41,111 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:41,111 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:26:41,111 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:41,111 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:26:41,112 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:26:41,113 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:26:41,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:26:41,113 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:26:41,113 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:26:41,114 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:26:41,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:26:41,114 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:41,114 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:26:41,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:41,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:41,118 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:41,118 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:26:41,119 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:26:41,119 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:26:41,119 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:26:41,129 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:26:41,129 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:41,132 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:41,132 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:41,133 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:41,133 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:41,133 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:41,134 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:41,151 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3308, Threshold=0.3421, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:26:41,152 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3308
2025-08-04 20:26:52,443 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:52,443 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:26:52,444 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:26:52,444 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:26:52,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:26:52,444 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:52,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:52,844 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:52,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:26:52,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:26:53,000 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:53,240 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:53,249 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:53,249 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:53,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:26:53,290 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:53,290 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:26:53,291 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:53,291 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:53,291 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:26:53,303 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:53,308 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,312 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:53,315 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:53,318 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:53,323 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:53,327 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:53,331 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:53,336 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:53,339 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:53,342 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:53,355 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:53,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:26:53,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:26:53,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:26:53,372 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:53,372 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:26:53,389 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:53,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:26:53,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:53,408 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:53,414 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:26:53,425 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:26:53,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:53,426 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:53,426 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:53,426 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:53,427 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:53,427 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:26:53,427 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:53,428 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:26:53,428 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:26:53,430 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:26:53,431 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:53,431 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:26:53,431 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:53,431 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:53,431 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:53,432 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:26:53,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:26:53,432 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:26:53,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:26:53,432 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:26:53,432 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:26:53,433 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:26:53,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:26:53,433 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:26:53,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:26:53,434 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:26:53,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:26:53,434 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:53,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:26:53,434 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:26:53,435 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:26:53,435 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:26:53,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:26:53,449 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:26:53,449 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:53,451 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:53,451 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:26:53,452 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:53,452 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:53,453 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:53,454 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:53,470 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3331, Threshold=0.3442, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:26:53,470 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3331
2025-08-04 20:27:04,747 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:04,747 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:04,747 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:04,747 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:27:04,748 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:27:04,748 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:05,247 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:05,248 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:05,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:27:05,404 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:27:05,405 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:05,530 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:05,538 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:05,538 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:05,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:27:05,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:05,553 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:27:05,554 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:05,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:05,555 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:27:05,567 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:05,571 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,574 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:05,578 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:05,581 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:05,586 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:05,588 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:05,591 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:05,594 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:05,596 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:05,599 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:05,610 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:05,610 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:27:05,615 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:27:05,615 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:27:05,621 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:05,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:27:05,637 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:05,638 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:27:05,638 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:05,657 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:05,663 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:27:05,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:27:05,671 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:05,671 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:05,671 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:05,672 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:05,672 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:05,672 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:27:05,672 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:05,673 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:27:05,673 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:05,674 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:27:05,675 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:27:05,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:05,675 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:27:05,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:05,675 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:05,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:05,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:27:05,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:27:05,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:27:05,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:27:05,676 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:27:05,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:27:05,677 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:27:05,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:27:05,677 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:27:05,677 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:27:05,677 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:27:05,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:27:05,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:05,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:27:05,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:05,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:05,678 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:05,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:27:05,679 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:27:05,679 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:27:05,679 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:27:05,682 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:27:05,683 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:05,684 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:05,684 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:05,685 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:05,685 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:05,686 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:05,686 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:05,700 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3293, Threshold=0.3389, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:27:05,700 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3293
2025-08-04 20:27:16,985 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:16,985 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:16,986 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:16,986 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:27:16,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:27:16,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:17,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:17,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:17,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:27:17,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:27:17,691 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:17,835 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:17,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:17,845 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:17,854 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:27:17,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:17,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:27:17,865 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:17,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:17,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:27:17,877 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:17,880 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,882 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:17,885 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:17,888 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:17,891 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:17,894 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:17,896 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:17,899 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:17,901 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:17,904 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:17,915 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:17,915 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:27:17,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:27:17,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:27:17,926 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:17,926 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:27:17,937 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:17,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:27:17,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:17,955 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:17,961 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:27:17,980 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:27:17,981 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:17,981 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:17,981 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:17,981 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:17,981 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:17,982 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:27:17,982 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:17,982 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:27:17,982 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:17,984 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:27:17,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:27:17,984 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:17,984 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:27:17,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:17,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:17,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:17,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:27:17,985 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:27:17,985 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:27:17,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:27:17,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:27:17,986 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:27:17,986 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:27:17,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:27:17,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:27:17,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:27:17,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:27:17,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:27:17,987 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:17,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:27:17,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:17,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:17,988 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:17,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:27:17,989 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:27:17,989 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:27:17,990 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:27:17,997 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:27:17,997 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:17,999 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:17,999 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:18,001 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:18,001 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:18,001 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:18,002 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:18,017 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3322, Threshold=0.3423, Accuracy=0.6783, F1=0.7790, Precision=0.9449, Recall=0.6626
2025-08-04 20:27:18,017 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6783, F1: 0.7790, Prec: 0.9449, Rec: 0.6626, Avg Anomaly Score: 0.3322
2025-08-04 20:27:35,322 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:35,322 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:35,322 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:35,322 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:27:35,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:27:35,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:35,629 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:35,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:35,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:27:35,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:27:35,783 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:35,903 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:35,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:35,909 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:35,914 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:27:35,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:35,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:27:35,921 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:35,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:35,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:27:35,929 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:35,931 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,934 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:35,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:35,938 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:35,940 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:35,943 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:35,945 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:35,948 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:35,950 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:35,952 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:35,960 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:35,961 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:27:35,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:27:35,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:27:35,969 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:35,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:27:35,977 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:35,978 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:27:35,978 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:35,992 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:35,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:27:36,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:27:36,001 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:36,001 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:36,001 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:36,002 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:36,002 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:36,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:27:36,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:36,003 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:27:36,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:36,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:27:36,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:27:36,005 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:36,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:27:36,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:36,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:36,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:36,006 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:27:36,006 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:27:36,007 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:27:36,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:27:36,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:27:36,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:27:36,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:36,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:27:36,008 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:36,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:36,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:36,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:27:36,009 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:27:36,009 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:27:36,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:27:36,017 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:27:36,017 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:36,018 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:36,018 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:36,019 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:36,019 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:36,020 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:36,020 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:36,034 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3330, Threshold=0.3452, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:27:36,034 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3330
2025-08-04 20:27:47,325 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:47,325 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:47,325 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:47,325 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:27:47,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:27:47,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:47,759 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:47,760 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:47,872 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:27:47,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:27:47,921 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:48,050 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:48,057 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:48,057 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:48,064 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:27:48,075 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:48,076 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:27:48,076 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:48,076 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:48,076 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:27:48,086 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:48,089 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:48,091 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:48,094 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:48,097 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:48,099 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:48,102 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:48,105 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:48,107 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:48,109 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:48,112 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:48,123 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:48,123 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:27:48,128 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:27:48,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:27:48,136 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:48,136 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:27:48,152 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:48,152 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:27:48,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:48,172 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:48,177 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:27:48,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:27:48,183 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:48,183 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:48,183 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:48,184 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:48,184 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:48,184 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:27:48,184 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:48,184 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:27:48,185 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:48,186 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:27:48,186 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:27:48,187 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:48,187 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:27:48,187 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:48,187 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:48,187 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:48,188 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:27:48,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:27:48,188 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:27:48,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:27:48,188 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:27:48,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:27:48,189 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:48,190 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:27:48,190 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:48,190 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:48,190 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:48,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:27:48,191 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:27:48,191 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:27:48,191 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:27:48,198 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:27:48,198 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:48,199 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:48,199 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:27:48,200 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:48,201 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:48,201 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:48,201 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:48,215 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3372, Threshold=0.3509, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:27:48,216 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3372
2025-08-04 20:27:59,487 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:59,487 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:27:59,487 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:27:59,487 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:27:59,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:27:59,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:59,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:59,729 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:59,811 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:27:59,846 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:27:59,846 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:59,928 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:59,934 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:59,934 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:59,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:27:59,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:59,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:27:59,944 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:59,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:59,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:27:59,952 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:59,955 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:59,957 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:59,959 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:59,962 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:59,965 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:59,967 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:59,970 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:59,973 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:59,975 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:59,977 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:59,987 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:59,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:27:59,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:27:59,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:27:59,998 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:59,998 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:28:00,011 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:00,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:28:00,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:00,028 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:00,032 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:28:00,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:28:00,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:00,037 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:00,038 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:00,038 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:00,038 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:00,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:28:00,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:00,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:28:00,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:00,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:28:00,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:28:00,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:00,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:28:00,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:00,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:28:00,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:28:00,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:00,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:00,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:00,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:28:00,044 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:28:00,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:28:00,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:28:00,047 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:28:00,047 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:00,048 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:00,048 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:00,049 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:00,049 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:00,049 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:00,050 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:00,063 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3398, Threshold=0.3530, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:28:00,063 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3398
2025-08-04 20:28:17,350 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:17,350 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:17,350 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:17,350 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:28:17,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:28:17,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:17,716 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:17,716 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:17,811 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:28:17,854 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:28:17,855 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:18,006 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:18,019 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:18,019 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:18,027 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:28:18,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:18,036 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:28:18,037 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:18,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:18,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:28:18,047 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:18,050 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,054 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:18,056 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:18,059 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:18,061 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:18,065 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:18,067 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:18,070 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:18,073 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:18,075 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:18,085 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:18,085 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:28:18,090 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:28:18,090 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:28:18,096 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:18,096 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:28:18,108 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:18,109 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:28:18,109 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:18,130 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:18,137 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:28:18,148 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:28:18,149 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:18,149 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:18,149 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:18,150 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:18,150 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:18,150 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:28:18,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:18,151 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:28:18,151 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:18,153 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:28:18,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:28:18,154 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:18,154 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:28:18,155 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:18,155 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:18,155 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:18,155 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:28:18,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:28:18,156 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:28:18,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:28:18,156 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:28:18,156 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:28:18,156 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:28:18,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:28:18,157 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:28:18,157 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:28:18,158 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:28:18,158 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:28:18,158 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:18,158 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:28:18,158 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:18,159 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:18,159 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:18,159 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:28:18,160 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:28:18,160 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:28:18,160 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:28:18,167 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:28:18,167 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:18,169 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:18,169 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:18,171 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:18,171 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:18,171 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:18,172 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:18,188 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3382, Threshold=0.3510, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:28:18,189 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3382
2025-08-04 20:28:29,471 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:29,472 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:29,472 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:29,473 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:28:29,473 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:28:29,473 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:30,026 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:30,027 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:30,141 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:28:30,184 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:28:30,185 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:30,303 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:30,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:30,313 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:30,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:28:30,333 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:30,334 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:28:30,334 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:30,334 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:30,335 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:28:30,344 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:30,347 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,349 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:30,352 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:30,355 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:30,357 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:30,360 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:30,363 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:30,366 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:30,368 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:30,371 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:30,385 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:30,385 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:28:30,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:28:30,391 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:28:30,400 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:30,400 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:28:30,417 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:30,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:28:30,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:30,438 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:30,445 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:28:30,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:28:30,454 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:30,454 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:30,455 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:30,455 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:30,456 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:30,456 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:28:30,456 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:30,456 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:28:30,456 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:30,458 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:28:30,458 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:28:30,459 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:28:30,460 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:28:30,460 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:28:30,460 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:28:30,460 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:28:30,460 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:28:30,461 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:28:30,461 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:28:30,461 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:28:30,461 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:28:30,461 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:28:30,461 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:30,462 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:28:30,463 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:28:30,463 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:28:30,463 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:28:30,467 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:28:30,467 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:30,469 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:30,469 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:30,471 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:30,471 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:30,471 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:30,472 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:30,493 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3408, Threshold=0.3541, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:28:30,494 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3408
2025-08-04 20:28:44,779 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:44,780 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:44,780 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:44,780 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:28:44,780 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:28:44,780 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:45,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:45,129 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:45,212 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:28:45,257 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:28:45,258 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:45,369 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:45,374 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:45,375 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:45,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:28:45,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:45,389 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:28:45,390 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:45,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:45,390 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:28:45,398 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:45,401 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:45,404 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:45,406 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:45,408 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:45,410 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:45,413 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:45,415 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:45,418 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:45,420 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:45,422 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:45,430 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:45,430 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:28:45,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:28:45,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:28:45,440 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:45,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:28:45,451 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:45,451 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:28:45,451 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:45,466 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:45,471 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:28:45,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:28:45,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:45,475 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:45,475 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:45,476 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:45,476 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:45,476 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:28:45,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:45,477 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:28:45,477 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:45,478 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:28:45,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:28:45,479 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:28:45,480 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:28:45,480 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:28:45,480 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:28:45,480 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:28:45,480 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:28:45,480 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:28:45,481 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:28:45,481 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:28:45,481 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:28:45,481 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:45,481 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:28:45,481 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:45,482 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:45,482 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:45,482 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:28:45,482 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:28:45,482 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:28:45,483 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:28:45,489 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:28:45,489 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:45,491 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:45,491 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:45,492 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:45,492 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:45,492 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:45,493 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:45,506 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3372, Threshold=0.3506, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:28:45,506 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3372
2025-08-04 20:28:56,808 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:56,808 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:28:56,811 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:28:56,811 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:28:56,811 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:28:56,811 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:57,207 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:57,207 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:57,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:28:57,336 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:28:57,336 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:57,451 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:57,461 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:57,461 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:57,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:28:57,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:57,504 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:28:57,505 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:57,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:57,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:28:57,514 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:57,517 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,519 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:57,521 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:57,524 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:57,526 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:57,529 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,532 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:57,535 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:57,537 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:57,540 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:57,554 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:57,554 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:28:57,559 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:28:57,560 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:28:57,566 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:57,566 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:28:57,580 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:57,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:28:57,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:57,602 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:57,610 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:28:57,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:28:57,616 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:57,617 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:57,617 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:57,617 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:57,617 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:57,618 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:28:57,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:57,618 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:28:57,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:57,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:28:57,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:28:57,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:57,620 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:28:57,620 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:28:57,621 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:28:57,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:28:57,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:28:57,622 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:28:57,622 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:28:57,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:28:57,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:28:57,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:28:57,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:57,625 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:28:57,625 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:57,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:57,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:57,626 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:28:57,626 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:28:57,626 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:28:57,627 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:28:57,637 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:28:57,637 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:57,639 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:57,639 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:28:57,640 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:57,641 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:57,641 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:57,641 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:57,657 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3413, Threshold=0.3549, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:28:57,657 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3413
2025-08-04 20:29:11,928 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:11,929 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:11,929 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:11,929 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:29:11,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:29:11,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:12,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:12,230 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:12,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:29:12,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:29:12,362 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:12,493 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:12,500 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:12,500 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:12,506 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:29:12,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:12,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:29:12,515 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:12,516 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:12,516 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:29:12,526 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:12,529 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:12,532 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:12,536 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:12,540 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:12,542 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:12,544 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:12,547 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:12,550 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:12,552 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:12,554 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:12,566 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:12,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:29:12,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:29:12,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:29:12,577 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:12,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:29:12,592 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:12,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:29:12,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:12,612 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:12,618 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:29:12,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:29:12,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:12,636 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:12,636 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:12,637 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:12,637 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:12,638 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:29:12,638 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:12,638 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:29:12,638 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:12,640 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:29:12,640 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:29:12,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:12,641 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:29:12,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:12,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:12,641 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:12,642 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:29:12,642 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:29:12,642 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:29:12,642 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:29:12,642 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:29:12,642 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:29:12,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:29:12,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:29:12,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:29:12,643 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:29:12,643 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:29:12,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:29:12,644 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:12,644 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:29:12,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:12,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:12,645 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:12,645 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:29:12,645 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:29:12,646 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:29:12,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:29:12,654 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:29:12,654 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:12,656 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:12,656 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:12,658 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:12,658 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:12,658 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:12,659 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:12,676 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3381, Threshold=0.3527, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:29:12,676 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3381
2025-08-04 20:29:26,957 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:26,957 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:26,958 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:26,958 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:29:26,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:29:26,958 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:27,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:27,294 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:27,383 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:29:27,430 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:29:27,430 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:27,567 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:27,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:27,574 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:27,580 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:29:27,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:27,597 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:29:27,598 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:27,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:27,598 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:29:27,607 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:27,611 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,613 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:27,615 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:27,618 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:27,620 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:27,622 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:27,626 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:27,629 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:27,632 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:27,635 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:27,646 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:27,646 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:29:27,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:29:27,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:29:27,656 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:27,656 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:29:27,665 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:27,666 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:29:27,666 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:27,680 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:27,685 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:29:27,689 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:29:27,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:27,690 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:27,690 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:27,690 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:27,690 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:27,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:29:27,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:27,691 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:29:27,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:27,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:29:27,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:29:27,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:27,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:29:27,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:27,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:27,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:27,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:29:27,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:29:27,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:29:27,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:29:27,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:29:27,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:29:27,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:29:27,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:29:27,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:29:27,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:29:27,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:29:27,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:29:27,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:27,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:29:27,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:27,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:27,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:27,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:29:27,697 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:29:27,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:29:27,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:29:27,706 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:29:27,706 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:27,707 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:27,707 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:27,709 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:27,709 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:27,709 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:27,710 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:27,723 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3347, Threshold=0.3501, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:29:27,724 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3347
2025-08-04 20:29:39,007 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:39,007 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:39,007 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:39,007 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:29:39,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:29:39,008 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:39,411 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:39,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:39,513 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:29:39,561 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:29:39,561 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:39,694 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:39,701 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:39,702 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:39,709 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:29:39,721 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:39,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:29:39,722 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:39,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:39,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:29:39,733 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:39,736 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,738 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:39,740 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:39,743 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:39,745 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:39,748 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:39,751 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:39,754 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:39,756 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:39,759 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:39,769 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:39,770 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:29:39,775 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:29:39,775 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:29:39,781 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:39,781 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:29:39,791 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:39,792 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:29:39,792 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:39,807 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:39,812 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:29:39,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:29:39,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:39,819 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:39,819 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:39,819 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:39,820 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:39,820 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:29:39,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:39,820 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:29:39,820 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:39,822 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:29:39,822 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:29:39,823 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:29:39,824 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:29:39,825 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:29:39,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:29:39,825 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:39,825 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:29:39,825 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:39,826 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:39,826 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:39,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:29:39,826 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:29:39,826 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:29:39,826 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:29:39,835 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:29:39,835 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:39,836 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:39,836 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:39,837 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:39,837 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:39,838 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:39,838 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:39,851 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3376, Threshold=0.3520, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:29:39,851 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3376
2025-08-04 20:29:54,138 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:54,139 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:29:54,139 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:29:54,139 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 20:29:54,139 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 20:29:54,139 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:54,559 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:54,559 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:54,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 20:29:54,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 20:29:54,694 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:54,813 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:54,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:54,820 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:54,828 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 20:29:54,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:54,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 20:29:54,848 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:54,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:54,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 20:29:54,857 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:54,860 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,862 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:54,864 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:54,867 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:54,869 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:54,873 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:54,876 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:54,879 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:54,883 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:54,886 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:54,896 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:54,897 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 20:29:54,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 20:29:54,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 20:29:54,906 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:54,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 20:29:54,914 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:54,915 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 20:29:54,915 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:54,928 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:54,933 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 20:29:54,938 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 20:29:54,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:54,939 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:54,939 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:54,939 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:54,940 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:54,940 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 20:29:54,940 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:54,940 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 20:29:54,940 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:54,942 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 20:29:54,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 20:29:54,942 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:54,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 20:29:54,942 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 20:29:54,943 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 20:29:54,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 20:29:54,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 20:29:54,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 20:29:54,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 20:29:54,944 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 20:29:54,944 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:54,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 20:29:54,945 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:54,945 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:54,945 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:54,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 20:29:54,945 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 20:29:54,946 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 20:29:54,946 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 20:29:54,950 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 20:29:54,950 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:54,951 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:54,951 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:29:54,956 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:54,956 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:54,956 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:54,957 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:54,970 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3445, Threshold=0.3598, Accuracy=0.6817, F1=0.7814, Precision=0.9478, Recall=0.6646
2025-08-04 20:29:54,970 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.6817, F1: 0.7814, Prec: 0.9478, Rec: 0.6646, Avg Anomaly Score: 0.3445
