2025-08-04 20:21:15,570 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:15,570 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:15,571 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:15,574 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:21:15,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:21:15,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:15,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:15,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:16,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:21:16,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:21:16,063 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:16,251 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:16,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:16,258 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:16,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:21:16,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:16,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:21:16,275 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:16,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:16,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:21:16,286 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:16,289 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:16,291 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:16,293 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:16,296 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:16,298 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:16,301 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:16,304 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:16,307 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:16,310 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:16,312 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:16,323 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:16,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:21:16,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:21:16,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:21:16,334 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:16,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:21:16,344 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:16,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:21:16,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:16,361 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:16,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:21:16,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:21:16,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:16,379 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:16,379 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:16,379 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:16,380 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:16,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:21:16,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:16,380 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:21:16,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:16,382 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:21:16,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:21:16,382 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:16,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:21:16,382 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:21:16,383 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:21:16,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:21:16,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:21:16,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:21:16,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:21:16,385 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:21:16,385 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:21:16,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:21:16,386 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:16,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:21:16,387 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:16,387 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:16,388 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:16,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:21:16,388 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:21:16,388 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:21:16,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:21:16,394 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:21:16,394 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:16,396 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:16,396 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:16,397 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:16,397 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:16,397 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:16,398 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:16,408 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5013, Accuracy=0.5246, F1=0.6667, Precision=0.7945, Recall=0.5743
2025-08-04 20:21:16,408 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.5246, F1: 0.6667, Prec: 0.7945, Rec: 0.5743, Avg Anomaly Score: 0.5018
2025-08-04 20:21:27,678 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:27,679 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:27,679 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:27,679 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:21:27,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:21:27,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:27,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:27,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:28,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:21:28,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:21:28,083 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:28,213 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:28,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:28,219 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:28,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:21:28,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:28,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:21:28,246 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:28,247 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:28,247 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:21:28,256 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:28,259 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:28,261 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:28,264 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:28,267 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:28,269 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:28,271 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:28,274 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:28,277 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:28,280 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:28,282 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:28,295 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:28,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:21:28,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:21:28,301 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:21:28,310 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:28,310 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:21:28,324 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:28,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:21:28,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:28,343 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:28,353 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:21:28,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:21:28,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:28,363 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:28,363 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:28,364 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:28,365 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:28,366 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:21:28,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:28,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:21:28,367 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:28,369 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:21:28,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:21:28,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:28,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:21:28,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:28,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:28,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:28,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:21:28,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:21:28,387 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:21:28,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:21:28,390 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:21:28,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:21:28,393 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:21:28,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:21:28,393 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:21:28,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:21:28,395 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:21:28,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:21:28,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:28,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:21:28,399 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:28,399 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:28,400 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:28,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:21:28,404 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:21:28,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:21:28,404 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:21:28,413 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:21:28,413 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:28,414 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:28,415 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:28,417 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:28,418 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:28,418 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:28,420 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:28,433 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5018, Threshold=0.5013, Accuracy=0.5246, F1=0.6667, Precision=0.7945, Recall=0.5743
2025-08-04 20:21:28,433 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.5246, F1: 0.6667, Prec: 0.7945, Rec: 0.5743, Avg Anomaly Score: 0.5018
2025-08-04 20:21:33,698 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:33,698 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:33,699 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:33,699 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:21:33,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:21:33,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:33,889 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:33,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:33,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:21:33,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:21:33,983 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:34,063 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:34,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:34,068 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:34,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:21:34,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:34,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:21:34,078 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:34,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:34,079 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:21:34,087 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:34,089 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:34,092 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:34,094 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:34,096 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:34,098 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:34,101 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:34,103 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:34,106 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:34,108 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:34,111 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:34,119 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:34,120 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:21:34,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:21:34,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:21:34,128 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:34,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:21:34,137 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:34,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:21:34,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:34,153 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:34,157 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:21:34,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:21:34,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:34,163 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:34,164 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:34,164 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:34,164 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:34,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:21:34,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:34,165 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:21:34,165 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:34,166 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:21:34,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:21:34,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:34,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:21:34,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:34,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:34,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:34,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:21:34,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:21:34,169 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:21:34,169 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:21:34,169 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:21:34,169 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:21:34,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:21:34,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:21:34,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:21:34,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:21:34,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:21:34,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:21:34,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:34,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:21:34,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:34,173 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:34,173 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:34,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:21:34,174 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:21:34,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:21:34,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:21:34,177 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:21:34,178 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:34,179 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:34,180 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:34,181 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 3/400.
2025-08-04 20:21:34,286 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:34,287 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:34,290 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 15 anomalous samples to GAN training data (target: 15).
2025-08-04 20:21:34,291 - ClientAppLogger [Client 2] - INFO - [Client] Round 3: Training GAN with 65 samples (50 normal, 15 anomalous).
2025-08-04 20:21:34,291 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:21:36,385 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 0.7043, Avg D Loss: 1.3815
2025-08-04 20:21:36,386 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 0.7043, Avg D Loss: 1.3815
2025-08-04 20:21:36,386 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:21:36,394 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5079, Threshold=0.5077, Accuracy=0.5410, F1=0.6782, Precision=0.8082, Recall=0.5842
2025-08-04 20:21:36,394 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6782
2025-08-04 20:21:36,395 - ClientAppLogger [Client 2] - INFO - Fit completed for round 3. Duration: 2.21s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 3, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 0.7042956612660334, 'd_loss': 1.3814811591001657, 'post_fit_local_f1': 0.6781609195402298, 'fit_time_seconds': 2.213310718536377, 'cpu_percent_fit': 5.56875, 'ram_mb_fit': 127.078125, 'accumulated_train_samples_this_round': 65}
2025-08-04 20:21:36,395 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:21:41,686 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:41,687 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:41,687 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:41,687 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:21:41,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:21:41,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:42,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:42,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:42,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:21:42,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:21:42,361 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:42,520 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:42,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:42,530 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:42,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:21:42,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:42,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:21:42,553 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:42,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:42,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:21:42,568 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:42,572 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,575 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:42,577 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:42,580 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:42,583 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:42,586 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:42,589 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:42,592 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:42,594 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:42,597 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:42,618 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:42,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:21:42,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:21:42,625 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:21:42,637 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:42,637 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:21:42,657 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:42,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:21:42,658 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:42,680 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:42,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:21:42,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:21:42,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:42,694 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:42,694 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:42,695 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:42,695 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:42,695 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:21:42,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:42,696 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:21:42,696 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:42,697 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:21:42,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:21:42,698 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:42,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:21:42,699 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:42,699 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:42,699 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:42,699 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:21:42,699 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:21:42,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:21:42,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:21:42,700 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:21:42,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:21:42,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:21:42,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:21:42,702 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:21:42,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:21:42,703 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:21:42,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:21:42,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:42,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:21:42,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:42,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:42,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:42,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:21:42,706 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:21:42,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:21:42,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:21:42,708 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:21:42,708 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:42,710 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:42,710 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:42,712 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:42,712 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:42,713 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:42,713 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:42,723 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5079, Threshold=0.5077, Accuracy=0.5410, F1=0.6782, Precision=0.8082, Recall=0.5842
2025-08-04 20:21:42,723 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.5410, F1: 0.6782, Prec: 0.8082, Rec: 0.5842, Avg Anomaly Score: 0.5079
2025-08-04 20:21:47,980 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:47,980 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:47,980 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:47,980 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:21:47,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:21:47,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:48,245 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:48,246 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:48,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:21:48,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:21:48,345 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:48,437 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:48,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:48,443 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:48,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:21:48,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:48,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:21:48,456 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:48,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:48,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:21:48,465 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:48,468 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:48,470 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:48,473 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:48,476 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:48,478 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:48,481 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:48,484 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:48,487 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:48,489 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:48,491 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:48,502 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:48,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:21:48,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:21:48,507 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:21:48,513 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:48,513 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:21:48,522 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:48,522 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:21:48,522 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:48,539 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:48,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:21:48,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:21:48,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:48,550 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:48,550 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:48,550 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:48,550 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:48,551 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:21:48,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:48,551 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:21:48,551 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:48,552 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:21:48,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:21:48,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:48,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:21:48,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:48,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:48,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:48,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:21:48,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:21:48,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:21:48,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:21:48,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:21:48,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:21:48,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:21:48,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:21:48,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:21:48,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:21:48,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:21:48,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:21:48,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:48,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:21:48,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:48,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:48,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:48,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:21:48,559 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:21:48,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:21:48,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:21:48,563 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:21:48,563 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:48,564 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:48,565 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:48,566 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 4/400.
2025-08-04 20:21:48,668 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:48,668 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:48,669 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 19 anomalous samples to GAN training data (target: 19).
2025-08-04 20:21:48,670 - ClientAppLogger [Client 2] - INFO - [Client] Round 4: Training GAN with 85 samples (66 normal, 19 anomalous).
2025-08-04 20:21:48,670 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:21:48,742 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 0.7401, Avg D Loss: 1.3520
2025-08-04 20:21:48,742 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 0.7401, Avg D Loss: 1.3520
2025-08-04 20:21:48,742 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:21:48,750 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.5246, F1=0.6667, Precision=0.7945, Recall=0.5743
2025-08-04 20:21:48,750 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6667
2025-08-04 20:21:48,750 - ClientAppLogger [Client 2] - INFO - Fit completed for round 4. Duration: 0.18s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 4, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 0.7400640611087576, 'd_loss': 1.3520001288021313, 'post_fit_local_f1': 0.6666666666666666, 'fit_time_seconds': 0.18379998207092285, 'cpu_percent_fit': 29.63125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 85}
2025-08-04 20:21:48,750 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:21:54,040 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:21:54,040 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:21:54,040 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:21:54,041 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:21:54,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:21:54,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:21:54,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:21:54,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:21:54,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:21:54,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:21:54,757 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:21:54,899 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:21:54,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:21:54,909 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:21:54,915 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:21:54,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:21:54,927 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:21:54,928 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:21:54,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:21:54,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:21:54,939 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:21:54,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:21:54,949 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:21:54,952 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:21:54,955 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:21:54,958 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:21:54,961 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:21:54,964 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:21:54,967 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:21:54,971 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:21:54,988 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:21:54,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:21:54,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:21:54,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:21:55,007 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:21:55,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:21:55,029 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:21:55,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:21:55,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:21:55,054 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:21:55,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:21:55,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:21:55,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:21:55,084 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:21:55,084 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:21:55,085 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:21:55,085 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:21:55,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:21:55,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:21:55,086 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:21:55,087 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:21:55,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:21:55,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:21:55,089 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:21:55,089 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:21:55,090 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:21:55,090 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:21:55,090 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:21:55,090 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:21:55,091 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:21:55,091 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:21:55,091 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:21:55,091 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:21:55,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:21:55,094 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:21:55,094 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:21:55,095 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:21:55,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:21:55,095 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:21:55,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:21:55,096 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:21:55,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:21:55,096 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:21:55,097 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:21:55,097 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:21:55,097 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:21:55,097 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:21:55,098 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:21:55,098 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:21:55,109 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:21:55,109 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:21:55,112 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:21:55,112 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:21:55,114 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:21:55,114 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:21:55,114 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:21:55,116 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:21:55,126 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5079, Accuracy=0.5246, F1=0.6667, Precision=0.7945, Recall=0.5743
2025-08-04 20:21:55,126 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.5246, F1: 0.6667, Prec: 0.7945, Rec: 0.5743, Avg Anomaly Score: 0.5085
2025-08-04 20:22:03,385 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:03,385 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:03,385 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:03,386 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:03,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:03,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:03,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:03,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:03,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:03,756 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:03,756 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:03,850 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:03,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:03,857 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:03,863 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:03,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:03,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:03,871 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:03,871 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:03,871 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:03,881 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:03,884 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:03,886 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:03,888 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:03,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:03,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:03,895 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:03,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:03,901 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:03,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:03,905 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:03,915 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:03,915 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:03,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:03,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:03,925 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:03,925 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:03,934 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:03,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:03,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:03,950 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:03,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:03,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:03,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:03,960 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:03,960 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:03,960 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:03,960 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:03,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:03,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:03,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:03,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:03,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:03,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:03,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:03,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:03,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:03,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:03,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:03,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:03,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:03,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:03,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:03,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:03,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:03,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:03,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:03,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:03,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:03,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:03,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:03,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:03,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:03,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:03,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:03,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:03,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:03,968 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:03,969 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:03,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:03,972 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:03,972 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:03,974 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:03,974 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:03,976 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 5/400.
2025-08-04 20:22:04,077 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:04,077 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:04,078 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 24 anomalous samples to GAN training data (target: 24).
2025-08-04 20:22:04,078 - ClientAppLogger [Client 2] - INFO - [Client] Round 5: Training GAN with 105 samples (81 normal, 24 anomalous).
2025-08-04 20:22:04,079 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:22:04,184 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 0.7929, Avg D Loss: 1.3107
2025-08-04 20:22:04,184 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 0.7929, Avg D Loss: 1.3107
2025-08-04 20:22:04,184 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:22:04,192 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.5082, F1=0.6552, Precision=0.7808, Recall=0.5644
2025-08-04 20:22:04,192 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6552
2025-08-04 20:22:04,192 - ClientAppLogger [Client 2] - INFO - Fit completed for round 5. Duration: 0.22s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 5, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 0.7928608630384717, 'd_loss': 1.3106907835460846, 'post_fit_local_f1': 0.6551724137931034, 'fit_time_seconds': 0.21636652946472168, 'cpu_percent_fit': 29.70625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 105}
2025-08-04 20:22:04,193 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:22:09,466 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:09,466 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:09,466 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:09,467 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:09,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:09,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:09,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:09,849 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:09,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:09,992 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:09,993 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:10,127 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:10,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:10,136 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:10,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:10,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:10,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:10,151 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:10,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:10,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:10,162 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:10,165 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,167 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:10,170 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:10,172 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:10,175 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:10,178 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:10,181 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:10,184 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:10,186 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:10,188 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:10,199 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:10,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:10,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:10,205 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:10,211 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:10,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:10,228 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:10,228 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:10,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:10,247 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:10,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:10,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:10,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:10,264 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:10,264 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:10,265 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:10,266 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:10,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:10,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:10,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:10,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:10,268 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:10,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:10,269 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:10,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:10,269 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:10,269 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:10,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:10,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:10,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:10,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:10,270 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:10,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:10,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:10,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:10,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:10,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:10,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:10,273 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:10,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:10,273 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:10,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:10,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:10,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:10,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:10,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:10,275 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:10,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:10,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:10,281 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:10,281 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:10,283 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:10,283 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:10,284 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:10,285 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:10,285 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:10,286 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:10,295 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5075, Accuracy=0.5082, F1=0.6552, Precision=0.7808, Recall=0.5644
2025-08-04 20:22:10,295 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.5082, F1: 0.6552, Prec: 0.7808, Rec: 0.5644, Avg Anomaly Score: 0.5085
2025-08-04 20:22:18,561 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:18,561 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:18,562 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:18,562 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:18,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:18,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:18,778 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:18,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:18,860 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:18,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:18,885 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:18,985 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:18,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:18,992 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:19,000 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:19,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:19,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:19,008 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:19,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:19,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:19,019 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:19,022 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:19,024 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:19,026 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:19,029 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:19,031 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:19,034 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:19,037 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:19,039 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:19,041 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:19,043 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:19,054 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:19,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:19,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:19,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:19,064 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:19,064 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:19,074 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:19,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:19,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:19,093 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:19,099 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:19,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:19,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:19,108 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:19,108 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:19,109 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:19,109 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:19,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:19,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:19,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:19,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:19,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:19,112 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:19,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:19,112 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:19,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:19,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:19,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:19,114 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:19,115 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:19,115 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:19,115 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:19,115 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:19,115 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:19,116 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:19,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:19,116 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:19,117 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:19,117 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:19,118 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:19,118 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:19,118 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:19,118 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:19,124 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:19,124 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:19,125 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:19,126 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:19,127 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 6/400.
2025-08-04 20:22:19,229 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:19,229 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:19,230 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 29 anomalous samples to GAN training data (target: 29).
2025-08-04 20:22:19,231 - ClientAppLogger [Client 2] - INFO - [Client] Round 6: Training GAN with 126 samples (97 normal, 29 anomalous).
2025-08-04 20:22:19,231 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:22:19,329 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 0.8855, Avg D Loss: 1.2490
2025-08-04 20:22:19,330 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 0.8855, Avg D Loss: 1.2490
2025-08-04 20:22:19,330 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:22:19,339 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:22:19,339 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6322
2025-08-04 20:22:19,340 - ClientAppLogger [Client 2] - INFO - Fit completed for round 6. Duration: 0.21s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 6, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 0.885472800239684, 'd_loss': 1.2490494824591136, 'post_fit_local_f1': 0.632183908045977, 'fit_time_seconds': 0.21273565292358398, 'cpu_percent_fit': 30.30625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 126}
2025-08-04 20:22:19,340 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:22:24,629 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:24,629 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:24,629 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:24,630 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:24,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:24,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:24,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:24,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:25,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:25,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:25,064 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:25,188 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:25,196 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:25,197 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:25,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:25,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:25,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:25,218 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:25,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:25,218 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:25,228 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:25,231 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,234 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:25,236 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:25,239 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:25,241 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:25,243 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:25,246 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:25,249 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:25,252 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:25,254 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:25,266 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:25,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:25,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:25,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:25,279 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:25,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:25,303 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:25,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:25,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:25,321 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:25,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:25,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:25,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:25,333 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:25,333 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:25,334 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:25,334 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:25,334 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:25,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:25,335 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:25,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:25,336 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:25,336 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:25,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:25,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:25,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:25,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:25,337 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:25,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:25,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:25,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:25,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:25,338 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:25,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:25,339 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:25,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:25,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:25,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:25,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:25,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:25,340 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:25,341 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:25,341 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:25,342 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:25,342 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:25,342 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:25,342 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:25,343 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:25,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:25,348 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:25,348 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:25,350 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:25,350 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:25,352 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:25,352 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:25,352 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:25,353 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:25,362 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5053, Threshold=0.5037, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:22:25,362 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.4754, F1: 0.6322, Prec: 0.7534, Rec: 0.5446, Avg Anomaly Score: 0.5053
2025-08-04 20:22:33,627 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:33,627 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:33,627 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:33,627 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:33,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:33,628 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:33,845 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:33,845 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:33,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:33,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:33,957 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:34,064 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:34,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:34,074 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:34,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:34,091 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:34,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:34,092 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:34,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:34,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:34,101 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:34,104 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:34,106 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:34,108 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:34,111 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:34,113 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:34,116 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:34,119 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:34,121 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:34,123 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:34,126 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:34,136 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:34,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:34,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:34,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:34,147 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:34,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:34,160 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:34,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:34,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:34,178 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:34,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:34,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:34,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:34,192 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:34,192 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:34,193 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:34,193 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:34,193 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:34,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:34,193 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:34,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:34,195 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:34,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:34,195 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:34,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:34,195 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:34,196 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:34,198 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:34,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:34,198 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:34,198 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:34,198 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:34,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:34,199 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:34,199 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:34,199 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:34,200 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:34,200 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:34,200 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:34,200 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:34,200 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:34,201 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:34,205 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:34,205 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:34,206 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:34,207 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:34,208 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 7/400.
2025-08-04 20:22:34,309 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:34,310 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:34,311 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 33 anomalous samples to GAN training data (target: 33).
2025-08-04 20:22:34,312 - ClientAppLogger [Client 2] - INFO - [Client] Round 7: Training GAN with 146 samples (113 normal, 33 anomalous).
2025-08-04 20:22:34,312 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:22:34,435 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 1.0113, Avg D Loss: 1.1833
2025-08-04 20:22:34,435 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 1.0113, Avg D Loss: 1.1833
2025-08-04 20:22:34,436 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:22:34,443 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4970, Threshold=0.4942, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:22:34,444 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6322
2025-08-04 20:22:34,444 - ClientAppLogger [Client 2] - INFO - Fit completed for round 7. Duration: 0.24s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 7, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 1.0113143207275705, 'd_loss': 1.1833498182362074, 'post_fit_local_f1': 0.632183908045977, 'fit_time_seconds': 0.23594045639038086, 'cpu_percent_fit': 30.63125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 146}
2025-08-04 20:22:34,444 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:22:39,712 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:39,712 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:39,712 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:39,713 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:39,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:39,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:39,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:39,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:40,097 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:40,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:40,125 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:40,262 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:40,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:40,275 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:40,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:40,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:40,294 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:40,295 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:40,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:40,295 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:40,305 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:40,309 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,312 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:40,315 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:40,318 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:40,320 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:40,323 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:40,326 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:40,328 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:40,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:40,333 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:40,346 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:40,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:40,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:40,352 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:40,360 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:40,360 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:40,377 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:40,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:40,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:40,402 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:40,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:40,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:40,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:40,442 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:40,442 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:40,443 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:40,443 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:40,443 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:40,443 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:40,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:40,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:40,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:40,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:40,446 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:40,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:40,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:40,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:40,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:40,447 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:40,447 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:40,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:40,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:40,448 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:40,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:40,451 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:40,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:40,451 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:40,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:40,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:40,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:40,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:40,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:40,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:40,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:40,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:40,454 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:40,454 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:40,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:40,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:40,460 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:40,460 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:40,462 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:40,463 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:40,464 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:40,465 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:40,465 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:40,466 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:40,476 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4970, Threshold=0.4942, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:22:40,476 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.4754, F1: 0.6322, Prec: 0.7534, Rec: 0.5446, Avg Anomaly Score: 0.4970
2025-08-04 20:22:48,740 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:48,740 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:48,740 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:48,740 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:48,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:48,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:48,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:48,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:49,057 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:49,084 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:49,085 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:49,171 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:49,177 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:49,177 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:49,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:49,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:49,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:49,192 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:49,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:49,192 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:49,200 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:49,203 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:49,206 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:49,208 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:49,210 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:49,213 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:49,215 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:49,217 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:49,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:49,222 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:49,224 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:49,234 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:49,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:49,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:49,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:49,244 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:49,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:49,253 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:49,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:49,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:49,270 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:49,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:49,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:49,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:49,279 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:49,279 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:49,280 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:49,280 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:49,280 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:49,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:49,280 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:49,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:49,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:49,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:49,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:49,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:49,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:49,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:49,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:49,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:49,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:49,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:49,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:49,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:49,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:49,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:49,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:49,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:49,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:49,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:49,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:49,287 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:49,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:49,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:49,291 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:49,291 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:49,293 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:49,293 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:49,294 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 8/400.
2025-08-04 20:22:49,395 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:49,396 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:49,397 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 37 anomalous samples to GAN training data (target: 37).
2025-08-04 20:22:49,397 - ClientAppLogger [Client 2] - INFO - [Client] Round 8: Training GAN with 163 samples (126 normal, 37 anomalous).
2025-08-04 20:22:49,397 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:22:49,532 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 1.2125, Avg D Loss: 1.1079
2025-08-04 20:22:49,533 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 1.2125, Avg D Loss: 1.1079
2025-08-04 20:22:49,533 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:22:49,541 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4814, Threshold=0.4773, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:22:49,541 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6322
2025-08-04 20:22:49,541 - ClientAppLogger [Client 2] - INFO - Fit completed for round 8. Duration: 0.25s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 8, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 1.212500091564436, 'd_loss': 1.1078583444554382, 'post_fit_local_f1': 0.632183908045977, 'fit_time_seconds': 0.24646472930908203, 'cpu_percent_fit': 30.44375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 163}
2025-08-04 20:22:49,541 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:22:54,818 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:22:54,818 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:22:54,818 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:22:54,818 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:22:54,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:22:54,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:22:55,094 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:22:55,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:22:55,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:22:55,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:22:55,195 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:22:55,291 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:22:55,299 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:22:55,299 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:22:55,306 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:22:55,312 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:22:55,312 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:22:55,313 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:22:55,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:22:55,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:22:55,322 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:22:55,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:55,327 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:22:55,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:22:55,333 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:22:55,336 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:22:55,338 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:22:55,341 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:22:55,345 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:22:55,347 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:22:55,349 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:22:55,360 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:22:55,360 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:22:55,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:22:55,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:22:55,371 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:22:55,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:22:55,383 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:22:55,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:22:55,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:22:55,400 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:22:55,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:22:55,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:22:55,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:22:55,411 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:22:55,411 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:22:55,412 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:22:55,412 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:22:55,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:22:55,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:22:55,413 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:22:55,413 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:22:55,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:22:55,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:22:55,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:22:55,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:22:55,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:22:55,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:22:55,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:22:55,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:22:55,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:22:55,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:22:55,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:22:55,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:22:55,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:22:55,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:22:55,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:22:55,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:22:55,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:22:55,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:22:55,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:22:55,420 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:22:55,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:22:55,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:22:55,424 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:22:55,424 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:22:55,425 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:22:55,425 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:22:55,426 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:22:55,427 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:22:55,427 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:22:55,428 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:22:55,437 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4814, Threshold=0.4773, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:22:55,437 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.4754, F1: 0.6322, Prec: 0.7534, Rec: 0.5446, Avg Anomaly Score: 0.4814
2025-08-04 20:23:00,689 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:00,690 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:00,690 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:00,690 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:00,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:00,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:00,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:00,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:01,051 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:01,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:01,075 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:01,171 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:01,178 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:01,178 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:01,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:01,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:01,193 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:01,194 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:01,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:01,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:01,203 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:01,206 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:01,208 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:01,210 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:01,213 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:01,215 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:01,217 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:01,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:01,223 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:01,224 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:01,227 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:01,238 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:01,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:01,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:01,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:01,247 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:01,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:01,257 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:01,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:01,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:01,273 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:01,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:01,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:01,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:01,286 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:01,286 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:01,286 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:01,287 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:01,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:01,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:01,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:01,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:01,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:01,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:01,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:01,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:01,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:01,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:01,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:01,291 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:01,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:01,291 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:01,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:01,291 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:01,291 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:01,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:01,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:01,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:01,292 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:01,293 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:01,293 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:01,293 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:01,293 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:01,293 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:01,297 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:01,297 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:01,299 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:01,299 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:01,300 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 9/400.
2025-08-04 20:23:01,401 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:01,402 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:01,403 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 43 anomalous samples to GAN training data (target: 43).
2025-08-04 20:23:01,404 - ClientAppLogger [Client 2] - INFO - [Client] Round 9: Training GAN with 188 samples (145 normal, 43 anomalous).
2025-08-04 20:23:01,404 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:01,566 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 1.4843, Avg D Loss: 1.0405
2025-08-04 20:23:01,566 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 1.4843, Avg D Loss: 1.0405
2025-08-04 20:23:01,566 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:01,574 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4580, Threshold=0.4522, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:23:01,574 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6322
2025-08-04 20:23:01,574 - ClientAppLogger [Client 2] - INFO - Fit completed for round 9. Duration: 0.27s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 9, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 1.4842849219099006, 'd_loss': 1.0404585906799804, 'post_fit_local_f1': 0.632183908045977, 'fit_time_seconds': 0.2737545967102051, 'cpu_percent_fit': 31.05625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 188}
2025-08-04 20:23:01,575 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:23:06,827 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:06,827 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:06,827 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:06,828 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:06,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:06,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:07,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:07,064 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:07,154 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:07,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:07,187 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:07,293 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:07,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:07,302 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:07,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:07,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:07,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:07,320 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:07,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:07,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:07,329 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:07,333 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:07,338 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:07,341 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:07,343 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:07,346 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:07,349 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:07,353 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:07,355 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:07,358 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:07,368 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:07,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:07,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:07,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:07,380 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:07,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:07,392 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:07,392 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:07,392 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:07,410 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:07,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:07,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:07,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:07,427 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:07,428 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:07,428 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:07,428 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:07,429 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:07,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:07,429 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:07,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:07,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:07,431 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:07,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:07,431 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:07,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:07,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:07,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:07,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:07,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:07,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:07,433 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:07,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:07,433 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:07,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:07,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:07,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:07,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:07,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:07,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:07,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:07,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:07,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:07,437 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:07,437 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:07,437 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:07,438 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:07,438 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:07,438 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:07,442 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:07,442 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:07,444 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:07,444 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:07,446 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:07,446 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:07,446 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:07,447 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:07,456 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4580, Threshold=0.4522, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:23:07,456 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.4754, F1: 0.6322, Prec: 0.7534, Rec: 0.5446, Avg Anomaly Score: 0.4580
2025-08-04 20:23:12,713 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:12,713 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:12,713 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:12,713 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:12,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:12,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:12,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:12,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:13,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:13,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:13,032 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:13,125 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:13,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:13,130 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:13,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:13,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:13,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:13,141 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:13,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:13,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:13,150 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:13,153 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:13,155 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:13,157 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:13,160 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:13,162 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:13,165 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:13,167 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:13,170 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:13,172 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:13,174 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:13,184 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:13,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:13,189 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:13,189 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:13,193 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:13,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:13,203 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:13,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:13,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:13,218 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:13,223 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:13,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:13,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:13,229 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:13,230 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:13,230 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:13,230 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:13,230 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:13,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:13,231 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:13,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:13,233 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:13,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:13,233 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:13,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:13,233 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:13,234 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:13,234 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:13,234 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:13,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:13,234 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:13,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:13,235 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:13,235 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:13,236 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:13,236 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:13,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:13,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:13,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:13,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:13,237 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:13,237 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:13,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:13,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:13,238 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:13,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:13,239 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:13,239 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:13,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:13,242 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:13,242 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:13,244 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:13,244 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:13,246 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 10/400.
2025-08-04 20:23:13,347 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:13,348 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:13,349 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 47 anomalous samples to GAN training data (target: 47).
2025-08-04 20:23:13,349 - ClientAppLogger [Client 2] - INFO - [Client] Round 10: Training GAN with 206 samples (159 normal, 47 anomalous).
2025-08-04 20:23:13,350 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:13,524 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 1.7879, Avg D Loss: 0.9925
2025-08-04 20:23:13,524 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 1.7879, Avg D Loss: 0.9925
2025-08-04 20:23:13,524 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:13,532 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4193, Threshold=0.4109, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:23:13,532 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6322
2025-08-04 20:23:13,533 - ClientAppLogger [Client 2] - INFO - Fit completed for round 10. Duration: 0.29s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 10, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 1.7879466897075615, 'd_loss': 0.99248579752098, 'post_fit_local_f1': 0.632183908045977, 'fit_time_seconds': 0.28659820556640625, 'cpu_percent_fit': 30.7125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 206}
2025-08-04 20:23:13,533 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:23:18,788 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:18,788 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:18,788 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:18,789 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:18,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:18,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:19,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:19,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:19,166 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:19,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:19,191 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:19,378 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:19,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:19,390 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:19,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:19,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:19,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:19,411 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:19,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:19,411 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:19,421 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:19,425 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,427 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:19,430 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:19,432 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:19,435 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:19,437 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:19,440 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:19,443 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:19,445 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:19,447 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:19,462 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:19,462 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:19,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:19,468 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:19,478 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:19,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:19,495 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:19,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:19,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:19,517 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:19,525 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:19,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:19,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:19,535 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:19,535 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:19,535 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:19,536 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:19,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:19,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:19,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:19,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:19,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:19,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:19,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:19,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:19,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:19,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:19,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:19,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:19,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:19,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:19,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:19,541 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:19,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:19,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:19,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:19,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:19,543 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:19,543 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:19,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:19,544 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:19,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:19,544 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:19,547 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:19,548 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:19,548 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:19,548 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:19,549 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:19,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:19,557 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:19,557 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:19,558 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:19,559 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:19,560 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:19,560 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:19,560 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:19,561 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:19,571 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4193, Threshold=0.4109, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:23:19,571 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.4754, F1: 0.6322, Prec: 0.7534, Rec: 0.5446, Avg Anomaly Score: 0.4193
2025-08-04 20:23:24,830 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:24,830 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:24,830 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:24,830 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:24,831 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:24,831 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:25,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:25,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:25,194 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:25,222 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:25,222 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:25,315 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:25,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:25,322 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:25,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:25,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:25,334 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:25,335 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:25,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:25,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:25,344 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:25,348 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:25,350 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:25,352 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:25,355 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:25,357 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:25,360 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:25,362 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:25,365 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:25,367 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:25,369 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:25,380 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:25,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:25,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:25,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:25,390 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:25,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:25,400 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:25,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:25,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:25,417 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:25,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:25,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:25,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:25,429 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:25,429 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:25,429 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:25,430 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:25,430 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:25,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:25,430 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:25,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:25,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:25,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:25,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:25,433 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:25,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:25,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:25,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:25,433 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:25,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:25,434 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:25,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:25,434 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:25,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:25,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:25,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:25,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:25,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:25,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:25,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:25,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:25,437 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:25,437 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:25,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:25,444 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:25,444 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:25,445 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:25,445 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:25,445 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:25,450 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:25,450 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:25,451 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:25,452 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:25,453 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 11/400.
2025-08-04 20:23:25,554 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:25,555 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:25,556 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 52 anomalous samples to GAN training data (target: 52).
2025-08-04 20:23:25,556 - ClientAppLogger [Client 2] - INFO - [Client] Round 11: Training GAN with 226 samples (174 normal, 52 anomalous).
2025-08-04 20:23:25,560 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:25,755 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 1.9986, Avg D Loss: 0.9612
2025-08-04 20:23:25,756 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 1.9986, Avg D Loss: 0.9612
2025-08-04 20:23:25,756 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:25,764 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3628, Threshold=0.3514, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:23:25,764 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.6322
2025-08-04 20:23:25,764 - ClientAppLogger [Client 2] - INFO - Fit completed for round 11. Duration: 0.31s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 11, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 1.9985661780939694, 'd_loss': 0.9612403413890738, 'post_fit_local_f1': 0.632183908045977, 'fit_time_seconds': 0.31064391136169434, 'cpu_percent_fit': 31.01875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 226}
2025-08-04 20:23:25,764 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:23:31,035 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:31,035 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:31,035 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:31,036 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:31,036 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:31,036 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:31,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:31,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:31,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:31,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:31,430 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:31,574 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:31,583 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:31,583 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:31,590 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:31,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:31,599 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:31,600 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:31,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:31,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:31,610 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:31,613 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:31,616 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:31,618 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:31,620 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:31,623 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:31,625 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:31,628 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:31,631 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:31,633 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:31,636 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:31,648 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:31,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:31,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:31,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:31,665 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:31,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:31,679 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:31,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:31,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:31,696 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:31,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:31,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:31,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:31,708 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:31,708 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:31,708 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:31,709 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:31,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:31,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:31,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:31,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:31,711 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:31,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:31,711 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:31,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:31,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:31,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:31,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:31,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:31,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:31,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:31,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:31,713 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:31,713 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:31,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:31,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:31,715 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:31,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:31,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:31,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:31,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:31,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:31,717 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:31,720 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:31,721 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:31,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:31,721 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:31,721 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:31,722 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:31,726 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:31,726 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:31,728 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:31,728 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:31,729 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:31,730 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:31,730 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:31,731 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:31,739 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3628, Threshold=0.3514, Accuracy=0.4754, F1=0.6322, Precision=0.7534, Recall=0.5446
2025-08-04 20:23:31,739 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.4754, F1: 0.6322, Prec: 0.7534, Rec: 0.5446, Avg Anomaly Score: 0.3628
2025-08-04 20:23:46,003 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:46,003 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:46,004 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:46,004 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:46,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:46,004 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:46,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:46,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:46,475 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:46,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:46,494 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:46,595 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:46,634 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:46,635 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:46,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:46,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:46,701 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:46,701 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:46,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:46,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:46,711 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:46,715 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:46,717 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:46,719 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:46,722 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:46,725 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:46,728 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:46,730 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:46,733 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:46,736 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:46,738 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:46,752 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:46,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:46,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:46,757 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:46,764 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:46,764 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:46,778 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:46,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:46,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:46,798 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:46,804 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:46,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:46,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:46,815 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:46,815 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:46,816 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:46,816 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:46,816 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:46,816 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:46,817 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:46,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:46,818 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:46,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:46,820 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:46,820 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:46,820 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:46,820 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:46,821 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:46,821 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:46,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:46,821 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:46,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:46,822 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:46,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:46,824 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:46,824 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:46,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:46,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:46,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:46,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:46,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:46,826 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:46,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:46,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:46,828 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:46,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:46,829 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:46,829 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:46,830 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:46,835 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:46,835 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:46,837 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:46,838 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:46,839 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:46,839 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:46,840 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:46,841 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:46,851 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3023, Threshold=0.2955, Accuracy=0.5738, F1=0.7011, Precision=0.8356, Recall=0.6040
2025-08-04 20:23:46,852 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.5738, F1: 0.7011, Prec: 0.8356, Rec: 0.6040, Avg Anomaly Score: 0.3023
2025-08-04 20:23:52,115 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:52,115 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:52,116 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:52,116 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:52,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:52,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:52,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:52,381 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:52,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:52,489 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:52,489 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:52,579 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:52,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:52,584 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:52,589 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:52,594 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:52,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:52,595 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:52,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:52,595 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:52,604 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:52,607 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:52,609 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:52,611 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:52,613 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:52,616 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:52,618 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:52,620 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:52,623 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:52,625 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:52,627 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:52,636 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:52,636 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:52,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:52,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:52,646 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:52,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:52,654 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:52,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:52,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:52,669 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:52,674 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:52,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:52,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:52,681 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:52,681 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:52,682 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:52,682 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:52,682 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:52,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:52,683 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:52,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:52,684 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:52,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:52,684 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:52,685 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:52,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:52,686 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:52,686 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:52,687 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:52,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:52,687 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:52,687 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:52,687 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:52,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:52,688 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:52,688 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:52,689 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:52,689 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:52,689 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:52,689 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:52,689 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:52,689 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:52,690 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:52,694 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:52,694 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:52,695 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:52,696 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:52,697 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 13/400.
2025-08-04 20:23:52,799 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:52,799 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:52,800 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 61 anomalous samples to GAN training data (target: 61).
2025-08-04 20:23:52,801 - ClientAppLogger [Client 2] - INFO - [Client] Round 13: Training GAN with 266 samples (205 normal, 61 anomalous).
2025-08-04 20:23:52,801 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:23:53,008 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0802, Avg D Loss: 0.9256
2025-08-04 20:23:53,008 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0802, Avg D Loss: 0.9256
2025-08-04 20:23:53,008 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:23:53,016 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3045, Threshold=0.3026, Accuracy=0.6066, F1=0.7241, Precision=0.8630, Recall=0.6238
2025-08-04 20:23:53,016 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7241
2025-08-04 20:23:53,016 - ClientAppLogger [Client 2] - INFO - Fit completed for round 13. Duration: 0.32s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 13, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080161708638184, 'd_loss': 0.9256281275498239, 'post_fit_local_f1': 0.7241379310344828, 'fit_time_seconds': 0.3188941478729248, 'cpu_percent_fit': 30.7375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 266}
2025-08-04 20:23:53,016 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:23:58,277 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:23:58,277 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:23:58,277 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:23:58,278 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:23:58,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:23:58,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:23:58,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:23:58,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:23:58,668 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:23:58,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:23:58,684 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:23:58,802 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:23:58,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:23:58,811 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:23:58,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:23:58,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:23:58,829 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:23:58,829 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:23:58,829 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:23:58,830 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:23:58,840 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:23:58,843 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:58,845 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:23:58,848 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:23:58,851 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:23:58,853 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:23:58,855 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:23:58,858 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:23:58,861 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:23:58,863 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:23:58,866 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:23:58,877 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:23:58,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:23:58,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:23:58,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:23:58,889 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:23:58,889 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:23:58,901 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:23:58,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:23:58,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:23:58,918 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:23:58,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:23:58,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:23:58,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:23:58,929 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:23:58,930 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:23:58,930 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:23:58,930 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:23:58,931 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:23:58,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:23:58,931 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:23:58,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:23:58,933 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:23:58,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:23:58,933 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:23:58,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:23:58,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:23:58,935 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:23:58,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:23:58,936 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:23:58,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:23:58,936 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:23:58,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:23:58,937 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:23:58,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:23:58,937 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:23:58,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:23:58,937 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:23:58,940 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:23:58,941 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:23:58,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:23:58,941 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:23:58,941 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:23:58,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:23:58,949 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:23:58,949 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:23:58,951 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:23:58,951 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:23:58,953 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:23:58,953 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:23:58,953 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:23:58,954 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:23:58,965 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3044, Threshold=0.3025, Accuracy=0.6066, F1=0.7241, Precision=0.8630, Recall=0.6238
2025-08-04 20:23:58,965 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.6066, F1: 0.7241, Prec: 0.8630, Rec: 0.6238, Avg Anomaly Score: 0.3044
2025-08-04 20:24:04,210 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:04,210 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:04,210 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:04,211 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:04,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:04,211 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:04,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:04,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:04,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:04,532 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:04,532 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:04,617 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:04,622 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:04,622 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:04,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:04,632 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:04,633 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:04,633 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:04,633 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:04,633 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:04,641 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:04,644 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:04,646 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:04,648 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:04,651 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:04,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:04,656 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:04,659 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:04,662 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:04,664 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:04,666 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:04,675 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:04,675 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:04,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:04,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:04,684 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:04,684 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:04,692 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:04,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:04,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:04,706 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:04,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:04,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:04,715 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:04,716 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:04,716 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:04,716 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:04,716 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:04,716 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:04,716 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:04,717 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:04,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:04,718 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:04,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:04,718 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:04,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:04,720 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:04,720 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:04,720 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:04,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:04,722 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:04,726 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:04,726 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:04,726 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:04,726 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:04,726 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:04,726 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:04,730 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:04,730 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:04,731 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:04,732 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:04,733 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 14/400.
2025-08-04 20:24:04,834 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:04,834 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:04,835 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 66 anomalous samples to GAN training data (target: 66).
2025-08-04 20:24:04,839 - ClientAppLogger [Client 2] - INFO - [Client] Round 14: Training GAN with 289 samples (223 normal, 66 anomalous).
2025-08-04 20:24:04,839 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:05,063 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0808, Avg D Loss: 0.9214
2025-08-04 20:24:05,063 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0808, Avg D Loss: 0.9214
2025-08-04 20:24:05,064 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:05,072 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3221, Threshold=0.3242, Accuracy=0.6557, F1=0.7586, Precision=0.9041, Recall=0.6535
2025-08-04 20:24:05,072 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7586
2025-08-04 20:24:05,072 - ClientAppLogger [Client 2] - INFO - Fit completed for round 14. Duration: 0.34s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 14, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0808297224110794, 'd_loss': 0.9213648206634918, 'post_fit_local_f1': 0.7586206896551724, 'fit_time_seconds': 0.33905553817749023, 'cpu_percent_fit': 30.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 289}
2025-08-04 20:24:05,072 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:24:10,337 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:10,337 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:10,337 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:10,338 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:10,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:10,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:10,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:10,616 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:10,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:10,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:10,729 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:10,865 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:10,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:10,870 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:10,875 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:10,881 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:10,881 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:10,881 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:10,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:10,882 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:10,891 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:10,895 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:10,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:10,900 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:10,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:10,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:10,908 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:10,911 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:10,914 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:10,916 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:10,918 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:10,930 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:10,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:10,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:10,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:10,940 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:10,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:10,950 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:10,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:10,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:10,968 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:10,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:10,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:10,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:10,981 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:10,981 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:10,982 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:10,982 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:10,982 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:10,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:10,983 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:10,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:10,984 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:10,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:10,985 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:10,985 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:10,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:10,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:10,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:10,986 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:10,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:10,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:10,987 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:10,987 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:10,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:10,990 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:10,991 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:10,991 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:10,995 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:10,995 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:10,995 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:10,996 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:10,996 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:10,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:10,997 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:10,997 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:10,999 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:10,999 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:11,001 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:11,001 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:11,001 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:11,002 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:11,010 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3220, Threshold=0.3241, Accuracy=0.6557, F1=0.7586, Precision=0.9041, Recall=0.6535
2025-08-04 20:24:11,010 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.6557, F1: 0.7586, Prec: 0.9041, Rec: 0.6535, Avg Anomaly Score: 0.3220
2025-08-04 20:24:16,265 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:16,266 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:16,266 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:16,266 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:16,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:16,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:16,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:16,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:16,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:16,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:16,645 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:16,735 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:16,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:16,740 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:16,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:16,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:16,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:16,751 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:16,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:16,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:16,760 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:16,763 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:16,765 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:16,767 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:16,769 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:16,771 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:16,774 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:16,777 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:16,780 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:16,781 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:16,784 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:16,793 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:16,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:16,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:16,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:16,802 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:16,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:16,811 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:16,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:16,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:16,827 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:16,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:16,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:16,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:16,838 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:16,838 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:16,839 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:16,839 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:16,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:16,839 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:16,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:16,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:16,841 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:16,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:16,841 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:16,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:16,843 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:16,843 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:16,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:16,845 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:16,849 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:16,849 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:16,849 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:16,849 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:16,849 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:16,849 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:16,853 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:16,853 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:16,854 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:16,855 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:16,856 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 15/400.
2025-08-04 20:24:16,957 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:16,957 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:16,958 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 72 anomalous samples to GAN training data (target: 72).
2025-08-04 20:24:16,962 - ClientAppLogger [Client 2] - INFO - [Client] Round 15: Training GAN with 315 samples (243 normal, 72 anomalous).
2025-08-04 20:24:16,962 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:17,192 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0793, Avg D Loss: 0.9170
2025-08-04 20:24:17,192 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0793, Avg D Loss: 0.9170
2025-08-04 20:24:17,192 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:17,200 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3019, Threshold=0.3064, Accuracy=0.7049, F1=0.7931, Precision=0.9452, Recall=0.6832
2025-08-04 20:24:17,200 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7931
2025-08-04 20:24:17,200 - ClientAppLogger [Client 2] - INFO - Fit completed for round 15. Duration: 0.34s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 15, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.079307205790565, 'd_loss': 0.9170354115206096, 'post_fit_local_f1': 0.7931034482758621, 'fit_time_seconds': 0.34418749809265137, 'cpu_percent_fit': 30.7875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 315}
2025-08-04 20:24:17,201 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:24:22,464 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:22,464 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:22,464 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:22,464 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:22,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:22,465 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:22,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:22,781 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:22,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:22,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:22,892 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:22,982 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:22,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:22,989 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:22,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:23,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:23,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:23,003 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:23,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:23,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:23,013 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:23,016 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,018 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:23,020 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:23,023 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:23,025 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:23,028 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:23,030 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:23,033 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:23,035 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:23,038 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:23,048 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:23,049 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:23,053 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:23,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:23,059 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:23,059 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:23,071 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:23,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:23,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:23,090 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:23,097 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:23,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:23,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:23,105 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:23,105 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:23,106 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:23,106 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:23,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:23,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:23,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:23,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:23,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:23,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:23,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:23,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:23,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:23,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:23,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:23,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:23,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:23,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:23,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:23,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:23,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:23,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:23,112 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:23,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:23,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:23,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:23,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:23,113 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:23,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:23,114 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:23,118 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:23,118 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:23,118 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:23,118 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:23,118 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:23,119 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:23,123 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:23,123 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:23,124 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:23,124 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:23,126 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:23,126 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:23,126 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:23,127 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:23,135 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3020, Threshold=0.3065, Accuracy=0.7049, F1=0.7931, Precision=0.9452, Recall=0.6832
2025-08-04 20:24:23,136 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7049, F1: 0.7931, Prec: 0.9452, Rec: 0.6832, Avg Anomaly Score: 0.3020
2025-08-04 20:24:28,389 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:28,389 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:28,389 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:28,389 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:28,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:28,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:28,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:28,600 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:28,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:28,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:28,704 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:28,790 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:28,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:28,796 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:28,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:28,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:28,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:28,808 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:28,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:28,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:28,816 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:28,819 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:28,821 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:28,824 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:28,826 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:28,828 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:28,831 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:28,834 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:28,836 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:28,838 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:28,841 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:28,849 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:28,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:28,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:28,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:28,859 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:28,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:28,867 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:28,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:28,868 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:28,881 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:28,886 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:28,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:28,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:28,891 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:28,891 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:28,891 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:28,891 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:28,892 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:28,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:28,892 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:28,892 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:28,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:28,894 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:28,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:28,894 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:28,894 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:28,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:28,896 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:28,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:28,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:28,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:28,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:28,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:28,897 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:28,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:28,898 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:28,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:28,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:28,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:28,902 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:28,902 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:28,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:28,906 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:28,907 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:28,907 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:28,908 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:28,909 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 16/400.
2025-08-04 20:24:29,011 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:29,011 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:29,012 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 78 anomalous samples to GAN training data (target: 78).
2025-08-04 20:24:29,016 - ClientAppLogger [Client 2] - INFO - [Client] Round 16: Training GAN with 339 samples (261 normal, 78 anomalous).
2025-08-04 20:24:29,016 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:29,260 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0809, Avg D Loss: 0.9108
2025-08-04 20:24:29,261 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0809, Avg D Loss: 0.9108
2025-08-04 20:24:29,261 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:29,268 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3002, Threshold=0.3049, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:24:29,268 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:24:29,268 - ClientAppLogger [Client 2] - INFO - Fit completed for round 16. Duration: 0.36s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 16, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080895495555394, 'd_loss': 0.9107570148850612, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.358856201171875, 'cpu_percent_fit': 31.0625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 339}
2025-08-04 20:24:29,268 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:24:34,542 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:34,542 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:34,542 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:34,542 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:34,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:34,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:34,847 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:34,847 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:34,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:34,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:34,943 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:35,036 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:35,040 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:35,041 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:35,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:35,053 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:35,053 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:35,053 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:35,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:35,054 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:35,064 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:35,067 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,070 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:35,073 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:35,076 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:35,078 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:35,081 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:35,084 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:35,086 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:35,088 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:35,091 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:35,101 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:35,101 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:35,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:35,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:35,113 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:35,114 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:35,129 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:35,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:35,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:35,147 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:35,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:35,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:35,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:35,159 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:35,160 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:35,160 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:35,160 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:35,161 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:35,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:35,161 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:35,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:35,163 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:35,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:35,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:35,165 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:35,165 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:35,165 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:35,165 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:35,166 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:35,166 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:35,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:35,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:35,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:35,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:35,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:35,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:35,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:35,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:35,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:35,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:35,173 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:35,173 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:35,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:35,177 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:35,177 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:35,178 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:35,179 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:35,180 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:35,180 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:35,180 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:35,181 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:35,190 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3001, Threshold=0.3048, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:24:35,190 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3001
2025-08-04 20:24:40,445 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:40,445 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:40,445 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:40,446 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:40,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:40,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:40,663 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:40,663 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:40,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:40,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:40,769 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:40,850 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:40,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:40,855 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:40,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:40,864 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:40,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:40,865 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:40,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:40,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:40,873 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:40,876 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:40,878 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:40,881 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:40,883 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:40,886 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:40,888 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:40,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:40,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:40,895 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:40,898 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:40,907 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:40,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:40,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:40,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:40,917 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:40,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:40,928 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:40,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:40,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:40,944 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:40,948 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:40,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:40,955 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:40,956 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:40,956 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:40,956 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:40,956 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:40,956 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:40,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:40,957 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:40,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:40,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:40,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:40,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:40,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:40,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:40,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:40,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:40,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:40,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:40,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:40,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:40,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:40,965 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:40,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:40,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:40,970 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:40,970 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:40,971 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:40,971 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:40,972 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 17/400.
2025-08-04 20:24:41,073 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:41,073 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:41,074 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 83 anomalous samples to GAN training data (target: 83).
2025-08-04 20:24:41,078 - ClientAppLogger [Client 2] - INFO - [Client] Round 17: Training GAN with 360 samples (277 normal, 83 anomalous).
2025-08-04 20:24:41,078 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:41,348 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0818, Avg D Loss: 0.9051
2025-08-04 20:24:41,348 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0818, Avg D Loss: 0.9051
2025-08-04 20:24:41,349 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:41,356 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.2989, Threshold=0.3044, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:24:41,356 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7816
2025-08-04 20:24:41,356 - ClientAppLogger [Client 2] - INFO - Fit completed for round 17. Duration: 0.38s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 17, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.081825649473402, 'd_loss': 0.9050699985027313, 'post_fit_local_f1': 0.7816091954022989, 'fit_time_seconds': 0.383986234664917, 'cpu_percent_fit': 31.09375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 360}
2025-08-04 20:24:41,356 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:24:46,605 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:46,605 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:46,605 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:46,605 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:46,606 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:46,606 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:46,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:46,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:46,942 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:46,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:46,967 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:47,063 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:47,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:47,069 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:47,075 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:47,080 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:47,080 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:47,081 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:47,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:47,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:47,090 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:47,093 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:47,095 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:47,097 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:47,100 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:47,102 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:47,104 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:47,107 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:47,110 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:47,112 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:47,115 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:47,125 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:47,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:47,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:47,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:47,136 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:47,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:47,146 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:47,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:47,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:47,163 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:47,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:47,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:47,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:47,182 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:47,182 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:47,183 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:47,183 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:47,184 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:47,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:47,184 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:47,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:47,186 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:47,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:47,186 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:47,186 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:47,187 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:47,187 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:47,187 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:47,187 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:47,188 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:47,188 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:47,188 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:47,188 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:47,188 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:47,189 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:47,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:47,190 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:47,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:47,190 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:47,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:47,191 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:47,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:47,191 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:47,195 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:47,195 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:47,195 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:47,195 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:47,196 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:47,196 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:47,201 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:47,201 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:47,202 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:47,203 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:47,204 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:47,205 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:47,205 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:47,206 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:47,214 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.2988, Threshold=0.3043, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:24:47,214 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.6885, F1: 0.7816, Prec: 0.9315, Rec: 0.6733, Avg Anomaly Score: 0.2988
2025-08-04 20:24:52,462 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:52,463 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:52,463 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:52,463 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:52,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:52,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:52,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:52,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:52,817 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:52,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:52,832 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:52,913 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:52,918 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:52,918 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:52,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:52,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:52,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:52,930 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:52,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:52,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:52,939 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:52,942 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:52,944 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:52,946 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:52,949 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:52,951 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:52,954 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:52,956 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:52,959 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:52,960 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:52,963 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:52,971 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:52,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:52,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:52,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:52,980 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:52,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:52,989 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:52,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:52,989 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:53,003 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:53,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:53,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:53,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:53,013 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:53,013 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:53,013 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:53,013 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:53,013 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:53,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:53,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:53,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:53,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:53,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:53,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:53,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:53,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:53,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:53,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:53,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:53,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:53,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:53,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:53,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:53,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:53,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:53,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:53,020 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:53,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:53,024 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:53,024 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:53,024 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:53,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:53,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:53,027 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:53,028 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:53,029 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:53,030 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:53,031 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 18/400.
2025-08-04 20:24:53,132 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:53,132 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:53,133 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 88 anomalous samples to GAN training data (target: 88).
2025-08-04 20:24:53,137 - ClientAppLogger [Client 2] - INFO - [Client] Round 18: Training GAN with 384 samples (296 normal, 88 anomalous).
2025-08-04 20:24:53,137 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:24:53,422 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0821, Avg D Loss: 0.9002
2025-08-04 20:24:53,423 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0821, Avg D Loss: 0.9002
2025-08-04 20:24:53,423 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:24:53,431 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3061, Threshold=0.3145, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:24:53,431 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7816
2025-08-04 20:24:53,431 - ClientAppLogger [Client 2] - INFO - Fit completed for round 18. Duration: 0.40s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 18, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082108130057653, 'd_loss': 0.9002380669116974, 'post_fit_local_f1': 0.7816091954022989, 'fit_time_seconds': 0.40006279945373535, 'cpu_percent_fit': 31.10625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 384}
2025-08-04 20:24:53,431 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:24:58,680 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:24:58,680 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:24:58,680 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:24:58,681 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:24:58,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:24:58,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:24:58,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:24:58,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:24:59,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:24:59,043 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:24:59,043 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:24:59,144 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:24:59,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:24:59,151 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:24:59,157 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:24:59,216 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:24:59,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:24:59,217 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:24:59,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:24:59,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:24:59,227 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:24:59,230 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,232 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:24:59,234 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:24:59,237 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:24:59,239 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:24:59,242 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:24:59,244 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:24:59,248 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:24:59,249 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:24:59,252 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:24:59,264 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:24:59,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:24:59,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:24:59,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:24:59,276 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:24:59,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:24:59,289 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:24:59,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:24:59,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:24:59,306 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:24:59,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:24:59,317 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:24:59,317 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:24:59,317 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:24:59,317 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:24:59,318 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:24:59,318 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:24:59,318 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:24:59,318 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:24:59,319 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:24:59,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:24:59,320 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:24:59,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:24:59,321 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:24:59,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:24:59,321 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:24:59,321 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:24:59,321 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:24:59,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:24:59,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:24:59,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:24:59,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:24:59,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:24:59,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:24:59,324 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:24:59,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:24:59,324 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:24:59,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:24:59,324 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:24:59,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:24:59,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:24:59,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:24:59,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:24:59,329 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:24:59,329 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:24:59,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:24:59,330 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:24:59,330 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:24:59,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:24:59,336 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:24:59,336 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:24:59,337 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:24:59,337 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:24:59,339 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:24:59,339 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:24:59,339 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:24:59,340 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:24:59,349 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3060, Threshold=0.3144, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:24:59,349 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.6885, F1: 0.7816, Prec: 0.9315, Rec: 0.6733, Avg Anomaly Score: 0.3060
2025-08-04 20:25:04,597 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:04,597 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:04,597 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:04,597 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:04,597 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:04,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:04,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:04,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:04,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:04,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:04,958 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:05,051 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:05,057 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:05,057 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:05,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:05,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:05,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:05,073 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:05,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:05,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:05,083 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:05,086 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:05,088 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:05,090 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:05,093 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:05,095 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:05,097 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:05,100 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:05,103 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:05,105 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:05,107 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:05,116 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:05,116 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:05,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:05,121 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:05,126 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:05,126 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:05,134 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:05,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:05,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:05,150 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:05,154 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:05,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:05,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:05,160 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:05,160 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:05,160 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:05,160 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:05,161 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:05,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:05,161 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:05,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:05,162 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:05,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:05,163 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:05,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:05,163 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:05,163 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:05,163 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:05,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:05,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:05,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:05,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:05,164 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:05,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:05,165 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:05,165 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:05,165 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:05,165 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:05,166 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:05,166 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:05,166 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:05,166 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:05,166 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:05,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:05,167 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:05,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:05,167 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:05,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:05,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:05,172 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:05,172 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:05,174 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:05,174 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:05,175 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 19/400.
2025-08-04 20:25:05,277 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:05,277 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:05,279 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 93 anomalous samples to GAN training data (target: 93).
2025-08-04 20:25:05,279 - ClientAppLogger [Client 2] - INFO - [Client] Round 19: Training GAN with 406 samples (313 normal, 93 anomalous).
2025-08-04 20:25:05,279 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:05,603 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0821, Avg D Loss: 0.8959
2025-08-04 20:25:05,604 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0821, Avg D Loss: 0.8959
2025-08-04 20:25:05,604 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:05,612 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3097, Threshold=0.3189, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:25:05,612 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7816
2025-08-04 20:25:05,612 - ClientAppLogger [Client 2] - INFO - Fit completed for round 19. Duration: 0.44s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 19, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0821368791786905, 'd_loss': 0.8959036508217235, 'post_fit_local_f1': 0.7816091954022989, 'fit_time_seconds': 0.4368441104888916, 'cpu_percent_fit': 31.11875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 406}
2025-08-04 20:25:05,613 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:25:10,882 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:10,883 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:10,883 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:10,883 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:10,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:10,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:11,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:11,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:11,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:11,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:11,281 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:11,382 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:11,392 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:11,392 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:11,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:11,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:11,449 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:11,450 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:11,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:11,450 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:11,459 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:11,462 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,464 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:11,466 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:11,469 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:11,472 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:11,474 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:11,477 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:11,479 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:11,481 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:11,484 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:11,494 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:11,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:11,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:11,499 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:11,505 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:11,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:11,524 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:11,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:11,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:11,541 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:11,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:11,552 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:11,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:11,553 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:11,553 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:11,553 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:11,553 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:11,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:11,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:11,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:11,554 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:11,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:11,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:11,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:11,557 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:11,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:11,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:11,557 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:11,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:11,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:11,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:11,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:11,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:11,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:11,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:11,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:11,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:11,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:11,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:11,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:11,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:11,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:11,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:11,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:11,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:11,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:11,562 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:11,563 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:11,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:11,570 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:11,570 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:11,572 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:11,572 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:11,573 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:11,573 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:11,573 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:11,574 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:11,583 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3096, Threshold=0.3188, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:25:11,584 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.6885, F1: 0.7816, Prec: 0.9315, Rec: 0.6733, Avg Anomaly Score: 0.3096
2025-08-04 20:25:16,833 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:16,833 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:16,833 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:16,834 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:16,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:16,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:17,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:17,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:17,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:17,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:17,151 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:17,243 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:17,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:17,250 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:17,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:17,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:17,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:17,276 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:17,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:17,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:17,285 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:17,288 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:17,290 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:17,293 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:17,295 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:17,297 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:17,300 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:17,302 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:17,305 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:17,307 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:17,309 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:17,318 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:17,318 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:17,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:17,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:17,328 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:17,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:17,336 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:17,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:17,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:17,352 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:17,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:17,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:17,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:17,361 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:17,361 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:17,362 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:17,362 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:17,362 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:17,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:17,362 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:17,363 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:17,364 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:17,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:17,364 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:17,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:17,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:17,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:17,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:17,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:17,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:17,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:17,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:17,366 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:17,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:17,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:17,367 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:17,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:17,367 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:17,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:17,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:17,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:17,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:17,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:17,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:17,369 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:17,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:17,369 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:17,369 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:17,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:17,374 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:17,374 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:17,376 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:17,376 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:17,377 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 20/400.
2025-08-04 20:25:17,478 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:17,478 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:17,480 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 98 anomalous samples to GAN training data (target: 98).
2025-08-04 20:25:17,480 - ClientAppLogger [Client 2] - INFO - [Client] Round 20: Training GAN with 426 samples (328 normal, 98 anomalous).
2025-08-04 20:25:17,480 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:17,825 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0827, Avg D Loss: 0.8957
2025-08-04 20:25:17,825 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0827, Avg D Loss: 0.8957
2025-08-04 20:25:17,825 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:17,833 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3218, Threshold=0.3320, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:25:17,833 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.7816
2025-08-04 20:25:17,833 - ClientAppLogger [Client 2] - INFO - Fit completed for round 20. Duration: 0.46s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 20, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0827123095731777, 'd_loss': 0.8956945284151697, 'post_fit_local_f1': 0.7816091954022989, 'fit_time_seconds': 0.4565122127532959, 'cpu_percent_fit': 31.11875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 426}
2025-08-04 20:25:17,834 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:25:23,090 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:23,090 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:23,090 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:23,090 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:23,091 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:23,091 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:23,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:23,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:23,467 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:23,496 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:23,496 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:23,604 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:23,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:23,610 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:23,617 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:23,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:23,626 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:23,627 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:23,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:23,627 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:23,636 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:23,639 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,641 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:23,643 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:23,646 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:23,648 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:23,651 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:23,654 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:23,656 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:23,658 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:23,661 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:23,672 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:23,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:23,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:23,678 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:23,682 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:23,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:23,691 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:23,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:23,691 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:23,711 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:23,718 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:23,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:23,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:23,730 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:23,730 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:23,731 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:23,731 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:23,731 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:23,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:23,732 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:23,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:23,734 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:23,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:23,735 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:23,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:23,736 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:23,737 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:23,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:23,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:23,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:23,739 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:23,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:23,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:23,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:23,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:23,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:23,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:23,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:23,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:23,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:23,742 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:23,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:23,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:23,746 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:23,747 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:23,748 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:23,748 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:23,750 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:23,751 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:23,751 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:23,751 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:23,759 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3216, Threshold=0.3318, Accuracy=0.6885, F1=0.7816, Precision=0.9315, Recall=0.6733
2025-08-04 20:25:23,759 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.6885, F1: 0.7816, Prec: 0.9315, Rec: 0.6733, Avg Anomaly Score: 0.3216
2025-08-04 20:25:29,020 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:29,021 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:29,021 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:29,021 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:29,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:29,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:29,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:29,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:29,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:29,386 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:29,386 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:29,475 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:29,481 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:29,481 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:29,487 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:29,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:29,493 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:29,493 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:29,493 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:29,493 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:29,502 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:29,504 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:29,507 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:29,509 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:29,511 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:29,514 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:29,516 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:29,519 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:29,522 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:29,524 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:29,526 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:29,535 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:29,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:29,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:29,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:29,545 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:29,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:29,555 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:29,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:29,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:29,570 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:29,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:29,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:29,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:29,580 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:29,580 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:29,580 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:29,580 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:29,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:29,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:29,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:29,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:29,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:29,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:29,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:29,583 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:29,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:29,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:29,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:29,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:29,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:29,584 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:29,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:29,584 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:29,584 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:29,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:29,587 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:29,587 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:29,587 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:29,587 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:29,587 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:29,588 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:29,588 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:29,588 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:29,590 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:29,590 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:29,591 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:29,591 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:29,593 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 21/400.
2025-08-04 20:25:29,694 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:29,694 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:29,695 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 102 anomalous samples to GAN training data (target: 102).
2025-08-04 20:25:29,696 - ClientAppLogger [Client 2] - INFO - [Client] Round 21: Training GAN with 444 samples (342 normal, 102 anomalous).
2025-08-04 20:25:29,696 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:30,036 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0822, Avg D Loss: 0.8930
2025-08-04 20:25:30,037 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0822, Avg D Loss: 0.8930
2025-08-04 20:25:30,037 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:30,045 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3190, Threshold=0.3290, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:25:30,045 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:25:30,045 - ClientAppLogger [Client 2] - INFO - Fit completed for round 21. Duration: 0.45s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 21, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0822357856475553, 'd_loss': 0.8930256428482297, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.45206761360168457, 'cpu_percent_fit': 30.9625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 444}
2025-08-04 20:25:30,045 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:25:35,330 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:35,330 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:35,330 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:35,331 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:35,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:35,331 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:35,629 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:35,630 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:35,721 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:35,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:35,751 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:35,848 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:35,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:35,854 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:35,859 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:35,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:35,865 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:35,865 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:35,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:35,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:35,875 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:35,878 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,880 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:35,883 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:35,886 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:35,888 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:35,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:35,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:35,896 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:35,897 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:35,900 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:35,910 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:35,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:35,915 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:35,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:35,921 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:35,921 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:35,932 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:35,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:35,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:35,948 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:35,954 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:35,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:35,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:35,962 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:35,962 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:35,962 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:35,963 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:35,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:35,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:35,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:35,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:35,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:35,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:35,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:35,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:35,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:35,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:35,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:35,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:35,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:35,967 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:35,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:35,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:35,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:35,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:35,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:35,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:35,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:35,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:35,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:35,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:35,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:35,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:35,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:35,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:35,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:35,972 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:35,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:35,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:35,977 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:35,977 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:35,978 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:35,978 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:35,980 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:35,980 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:35,980 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:35,981 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:35,990 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3190, Threshold=0.3289, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:25:35,990 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3190
2025-08-04 20:25:47,264 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:47,264 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:47,264 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:47,265 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:47,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:47,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:47,518 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:47,518 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:47,601 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:47,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:47,623 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:47,718 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:47,724 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:47,724 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:47,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:47,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:47,736 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:47,736 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:47,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:47,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:47,746 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:47,750 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:47,752 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:47,755 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:47,757 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:47,760 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:47,762 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:47,764 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:47,767 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:47,769 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:47,771 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:47,783 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:47,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:47,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:47,788 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:47,794 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:47,795 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:47,808 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:47,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:47,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:47,824 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:47,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:47,833 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:47,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:47,834 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:47,834 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:47,834 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:47,835 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:47,835 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:47,835 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:47,835 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:47,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:47,837 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:47,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:47,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:47,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:47,839 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:47,839 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:47,839 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:47,840 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:47,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:47,840 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:47,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:47,841 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:47,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:47,841 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:47,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:47,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:47,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:47,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:47,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:47,843 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:47,843 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:47,843 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:47,844 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:47,844 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:47,846 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:47,846 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:47,848 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:25:47,848 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:47,848 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:47,849 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:25:47,857 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3221, Threshold=0.3320, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:25:47,858 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3221
2025-08-04 20:25:53,123 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:25:53,123 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:25:53,124 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:25:53,124 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:25:53,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:25:53,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:25:53,363 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:25:53,363 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:25:53,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:25:53,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:25:53,464 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:25:53,547 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:25:53,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:25:53,553 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:25:53,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:25:53,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:25:53,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:25:53,564 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:25:53,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:25:53,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:25:53,573 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:25:53,575 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:53,578 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:25:53,580 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:25:53,583 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:25:53,585 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:25:53,588 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:25:53,590 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:25:53,593 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:25:53,595 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:25:53,597 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:25:53,605 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:25:53,605 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:25:53,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:25:53,610 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:25:53,615 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:25:53,615 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:25:53,623 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:25:53,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:25:53,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:25:53,638 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:25:53,643 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:25:53,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:25:53,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:25:53,650 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:25:53,650 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:25:53,650 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:25:53,650 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:25:53,650 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:25:53,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:25:53,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:25:53,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:25:53,652 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:25:53,653 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:25:53,654 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:25:53,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:25:53,654 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:25:53,654 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:25:53,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:25:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:25:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:25:53,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:25:53,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:25:53,657 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:25:53,657 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:25:53,657 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:25:53,660 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:25:53,661 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:25:53,662 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:25:53,662 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:25:53,663 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 23/400.
2025-08-04 20:25:53,764 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:25:53,764 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:25:53,766 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 113 anomalous samples to GAN training data (target: 113).
2025-08-04 20:25:53,766 - ClientAppLogger [Client 2] - INFO - [Client] Round 23: Training GAN with 491 samples (378 normal, 113 anomalous).
2025-08-04 20:25:53,766 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:25:54,148 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.8922
2025-08-04 20:25:54,148 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.8922
2025-08-04 20:25:54,148 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:25:54,157 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3303, Threshold=0.3417, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:25:54,157 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:25:54,158 - ClientAppLogger [Client 2] - INFO - Fit completed for round 23. Duration: 0.49s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 23, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0826155799469492, 'd_loss': 0.892153515058234, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.4944474697113037, 'cpu_percent_fit': 31.125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 491}
2025-08-04 20:25:54,158 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:26:02,428 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:02,428 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:02,428 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:02,428 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:02,428 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:02,428 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:02,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:02,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:02,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:02,769 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:02,769 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:02,856 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:02,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:02,862 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:02,869 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:02,876 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:02,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:02,877 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:02,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:02,877 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:02,886 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:02,889 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:02,891 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:02,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:02,896 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:02,898 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:02,900 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:02,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:02,906 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:02,908 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:02,910 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:02,919 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:02,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:02,925 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:02,925 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:02,930 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:02,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:02,938 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:02,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:02,939 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:02,954 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:02,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:02,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:02,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:02,964 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:02,964 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:02,965 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:02,965 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:02,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:02,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:02,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:02,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:02,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:02,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:02,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:02,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:02,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:02,969 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:02,969 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:02,969 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:02,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:02,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:02,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:02,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:02,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:02,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:02,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:02,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:02,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:02,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:02,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:02,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:02,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:02,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:02,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:02,975 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:02,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:02,975 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:02,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:02,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:02,979 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:02,980 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:02,982 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:02,982 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:02,984 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:02,984 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:02,984 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:02,986 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:02,996 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3300, Threshold=0.3414, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:02,997 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3300
2025-08-04 20:26:08,260 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:08,260 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:08,260 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:08,260 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:08,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:08,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:08,509 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:08,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:08,594 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:08,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:08,618 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:08,703 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:08,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:08,709 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:08,714 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:08,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:08,719 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:08,720 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:08,720 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:08,720 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:08,728 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:08,731 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:08,733 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:08,735 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:08,738 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:08,740 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:08,742 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:08,745 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:08,747 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:08,749 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:08,751 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:08,760 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:08,760 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:08,764 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:08,764 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:08,769 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:08,769 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:08,777 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:08,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:08,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:08,791 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:08,796 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:08,802 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:08,803 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:08,803 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:08,803 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:08,803 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:08,803 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:08,804 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:08,804 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:08,804 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:08,804 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:08,805 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:08,806 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:08,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:08,806 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:08,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:08,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:08,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:08,807 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:08,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:08,807 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:08,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:08,807 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:08,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:08,808 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:08,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:08,808 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:08,808 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:08,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:08,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:08,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:08,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:08,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:08,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:08,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:08,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:08,810 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:08,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:08,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:08,814 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:08,814 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:08,816 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:08,816 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:08,818 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 24/400.
2025-08-04 20:26:08,918 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:08,918 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:08,929 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 118 anomalous samples to GAN training data (target: 118).
2025-08-04 20:26:08,929 - ClientAppLogger [Client 2] - INFO - [Client] Round 24: Training GAN with 513 samples (395 normal, 118 anomalous).
2025-08-04 20:26:08,929 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:09,340 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.8884
2025-08-04 20:26:09,341 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.8884
2025-08-04 20:26:09,341 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:09,350 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3216, Threshold=0.3316, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:09,351 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:26:09,351 - ClientAppLogger [Client 2] - INFO - Fit completed for round 24. Duration: 0.53s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 24, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083751422201681, 'd_loss': 0.8883515119668802, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.533214807510376, 'cpu_percent_fit': 30.2, 'ram_mb_fit': 3.09375, 'accumulated_train_samples_this_round': 513}
2025-08-04 20:26:09,351 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:26:14,609 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:14,609 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:14,609 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:14,609 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:14,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:14,609 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:14,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:14,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:14,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:14,940 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:14,940 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:15,023 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:15,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:15,028 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:15,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:15,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:15,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:15,038 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:15,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:15,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:15,046 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:15,049 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:15,051 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:15,053 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:15,056 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:15,057 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:15,060 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:15,062 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:15,065 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:15,067 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:15,069 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:15,077 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:15,077 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:15,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:15,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:15,086 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:15,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:15,095 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:15,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:15,095 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:15,114 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:15,119 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:15,128 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:15,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:15,129 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:15,129 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:15,129 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:15,130 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:15,130 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:15,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:15,131 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:15,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:15,133 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:15,133 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:15,133 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:15,133 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:15,133 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:15,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:15,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:15,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:15,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:15,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:15,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:15,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:15,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:15,136 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:15,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:15,136 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:15,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:15,136 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:15,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:15,137 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:15,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:15,137 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:15,138 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:15,138 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:15,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:15,138 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:15,138 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:15,139 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:15,143 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:15,144 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:15,145 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:15,145 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:15,147 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:15,147 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:15,147 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:15,148 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:15,156 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3215, Threshold=0.3315, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:15,157 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3215
2025-08-04 20:26:20,406 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:20,406 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:20,406 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:20,407 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:20,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:20,407 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:20,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:20,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:20,737 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:20,749 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:20,749 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:20,827 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:20,831 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:20,831 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:20,836 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:20,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:20,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:20,841 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:20,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:20,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:20,850 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:20,853 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:20,855 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:20,858 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:20,861 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:20,863 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:20,866 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:20,868 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:20,871 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:20,873 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:20,875 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:20,883 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:20,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:20,888 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:20,888 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:20,893 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:20,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:20,900 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:20,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:20,901 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:20,915 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:20,923 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:20,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:20,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:20,929 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:20,929 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:20,929 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:20,930 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:20,930 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:20,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:20,930 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:20,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:20,932 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:20,932 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:20,933 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:20,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:20,933 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:20,933 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:20,933 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:20,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:20,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:20,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:20,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:20,934 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:20,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:20,935 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:20,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:20,935 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:20,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:20,936 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:20,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:20,936 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:20,936 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:20,936 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:20,936 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:20,937 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:20,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:20,937 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:20,937 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:20,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:20,939 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:20,939 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:20,940 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:20,940 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:20,942 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 25/400.
2025-08-04 20:26:21,042 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:21,042 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:21,044 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 123 anomalous samples to GAN training data (target: 123).
2025-08-04 20:26:21,044 - ClientAppLogger [Client 2] - INFO - [Client] Round 25: Training GAN with 536 samples (413 normal, 123 anomalous).
2025-08-04 20:26:21,044 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:21,441 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0843, Avg D Loss: 0.8905
2025-08-04 20:26:21,442 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0843, Avg D Loss: 0.8905
2025-08-04 20:26:21,442 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:21,449 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3259, Threshold=0.3380, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:21,449 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:26:21,450 - ClientAppLogger [Client 2] - INFO - Fit completed for round 25. Duration: 0.51s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 25, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0842867929544022, 'd_loss': 0.890482554151051, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.5078692436218262, 'cpu_percent_fit': 31.14375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 536}
2025-08-04 20:26:21,450 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:26:26,702 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:26,702 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:26,702 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:26,702 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:26,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:26,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:26,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:26,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:27,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:27,072 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:27,073 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:27,161 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:27,166 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:27,166 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:27,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:27,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:27,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:27,181 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:27,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:27,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:27,190 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:27,193 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:27,196 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:27,198 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:27,201 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:27,203 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:27,205 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:27,208 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:27,211 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:27,213 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:27,215 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:27,224 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:27,224 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:27,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:27,229 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:27,233 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:27,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:27,242 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:27,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:27,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:27,257 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:27,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:27,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:27,267 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:27,267 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:27,267 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:27,268 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:27,268 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:27,268 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:27,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:27,269 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:27,269 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:27,270 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:27,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:27,271 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:27,271 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:27,271 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:27,271 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:27,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:27,273 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:27,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:27,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:27,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:27,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:27,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:27,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:27,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:27,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:27,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:27,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:27,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:27,276 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:27,276 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:27,276 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:27,280 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:27,280 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:27,282 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:27,282 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:27,284 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:27,284 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:27,284 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:27,285 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:27,293 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3259, Threshold=0.3380, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:27,294 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3259
2025-08-04 20:26:32,540 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:32,541 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:32,541 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:32,541 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:32,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:32,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:32,761 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:32,761 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:32,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:32,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:32,867 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:32,951 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:32,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:32,956 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:32,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:32,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:32,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:32,970 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:32,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:32,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:32,979 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:32,982 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:32,984 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:32,987 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:32,989 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:32,992 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:32,994 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:32,997 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:32,999 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:33,001 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:33,004 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:33,012 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:33,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:33,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:33,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:33,021 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:33,021 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:33,030 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:33,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:33,030 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:33,049 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:33,055 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:33,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:33,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:33,060 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:33,060 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:33,061 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:33,061 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:33,061 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:33,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:33,062 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:33,062 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:33,063 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:33,063 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:33,064 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:33,064 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:33,064 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:33,064 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:33,064 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:33,065 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:33,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:33,065 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:33,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:33,065 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:33,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:33,066 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:33,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:33,068 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:33,068 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:33,068 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:33,068 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:33,068 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:33,069 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:33,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:33,072 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:33,072 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:33,073 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:33,073 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:33,074 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 26/400.
2025-08-04 20:26:33,175 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:33,175 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:33,177 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 129 anomalous samples to GAN training data (target: 129).
2025-08-04 20:26:33,177 - ClientAppLogger [Client 2] - INFO - [Client] Round 26: Training GAN with 559 samples (430 normal, 129 anomalous).
2025-08-04 20:26:33,177 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:33,621 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0843, Avg D Loss: 0.8873
2025-08-04 20:26:33,621 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0843, Avg D Loss: 0.8873
2025-08-04 20:26:33,622 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:33,630 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3302, Threshold=0.3438, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:33,630 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:26:33,630 - ClientAppLogger [Client 2] - INFO - Fit completed for round 26. Duration: 0.56s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 26, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0843409030723232, 'd_loss': 0.8873091737251588, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.5556049346923828, 'cpu_percent_fit': 31.19375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 559}
2025-08-04 20:26:33,630 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:26:38,887 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:38,887 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:38,887 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:38,888 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:38,888 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:38,888 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:39,122 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:39,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:39,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:39,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:39,217 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:39,308 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:39,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:39,314 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:39,319 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:39,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:39,329 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:39,329 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:39,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:39,330 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:39,338 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:39,341 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:39,343 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:39,346 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:39,348 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:39,350 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:39,353 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:39,355 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:39,358 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:39,359 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:39,361 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:39,371 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:39,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:39,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:39,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:39,380 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:39,380 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:39,389 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:39,390 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:39,390 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:39,405 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:39,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:39,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:39,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:39,417 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:39,417 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:39,418 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:39,418 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:39,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:39,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:39,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:39,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:39,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:39,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:39,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:39,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:39,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:39,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:39,421 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:39,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:39,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:39,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:39,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:39,422 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:39,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:39,424 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:39,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:39,424 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:39,425 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:39,425 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:39,425 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:39,425 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:39,425 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:39,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:39,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:39,426 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:39,426 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:39,426 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:39,427 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:39,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:39,431 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:39,431 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:39,432 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:39,432 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:39,434 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:39,434 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:39,434 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:39,435 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:39,443 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3299, Threshold=0.3436, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:39,443 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3299
2025-08-04 20:26:44,693 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:44,693 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:44,693 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:44,694 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:44,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:44,694 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:44,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:44,937 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:45,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:45,037 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:45,037 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:45,141 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:45,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:45,148 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:45,153 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:45,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:45,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:45,160 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:45,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:45,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:45,169 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:45,172 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:45,174 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:45,176 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:45,178 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:45,180 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:45,183 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:45,186 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:45,189 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:45,190 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:45,193 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:45,203 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:45,203 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:45,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:45,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:45,214 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:45,214 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:45,225 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:45,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:45,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:45,241 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:45,247 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:45,253 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:45,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:45,254 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:45,254 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:45,254 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:45,255 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:45,255 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:45,255 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:45,255 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:45,255 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:45,256 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:45,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:45,257 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:45,257 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:45,257 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:45,257 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:45,257 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:45,258 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:45,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:45,258 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:45,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:45,258 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:45,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:45,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:45,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:45,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:45,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:45,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:45,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:45,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:45,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:45,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:45,262 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:45,262 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:45,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:45,262 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:45,262 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:45,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:45,267 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:45,267 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:45,269 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:45,269 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:45,274 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 27/400.
2025-08-04 20:26:45,375 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:45,375 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:45,377 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 135 anomalous samples to GAN training data (target: 135).
2025-08-04 20:26:45,378 - ClientAppLogger [Client 2] - INFO - [Client] Round 27: Training GAN with 585 samples (450 normal, 135 anomalous).
2025-08-04 20:26:45,378 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:45,866 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.8878
2025-08-04 20:26:45,866 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.8878
2025-08-04 20:26:45,866 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:45,875 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3326, Threshold=0.3461, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:45,875 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:26:45,875 - ClientAppLogger [Client 2] - INFO - Fit completed for round 27. Duration: 0.60s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 27, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085539183412862, 'd_loss': 0.8878286275598738, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6008889675140381, 'cpu_percent_fit': 31.00625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 585}
2025-08-04 20:26:45,875 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:26:51,130 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:51,130 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:51,130 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:51,130 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:51,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:51,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:51,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:51,391 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:51,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:51,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:51,502 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:51,601 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:51,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:51,608 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:51,612 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:51,617 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:51,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:51,618 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:51,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:51,618 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:51,627 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:51,630 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:51,632 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:51,635 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:51,637 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:51,640 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:51,642 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:51,645 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:51,648 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:51,650 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:51,652 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:51,660 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:51,660 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:51,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:51,665 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:51,671 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:51,671 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:51,681 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:51,681 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:51,682 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:51,696 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:51,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:51,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:51,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:51,704 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:51,705 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:51,705 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:51,705 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:51,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:51,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:51,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:51,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:51,707 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:51,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:51,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:51,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:51,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:51,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:51,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:51,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:51,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:51,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:51,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:51,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:51,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:51,710 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:51,710 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:51,710 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:51,710 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:51,711 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:51,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:51,711 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:51,711 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:51,711 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:51,711 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:51,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:51,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:51,712 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:51,712 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:51,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:51,713 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:51,714 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:51,715 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:51,715 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:51,717 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:26:51,717 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:51,717 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:51,717 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:26:51,725 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3323, Threshold=0.3458, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:51,725 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3323
2025-08-04 20:26:56,993 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:26:56,993 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:26:56,993 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:26:56,993 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:26:56,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:26:56,994 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:26:57,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:26:57,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:26:57,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:26:57,350 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:26:57,350 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:26:57,442 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:26:57,448 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:26:57,448 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:26:57,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:26:57,459 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:26:57,459 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:26:57,460 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:26:57,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:26:57,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:26:57,470 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:26:57,473 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:57,475 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:26:57,477 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:26:57,480 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:26:57,482 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:26:57,485 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:26:57,487 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:26:57,490 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:26:57,492 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:26:57,495 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:26:57,504 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:26:57,504 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:26:57,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:26:57,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:26:57,518 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:26:57,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:26:57,527 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:26:57,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:26:57,528 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:26:57,544 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:26:57,549 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:26:57,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:26:57,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:26:57,555 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:26:57,555 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:26:57,555 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:26:57,556 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:26:57,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:26:57,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:26:57,556 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:26:57,556 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:26:57,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:26:57,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:26:57,558 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:26:57,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:26:57,559 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:26:57,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:26:57,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:26:57,560 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:26:57,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:26:57,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:26:57,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:26:57,561 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:26:57,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:26:57,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:26:57,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:26:57,562 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:26:57,563 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:26:57,563 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:26:57,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:26:57,563 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:26:57,563 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:26:57,564 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:26:57,567 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:26:57,567 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:26:57,569 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:26:57,569 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:26:57,570 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 28/400.
2025-08-04 20:26:57,671 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:26:57,671 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:26:57,673 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 140 anomalous samples to GAN training data (target: 140).
2025-08-04 20:26:57,673 - ClientAppLogger [Client 2] - INFO - [Client] Round 28: Training GAN with 608 samples (468 normal, 140 anomalous).
2025-08-04 20:26:57,673 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:26:58,111 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.8869
2025-08-04 20:26:58,112 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.8869
2025-08-04 20:26:58,112 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:26:58,120 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3288, Threshold=0.3406, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:26:58,120 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:26:58,120 - ClientAppLogger [Client 2] - INFO - Fit completed for round 28. Duration: 0.55s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 28, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.084651847889549, 'd_loss': 0.8868787950591038, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.549475908279419, 'cpu_percent_fit': 31.1875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 608}
2025-08-04 20:26:58,120 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:27:03,377 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:03,377 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:03,377 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:03,377 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:03,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:03,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:03,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:03,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:03,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:03,728 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:03,728 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:03,816 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:03,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:03,822 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:03,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:03,834 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:03,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:03,838 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:03,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:03,838 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:03,847 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:03,850 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:03,852 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:03,854 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:03,857 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:03,859 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:03,861 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:03,864 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:03,867 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:03,868 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:03,870 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:03,880 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:03,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:03,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:03,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:03,890 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:03,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:03,899 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:03,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:03,900 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:03,915 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:03,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:03,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:03,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:03,925 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:03,925 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:03,925 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:03,925 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:03,926 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:03,926 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:03,926 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:03,926 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:03,927 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:03,928 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:03,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:03,929 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:03,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:03,929 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:03,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:03,930 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:03,930 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:03,930 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:03,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:03,931 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:03,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:03,931 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:03,931 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:03,931 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:03,932 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:03,932 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:03,932 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:03,932 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:03,932 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:03,932 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:03,936 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:03,936 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:03,937 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:03,937 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:03,939 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:03,939 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:03,939 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:03,940 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:03,947 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3286, Threshold=0.3404, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:03,948 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3286
2025-08-04 20:27:09,190 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:09,190 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:09,190 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:09,190 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:09,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:09,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:09,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:09,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:09,494 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:09,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:09,517 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:09,603 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:09,608 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:09,608 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:09,613 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:09,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:09,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:09,621 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:09,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:09,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:09,629 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:09,632 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:09,634 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:09,636 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:09,639 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:09,641 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:09,644 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:09,646 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:09,649 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:09,651 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:09,653 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:09,661 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:09,661 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:09,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:09,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:09,670 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:09,670 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:09,679 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:09,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:09,679 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:09,694 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:09,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:09,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:09,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:09,703 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:09,703 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:09,703 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:09,704 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:09,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:09,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:09,704 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:09,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:09,705 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:09,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:09,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:09,707 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:09,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:09,707 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:09,707 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:09,707 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:09,708 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:09,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:09,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:09,709 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:09,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:09,709 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:09,710 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:09,710 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:09,714 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:09,714 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:09,715 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:09,715 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:09,717 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 29/400.
2025-08-04 20:27:09,818 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:09,818 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:09,819 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 146 anomalous samples to GAN training data (target: 146).
2025-08-04 20:27:09,819 - ClientAppLogger [Client 2] - INFO - [Client] Round 29: Training GAN with 633 samples (487 normal, 146 anomalous).
2025-08-04 20:27:09,820 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:10,277 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0852, Avg D Loss: 0.8919
2025-08-04 20:27:10,278 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0852, Avg D Loss: 0.8919
2025-08-04 20:27:10,278 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:10,285 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3314, Threshold=0.3440, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:10,285 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:27:10,286 - ClientAppLogger [Client 2] - INFO - Fit completed for round 29. Duration: 0.57s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 29, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085214321986194, 'd_loss': 0.8918894552412379, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.5688591003417969, 'cpu_percent_fit': 31.25, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 633}
2025-08-04 20:27:10,286 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:27:15,545 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:15,545 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:15,545 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:15,545 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:15,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:15,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:15,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:15,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:15,866 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:15,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:15,896 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:15,991 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:15,997 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:15,998 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:16,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:16,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:16,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:16,017 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:16,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:16,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:16,026 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:16,029 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:16,031 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:16,033 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:16,036 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:16,038 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:16,041 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:16,043 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:16,046 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:16,048 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:16,050 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:16,061 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:16,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:16,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:16,065 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:16,071 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:16,071 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:16,080 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:16,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:16,081 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:16,096 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:16,100 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:16,104 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:16,105 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:16,105 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:16,105 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:16,105 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:16,105 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:16,105 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:16,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:16,106 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:16,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:16,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:16,107 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:16,107 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:16,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:16,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:16,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:16,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:16,108 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:16,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:16,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:16,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:16,109 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:16,109 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:16,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:16,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:16,110 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:16,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:16,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:16,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:16,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:16,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:16,111 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:16,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:16,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:16,112 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:16,112 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:16,112 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:16,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:16,117 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:16,117 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:16,119 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:16,119 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:16,120 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:16,121 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:16,121 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:16,121 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:16,131 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3314, Threshold=0.3440, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:16,131 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3314
2025-08-04 20:27:24,382 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:24,382 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:24,382 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:24,382 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:24,382 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:24,383 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:24,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:24,621 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:24,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:24,723 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:24,724 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:24,808 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:24,813 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:24,813 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:24,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:24,823 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:24,823 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:24,824 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:24,824 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:24,824 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:24,832 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:24,835 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:24,837 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:24,839 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:24,841 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:24,843 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:24,846 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:24,848 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:24,851 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:24,852 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:24,854 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:24,862 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:24,862 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:24,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:24,867 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:24,871 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:24,872 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:24,879 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:24,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:24,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:24,894 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:24,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:24,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:24,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:24,903 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:24,903 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:24,903 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:24,903 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:24,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:24,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:24,904 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:24,904 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:24,905 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:24,906 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:24,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:24,907 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:24,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:24,907 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:24,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:24,908 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:24,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:24,908 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:24,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:24,909 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:24,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:24,909 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:24,909 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:24,909 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:24,910 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:24,910 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:24,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:24,910 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:24,910 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:24,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:24,913 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:24,914 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:24,915 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:24,915 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:24,916 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 30/400.
2025-08-04 20:27:25,018 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:25,018 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:25,019 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 150 anomalous samples to GAN training data (target: 150).
2025-08-04 20:27:25,019 - ClientAppLogger [Client 2] - INFO - [Client] Round 30: Training GAN with 651 samples (501 normal, 150 anomalous).
2025-08-04 20:27:25,020 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:25,513 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0849, Avg D Loss: 0.8845
2025-08-04 20:27:25,514 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0849, Avg D Loss: 0.8845
2025-08-04 20:27:25,514 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:25,522 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3326, Threshold=0.3472, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:25,522 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:27:25,522 - ClientAppLogger [Client 2] - INFO - Fit completed for round 30. Duration: 0.61s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 30, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0849389844226396, 'd_loss': 0.8845134346807424, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6055722236633301, 'cpu_percent_fit': 31.21875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 651}
2025-08-04 20:27:25,522 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:27:33,781 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:33,781 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:33,781 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:33,782 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:33,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:33,782 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:34,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:34,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:34,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:34,163 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:34,163 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:34,250 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:34,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:34,258 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:34,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:34,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:34,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:34,274 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:34,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:34,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:34,283 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:34,287 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:34,289 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:34,291 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:34,294 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:34,296 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:34,299 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:34,301 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:34,304 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:34,305 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:34,308 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:34,317 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:34,317 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:34,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:34,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:34,327 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:34,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:34,337 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:34,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:34,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:34,353 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:34,357 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:34,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:34,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:34,364 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:34,364 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:34,364 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:34,364 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:34,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:34,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:34,365 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:34,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:34,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:34,367 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:34,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:34,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:34,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:34,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:34,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:34,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:34,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:34,369 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:34,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:34,369 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:34,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:34,370 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:34,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:34,370 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:34,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:34,370 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:34,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:34,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:34,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:34,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:34,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:34,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:34,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:34,372 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:34,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:34,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:34,375 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:34,375 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:34,377 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:34,377 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:34,379 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:34,379 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:34,379 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:34,380 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:34,389 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3325, Threshold=0.3470, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:34,390 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3325
2025-08-04 20:27:39,640 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:39,640 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:39,640 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:39,641 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:39,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:39,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:39,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:39,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:39,938 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:39,950 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:39,951 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:40,030 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:40,035 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:40,035 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:40,039 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:40,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:40,046 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:40,047 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:40,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:40,047 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:40,055 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:40,058 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:40,060 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:40,062 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:40,065 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:40,067 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:40,070 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:40,072 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:40,075 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:40,077 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:40,079 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:40,087 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:40,087 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:40,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:40,092 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:40,097 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:40,097 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:40,106 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:40,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:40,106 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:40,121 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:40,125 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:40,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:40,131 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:40,131 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:40,131 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:40,131 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:40,132 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:40,132 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:40,132 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:40,132 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:40,132 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:40,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:40,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:40,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:40,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:40,134 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:40,135 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:40,136 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:40,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:40,136 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:40,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:40,137 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:40,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:40,137 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:40,137 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:40,137 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:40,138 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:40,138 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:40,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:40,138 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:40,138 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:40,138 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:40,141 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:40,141 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:40,143 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:40,143 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:40,144 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 31/400.
2025-08-04 20:27:40,245 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:40,245 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:40,246 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 154 anomalous samples to GAN training data (target: 154).
2025-08-04 20:27:40,246 - ClientAppLogger [Client 2] - INFO - [Client] Round 31: Training GAN with 668 samples (514 normal, 154 anomalous).
2025-08-04 20:27:40,247 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:40,719 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0854, Avg D Loss: 0.8845
2025-08-04 20:27:40,719 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0854, Avg D Loss: 0.8845
2025-08-04 20:27:40,720 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:40,727 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3367, Threshold=0.3527, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:40,727 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:27:40,728 - ClientAppLogger [Client 2] - INFO - Fit completed for round 31. Duration: 0.58s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 31, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085392809485247, 'd_loss': 0.8844990428693281, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.5831806659698486, 'cpu_percent_fit': 31.2, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 668}
2025-08-04 20:27:40,728 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:27:45,985 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:45,985 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:45,985 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:45,985 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:45,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:45,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:46,228 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:46,228 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:46,313 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:46,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:46,329 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:46,421 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:46,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:46,429 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:46,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:46,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:46,440 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:46,441 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:46,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:46,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:46,450 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:46,452 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:46,454 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:46,457 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:46,460 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:46,462 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:46,465 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:46,467 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:46,470 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:46,472 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:46,475 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:46,484 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:46,484 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:46,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:46,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:46,495 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:46,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:46,506 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:46,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:46,506 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:46,521 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:46,526 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:46,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:46,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:46,532 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:46,532 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:46,532 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:46,532 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:46,533 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:46,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:46,533 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:46,533 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:46,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:46,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:46,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:46,535 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:46,535 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:46,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:46,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:46,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:46,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:46,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:46,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:46,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:46,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:46,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:46,538 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:46,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:46,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:46,539 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:46,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:46,539 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:46,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:46,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:46,542 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:46,542 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:46,543 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:46,543 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:46,545 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:27:46,545 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:46,545 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:46,546 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:27:46,554 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3367, Threshold=0.3527, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:46,554 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3367
2025-08-04 20:27:54,810 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:27:54,818 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:27:54,818 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:27:54,818 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:27:54,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:27:54,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:27:55,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:27:55,045 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:27:55,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:27:55,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:27:55,136 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:27:55,219 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:27:55,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:27:55,225 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:27:55,231 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:27:55,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:27:55,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:27:55,239 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:27:55,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:27:55,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:27:55,248 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:27:55,250 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:55,253 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:27:55,255 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:27:55,257 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:27:55,260 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:27:55,262 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:27:55,265 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:27:55,267 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:27:55,269 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:27:55,271 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:27:55,280 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:27:55,280 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:27:55,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:27:55,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:27:55,289 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:27:55,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:27:55,298 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:27:55,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:27:55,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:27:55,312 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:27:55,316 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:27:55,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:27:55,321 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:27:55,321 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:27:55,322 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:27:55,322 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:27:55,322 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:27:55,322 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:27:55,322 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:27:55,323 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:27:55,323 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:27:55,324 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:27:55,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:27:55,324 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:27:55,324 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:27:55,325 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:27:55,326 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:27:55,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:27:55,326 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:27:55,326 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:27:55,327 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:27:55,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:27:55,327 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:27:55,327 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:27:55,327 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:27:55,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:27:55,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:27:55,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:27:55,328 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:27:55,328 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:27:55,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:27:55,331 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:27:55,332 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:27:55,333 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:27:55,333 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:27:55,334 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 32/400.
2025-08-04 20:27:55,436 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:27:55,436 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:27:55,437 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 159 anomalous samples to GAN training data (target: 159).
2025-08-04 20:27:55,437 - ClientAppLogger [Client 2] - INFO - [Client] Round 32: Training GAN with 690 samples (531 normal, 159 anomalous).
2025-08-04 20:27:55,438 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:27:55,940 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0854, Avg D Loss: 0.8910
2025-08-04 20:27:55,940 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0854, Avg D Loss: 0.8910
2025-08-04 20:27:55,940 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:27:55,947 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3393, Threshold=0.3549, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:27:55,947 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:27:55,948 - ClientAppLogger [Client 2] - INFO - Fit completed for round 32. Duration: 0.61s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 32, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085365367212157, 'd_loss': 0.8909974105634552, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6132354736328125, 'cpu_percent_fit': 31.1375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 690}
2025-08-04 20:27:55,948 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:28:01,208 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:01,208 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:01,208 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:01,208 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:01,208 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:01,209 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:01,501 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:01,502 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:01,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:01,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:01,620 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:01,713 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:01,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:01,718 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:01,723 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:01,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:01,730 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:01,731 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:01,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:01,731 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:01,741 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:01,743 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:01,745 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:01,748 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:01,750 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:01,752 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:01,755 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:01,757 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:01,760 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:01,762 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:01,764 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:01,774 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:01,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:01,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:01,779 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:01,783 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:01,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:01,792 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:01,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:01,793 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:01,809 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:01,815 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:01,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:01,821 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:01,821 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:01,821 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:01,822 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:01,822 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:01,822 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:01,822 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:01,823 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:01,823 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:01,824 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:01,824 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:01,825 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:01,826 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:01,826 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:01,826 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:01,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:01,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:01,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:01,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:01,827 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:01,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:01,828 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:01,828 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:01,828 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:01,832 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:01,832 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:01,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:01,832 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:01,833 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:01,833 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:01,837 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:01,838 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:01,839 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:01,839 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:01,841 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:01,841 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:01,841 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:01,842 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:01,850 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3391, Threshold=0.3547, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:01,850 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3391
2025-08-04 20:28:10,110 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:10,111 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:10,111 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:10,111 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:10,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:10,111 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:10,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:10,358 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:10,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:10,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:10,463 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:10,548 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:10,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:10,553 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:10,558 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:10,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:10,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:10,563 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:10,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:10,563 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:10,571 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:10,574 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:10,576 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:10,578 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:10,581 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:10,583 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:10,585 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:10,587 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:10,590 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:10,591 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:10,594 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:10,602 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:10,602 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:10,607 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:10,607 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:10,611 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:10,611 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:10,619 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:10,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:10,620 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:10,634 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:10,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:10,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:10,644 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:10,645 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:10,645 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:10,645 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:10,645 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:10,645 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:10,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:10,646 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:10,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:10,647 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:10,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:10,647 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:10,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:10,648 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:10,648 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:10,648 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:10,648 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:10,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:10,648 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:10,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:10,649 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:10,649 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:10,650 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:10,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:10,650 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:10,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:10,650 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:10,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:10,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:10,651 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:10,651 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:10,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:10,655 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:10,655 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:10,655 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:10,656 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:10,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:10,659 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:10,659 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:10,660 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:10,661 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:10,662 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 33/400.
2025-08-04 20:28:10,763 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:10,763 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:10,764 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 165 anomalous samples to GAN training data (target: 165).
2025-08-04 20:28:10,768 - ClientAppLogger [Client 2] - INFO - [Client] Round 33: Training GAN with 716 samples (551 normal, 165 anomalous).
2025-08-04 20:28:10,768 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:11,292 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0849, Avg D Loss: 0.8864
2025-08-04 20:28:11,293 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0849, Avg D Loss: 0.8864
2025-08-04 20:28:11,293 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:11,300 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3378, Threshold=0.3529, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:11,301 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:28:11,301 - ClientAppLogger [Client 2] - INFO - Fit completed for round 33. Duration: 0.64s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 33, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0848623805871886, 'd_loss': 0.8863757780144335, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6392161846160889, 'cpu_percent_fit': 31.11875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 716}
2025-08-04 20:28:11,301 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:28:16,549 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:16,549 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:16,549 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:16,549 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:16,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:16,550 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:16,818 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:16,819 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:16,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:16,933 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:16,933 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:17,023 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:17,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:17,028 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:17,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:17,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:17,041 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:17,042 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:17,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:17,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:17,051 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:17,053 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:17,055 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:17,057 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:17,060 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:17,063 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:17,065 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:17,067 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:17,070 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:17,072 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:17,075 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:17,085 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:17,086 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:17,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:17,091 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:17,096 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:17,096 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:17,110 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:17,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:17,110 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:17,131 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:17,136 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:17,141 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:17,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:17,142 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:17,142 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:17,142 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:17,143 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:17,143 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:17,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:17,143 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:17,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:17,145 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:17,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:17,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:17,146 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:17,146 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:17,147 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:17,148 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:17,149 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:17,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:17,149 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:17,149 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:17,150 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:17,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:17,150 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:17,150 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:17,151 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:17,154 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:17,154 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:17,154 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:17,155 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:17,155 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:17,155 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:17,159 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:17,159 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:17,160 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:17,161 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:17,163 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:17,163 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:17,163 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:17,164 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:17,172 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3376, Threshold=0.3527, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:17,173 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3376
2025-08-04 20:28:22,426 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:22,426 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:22,427 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:22,427 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:22,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:22,427 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:22,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:22,677 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:22,758 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:22,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:22,783 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:22,868 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:22,873 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:22,874 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:22,878 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:22,883 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:22,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:22,884 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:22,884 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:22,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:22,893 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:22,895 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:22,897 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:22,899 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:22,903 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:22,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:22,907 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:22,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:22,912 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:22,914 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:22,916 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:22,924 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:22,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:22,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:22,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:22,934 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:22,934 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:22,943 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:22,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:22,943 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:22,957 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:22,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:22,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:22,967 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:22,967 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:22,967 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:22,967 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:22,968 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:22,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:22,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:22,968 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:22,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:22,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:22,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:22,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:22,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:22,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:22,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:22,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:22,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:22,974 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:22,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:22,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:22,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:22,977 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:22,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:22,978 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:22,981 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:22,981 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:22,983 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:22,983 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:22,984 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 34/400.
2025-08-04 20:28:23,085 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:23,085 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:23,087 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 169 anomalous samples to GAN training data (target: 169).
2025-08-04 20:28:23,087 - ClientAppLogger [Client 2] - INFO - [Client] Round 34: Training GAN with 733 samples (564 normal, 169 anomalous).
2025-08-04 20:28:23,087 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:23,638 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0853, Avg D Loss: 0.8863
2025-08-04 20:28:23,639 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0853, Avg D Loss: 0.8863
2025-08-04 20:28:23,639 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:23,648 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3403, Threshold=0.3561, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:23,648 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:28:23,649 - ClientAppLogger [Client 2] - INFO - Fit completed for round 34. Duration: 0.66s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 34, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0853307765958093, 'd_loss': 0.8862927271350507, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.664292573928833, 'cpu_percent_fit': 31.04375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 733}
2025-08-04 20:28:23,649 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:28:28,917 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:28,917 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:28,917 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:28,917 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:28,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:28,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:29,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:29,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:29,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:29,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:29,273 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:29,379 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:29,387 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:29,387 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:29,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:29,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:29,421 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:29,422 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:29,422 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:29,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:29,432 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:29,435 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:29,437 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:29,440 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:29,443 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:29,445 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:29,447 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:29,450 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:29,454 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:29,456 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:29,459 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:29,470 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:29,470 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:29,476 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:29,477 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:29,483 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:29,483 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:29,497 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:29,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:29,498 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:29,517 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:29,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:29,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:29,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:29,535 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:29,535 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:29,536 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:29,536 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:29,536 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:29,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:29,537 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:29,537 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:29,538 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:29,539 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:29,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:29,540 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:29,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:29,540 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:29,541 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:29,541 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:29,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:29,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:29,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:29,542 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:29,542 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:29,546 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:29,546 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:29,546 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:29,546 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:29,547 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:29,547 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:29,547 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:29,548 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:29,549 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:29,552 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:29,553 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:29,553 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:29,554 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:29,554 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:29,555 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:29,561 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:29,561 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:29,563 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:29,563 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:29,565 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:29,565 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:29,565 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:29,566 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:29,578 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3402, Threshold=0.3559, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:29,578 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3402
2025-08-04 20:28:37,840 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:37,841 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:37,841 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:37,841 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:37,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:37,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:38,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:38,074 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:38,158 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:38,183 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:38,183 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:38,266 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:38,272 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:38,272 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:38,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:38,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:38,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:38,287 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:38,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:38,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:38,296 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:38,299 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:38,301 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:38,303 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:38,306 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:38,308 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:38,310 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:38,313 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:38,315 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:38,317 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:38,319 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:38,328 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:38,328 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:38,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:38,333 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:38,337 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:38,337 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:38,345 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:38,345 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:38,346 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:38,360 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:38,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:38,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:38,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:38,369 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:38,369 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:38,370 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:38,370 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:38,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:38,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:38,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:38,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:38,372 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:38,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:38,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:38,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:38,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:38,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:38,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:38,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:38,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:38,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:38,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:38,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:38,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:38,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:38,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:38,375 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:38,375 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:38,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:38,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:38,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:38,376 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:38,376 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:38,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:38,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:38,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:38,377 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:38,377 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:38,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:38,382 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:38,382 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:38,383 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:38,383 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:38,385 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 35/400.
2025-08-04 20:28:38,486 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:38,486 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:38,488 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 174 anomalous samples to GAN training data (target: 174).
2025-08-04 20:28:38,488 - ClientAppLogger [Client 2] - INFO - [Client] Round 35: Training GAN with 754 samples (580 normal, 174 anomalous).
2025-08-04 20:28:38,488 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:39,047 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0851, Avg D Loss: 0.8857
2025-08-04 20:28:39,047 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0851, Avg D Loss: 0.8857
2025-08-04 20:28:39,047 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:39,055 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3366, Threshold=0.3527, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:39,055 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:28:39,055 - ClientAppLogger [Client 2] - INFO - Fit completed for round 35. Duration: 0.67s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 35, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0850534379640373, 'd_loss': 0.8856876188311084, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6702382564544678, 'cpu_percent_fit': 31.175, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 754}
2025-08-04 20:28:39,056 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:28:44,313 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:44,313 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:44,313 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:44,313 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:44,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:44,314 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:44,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:44,596 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:44,683 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:44,709 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:44,709 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:44,818 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:44,825 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:44,825 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:44,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:44,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:44,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:44,842 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:44,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:44,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:44,851 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:44,854 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:44,856 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:44,858 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:44,860 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:44,863 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:44,865 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:44,868 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:44,870 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:44,872 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:44,875 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:44,885 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:44,885 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:44,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:44,890 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:44,897 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:44,898 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:44,912 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:44,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:44,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:44,930 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:44,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:44,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:44,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:44,953 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:44,954 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:44,955 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:44,956 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:44,956 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:44,956 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:44,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:44,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:44,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:44,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:44,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:44,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:44,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:44,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:44,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:44,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:44,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:44,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:44,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:44,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:44,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:44,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:44,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:44,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:44,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:44,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:44,971 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:44,971 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:44,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:44,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:44,978 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:44,978 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:44,980 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:44,980 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:44,982 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:44,982 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:44,982 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:44,983 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:44,993 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3366, Threshold=0.3527, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:44,993 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3366
2025-08-04 20:28:50,249 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:50,249 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:50,249 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:50,249 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:50,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:50,250 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:50,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:50,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:50,603 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:50,629 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:50,630 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:50,724 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:50,729 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:50,730 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:50,735 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:50,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:50,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:50,741 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:50,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:50,741 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:50,749 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:50,752 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:50,754 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:50,756 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:50,759 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:50,761 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:50,763 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:50,766 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:50,768 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:50,770 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:50,773 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:50,783 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:50,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:50,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:50,789 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:50,795 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:50,795 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:50,809 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:50,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:50,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:50,826 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:50,832 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:50,839 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:50,840 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:50,840 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:50,840 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:50,840 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:50,840 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:50,841 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:50,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:50,841 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:50,841 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:50,842 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:50,842 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:50,843 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:50,843 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:50,843 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:50,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:50,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:50,844 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:50,845 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:50,845 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:50,845 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:50,846 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:50,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:50,848 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:50,849 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:50,849 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:50,849 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:50,850 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:50,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:50,850 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:50,851 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:50,851 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:50,855 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:50,855 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:50,857 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:50,857 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:50,859 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 36/400.
2025-08-04 20:28:50,963 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:50,963 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:50,965 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 179 anomalous samples to GAN training data (target: 179).
2025-08-04 20:28:50,965 - ClientAppLogger [Client 2] - INFO - [Client] Round 36: Training GAN with 776 samples (597 normal, 179 anomalous).
2025-08-04 20:28:50,965 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:28:51,551 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0852, Avg D Loss: 0.8801
2025-08-04 20:28:51,552 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0852, Avg D Loss: 0.8801
2025-08-04 20:28:51,552 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:28:51,559 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3411, Threshold=0.3573, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:51,559 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:28:51,560 - ClientAppLogger [Client 2] - INFO - Fit completed for round 36. Duration: 0.70s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 36, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085205662127623, 'd_loss': 0.8800876131377269, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6978497505187988, 'cpu_percent_fit': 31.10625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 776}
2025-08-04 20:28:51,560 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:28:56,843 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:28:56,843 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:28:56,843 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:28:56,844 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:28:56,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:28:56,844 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:28:57,219 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:28:57,220 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:28:57,305 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:28:57,320 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:28:57,321 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:28:57,426 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:28:57,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:28:57,436 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:28:57,446 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:28:57,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:28:57,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:28:57,470 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:28:57,470 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:28:57,470 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:28:57,481 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:28:57,485 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,487 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:28:57,489 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:28:57,492 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:28:57,495 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:28:57,498 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:28:57,501 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:28:57,504 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:28:57,507 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:28:57,509 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:28:57,519 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:28:57,519 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:28:57,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:28:57,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:28:57,530 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:28:57,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:28:57,543 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:28:57,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:28:57,544 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:28:57,564 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:28:57,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:28:57,575 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:28:57,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:28:57,578 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:28:57,578 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:28:57,578 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:28:57,579 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:28:57,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:28:57,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:28:57,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:28:57,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:28:57,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:28:57,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:28:57,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:28:57,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:28:57,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:28:57,582 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:28:57,583 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:28:57,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:28:57,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:28:57,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:28:57,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:28:57,586 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:28:57,586 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:28:57,587 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:28:57,587 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:28:57,587 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:28:57,588 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:28:57,588 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:28:57,588 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:28:57,588 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:28:57,588 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:28:57,588 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:28:57,595 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:28:57,595 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:28:57,596 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:28:57,597 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:28:57,598 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:28:57,598 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:28:57,599 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:28:57,599 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:28:57,613 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3408, Threshold=0.3570, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:28:57,613 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3408
2025-08-04 20:29:05,879 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:05,879 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:05,879 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:05,879 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:05,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:05,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:06,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:06,102 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:06,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:06,204 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:06,205 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:06,293 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:06,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:06,299 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:06,304 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:06,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:06,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:06,311 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:06,312 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:06,312 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:06,320 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:06,323 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:06,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:06,327 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:06,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:06,332 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:06,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:06,338 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:06,340 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:06,342 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:06,345 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:06,354 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:06,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:06,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:06,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:06,364 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:06,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:06,372 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:06,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:06,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:06,387 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:06,392 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:06,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:06,397 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:06,397 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:06,397 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:06,397 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:06,397 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:06,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:06,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:06,398 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:06,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:06,399 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:06,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:06,400 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:06,400 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:06,400 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:06,400 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:06,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:06,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:06,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:06,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:06,402 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:06,402 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:06,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:06,403 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:06,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:06,403 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:06,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:06,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:06,404 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:06,404 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:06,404 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:06,405 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:06,408 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:06,408 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:06,410 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:06,410 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:06,412 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 37/400.
2025-08-04 20:29:06,513 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:06,513 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:06,514 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 183 anomalous samples to GAN training data (target: 183).
2025-08-04 20:29:06,515 - ClientAppLogger [Client 2] - INFO - [Client] Round 37: Training GAN with 793 samples (610 normal, 183 anomalous).
2025-08-04 20:29:06,515 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:07,087 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0857, Avg D Loss: 0.8814
2025-08-04 20:29:07,087 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0857, Avg D Loss: 0.8814
2025-08-04 20:29:07,087 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:07,095 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3378, Threshold=0.3550, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:07,095 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:29:07,095 - ClientAppLogger [Client 2] - INFO - Fit completed for round 37. Duration: 0.68s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 37, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0856572533014592, 'd_loss': 0.8813983628608539, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6833503246307373, 'cpu_percent_fit': 31.14375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 793}
2025-08-04 20:29:07,095 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:29:12,371 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:12,372 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:12,372 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:12,372 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:12,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:12,372 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:12,640 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:12,641 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:12,732 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:12,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:12,751 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:12,857 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:12,864 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:12,864 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:12,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:12,879 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:12,879 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:12,880 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:12,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:12,880 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:12,890 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:12,893 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:12,895 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:12,897 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:12,900 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:12,902 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:12,905 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:12,907 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:12,910 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:12,912 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:12,914 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:12,924 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:12,924 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:12,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:12,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:12,935 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:12,935 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:12,944 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:12,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:12,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:12,959 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:12,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:12,968 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:12,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:12,969 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:12,969 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:12,969 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:12,969 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:12,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:12,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:12,970 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:12,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:12,971 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:12,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:12,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:12,972 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:12,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:12,972 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:12,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:12,975 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:12,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:12,975 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:12,975 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:12,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:12,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:12,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:12,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:12,976 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:12,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:12,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:12,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:12,977 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:12,977 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:12,977 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:12,981 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:12,981 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:12,982 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:12,982 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:12,984 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:12,984 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:12,984 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:12,985 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:12,993 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3377, Threshold=0.3549, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:12,993 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3377
2025-08-04 20:29:18,244 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:18,244 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:18,244 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:18,244 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:18,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:18,244 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:18,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:18,492 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:18,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:18,598 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:18,598 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:18,690 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:18,695 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:18,695 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:18,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:18,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:18,705 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:18,706 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:18,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:18,706 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:18,714 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:18,716 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:18,718 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:18,720 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:18,723 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:18,725 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:18,728 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:18,730 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:18,733 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:18,735 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:18,738 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:18,746 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:18,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:18,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:18,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:18,756 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:18,756 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:18,764 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:18,765 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:18,765 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:18,787 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:18,794 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:18,803 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:18,803 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:18,803 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:18,804 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:18,804 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:18,804 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:18,804 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:18,805 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:18,805 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:18,805 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:18,806 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:18,807 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:18,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:18,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:18,809 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:18,810 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:18,811 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:18,811 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:18,812 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:18,813 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:18,813 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:18,813 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:18,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:18,814 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:18,814 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:18,814 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:18,818 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:18,818 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:18,819 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:18,819 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:18,821 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 38/400.
2025-08-04 20:29:18,922 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:18,922 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:18,923 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 189 anomalous samples to GAN training data (target: 189).
2025-08-04 20:29:18,924 - ClientAppLogger [Client 2] - INFO - [Client] Round 38: Training GAN with 820 samples (631 normal, 189 anomalous).
2025-08-04 20:29:18,924 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:19,507 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0860, Avg D Loss: 0.8848
2025-08-04 20:29:19,507 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0860, Avg D Loss: 0.8848
2025-08-04 20:29:19,507 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:19,515 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3344, Threshold=0.3523, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:19,515 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:29:19,516 - ClientAppLogger [Client 2] - INFO - Fit completed for round 38. Duration: 0.69s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 38, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.085997599857609, 'd_loss': 0.8847845974201111, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.6941862106323242, 'cpu_percent_fit': 31.175, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 820}
2025-08-04 20:29:19,516 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:29:24,797 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:24,797 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:24,797 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:24,798 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:24,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:24,798 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:25,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:25,078 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:25,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:25,182 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:25,182 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:25,276 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:25,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:25,282 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:25,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:25,299 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:25,299 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:25,300 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:25,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:25,300 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:25,309 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:25,312 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:25,314 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:25,316 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:25,318 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:25,320 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:25,323 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:25,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:25,328 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:25,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:25,332 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:25,343 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:25,343 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:25,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:25,348 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:25,354 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:25,354 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:25,364 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:25,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:25,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:25,379 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:25,384 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:25,388 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:25,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:25,389 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:25,389 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:25,389 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:25,389 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:25,390 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:25,390 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:25,390 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:25,390 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:25,391 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:25,392 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:25,392 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:25,392 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:25,392 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:25,392 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:25,393 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:25,394 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:25,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:25,394 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:25,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:25,395 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:25,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:25,395 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:25,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:25,395 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:25,395 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:25,396 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:25,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:25,396 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:25,396 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:25,396 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:25,401 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:25,401 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:25,403 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:25,403 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:25,404 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:25,405 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:25,405 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:25,405 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:25,413 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3343, Threshold=0.3522, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:25,413 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3343
2025-08-04 20:29:30,663 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:30,663 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:30,663 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:30,663 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:30,663 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:30,664 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:30,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:30,895 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:30,974 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:30,986 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:30,986 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:31,066 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:31,071 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:31,072 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:31,076 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:31,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:31,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:31,082 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:31,082 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:31,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:31,091 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:31,094 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:31,096 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:31,098 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:31,101 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:31,103 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:31,105 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:31,108 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:31,111 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:31,113 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:31,115 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:31,124 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:31,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:31,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:31,129 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:31,134 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:31,134 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:31,143 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:31,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:31,144 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:31,157 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:31,162 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:31,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:31,167 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:31,167 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:31,167 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:31,168 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:31,168 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:31,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:31,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:31,168 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:31,169 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:31,170 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:31,170 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:31,170 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:31,170 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:31,170 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:31,170 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:31,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:31,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:31,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:31,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:31,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:31,171 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:31,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:31,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:31,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:31,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:31,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:31,173 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:31,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:31,173 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:31,173 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:31,173 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:31,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:31,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:31,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:31,174 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:31,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:31,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:31,177 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:31,177 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:31,178 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:31,178 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:31,180 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 39/400.
2025-08-04 20:29:31,281 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:31,281 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:31,282 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 194 anomalous samples to GAN training data (target: 194).
2025-08-04 20:29:31,283 - ClientAppLogger [Client 2] - INFO - [Client] Round 39: Training GAN with 842 samples (648 normal, 194 anomalous).
2025-08-04 20:29:31,283 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:31,933 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0862, Avg D Loss: 0.8826
2025-08-04 20:29:31,934 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0862, Avg D Loss: 0.8826
2025-08-04 20:29:31,934 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:31,942 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3373, Threshold=0.3544, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:31,942 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:29:31,943 - ClientAppLogger [Client 2] - INFO - Fit completed for round 39. Duration: 0.76s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 39, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0861941676808082, 'd_loss': 0.8826177093733516, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.7630026340484619, 'cpu_percent_fit': 31.15, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 842}
2025-08-04 20:29:31,943 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:29:37,211 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:37,211 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:37,211 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:37,212 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:37,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:37,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:37,425 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:37,425 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:37,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:37,534 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:37,535 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:37,625 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:37,631 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:37,632 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:37,639 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:37,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:37,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:37,646 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:37,646 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:37,647 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:37,657 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:37,659 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:37,663 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:37,665 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:37,667 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:37,670 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:37,672 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:37,674 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:37,677 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:37,679 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:37,681 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:37,691 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:37,692 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:37,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:37,698 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:37,704 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:37,704 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:37,714 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:37,714 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:37,714 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:37,729 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:37,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:37,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:37,739 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:37,739 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:37,739 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:37,739 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:37,739 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:37,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:37,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:37,740 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:37,740 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:37,741 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:37,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:37,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:37,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:37,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:37,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:37,742 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:37,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:37,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:37,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:37,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:37,743 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:37,743 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:37,744 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:37,744 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:37,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:37,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:37,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:37,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:37,745 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:37,745 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:37,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:37,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:37,746 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:37,746 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:37,747 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:37,747 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:37,747 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:37,751 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:37,751 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:37,753 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:37,753 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:37,754 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:37,754 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:37,755 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:37,755 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:37,763 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3370, Threshold=0.3541, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:37,763 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3370
2025-08-04 20:29:43,025 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:43,025 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:43,025 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:43,025 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:43,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:43,026 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:43,259 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:43,259 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:43,347 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:43,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:43,371 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:43,459 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:43,465 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:43,466 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:43,471 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:43,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:43,480 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:43,480 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:43,481 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:43,481 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:43,490 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:43,493 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:43,495 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:43,497 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:43,500 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:43,502 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:43,505 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:43,508 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:43,511 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:43,513 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:43,515 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:43,525 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:43,526 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:43,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:43,530 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:43,535 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:43,536 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:43,544 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:43,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:43,545 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:43,562 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:43,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:43,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:43,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:43,572 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:43,572 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:43,573 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:43,573 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:43,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:43,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:43,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:43,574 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:43,575 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:43,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:43,576 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:43,576 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:43,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:43,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:43,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:43,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:43,577 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:43,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:43,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:43,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:43,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:43,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:43,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:43,579 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:43,579 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:43,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:43,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:43,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:43,580 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:43,580 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:43,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:43,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:43,581 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:43,581 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:43,581 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:43,582 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:43,585 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:43,585 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:43,587 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:43,587 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:43,589 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 40/400.
2025-08-04 20:29:43,691 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:43,691 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:43,693 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 200 anomalous samples to GAN training data (target: 200).
2025-08-04 20:29:43,693 - ClientAppLogger [Client 2] - INFO - [Client] Round 40: Training GAN with 867 samples (667 normal, 200 anomalous).
2025-08-04 20:29:43,693 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 20:29:44,414 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0856, Avg D Loss: 0.8876
2025-08-04 20:29:44,414 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0856, Avg D Loss: 0.8876
2025-08-04 20:29:44,415 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:29:44,423 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3433, Threshold=0.3613, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:44,423 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8046
2025-08-04 20:29:44,423 - ClientAppLogger [Client 2] - INFO - Fit completed for round 40. Duration: 0.83s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 40, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0856339902613814, 'd_loss': 0.8875874644676018, 'post_fit_local_f1': 0.8045977011494253, 'fit_time_seconds': 0.833773136138916, 'cpu_percent_fit': 31.225, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 867}
2025-08-04 20:29:44,424 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 20:29:52,680 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2000
2025-08-04 20:29:52,680 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 20:29:52,680 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 20:29:52,680 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 20:29:52,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 20:29:52,680 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:29:52,941 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:29:52,942 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 20:29:53,042 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 20:29:53,067 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 20:29:53,068 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:29:53,170 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:29:53,177 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:29:53,177 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:29:53,184 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 20:29:53,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:29:53,190 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 20:29:53,190 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:29:53,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:29:53,191 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 20:29:53,199 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:29:53,202 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:53,204 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:29:53,206 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:29:53,209 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:29:53,211 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:29:53,213 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:29:53,216 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:29:53,218 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:29:53,220 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:29:53,223 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:29:53,234 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:29:53,234 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 20:29:53,238 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 20:29:53,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 20:29:53,243 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:29:53,243 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 20:29:53,254 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:29:53,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 20:29:53,254 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:29:53,270 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:29:53,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 20:29:53,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 20:29:53,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:29:53,281 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:29:53,281 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:29:53,282 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:29:53,282 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:29:53,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 20:29:53,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:29:53,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 20:29:53,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 20:29:53,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 20:29:53,284 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 20:29:53,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 20:29:53,285 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 20:29:53,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 20:29:53,286 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 20:29:53,286 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 20:29:53,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 20:29:53,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 20:29:53,288 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 20:29:53,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 20:29:53,288 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 20:29:53,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 20:29:53,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:29:53,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 20:29:53,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:29:53,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:29:53,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 20:29:53,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 20:29:53,290 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 20:29:53,290 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 20:29:53,290 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 20:29:53,294 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 20:29:53,294 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:29:53,296 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:29:53,296 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 20:29:53,298 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:29:53,298 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:29:53,298 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:29:53,299 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:29:53,307 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.3438, Threshold=0.3620, Accuracy=0.7213, F1=0.8046, Precision=0.9589, Recall=0.6931
2025-08-04 20:29:53,307 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7213, F1: 0.8046, Prec: 0.9589, Rec: 0.6931, Avg Anomaly Score: 0.3438
