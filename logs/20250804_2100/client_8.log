2025-08-04 21:00:15,656 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:15,657 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:00:15,657 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:00:15,657 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:00:15,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:00:15,657 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:15,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:15,961 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:16,060 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:00:16,083 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:00:16,084 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:16,237 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:16,248 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:16,248 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:16,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:00:16,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:16,286 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:00:16,287 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:16,287 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:16,288 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:00:16,299 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:16,302 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,304 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:16,307 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:16,310 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:16,313 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:16,316 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,319 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:16,324 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:16,328 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:16,332 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:16,343 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:16,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:00:16,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:00:16,349 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:00:16,358 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:16,358 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:00:16,377 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:16,377 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:00:16,378 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:16,399 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:16,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:00:16,416 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:00:16,416 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:16,416 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:16,417 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:16,417 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:16,418 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:16,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:00:16,418 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:16,418 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:00:16,419 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:16,420 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:00:16,421 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:00:16,422 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:16,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:00:16,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:16,423 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:16,424 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:16,424 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:00:16,424 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:00:16,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:00:16,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:00:16,425 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:00:16,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:00:16,426 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:00:16,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:00:16,426 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:00:16,426 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:00:16,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:00:16,427 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:00:16,427 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:16,428 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:00:16,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:16,428 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:16,429 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:16,432 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:00:16,432 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:00:16,432 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:00:16,433 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:00:16,441 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:00:16,441 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:16,442 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:16,442 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:00:16,444 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:16,444 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:16,444 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:16,445 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:16,458 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5506, Threshold=0.5908, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 21:00:16,458 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5506
2025-08-04 21:00:39,777 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:39,777 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:00:39,777 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:00:39,777 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:00:39,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:00:39,777 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:40,112 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:40,112 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:40,202 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:00:40,222 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:00:40,223 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:40,366 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:40,373 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:40,374 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:40,380 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:00:40,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:40,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:00:40,406 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:40,406 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:40,407 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:00:40,417 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:40,421 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,424 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:40,427 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:40,431 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:40,434 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:40,438 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,441 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:40,444 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:40,446 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:40,449 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:40,460 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:40,460 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:00:40,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:00:40,465 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:00:40,473 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:40,474 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:00:40,488 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:40,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:00:40,489 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:40,509 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:40,514 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:00:40,520 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:00:40,520 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:40,520 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:40,520 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:40,521 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:40,521 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:40,521 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:00:40,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:40,522 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:00:40,522 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:40,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:00:40,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:00:40,524 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:40,524 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:00:40,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:40,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:40,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:40,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:00:40,525 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:00:40,525 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:00:40,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:00:40,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:00:40,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:00:40,527 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:40,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:00:40,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:40,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:40,528 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:40,532 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:00:40,532 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:00:40,532 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:00:40,532 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:00:40,541 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:00:40,542 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:40,543 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:40,543 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:00:40,544 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:40,545 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:40,545 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:40,545 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:40,560 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5355, Threshold=0.5668, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 21:00:40,561 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5355
2025-08-04 21:01:00,855 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:00,856 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:00,856 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:00,856 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:01:00,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:01:00,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:01,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:01,158 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:01,247 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:01:01,271 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:01:01,271 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:01,393 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:01,401 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:01,401 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:01,408 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:01:01,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:01,435 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:01:01,436 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:01,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:01,436 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:01:01,446 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:01,449 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,451 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:01,453 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:01,456 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:01,459 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:01,463 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,466 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:01,469 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:01,471 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:01,473 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:01,486 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:01,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:01:01,491 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:01:01,491 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:01:01,499 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:01,499 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:01:01,518 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:01,518 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:01:01,519 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:01,539 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:01,545 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:01:01,552 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:01:01,552 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:01,552 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:01,552 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:01,553 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:01,553 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:01,553 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:01:01,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:01,554 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:01:01,554 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:01,556 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:01:01,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:01:01,556 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:01,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:01:01,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:01,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:01,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:01,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:01:01,557 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:01:01,557 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:01:01,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:01:01,558 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:01:01,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:01:01,558 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:01:01,558 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:01:01,558 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:01:01,559 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:01:01,559 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:01:01,559 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:01:01,559 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:01,560 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:01:01,560 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:01,560 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:01,560 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:01,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:01:01,561 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:01:01,561 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:01:01,561 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:01:01,569 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:01:01,569 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:01,571 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:01,571 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:01,572 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:01,573 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:01,573 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:01,573 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:01,587 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5536, Threshold=0.5905, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:01:01,588 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5536
2025-08-04 21:01:24,926 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:24,927 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:24,927 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:24,927 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:01:24,927 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:01:24,927 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:25,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:25,256 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:25,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:01:25,367 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:01:25,367 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:25,492 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:25,499 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:25,499 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:25,504 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:01:25,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:25,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:01:25,527 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:25,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:25,527 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:01:25,537 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:25,540 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,542 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:25,544 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:25,547 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:25,550 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:25,552 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,555 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:25,558 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:25,560 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:25,562 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:25,573 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:25,574 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:01:25,579 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:01:25,579 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:01:25,587 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:25,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:01:25,604 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:25,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:01:25,605 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:25,623 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:25,630 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:01:25,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:01:25,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:25,636 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:25,637 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:25,637 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:25,637 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:25,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:01:25,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:25,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:01:25,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:25,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:01:25,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:01:25,640 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:25,640 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:01:25,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:25,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:25,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:25,641 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:01:25,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:01:25,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:01:25,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:01:25,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:01:25,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:01:25,642 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:01:25,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:01:25,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:01:25,643 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:01:25,643 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:01:25,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:01:25,644 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:25,644 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:01:25,644 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:25,645 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:25,645 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:25,645 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:01:25,646 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:01:25,646 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:01:25,646 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:01:25,654 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:01:25,654 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:25,655 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:25,655 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:25,657 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:25,657 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:25,657 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:25,658 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:25,672 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5257, Threshold=0.5580, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:01:25,672 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5257
2025-08-04 21:01:37,000 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:37,000 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:37,000 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:37,000 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:01:37,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:01:37,001 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:37,334 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:37,334 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:37,429 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:01:37,451 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:01:37,452 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:37,582 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:37,589 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:37,589 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:37,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:01:37,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:37,616 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:01:37,617 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:37,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:37,617 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:01:37,626 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:37,629 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,631 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:37,633 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:37,636 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:37,638 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:37,641 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,643 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:37,646 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:37,648 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:37,651 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:37,664 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:37,664 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:01:37,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:01:37,670 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:01:37,678 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:37,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:01:37,693 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:37,693 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:01:37,694 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:37,712 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:37,718 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:01:37,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:01:37,726 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:37,726 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:37,726 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:37,727 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:37,727 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:37,727 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:01:37,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:37,728 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:01:37,728 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:37,729 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:01:37,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:01:37,730 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:37,730 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:01:37,730 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:37,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:37,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:37,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:01:37,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:01:37,731 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:01:37,731 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:01:37,732 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:01:37,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:01:37,732 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:01:37,732 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:01:37,732 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:01:37,733 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:01:37,733 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:01:37,733 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:01:37,733 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:37,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:01:37,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:37,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:37,734 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:37,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:01:37,735 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:01:37,735 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:01:37,735 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:01:37,742 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:01:37,743 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:37,744 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:37,744 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:37,745 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:37,746 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:37,746 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:37,747 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:37,760 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5773, Threshold=0.6383, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:01:37,760 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5773
2025-08-04 21:01:43,010 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:43,010 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:43,010 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:43,010 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:01:43,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:01:43,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:43,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:43,290 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:43,375 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:01:43,395 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:01:43,396 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:43,507 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:43,513 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:43,513 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:43,517 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:01:43,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:43,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:01:43,538 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:43,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:43,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:01:43,547 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:43,550 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:43,552 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:43,555 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:43,558 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:43,560 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:43,563 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:43,565 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:43,568 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:43,570 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:43,572 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:43,582 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:43,582 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:01:43,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:01:43,587 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:01:43,593 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:43,593 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:01:43,605 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:43,606 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:01:43,606 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:43,621 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:43,626 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:01:43,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:01:43,632 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:43,632 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:43,632 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:43,632 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:43,632 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:43,633 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:01:43,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:43,633 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:01:43,633 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:43,634 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:01:43,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:01:43,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:43,635 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:01:43,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:43,635 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:01:43,636 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:01:43,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:01:43,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:01:43,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:01:43,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:01:43,637 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:01:43,637 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:01:43,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:43,638 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:01:43,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:43,638 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:43,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:43,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:01:43,639 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:01:43,639 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:01:43,639 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:01:43,646 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:01:43,646 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:43,648 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:43,648 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:43,649 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 163/400.
2025-08-04 21:01:43,751 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:43,751 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:43,753 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 21:01:43,753 - ClientAppLogger [Client 8] - INFO - [Client] Round 163: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 21:01:43,753 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:43,780 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0809, Avg D Loss: 0.7626
2025-08-04 21:01:43,781 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0809, Avg D Loss: 0.7626
2025-08-04 21:01:43,781 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:43,792 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4634, Threshold=0.4718, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:01:43,792 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 21:01:43,792 - ClientAppLogger [Client 8] - INFO - Fit completed for round 163. Duration: 0.14s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 163, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.080902576446533, 'd_loss': 0.7625716745853424, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.14310932159423828, 'cpu_percent_fit': 28.38125, 'ram_mb_fit': 8.83984375, 'accumulated_train_samples_this_round': 28}
2025-08-04 21:01:43,793 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 21:01:49,094 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:49,094 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:49,095 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:49,095 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:01:49,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:01:49,095 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:49,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:49,414 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:49,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:01:49,526 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:01:49,527 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:49,649 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:49,656 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:49,656 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:49,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:01:49,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:49,687 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:01:49,688 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:49,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:49,688 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:01:49,697 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:49,701 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:49,703 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:49,705 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:49,708 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:49,710 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:49,712 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:49,715 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:49,718 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:49,720 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:49,722 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:49,734 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:49,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:01:49,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:01:49,739 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:01:49,747 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:49,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:01:49,763 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:49,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:01:49,763 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:49,782 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:49,787 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:01:49,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:01:49,794 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:49,794 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:49,794 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:49,795 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:49,795 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:49,795 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:01:49,795 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:49,795 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:01:49,796 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:49,797 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:01:49,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:01:49,798 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:01:49,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:01:49,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:01:49,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:01:49,799 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:01:49,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:01:49,800 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:01:49,800 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:01:49,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:01:49,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:01:49,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:49,801 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:01:49,801 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:49,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:49,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:49,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:01:49,803 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:01:49,803 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:01:49,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:01:49,812 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:01:49,812 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:49,813 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:49,814 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:49,815 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:49,815 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:49,816 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:49,816 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:49,828 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5110, Threshold=0.5282, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:01:49,828 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5110
2025-08-04 21:02:10,166 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:10,167 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:10,167 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:10,167 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:02:10,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:02:10,167 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:10,531 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:10,531 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:10,628 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:02:10,654 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:02:10,654 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:10,785 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:10,793 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:10,793 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:10,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:02:10,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:10,835 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:02:10,836 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:10,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:10,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:02:10,846 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:10,857 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,861 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:10,863 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:10,866 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:10,869 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:10,871 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,874 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:10,877 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:10,879 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:10,881 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:10,898 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:10,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:02:10,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:02:10,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:02:10,912 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:10,912 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:02:10,933 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:10,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:02:10,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:10,952 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:10,958 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:02:10,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:02:10,967 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:10,967 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:10,967 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:10,968 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:10,968 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:10,968 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:02:10,969 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:10,969 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:02:10,969 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:10,970 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:02:10,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:02:10,971 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:10,971 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:02:10,971 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:10,972 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:10,972 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:10,972 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:02:10,972 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:02:10,973 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:02:10,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:02:10,973 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:02:10,973 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:02:10,973 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:02:10,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:02:10,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:02:10,974 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:02:10,974 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:02:10,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:02:10,975 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:10,975 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:02:10,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:10,979 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:10,980 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:10,980 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:02:10,981 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:02:10,981 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:02:10,981 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:02:10,990 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:02:10,990 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:10,992 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:10,992 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:10,995 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:10,995 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:10,995 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:10,996 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:11,010 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5517, Threshold=0.5909, Accuracy=0.7196, F1=0.8068, Precision=0.9752, Recall=0.6880
2025-08-04 21:02:11,010 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7196, F1: 0.8068, Prec: 0.9752, Rec: 0.6880, Avg Anomaly Score: 0.5517
2025-08-04 21:02:31,365 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:31,365 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:31,365 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:31,365 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:02:31,365 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:02:31,365 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:31,743 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:31,747 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:31,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:02:31,863 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:02:31,863 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:31,994 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:32,003 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:32,003 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:32,010 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:02:32,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:32,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:02:32,040 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:32,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:32,040 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:02:32,050 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:32,053 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,055 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:32,058 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:32,061 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:32,063 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:32,066 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,069 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:32,073 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:32,075 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:32,078 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:32,092 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:32,092 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:02:32,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:02:32,098 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:02:32,106 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:32,106 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:02:32,125 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:32,125 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:02:32,126 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:32,143 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:32,148 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:02:32,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:02:32,155 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:32,155 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:32,155 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:32,156 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:32,156 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:32,156 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:02:32,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:32,157 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:02:32,157 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:32,158 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:02:32,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:02:32,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:32,159 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:02:32,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:32,159 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:02:32,160 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:02:32,161 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:02:32,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:02:32,161 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:02:32,161 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:02:32,162 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:02:32,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:02:32,162 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:32,162 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:02:32,162 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:32,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:32,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:32,163 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:02:32,163 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:02:32,163 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:02:32,164 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:02:32,171 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:02:32,172 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:32,173 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:32,173 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:32,175 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:32,175 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:32,175 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:32,176 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:32,192 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5638, Threshold=0.6045, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:02:32,192 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5638
2025-08-04 21:02:52,529 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:52,529 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:52,529 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:52,529 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:02:52,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:02:52,530 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:53,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:53,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:53,111 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:02:53,136 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:02:53,137 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:53,286 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:53,297 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:53,297 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:53,304 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:02:53,341 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:53,342 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:02:53,343 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:53,343 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:53,344 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:02:53,353 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:53,358 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,361 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:53,364 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:53,367 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:53,370 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:53,373 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,376 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:53,379 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:53,381 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:53,385 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:53,404 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:53,404 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:02:53,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:02:53,412 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:02:53,423 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,423 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:02:53,443 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:02:53,444 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:53,465 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:53,472 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:02:53,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:02:53,484 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:53,484 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:53,484 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:53,485 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:53,485 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:53,486 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:02:53,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:53,486 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:02:53,486 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:53,488 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:02:53,488 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:02:53,490 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:53,490 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:02:53,490 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:53,491 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:53,491 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:53,492 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:02:53,492 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:02:53,493 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:02:53,493 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:02:53,493 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:02:53,494 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:02:53,494 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:02:53,494 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:02:53,495 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:02:53,495 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:02:53,496 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:02:53,496 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:02:53,496 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:53,496 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:02:53,500 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:53,500 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:53,501 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:53,505 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:02:53,505 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:02:53,505 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:02:53,506 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:02:53,516 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:02:53,517 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:53,519 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:53,520 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:53,524 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:53,525 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:53,525 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:53,526 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:53,556 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5143, Threshold=0.5372, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:02:53,556 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5143
2025-08-04 21:03:13,873 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:13,873 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:13,873 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:13,873 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:03:13,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:03:13,874 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:14,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:14,214 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:14,306 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:03:14,333 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:03:14,333 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:14,526 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:14,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:14,539 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:14,552 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:03:14,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:14,610 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:03:14,614 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:14,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:14,615 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:03:14,631 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:14,638 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:14,641 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:14,645 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:14,648 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:14,651 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:14,654 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:14,658 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:14,663 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:14,666 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:14,670 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:14,709 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:14,712 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:03:14,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:03:14,720 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:03:14,733 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:14,733 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:03:14,767 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:14,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:03:14,770 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:14,812 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:14,822 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:03:14,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:03:14,842 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:14,842 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:14,842 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:14,843 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:14,843 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:14,843 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:03:14,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:14,844 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:03:14,844 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:14,846 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:03:14,846 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:03:14,847 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:14,848 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:03:14,850 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:14,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:14,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:14,854 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:03:14,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:03:14,855 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:03:14,855 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:03:14,856 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:03:14,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:03:14,856 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:03:14,856 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:03:14,857 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:03:14,857 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:03:14,858 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:03:14,858 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:03:14,858 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:14,862 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:03:14,893 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:14,896 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:14,897 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:14,898 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:03:14,902 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:03:14,902 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:03:14,903 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:03:14,913 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:03:14,914 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:14,924 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:14,927 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:14,934 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:14,934 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:14,934 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:14,936 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:14,985 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5662, Threshold=0.6034, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:03:14,986 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5662
2025-08-04 21:03:32,300 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:32,300 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:32,300 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:32,300 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:03:32,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:03:32,301 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:32,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:32,556 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:32,642 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:03:32,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:03:32,663 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:32,791 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:32,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:32,799 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:32,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:03:32,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:32,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:03:32,887 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:32,887 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:32,888 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:03:32,898 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:32,901 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:32,904 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:32,907 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:32,912 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:32,915 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:32,918 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:32,921 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:32,925 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:32,930 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:32,933 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:32,949 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:32,949 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:03:32,955 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:03:32,956 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:03:32,965 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:32,966 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:03:32,987 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:32,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:03:32,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:33,019 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:33,025 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:03:33,038 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:03:33,039 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:33,039 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:33,039 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:33,040 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:33,040 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:33,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:03:33,041 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:33,041 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:03:33,042 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:33,043 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:03:33,044 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:03:33,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:33,045 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:03:33,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:33,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:33,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:33,045 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:03:33,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:03:33,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:03:33,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:03:33,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:03:33,046 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:03:33,046 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:03:33,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:03:33,047 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:03:33,047 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:03:33,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:03:33,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:03:33,048 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:33,048 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:03:33,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:33,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:33,056 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:33,057 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:03:33,058 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:03:33,059 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:03:33,059 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:03:33,067 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:03:33,068 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:33,075 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:33,077 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:33,081 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:33,081 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:33,081 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:33,083 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:33,115 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5512, Threshold=0.5843, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:03:33,116 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5512
2025-08-04 21:03:38,383 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:38,383 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:38,384 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:38,384 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:03:38,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:03:38,384 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:38,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:38,678 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:38,764 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:03:38,781 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:03:38,781 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:38,867 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:38,873 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:38,873 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:38,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:03:38,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:38,891 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:03:38,892 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:38,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:38,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:03:38,900 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:38,903 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:38,905 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:38,907 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:38,910 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:38,912 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:38,915 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:38,917 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:38,920 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:38,922 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:38,924 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:38,934 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:38,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:03:38,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:03:38,939 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:03:38,945 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:38,946 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:03:38,958 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:38,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:03:38,959 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:38,975 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:38,979 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:03:38,984 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:03:38,984 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:38,984 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:38,984 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:38,985 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:38,985 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:38,985 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:03:38,985 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:38,986 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:03:38,986 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:38,987 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:03:38,987 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:03:38,988 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:03:38,989 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:03:38,990 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:03:38,990 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:03:38,990 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:38,990 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:03:38,991 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:03:38,994 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:03:38,995 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:38,996 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:38,996 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:38,997 - ClientAppLogger [Client 8] - INFO - [Client] Fit started for round 169/400.
2025-08-04 21:03:39,098 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:39,098 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:39,114 - ClientAppLogger [Client 8] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 21:03:39,115 - ClientAppLogger [Client 8] - INFO - [Client] Round 169: Training GAN with 31 samples (24 normal, 7 anomalous).
2025-08-04 21:03:39,115 - ClientAppLogger [Client 8] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:39,150 - ClientAppLogger [Client 8] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0763, Avg D Loss: 0.7829
2025-08-04 21:03:39,150 - ClientAppLogger [Client 8] - INFO - GAN Training completed. Avg G Loss: 2.0763, Avg D Loss: 0.7829
2025-08-04 21:03:39,150 - ClientAppLogger [Client 8] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:39,162 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.4701, Threshold=0.4758, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:03:39,163 - ClientAppLogger [Client 8] - INFO - [Client] Post-fit local evaluation F1: 0.8103
2025-08-04 21:03:39,163 - ClientAppLogger [Client 8] - INFO - Fit completed for round 169. Duration: 0.17s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '8', 'server_round': 169, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0763227939605713, 'd_loss': 0.7829400181770325, 'post_fit_local_f1': 0.8102564102564103, 'fit_time_seconds': 0.16533899307250977, 'cpu_percent_fit': 21.21875, 'ram_mb_fit': 9.3671875, 'accumulated_train_samples_this_round': 31}
2025-08-04 21:03:39,163 - ClientAppLogger [Client 8] - INFO - [Client] get_parameters called
2025-08-04 21:03:44,424 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:44,424 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:44,424 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:44,424 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:03:44,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:03:44,425 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:44,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:44,666 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:44,748 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:03:44,768 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:03:44,768 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:44,870 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:44,877 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:44,877 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:44,883 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:03:44,908 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:44,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:03:44,909 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:44,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:44,909 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:03:44,919 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:44,922 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:44,924 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:44,926 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:44,929 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:44,931 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:44,933 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:44,936 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:44,938 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:44,940 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:44,942 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:44,952 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:44,952 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:03:44,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:03:44,957 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:03:44,963 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:44,964 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:03:44,978 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:44,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:03:44,978 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:44,996 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:45,002 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:03:45,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:03:45,011 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:45,011 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:45,011 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:45,012 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:45,012 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:45,012 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:03:45,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:45,013 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:03:45,013 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:45,014 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:03:45,015 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:03:45,015 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:45,015 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:03:45,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:45,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:45,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:45,016 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:03:45,016 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:03:45,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:03:45,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:03:45,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:03:45,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:03:45,017 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:03:45,017 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:03:45,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:03:45,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:03:45,018 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:03:45,018 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:03:45,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:45,019 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:03:45,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:45,019 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:45,020 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:45,020 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:03:45,021 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:03:45,021 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:03:45,021 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:03:45,026 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:03:45,027 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:45,028 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:45,028 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:45,030 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:45,030 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:45,030 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:45,031 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:45,044 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5044, Threshold=0.5076, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:03:45,044 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5044
2025-08-04 21:03:59,313 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:59,321 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:59,321 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:59,321 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:03:59,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:03:59,321 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:59,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:59,598 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:59,683 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:03:59,703 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:03:59,704 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:59,793 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:59,799 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:59,799 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:59,804 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:03:59,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:59,836 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:03:59,837 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:59,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:59,837 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:03:59,847 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:59,851 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:59,853 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:59,855 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:59,858 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:59,860 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:59,862 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:59,865 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:59,867 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:59,870 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:59,872 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:59,881 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:59,881 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:03:59,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:03:59,886 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:03:59,892 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:59,892 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:03:59,905 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:59,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:03:59,905 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:59,921 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:59,926 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:03:59,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:03:59,930 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:59,930 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:59,931 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:59,931 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:59,931 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:59,932 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:03:59,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:59,932 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:03:59,932 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:59,934 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:59,935 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:03:59,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:03:59,935 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:03:59,935 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:03:59,935 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:03:59,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:03:59,936 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:03:59,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:03:59,936 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:03:59,936 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:03:59,936 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:03:59,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:03:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:59,937 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:03:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:59,937 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:59,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:59,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:03:59,938 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:03:59,938 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:03:59,938 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:03:59,941 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:03:59,941 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:59,942 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:59,943 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:59,944 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:59,944 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:59,945 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:59,945 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:59,956 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5745, Threshold=0.6275, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:03:59,956 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5745
2025-08-04 21:04:22,531 - ClientAppLogger [Client 8] - INFO - ClientApp starting for partition_id: 8. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:22,532 - ClientAppLogger [Client 8] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:04:22,537 - ClientAppLogger [Client 8] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:04:22,537 - ClientAppLogger [Client 8] - INFO - Loading data for partition 8/10...
2025-08-04 21:04:22,537 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting load_data function.
2025-08-04 21:04:22,538 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:25,363 - ClientAppLogger [Client 8] - INFO - [LoadData 8] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:25,364 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:25,500 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Numeric conversion completed.
2025-08-04 21:04:25,529 - ClientAppLogger [Client 8] - INFO - [LoadData 8] NA values filled.
2025-08-04 21:04:25,529 - ClientAppLogger [Client 8] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:25,644 - ClientAppLogger [Client 8] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,653 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,653 - ClientAppLogger [Client 8] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,662 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Scaler fitting process completed.
2025-08-04 21:04:25,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,674 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,675 - ClientAppLogger [Client 8] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,675 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting anomaly reduction logic.
2025-08-04 21:04:25,685 - ClientAppLogger [Client 8] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,690 - ClientAppLogger [Client 8] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,693 - ClientAppLogger [Client 8] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,697 - ClientAppLogger [Client 8] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,701 - ClientAppLogger [Client 8] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,703 - ClientAppLogger [Client 8] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,705 - ClientAppLogger [Client 8] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,708 - ClientAppLogger [Client 8] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,711 - ClientAppLogger [Client 8] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,713 - ClientAppLogger [Client 8] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,716 - ClientAppLogger [Client 8] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,729 - ClientAppLogger [Client 8] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,729 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Anomaly reduction logic completed.
2025-08-04 21:04:25,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,734 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating unlabeled training base.
2025-08-04 21:04:25,743 - ClientAppLogger [Client 8] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,743 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating labeled pool.
2025-08-04 21:04:25,765 - ClientAppLogger [Client 8] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Labeled pool creation completed.
2025-08-04 21:04:25,765 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,783 - ClientAppLogger [Client 8] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,789 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Combining data for final AE training set.
2025-08-04 21:04:25,796 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Final AE training data combination completed.
2025-08-04 21:04:25,797 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,797 - ClientAppLogger [Client 8] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,799 - ClientAppLogger [Client 8] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,799 - ClientAppLogger [Client 8] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,801 - ClientAppLogger [Client 8] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] START of partitioning block.
2025-08-04 21:04:25,802 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,802 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 1: Full indices created.
2025-08-04 21:04:25,803 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,804 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 2: Full indices shuffled.
2025-08-04 21:04:25,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,806 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,806 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,807 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,808 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 6: Start indices calculated. train_start=54213
2025-08-04 21:04:25,808 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Start indices calculated. Train_start=54213, Val_start=7140, Test_start=5419
2025-08-04 21:04:25,809 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 7: End indices calculated. train_end=54318
2025-08-04 21:04:25,809 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: End indices calculated. Train_end=54318, Val_end=7543, Test_end=8016
2025-08-04 21:04:25,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 8: Partition-specific indices extracted. Num train indices: 105
2025-08-04 21:04:25,810 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Specific indices extracted. Train idx: 105, Val idx: 403, Test idx: 2597
2025-08-04 21:04:25,810 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9a: Train data sliced for partition. X_train_part_full shape: (105, 17)
2025-08-04 21:04:25,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Train data sliced. Shape: (105, 17)
2025-08-04 21:04:25,811 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9b: Validation data sliced for partition. X_val_part shape: (403, 17)
2025-08-04 21:04:25,811 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Validation data sliced. Shape: (403, 17)
2025-08-04 21:04:25,812 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 9c: Test data sliced for partition. X_test_part shape: (2597, 17)
2025-08-04 21:04:25,812 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Partitioning: Test data sliced. Shape: (2597, 17)
2025-08-04 21:04:25,813 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,813 - ClientAppLogger [Client 8] - INFO - [LoadData 8] Creating TonIoTDataset objects.
2025-08-04 21:04:25,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,814 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,814 - ClientAppLogger [Client 8] - INFO - [LoadData 8] TonIoTDataset objects created.
2025-08-04 21:04:25,815 - ClientAppLogger [Client 8] - INFO - Partition 8 (Static Datasets): Train Potential 105, Val 403, Test 2597
2025-08-04 21:04:25,815 - ClientAppLogger [Client 8] - INFO - [Partitioning Debug 8] END of partitioning block, returning datasets.
2025-08-04 21:04:25,815 - ClientAppLogger [Client 8] - INFO - [LoadData 8] load_data function completed.
2025-08-04 21:04:25,819 - ClientAppLogger [Client 8] - INFO - Data loaded for partition 8: Train samples: 105, Val samples: 403
2025-08-04 21:04:25,819 - ClientAppLogger [Client 8] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,821 - ClientAppLogger [Client 8] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,822 - ClientAppLogger [Client 8] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:04:25,823 - ClientAppLogger [Client 8] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,824 - ClientAppLogger [Client 8] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,824 - ClientAppLogger [Client 8] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,825 - ClientAppLogger [Client 8] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,839 - ClientAppLogger [Client 8] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=403, Avg Anomaly Score (all samples)=0.5749, Threshold=0.6367, Accuracy=0.7246, F1=0.8103, Precision=0.9793, Recall=0.6910
2025-08-04 21:04:25,840 - ClientAppLogger [Client 8] - INFO - [Client] Evaluation finished. Samples: 403, Acc: 0.7246, F1: 0.8103, Prec: 0.9793, Rec: 0.6910, Avg Anomaly Score: 0.5749
