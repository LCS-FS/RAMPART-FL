2025-08-04 21:00:17,480 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:17,480 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:00:17,480 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:00:17,480 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:00:17,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:00:17,481 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:17,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:17,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:17,897 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:00:17,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:00:17,924 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:18,039 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:18,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:18,048 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:18,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:00:18,063 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:18,063 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:00:18,064 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:18,064 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:18,064 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:00:18,074 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:18,077 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:18,080 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:18,082 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:18,085 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:18,087 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:18,090 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:18,092 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:18,096 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:18,098 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:18,102 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:18,113 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:18,114 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:00:18,118 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:00:18,119 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:00:18,123 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:18,124 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:00:18,134 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:18,134 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:00:18,134 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:18,150 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:18,154 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:00:18,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:00:18,160 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:18,160 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:18,160 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:18,161 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:18,161 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:18,161 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:00:18,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:18,162 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:00:18,162 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:18,163 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:00:18,163 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:00:18,164 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:18,164 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:00:18,164 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:18,164 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:18,164 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:18,165 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:00:18,165 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:00:18,165 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:00:18,165 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:00:18,165 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:00:18,165 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:00:18,166 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:00:18,166 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:00:18,166 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:00:18,166 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:00:18,166 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:00:18,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:00:18,167 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:18,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:00:18,167 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:18,167 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:18,168 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:18,168 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:00:18,168 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:00:18,168 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:00:18,168 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:00:18,174 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:00:18,174 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:18,176 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:18,176 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:00:18,177 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:18,178 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:18,178 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:18,178 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:18,228 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5391, Threshold=0.5859, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 21:00:18,228 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5391
2025-08-04 21:00:41,530 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:41,530 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:00:41,530 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:00:41,530 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:00:41,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:00:41,530 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:41,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:41,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:41,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:00:41,971 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:00:41,971 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:42,093 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:42,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:42,100 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:42,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:00:42,112 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:42,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:00:42,113 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:42,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:42,113 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:00:42,122 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:42,125 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:42,127 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:42,129 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:42,131 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:42,133 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:42,136 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:42,138 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:42,141 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:42,143 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:42,145 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:42,156 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:42,156 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:00:42,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:00:42,161 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:00:42,167 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:42,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:00:42,181 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:42,181 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:00:42,181 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:42,199 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:42,204 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:00:42,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:00:42,214 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:42,214 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:42,214 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:42,215 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:42,215 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:42,215 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:00:42,215 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:42,216 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:00:42,216 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:42,217 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:00:42,217 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:00:42,218 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:00:42,219 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:00:42,219 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:00:42,219 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:00:42,219 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:00:42,219 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:00:42,219 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:00:42,220 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:00:42,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:00:42,220 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:00:42,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:00:42,220 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:42,220 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:00:42,221 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:42,221 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:42,221 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:42,221 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:00:42,221 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:00:42,222 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:00:42,222 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:00:42,229 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:00:42,229 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:42,230 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:42,230 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:00:42,232 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:42,232 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:42,232 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:42,233 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:42,283 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5242, Threshold=0.5637, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:00:42,283 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5242
2025-08-04 21:01:02,584 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:02,584 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:01:02,584 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:01:02,584 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:01:02,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:01:02,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:02,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:02,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:03,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:01:03,111 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:01:03,111 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:03,227 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:03,233 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:03,234 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:03,240 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:01:03,264 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:03,264 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:01:03,265 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:03,265 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:03,265 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:01:03,274 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:03,278 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:03,280 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:03,283 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:03,286 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:03,288 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:03,290 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:03,294 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:03,297 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:03,299 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:03,301 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:03,312 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:03,312 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:01:03,317 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:01:03,317 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:01:03,322 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:03,322 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:01:03,334 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:03,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:01:03,334 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:03,352 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:03,358 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:01:03,365 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:01:03,366 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:03,366 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:03,366 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:03,366 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:03,367 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:03,367 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:01:03,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:03,367 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:01:03,367 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:03,369 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:01:03,369 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:01:03,370 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:03,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:01:03,370 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:03,370 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:03,370 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:03,370 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:01:03,371 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:01:03,372 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:01:03,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:01:03,372 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:01:03,372 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:01:03,373 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:03,373 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:01:03,373 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:03,373 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:03,373 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:03,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:01:03,374 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:01:03,374 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:01:03,374 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:01:03,381 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:01:03,381 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:03,383 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:03,383 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:01:03,384 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:03,385 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:03,385 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:03,386 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:03,437 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5424, Threshold=0.5873, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:01:03,438 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5424
2025-08-04 21:01:11,717 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:11,718 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:01:11,718 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:01:11,718 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:01:11,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:01:11,718 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:12,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:12,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:12,192 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:01:12,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:01:12,236 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:12,381 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:12,387 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:12,387 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:12,395 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:01:12,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:12,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:01:12,402 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:12,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:12,402 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:01:12,411 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:12,414 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:12,416 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:12,418 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:12,421 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:12,423 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:12,426 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:12,429 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:12,432 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:12,434 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:12,437 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:12,447 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:12,447 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:01:12,452 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:01:12,452 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:01:12,457 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:12,458 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:01:12,467 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:12,467 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:01:12,467 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:12,482 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:12,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:01:12,491 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:01:12,492 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:12,492 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:12,492 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:12,492 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:12,493 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:12,493 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:01:12,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:12,493 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:01:12,493 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:12,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:01:12,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:01:12,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:12,495 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:01:12,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:12,495 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:01:12,496 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:01:12,497 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:01:12,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:01:12,497 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:01:12,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:01:12,497 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:01:12,497 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:01:12,498 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:12,498 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:01:12,498 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:12,498 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:12,499 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:12,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:01:12,499 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:01:12,499 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:01:12,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:01:12,504 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:01:12,505 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:12,506 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:12,506 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:01:12,507 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 161/400.
2025-08-04 21:01:12,608 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:12,609 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:12,610 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 71 anomalous samples to GAN training data (target: 71).
2025-08-04 21:01:12,610 - ClientAppLogger [Client 4] - INFO - [Client] Round 161: Training GAN with 309 samples (238 normal, 71 anomalous).
2025-08-04 21:01:12,611 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:12,849 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0828, Avg D Loss: 0.7634
2025-08-04 21:01:12,849 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0828, Avg D Loss: 0.7634
2025-08-04 21:01:12,849 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:12,895 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5767, Threshold=0.6536, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:01:12,895 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8129
2025-08-04 21:01:12,896 - ClientAppLogger [Client 4] - INFO - Fit completed for round 161. Duration: 0.39s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 161, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0828370328088406, 'd_loss': 0.7633691459990627, 'post_fit_local_f1': 0.81291504465308, 'fit_time_seconds': 0.38828253746032715, 'cpu_percent_fit': 18.7, 'ram_mb_fit': 8.6796875, 'accumulated_train_samples_this_round': 309}
2025-08-04 21:01:12,896 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 21:01:24,176 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:24,176 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:01:24,176 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:01:24,176 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:01:24,176 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:01:24,177 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:24,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:24,521 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:24,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:01:24,642 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:01:24,642 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:24,783 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:24,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:24,790 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:24,796 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:01:24,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:24,822 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:01:24,823 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:24,823 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:24,823 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:01:24,833 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:24,837 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:24,840 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:24,842 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:24,845 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:24,848 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:24,850 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:24,853 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:24,856 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:24,858 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:24,860 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:24,870 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:24,870 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:01:24,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:01:24,875 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:01:24,880 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:24,880 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:01:24,893 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:24,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:01:24,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:24,910 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:24,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:01:24,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:01:24,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:24,920 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:24,921 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:24,921 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:24,921 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:24,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:01:24,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:24,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:01:24,922 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:24,924 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:01:24,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:01:24,924 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:24,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:01:24,925 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:24,925 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:24,925 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:24,925 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:01:24,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:01:24,926 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:01:24,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:01:24,926 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:01:24,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:01:24,926 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:01:24,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:01:24,927 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:01:24,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:01:24,927 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:01:24,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:01:24,927 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:24,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:01:24,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:24,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:24,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:24,928 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:01:24,928 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:01:24,929 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:01:24,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:01:24,937 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:01:24,937 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:24,938 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:24,939 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:01:24,940 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:24,940 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:24,940 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:24,941 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:24,986 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5140, Threshold=0.5512, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:01:24,986 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5140
2025-08-04 21:01:36,262 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:36,262 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:01:36,262 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:01:36,262 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:01:36,262 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:01:36,262 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:36,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:36,677 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:36,777 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:01:36,820 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:01:36,820 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:36,948 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:36,954 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:36,955 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:36,961 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:01:36,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:36,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:01:36,969 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:36,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:36,969 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:01:36,980 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:36,983 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:36,985 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:36,988 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:36,991 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:36,993 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:36,996 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,000 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:37,004 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:37,006 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:37,009 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:37,022 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:37,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:01:37,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:01:37,028 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:01:37,036 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:37,036 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:01:37,048 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:37,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:01:37,048 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:37,065 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:37,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:01:37,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:01:37,076 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:37,076 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:37,076 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:37,077 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:37,077 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:37,077 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:01:37,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:37,078 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:01:37,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:37,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:01:37,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:01:37,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:37,080 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:01:37,080 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:37,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:37,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:37,081 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:01:37,081 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:01:37,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:01:37,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:01:37,082 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:01:37,082 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:01:37,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:01:37,083 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:01:37,083 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:01:37,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:01:37,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:01:37,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:01:37,084 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:37,084 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:01:37,085 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:37,086 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:37,086 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:37,086 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:01:37,086 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:01:37,087 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:01:37,087 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:01:37,093 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:01:37,093 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:37,094 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:37,094 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:01:37,096 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:37,097 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:37,097 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:37,098 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:37,143 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5636, Threshold=0.6328, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:01:37,143 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5636
2025-08-04 21:01:48,426 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:48,426 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:01:48,426 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:01:48,426 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:01:48,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:01:48,427 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:48,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:48,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:48,895 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:01:48,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:01:48,925 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:49,059 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:49,066 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:49,066 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:49,072 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:01:49,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:49,078 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:01:49,079 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:49,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:49,079 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:01:49,088 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:49,091 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:49,093 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:49,096 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:49,099 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:49,101 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:49,104 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:49,107 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:49,110 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:49,112 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:49,114 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:49,125 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:49,125 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:01:49,130 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:01:49,131 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:01:49,136 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:49,136 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:01:49,147 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:49,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:01:49,147 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:49,162 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:49,167 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:01:49,178 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:01:49,178 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:49,179 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:49,179 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:49,179 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:49,179 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:49,180 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:01:49,180 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:49,180 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:01:49,180 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:49,182 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:01:49,182 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:01:49,182 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:49,183 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:01:49,183 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:49,183 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:49,183 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:49,183 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:01:49,183 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:01:49,184 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:01:49,184 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:01:49,185 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:01:49,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:01:49,185 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:01:49,185 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:01:49,186 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:01:49,186 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:01:49,186 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:01:49,186 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:01:49,187 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:49,187 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:01:49,187 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:49,188 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:49,188 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:49,188 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:01:49,188 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:01:49,188 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:01:49,189 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:01:49,195 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:01:49,197 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:49,198 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:49,199 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:01:49,200 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:49,200 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:49,200 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:49,201 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:49,245 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5000, Threshold=0.5258, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:01:49,245 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5000
2025-08-04 21:02:09,527 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:09,528 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:02:09,528 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:02:09,528 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:02:09,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:02:09,528 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:09,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:09,931 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:10,033 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:02:10,075 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:02:10,075 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:10,214 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:10,235 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:10,235 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:10,247 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:02:10,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:10,258 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:02:10,259 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:10,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:10,259 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:02:10,268 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:10,272 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,276 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:10,278 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:10,282 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:10,286 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:10,289 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,293 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:10,295 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:10,297 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:10,300 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:10,313 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:10,313 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:02:10,318 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:02:10,318 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:02:10,325 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:10,325 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:02:10,339 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:10,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:02:10,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:10,363 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:10,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:02:10,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:02:10,381 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:10,382 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:10,382 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:10,383 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:10,383 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:10,383 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:02:10,383 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:10,384 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:02:10,384 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:10,385 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:02:10,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:02:10,386 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:10,386 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:02:10,387 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:10,387 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:10,387 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:10,388 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:02:10,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:02:10,388 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:02:10,388 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:02:10,388 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:02:10,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:02:10,389 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:02:10,389 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:02:10,390 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:02:10,390 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:02:10,390 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:02:10,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:02:10,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:10,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:02:10,391 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:10,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:10,392 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:10,392 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:02:10,392 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:02:10,393 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:02:10,393 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:02:10,401 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:02:10,401 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:10,403 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:10,403 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:02:10,404 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:10,405 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:10,405 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:10,406 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:10,453 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5408, Threshold=0.5867, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:02:10,454 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5408
2025-08-04 21:02:30,740 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:30,740 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:02:30,741 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:02:30,741 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:02:30,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:02:30,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:31,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:31,138 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:31,232 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:02:31,261 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:02:31,261 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:31,421 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:31,428 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:31,429 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:31,440 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:02:31,478 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:31,478 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:02:31,479 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:31,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:31,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:02:31,491 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:31,495 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:31,497 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:31,500 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:31,502 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:31,505 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:31,507 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:31,510 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:31,513 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:31,515 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:31,518 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:31,531 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:31,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:02:31,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:02:31,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:02:31,551 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:31,552 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:02:31,569 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:31,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:02:31,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:31,588 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:31,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:02:31,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:02:31,608 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:31,609 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:31,609 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:31,610 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:31,610 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:31,610 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:02:31,610 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:31,611 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:02:31,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:31,612 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:02:31,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:02:31,613 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:31,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:02:31,613 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:02:31,614 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:02:31,615 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:02:31,615 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:02:31,616 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:02:31,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:02:31,617 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:02:31,617 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:02:31,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:31,618 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:02:31,618 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:31,620 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:31,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:31,621 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:02:31,621 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:02:31,621 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:02:31,622 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:02:31,634 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:02:31,634 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:31,636 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:31,637 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:02:31,639 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:31,641 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:31,641 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:31,642 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:31,698 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5527, Threshold=0.6008, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:02:31,747 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7293, F1: 0.8129, Prec: 0.9801, Rec: 0.6944, Avg Anomaly Score: 0.5527
2025-08-04 21:02:52,049 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:52,049 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:02:52,050 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:02:52,050 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:02:52,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:02:52,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:52,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:52,479 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:52,585 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:02:52,638 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:02:52,638 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:52,890 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:52,901 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:52,902 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:52,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:02:52,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:52,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:02:52,928 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:52,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:52,929 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:02:52,942 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:52,948 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:52,951 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:52,954 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:52,957 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:52,961 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:52,964 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:52,968 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:52,971 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:52,974 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:52,978 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:52,990 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:52,991 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:02:52,997 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:02:52,997 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:02:53,005 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,006 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:02:53,021 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:02:53,022 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:53,040 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:53,046 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:02:53,052 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:02:53,053 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:53,053 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:53,053 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:53,053 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:53,054 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:53,054 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:02:53,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:53,054 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:02:53,054 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:53,056 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:02:53,056 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:02:53,057 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:53,057 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:02:53,057 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:53,057 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:53,057 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:53,057 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:02:53,058 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:02:53,058 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:02:53,058 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:02:53,058 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:02:53,058 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:02:53,059 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:02:53,059 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:02:53,059 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:02:53,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:02:53,060 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:02:53,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:02:53,060 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:53,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:02:53,061 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:53,061 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:53,061 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:53,062 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:02:53,062 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:02:53,062 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:02:53,062 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:02:53,070 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:02:53,070 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:53,071 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:53,072 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:02:53,074 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:53,074 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:53,074 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:53,075 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:53,127 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5040, Threshold=0.5338, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:02:53,128 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5040
2025-08-04 21:02:58,400 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:58,401 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:02:58,401 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:02:58,401 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:02:58,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:02:58,401 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:58,723 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:58,723 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:58,806 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:02:58,833 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:02:58,834 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:58,970 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:58,979 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:58,979 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:58,985 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:02:58,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:58,992 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:02:58,993 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:58,993 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:58,993 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:02:59,003 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:59,006 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:59,008 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:59,010 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:59,013 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:59,016 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:59,018 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:59,021 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:59,024 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:59,026 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:59,028 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:59,039 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:59,039 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:02:59,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:02:59,044 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:02:59,050 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:59,050 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:02:59,059 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:59,059 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:02:59,060 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:59,077 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:59,083 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:02:59,098 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:02:59,098 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:59,098 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:59,098 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:59,099 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:59,099 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:59,099 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:02:59,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:59,100 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:02:59,100 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:59,101 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:02:59,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:02:59,102 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:59,102 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:02:59,102 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:59,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:59,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:59,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:02:59,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:02:59,103 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:02:59,103 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:02:59,104 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:02:59,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:02:59,104 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:02:59,104 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:02:59,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:02:59,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:02:59,105 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:02:59,105 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:02:59,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:59,106 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:02:59,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:59,106 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:59,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:59,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:02:59,107 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:02:59,107 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:02:59,107 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:02:59,114 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:02:59,114 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:59,116 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:59,116 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:02:59,118 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 167/400.
2025-08-04 21:02:59,218 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:59,219 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:59,220 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 75 anomalous samples to GAN training data (target: 75).
2025-08-04 21:02:59,221 - ClientAppLogger [Client 4] - INFO - [Client] Round 167: Training GAN with 325 samples (250 normal, 75 anomalous).
2025-08-04 21:02:59,221 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:59,511 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7734
2025-08-04 21:02:59,512 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7734
2025-08-04 21:02:59,512 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:59,559 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5646, Threshold=0.6277, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:02:59,559 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8129
2025-08-04 21:02:59,559 - ClientAppLogger [Client 4] - INFO - Fit completed for round 167. Duration: 0.44s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 167, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084088175553542, 'd_loss': 0.7733900427084703, 'post_fit_local_f1': 0.81291504465308, 'fit_time_seconds': 0.44156575202941895, 'cpu_percent_fit': 18.5125, 'ram_mb_fit': 11.671875, 'accumulated_train_samples_this_round': 325}
2025-08-04 21:02:59,560 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 21:03:13,847 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:13,847 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:03:13,847 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:03:13,848 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:03:13,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:03:13,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:14,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:14,280 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:14,382 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:03:14,431 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:03:14,432 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:14,641 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:14,662 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:14,662 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:14,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:03:14,708 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:14,712 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:03:14,713 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:14,714 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:14,715 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:03:14,729 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:14,734 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:14,738 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:14,742 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:14,747 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:14,751 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:14,756 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:14,761 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:14,765 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:14,769 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:14,773 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:14,792 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:14,792 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:03:14,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:03:14,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:03:14,813 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:14,813 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:03:14,870 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:14,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:03:14,871 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:14,894 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:14,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:03:14,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:03:14,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:14,915 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:14,915 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:14,916 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:14,916 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:14,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:03:14,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:14,918 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:03:14,918 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:14,920 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:03:14,920 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:03:14,921 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:14,921 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:03:14,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:14,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:14,922 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:14,923 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:03:14,923 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:03:14,923 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:03:14,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:03:14,924 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:03:14,924 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:03:14,925 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:03:14,925 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:03:14,926 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:03:14,926 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:03:14,926 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:03:14,927 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:03:14,928 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:14,928 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:03:14,929 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:14,929 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:14,930 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:14,930 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:03:14,931 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:03:14,931 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:03:14,932 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:03:14,941 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:03:14,941 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:14,943 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:14,943 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:03:14,945 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:14,945 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:14,946 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:14,946 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:15,028 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5559, Threshold=0.6012, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:03:15,028 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5559
2025-08-04 21:03:20,302 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:20,302 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:03:20,302 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:03:20,302 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:03:20,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:03:20,302 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:20,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:20,634 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:20,719 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:03:20,741 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:03:20,741 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:20,887 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:20,893 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:20,893 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:20,898 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:03:20,904 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:20,904 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:03:20,905 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:20,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:20,905 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:03:20,913 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:20,917 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:20,919 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:20,921 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:20,924 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:20,926 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:20,928 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:20,931 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:20,934 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:20,936 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:20,938 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:20,948 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:20,948 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:03:20,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:03:20,953 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:03:20,958 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:20,958 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:03:20,968 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:20,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:03:20,968 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:20,983 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:20,988 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:03:20,999 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:03:20,999 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:20,999 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:21,000 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:21,000 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:21,000 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:21,000 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:03:21,000 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:21,001 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:03:21,001 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:21,002 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:03:21,002 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:03:21,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:21,003 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:03:21,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:21,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:21,003 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:21,004 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:03:21,004 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:03:21,004 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:03:21,004 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:03:21,004 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:03:21,004 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:03:21,005 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:03:21,005 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:03:21,005 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:03:21,005 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:03:21,006 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:03:21,006 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:03:21,006 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:21,006 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:03:21,006 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:21,007 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:21,007 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:21,007 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:03:21,007 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:03:21,007 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:03:21,008 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:03:21,014 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:03:21,014 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:21,015 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:21,015 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:03:21,016 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 168/400.
2025-08-04 21:03:21,117 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:21,117 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:21,119 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 75 anomalous samples to GAN training data (target: 75).
2025-08-04 21:03:21,119 - ClientAppLogger [Client 4] - INFO - [Client] Round 168: Training GAN with 327 samples (252 normal, 75 anomalous).
2025-08-04 21:03:21,120 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:21,387 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7761
2025-08-04 21:03:21,387 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7761
2025-08-04 21:03:21,388 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:21,431 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5328, Threshold=0.5786, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:03:21,432 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8134
2025-08-04 21:03:21,432 - ClientAppLogger [Client 4] - INFO - Fit completed for round 168. Duration: 0.42s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 168, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083538376811083, 'd_loss': 0.7760696560417839, 'post_fit_local_f1': 0.8133730249599267, 'fit_time_seconds': 0.4153916835784912, 'cpu_percent_fit': 18.65625, 'ram_mb_fit': 7.09375, 'accumulated_train_samples_this_round': 327}
2025-08-04 21:03:21,432 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 21:03:32,714 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:32,715 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:03:32,715 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:03:32,716 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:03:32,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:03:32,716 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:33,169 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:33,169 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:03:33,340 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:03:33,340 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:33,528 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:33,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:33,540 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:33,548 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:03:33,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:33,555 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:03:33,555 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:33,556 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:33,556 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:03:33,565 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:33,568 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,571 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:33,573 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:33,576 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:33,578 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:33,581 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,584 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:33,587 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:33,590 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:33,592 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:33,607 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:33,607 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:03:33,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:03:33,613 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:03:33,619 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:33,619 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:03:33,635 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:33,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:03:33,636 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:33,656 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:33,664 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:03:33,682 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:03:33,683 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:33,683 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:33,683 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:33,684 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:33,684 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:33,684 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:03:33,684 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:33,685 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:03:33,685 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:33,686 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:03:33,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:03:33,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:33,687 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:03:33,687 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:33,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:33,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:33,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:03:33,688 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:03:33,688 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:03:33,689 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:03:33,689 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:03:33,689 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:03:33,690 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:03:33,690 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:03:33,690 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:03:33,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:03:33,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:03:33,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:03:33,691 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:33,692 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:03:33,692 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:33,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:33,693 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:33,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:03:33,694 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:03:33,694 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:03:33,694 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:03:33,701 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:03:33,701 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:33,703 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:33,704 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:03:33,705 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:33,706 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:33,706 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:33,707 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:33,759 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5411, Threshold=0.5816, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:03:33,760 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5411
2025-08-04 21:03:45,050 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:45,050 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:03:45,050 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:03:45,050 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:03:45,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:03:45,051 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:45,446 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:45,447 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:45,557 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:03:45,589 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:03:45,589 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:45,735 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:45,745 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:45,745 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:45,756 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:03:45,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:45,790 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:03:45,791 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:45,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:45,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:03:45,802 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:45,806 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:45,808 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:45,810 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:45,813 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:45,816 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:45,818 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:45,820 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:45,823 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:45,825 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:45,828 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:45,840 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:45,841 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:03:45,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:03:45,846 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:03:45,851 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:45,852 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:03:45,867 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:45,867 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:03:45,868 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:45,888 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:45,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:03:45,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:03:45,906 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:45,906 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:45,906 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:45,907 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:45,907 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:45,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:03:45,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:45,908 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:03:45,908 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:45,910 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:03:45,910 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:03:45,910 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:45,910 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:03:45,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:45,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:45,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:45,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:03:45,911 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:03:45,911 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:03:45,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:03:45,912 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:03:45,912 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:03:45,912 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:03:45,913 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:03:45,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:03:45,914 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:03:45,914 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:03:45,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:03:45,915 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:45,915 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:03:45,915 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:45,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:45,916 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:45,916 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:03:45,917 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:03:45,917 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:03:45,917 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:03:45,926 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:03:45,926 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:45,928 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:45,928 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:03:45,930 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:45,930 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:45,930 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:45,931 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:45,978 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.4957, Threshold=0.5033, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:03:45,978 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.4957
2025-08-04 21:03:54,247 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:54,248 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:03:54,248 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:03:54,248 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:03:54,248 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:03:54,248 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:54,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:54,570 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:54,657 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:03:54,691 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:03:54,691 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:54,784 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:54,791 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:54,791 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:54,795 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:03:54,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:54,800 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:03:54,801 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:54,801 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:54,802 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:03:54,810 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:54,813 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:54,815 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:54,817 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:54,820 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:54,822 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:54,825 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:54,827 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:54,830 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:54,832 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:54,834 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:54,843 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:54,843 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:03:54,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:03:54,848 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:03:54,852 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:54,852 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:03:54,859 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:54,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:03:54,860 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:54,874 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:54,878 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:03:54,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:03:54,883 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:54,883 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:54,883 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:54,884 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:54,884 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:54,884 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:03:54,884 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:54,885 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:03:54,885 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:54,886 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:03:54,886 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:03:54,887 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:54,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:03:54,887 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:54,887 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:54,887 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:54,887 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:03:54,888 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:03:54,889 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:54,890 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:54,890 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:54,890 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:03:54,890 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:03:54,890 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:03:54,891 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:03:54,895 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:03:54,896 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:54,897 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:54,897 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:03:54,898 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 170/400.
2025-08-04 21:03:54,999 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:54,999 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:55,001 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 76 anomalous samples to GAN training data (target: 76).
2025-08-04 21:03:55,001 - ClientAppLogger [Client 4] - INFO - [Client] Round 170: Training GAN with 330 samples (254 normal, 76 anomalous).
2025-08-04 21:03:55,001 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:55,253 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7746
2025-08-04 21:03:55,253 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7746
2025-08-04 21:03:55,254 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:55,294 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5935, Threshold=0.6620, Accuracy=0.7293, F1=0.8129, Precision=0.9801, Recall=0.6944
2025-08-04 21:03:55,294 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8129
2025-08-04 21:03:55,295 - ClientAppLogger [Client 4] - INFO - Fit completed for round 170. Duration: 0.40s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 170, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0839129765828455, 'd_loss': 0.7745931023178678, 'post_fit_local_f1': 0.81291504465308, 'fit_time_seconds': 0.3960716724395752, 'cpu_percent_fit': 18.60625, 'ram_mb_fit': 4.484375, 'accumulated_train_samples_this_round': 330}
2025-08-04 21:03:55,295 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 21:04:00,594 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:00,594 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:04:00,595 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:04:00,595 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:04:00,595 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:04:00,596 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:01,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:01,070 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:01,171 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:04:01,204 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:04:01,204 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:01,381 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:01,391 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:01,392 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:01,400 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:04:01,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:01,411 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:04:01,412 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:01,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:01,412 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:04:01,422 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:01,425 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,428 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:01,430 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:01,434 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:01,437 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:01,441 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,445 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:01,448 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:01,451 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:01,455 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:01,467 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:01,470 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:04:01,475 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:04:01,476 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:04:01,485 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:01,486 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:04:01,498 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:01,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:04:01,499 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:01,517 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:01,525 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:04:01,531 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:04:01,532 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:01,532 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:01,532 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:01,532 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:01,533 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:01,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:04:01,533 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:01,533 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:04:01,534 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:01,535 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:04:01,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:04:01,536 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:01,536 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:04:01,536 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:01,536 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:01,536 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:01,537 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:04:01,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:04:01,537 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:04:01,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:04:01,537 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:04:01,537 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:04:01,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:04:01,538 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:04:01,538 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:04:01,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:04:01,539 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:04:01,539 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:04:01,539 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:01,540 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:04:01,540 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:01,541 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:01,541 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:01,541 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:04:01,541 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:04:01,541 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:04:01,541 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:04:01,548 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:04:01,549 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:01,550 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:01,550 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:04:01,552 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:01,552 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:01,552 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:01,553 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:01,613 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5632, Threshold=0.6238, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:04:01,613 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7300, F1: 0.8134, Prec: 0.9807, Rec: 0.6948, Avg Anomaly Score: 0.5632
2025-08-04 21:04:06,901 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:06,901 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:04:06,902 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:04:06,902 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:04:06,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:04:06,903 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:07,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:07,277 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:07,370 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:04:07,408 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:04:07,408 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:07,523 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:07,529 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:07,529 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:07,535 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:04:07,540 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:07,540 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:04:07,541 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:07,544 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:07,544 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:04:07,555 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:07,558 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:07,560 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:07,563 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:07,566 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:07,568 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:07,570 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:07,573 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:07,575 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:07,577 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:07,579 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:07,589 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:07,589 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:04:07,593 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:04:07,594 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:04:07,599 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:07,599 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:04:07,610 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:07,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:04:07,611 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:07,627 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:07,633 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:04:07,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:04:07,640 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:07,640 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:07,640 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:07,640 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:07,641 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:07,641 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:04:07,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:07,641 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:04:07,641 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:07,642 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:04:07,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:04:07,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:07,643 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:04:07,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:07,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:07,643 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:07,644 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:04:07,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:04:07,644 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:04:07,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:04:07,644 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:04:07,644 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:04:07,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:04:07,645 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:04:07,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:04:07,645 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:04:07,645 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:04:07,646 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:04:07,646 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:07,646 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:04:07,646 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:07,646 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:07,647 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:07,647 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:04:07,647 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:04:07,648 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:04:07,648 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:04:07,653 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:04:07,653 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:07,655 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:07,655 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:04:07,657 - ClientAppLogger [Client 4] - INFO - [Client] Fit started for round 171/400.
2025-08-04 21:04:07,766 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:07,766 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:07,784 - ClientAppLogger [Client 4] - INFO - [Client] Semi-supervised: Added 76 anomalous samples to GAN training data (target: 76).
2025-08-04 21:04:07,787 - ClientAppLogger [Client 4] - INFO - [Client] Round 171: Training GAN with 330 samples (254 normal, 76 anomalous).
2025-08-04 21:04:07,787 - ClientAppLogger [Client 4] - INFO - [Client] Starting GAN training...
2025-08-04 21:04:08,072 - ClientAppLogger [Client 4] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7659
2025-08-04 21:04:08,072 - ClientAppLogger [Client 4] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7659
2025-08-04 21:04:08,073 - ClientAppLogger [Client 4] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:04:08,122 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5966, Threshold=0.6744, Accuracy=0.7300, F1=0.8134, Precision=0.9807, Recall=0.6948
2025-08-04 21:04:08,123 - ClientAppLogger [Client 4] - INFO - [Client] Post-fit local evaluation F1: 0.8134
2025-08-04 21:04:08,123 - ClientAppLogger [Client 4] - INFO - Fit completed for round 171. Duration: 0.47s. Metrics: {'cpu_cores_available': 3, 'client_cid_for_attributes': '4', 'server_round': 171, 'allocated_cores_for_pytorch': 3, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0836801468242294, 'd_loss': 0.7659331194920973, 'post_fit_local_f1': 0.8133730249599267, 'fit_time_seconds': 0.46616268157958984, 'cpu_percent_fit': 17.69375, 'ram_mb_fit': 7.91796875, 'accumulated_train_samples_this_round': 330}
2025-08-04 21:04:08,123 - ClientAppLogger [Client 4] - INFO - [Client] get_parameters called
2025-08-04 21:04:22,562 - ClientAppLogger [Client 4] - INFO - ClientApp starting for partition_id: 4. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:22,562 - ClientAppLogger [Client 4] - INFO - ALLOCATED_CORES='3' found. Setting PyTorch threads to 3.
2025-08-04 21:04:22,563 - ClientAppLogger [Client 4] - INFO - Called torch.set_num_threads(3). Current PyTorch intra-op threads: 3. Client will operate with 3 core(s).
2025-08-04 21:04:22,563 - ClientAppLogger [Client 4] - INFO - Loading data for partition 4/10...
2025-08-04 21:04:22,564 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting load_data function.
2025-08-04 21:04:22,565 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:25,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:25,488 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:25,601 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Numeric conversion completed.
2025-08-04 21:04:25,635 - ClientAppLogger [Client 4] - INFO - [LoadData 4] NA values filled.
2025-08-04 21:04:25,635 - ClientAppLogger [Client 4] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:25,748 - ClientAppLogger [Client 4] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,756 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,756 - ClientAppLogger [Client 4] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,765 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Scaler fitting process completed.
2025-08-04 21:04:25,773 - ClientAppLogger [Client 4] - INFO - [LoadData 4] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,773 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,774 - ClientAppLogger [Client 4] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,774 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting anomaly reduction logic.
2025-08-04 21:04:25,783 - ClientAppLogger [Client 4] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,787 - ClientAppLogger [Client 4] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,789 - ClientAppLogger [Client 4] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,792 - ClientAppLogger [Client 4] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,795 - ClientAppLogger [Client 4] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,797 - ClientAppLogger [Client 4] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,800 - ClientAppLogger [Client 4] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,804 - ClientAppLogger [Client 4] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,807 - ClientAppLogger [Client 4] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,809 - ClientAppLogger [Client 4] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,812 - ClientAppLogger [Client 4] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,826 - ClientAppLogger [Client 4] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,826 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Anomaly reduction logic completed.
2025-08-04 21:04:25,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,831 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating unlabeled training base.
2025-08-04 21:04:25,837 - ClientAppLogger [Client 4] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,837 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating labeled pool.
2025-08-04 21:04:25,849 - ClientAppLogger [Client 4] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,849 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Labeled pool creation completed.
2025-08-04 21:04:25,849 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,867 - ClientAppLogger [Client 4] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,873 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Combining data for final AE training set.
2025-08-04 21:04:25,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Final AE training data combination completed.
2025-08-04 21:04:25,887 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,887 - ClientAppLogger [Client 4] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,887 - ClientAppLogger [Client 4] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,888 - ClientAppLogger [Client 4] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,888 - ClientAppLogger [Client 4] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,888 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] START of partitioning block.
2025-08-04 21:04:25,889 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,889 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 1: Full indices created.
2025-08-04 21:04:25,889 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,890 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 2: Full indices shuffled.
2025-08-04 21:04:25,891 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,891 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,891 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,891 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,892 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,892 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,892 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 6: Start indices calculated. train_start=51833
2025-08-04 21:04:25,892 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Start indices calculated. Train_start=51833, Val_start=1246, Test_start=4212
2025-08-04 21:04:25,892 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 7: End indices calculated. train_end=52919
2025-08-04 21:04:25,893 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: End indices calculated. Train_end=52919, Val_end=4264, Test_end=4591
2025-08-04 21:04:25,893 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 8: Partition-specific indices extracted. Num train indices: 1086
2025-08-04 21:04:25,893 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Specific indices extracted. Train idx: 1086, Val idx: 3018, Test idx: 379
2025-08-04 21:04:25,893 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9a: Train data sliced for partition. X_train_part_full shape: (1086, 17)
2025-08-04 21:04:25,893 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Train data sliced. Shape: (1086, 17)
2025-08-04 21:04:25,894 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9b: Validation data sliced for partition. X_val_part shape: (3018, 17)
2025-08-04 21:04:25,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Validation data sliced. Shape: (3018, 17)
2025-08-04 21:04:25,894 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 9c: Test data sliced for partition. X_test_part shape: (379, 17)
2025-08-04 21:04:25,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Partitioning: Test data sliced. Shape: (379, 17)
2025-08-04 21:04:25,894 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,894 - ClientAppLogger [Client 4] - INFO - [LoadData 4] Creating TonIoTDataset objects.
2025-08-04 21:04:25,895 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,896 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,896 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,896 - ClientAppLogger [Client 4] - INFO - [LoadData 4] TonIoTDataset objects created.
2025-08-04 21:04:25,896 - ClientAppLogger [Client 4] - INFO - Partition 4 (Static Datasets): Train Potential 1086, Val 3018, Test 379
2025-08-04 21:04:25,896 - ClientAppLogger [Client 4] - INFO - [Partitioning Debug 4] END of partitioning block, returning datasets.
2025-08-04 21:04:25,896 - ClientAppLogger [Client 4] - INFO - [LoadData 4] load_data function completed.
2025-08-04 21:04:25,901 - ClientAppLogger [Client 4] - INFO - Data loaded for partition 4: Train samples: 1086, Val samples: 3018
2025-08-04 21:04:25,901 - ClientAppLogger [Client 4] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,903 - ClientAppLogger [Client 4] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,903 - ClientAppLogger [Client 4] - INFO - [Client] Initialized. Device: cpu. Operating with 3 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 3.
2025-08-04 21:04:25,905 - ClientAppLogger [Client 4] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,905 - ClientAppLogger [Client 4] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,905 - ClientAppLogger [Client 4] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,905 - ClientAppLogger [Client 4] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,961 - ClientAppLogger [Client 4] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=3018, Avg Anomaly Score (all samples)=0.5633, Threshold=0.6285, Accuracy=0.7280, F1=0.8120, Precision=0.9790, Recall=0.6937
2025-08-04 21:04:25,962 - ClientAppLogger [Client 4] - INFO - [Client] Evaluation finished. Samples: 3018, Acc: 0.7280, F1: 0.8120, Prec: 0.9790, Rec: 0.6937, Avg Anomaly Score: 0.5633
