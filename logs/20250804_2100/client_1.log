2025-08-04 21:00:01,872 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:01,873 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:01,873 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:01,873 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:00:01,873 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:00:01,874 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:02,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:02,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:02,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:00:02,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:00:02,382 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:02,535 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:02,541 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:02,541 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:02,547 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:00:02,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:02,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:00:02,553 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:02,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:02,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:00:02,564 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:02,567 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:02,569 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:02,571 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:02,575 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:02,577 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:02,580 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:02,583 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:02,586 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:02,589 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:02,591 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:02,600 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:02,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:00:02,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:00:02,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:00:02,613 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:02,613 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:00:02,624 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:02,625 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:00:02,625 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:02,642 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:02,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:00:02,654 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:00:02,654 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:02,654 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:02,654 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:02,654 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:02,655 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:02,655 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:00:02,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:02,655 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:00:02,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:02,657 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:00:02,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:00:02,657 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:02,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:00:02,657 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:02,657 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:00:02,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:00:02,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:00:02,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:00:02,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:00:02,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:00:02,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:00:02,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:00:02,662 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:02,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:00:02,662 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:02,663 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:02,663 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:02,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:00:02,663 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:00:02,663 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:00:02,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:00:02,671 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:00:02,671 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:02,672 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:02,672 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:02,674 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 158/400.
2025-08-04 21:00:02,775 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:02,775 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:02,786 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2494 anomalous samples to GAN training data (target: 2494).
2025-08-04 21:00:02,788 - ClientAppLogger [Client 1] - INFO - [Client] Round 158: Training GAN with 10808 samples (8314 normal, 2494 anomalous).
2025-08-04 21:00:02,788 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:10,735 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7869
2025-08-04 21:00:10,735 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7869
2025-08-04 21:00:10,735 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:10,747 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5422, Threshold=0.5851, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:00:10,747 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:00:10,748 - ClientAppLogger [Client 1] - INFO - Fit completed for round 158. Duration: 8.07s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 158, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834520806743866, 'd_loss': 0.7869234906356481, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.074000597000122, 'cpu_percent_fit': 12.475, 'ram_mb_fit': 7.30078125, 'accumulated_train_samples_this_round': 10808}
2025-08-04 21:00:10,748 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:00:16,038 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:16,038 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:16,038 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:16,038 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:00:16,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:00:16,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:16,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:16,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:16,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:00:16,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:00:16,724 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:16,901 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:16,908 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:16,909 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:16,915 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:00:16,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:16,927 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:00:16,927 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:16,927 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:16,927 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:00:16,938 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:16,941 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,944 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:16,946 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:16,949 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:16,951 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:16,953 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,956 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:16,959 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:16,962 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:16,964 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:16,976 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:16,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:00:16,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:00:16,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:00:16,988 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:16,988 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:00:16,999 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:17,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:00:17,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:17,016 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:17,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:00:17,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:00:17,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:17,027 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:17,027 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:17,028 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:17,028 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:17,028 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:00:17,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:17,028 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:00:17,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:17,030 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:00:17,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:00:17,031 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:17,031 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:00:17,031 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:17,031 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:17,031 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:17,032 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:00:17,032 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:00:17,032 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:00:17,032 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:00:17,032 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:00:17,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:00:17,037 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:00:17,037 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:00:17,037 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:00:17,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:00:17,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:00:17,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:00:17,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:17,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:00:17,039 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:17,042 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:17,042 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:17,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:00:17,043 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:00:17,043 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:00:17,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:00:17,051 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:00:17,053 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:17,055 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:17,055 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:17,057 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:17,057 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:17,057 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:17,058 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:17,073 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5421, Threshold=0.5849, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:00:17,073 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5421
2025-08-04 21:00:25,348 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:25,348 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:25,348 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:25,348 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:00:25,348 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:00:25,348 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:25,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:25,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:25,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:00:25,813 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:00:25,814 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:25,931 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:25,937 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:25,937 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:25,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:00:25,947 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:25,947 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:00:25,947 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:25,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:25,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:00:25,956 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:25,958 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:25,961 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:25,963 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:25,966 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:25,968 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:25,971 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:25,974 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:25,976 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:25,978 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:25,981 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:25,990 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:25,990 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:00:25,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:00:25,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:00:26,000 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:26,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:00:26,010 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:26,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:00:26,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:26,026 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:26,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:00:26,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:00:26,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:26,037 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:26,037 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:26,037 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:26,037 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:26,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:00:26,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:26,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:00:26,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:26,040 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:00:26,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:00:26,040 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:26,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:00:26,040 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:00:26,041 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:00:26,042 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:00:26,044 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:00:26,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:00:26,044 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:00:26,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:00:26,044 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:00:26,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:00:26,045 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:26,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:00:26,045 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:26,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:26,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:26,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:00:26,050 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:00:26,050 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:00:26,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:00:26,054 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:00:26,054 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:26,056 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:26,056 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:26,058 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 159/400.
2025-08-04 21:00:26,159 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:26,159 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:26,161 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2511 anomalous samples to GAN training data (target: 2511).
2025-08-04 21:00:26,164 - ClientAppLogger [Client 1] - INFO - [Client] Round 159: Training GAN with 10884 samples (8373 normal, 2511 anomalous).
2025-08-04 21:00:26,165 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:33,943 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7803
2025-08-04 21:00:33,943 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7803
2025-08-04 21:00:33,943 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:33,954 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5272, Threshold=0.5610, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:00:33,954 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:00:33,955 - ClientAppLogger [Client 1] - INFO - Fit completed for round 159. Duration: 7.90s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 159, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083575148890887, 'd_loss': 0.7803278191108907, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.8967978954315186, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 1.7578125, 'accumulated_train_samples_this_round': 10884}
2025-08-04 21:00:33,955 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:00:39,222 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:39,222 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:39,222 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:39,222 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:00:39,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:00:39,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:39,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:39,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:39,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:00:39,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:00:39,787 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:39,948 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:39,954 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:39,954 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:39,962 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:00:39,969 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:39,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:00:39,970 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:39,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:39,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:00:39,979 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:39,982 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:39,985 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:39,987 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:39,990 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:39,992 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:39,994 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:39,997 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:40,000 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:40,001 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:40,004 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:40,014 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:40,014 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:00:40,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:00:40,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:00:40,025 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:40,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:00:40,041 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:40,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:00:40,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:40,062 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:40,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:00:40,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:00:40,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:40,074 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:40,074 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:40,075 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:40,075 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:40,075 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:00:40,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:40,076 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:00:40,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:40,077 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:00:40,077 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:00:40,077 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:40,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:00:40,078 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:40,078 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:40,078 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:40,078 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:00:40,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:00:40,079 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:00:40,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:00:40,079 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:00:40,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:00:40,083 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:00:40,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:00:40,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:00:40,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:00:40,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:00:40,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:00:40,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:40,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:00:40,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:40,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:40,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:40,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:00:40,088 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:00:40,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:00:40,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:00:40,095 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:00:40,095 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:40,096 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:40,097 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:40,099 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:40,099 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:40,099 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:40,100 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:40,113 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5273, Threshold=0.5613, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:00:40,113 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5273
2025-08-04 21:00:48,389 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:48,389 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:48,389 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:48,389 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:00:48,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:00:48,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:48,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:48,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:48,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:00:48,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:00:48,880 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:49,004 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:49,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:49,011 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:49,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:00:49,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:49,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:00:49,021 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:49,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:49,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:00:49,029 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:49,032 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:49,034 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:49,037 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:49,039 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:49,041 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:49,044 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:49,047 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:49,050 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:49,052 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:49,055 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:49,066 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:49,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:00:49,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:00:49,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:00:49,078 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:49,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:00:49,088 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:49,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:00:49,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:49,103 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:49,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:00:49,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:00:49,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:49,113 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:49,114 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:49,114 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:49,114 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:49,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:00:49,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:49,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:00:49,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:49,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:00:49,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:00:49,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:49,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:00:49,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:49,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:49,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:49,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:00:49,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:00:49,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:00:49,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:00:49,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:00:49,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:00:49,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:00:49,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:00:49,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:00:49,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:00:49,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:00:49,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:00:49,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:49,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:00:49,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:49,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:49,126 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:49,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:00:49,126 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:00:49,127 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:00:49,127 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:00:49,131 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:00:49,131 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:49,133 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:49,133 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:49,134 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 160/400.
2025-08-04 21:00:49,235 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:49,235 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:49,237 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2527 anomalous samples to GAN training data (target: 2527).
2025-08-04 21:00:49,237 - ClientAppLogger [Client 1] - INFO - [Client] Round 160: Training GAN with 10953 samples (8426 normal, 2527 anomalous).
2025-08-04 21:00:49,240 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:57,345 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.7804
2025-08-04 21:00:57,346 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.7804
2025-08-04 21:00:57,346 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:57,358 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5551, Threshold=0.5997, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:00:57,358 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:00:57,359 - ClientAppLogger [Client 1] - INFO - Fit completed for round 160. Duration: 8.22s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 160, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.08344033411798, 'd_loss': 0.7803644538366509, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.224448442459106, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10953}
2025-08-04 21:00:57,359 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:01:02,635 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:02,635 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:02,635 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:02,635 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:01:02,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:01:02,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:02,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:02,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:03,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:01:03,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:01:03,107 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:03,272 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:03,278 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:03,278 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:03,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:01:03,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:03,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:01:03,293 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:03,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:03,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:01:03,304 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:03,307 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:03,309 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:03,311 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:03,314 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:03,316 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:03,319 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:03,322 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:03,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:03,327 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:03,330 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:03,341 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:03,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:01:03,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:01:03,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:01:03,352 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:03,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:01:03,364 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:03,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:01:03,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:03,384 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:03,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:01:03,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:01:03,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:03,397 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:03,397 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:03,397 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:03,398 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:03,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:01:03,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:03,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:01:03,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:03,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:01:03,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:01:03,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:03,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:01:03,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:03,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:03,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:03,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:01:03,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:01:03,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:01:03,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:01:03,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:01:03,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:01:03,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:01:03,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:01:03,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:01:03,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:01:03,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:01:03,407 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:01:03,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:03,407 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:01:03,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:03,408 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:03,408 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:03,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:01:03,408 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:01:03,408 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:01:03,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:01:03,416 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:01:03,416 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:03,417 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:03,417 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:03,419 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:03,419 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:03,419 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:03,420 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:03,433 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5455, Threshold=0.5840, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:01:03,433 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5455
2025-08-04 21:01:11,695 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:11,695 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:11,695 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:11,695 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:01:11,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:01:11,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:12,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:12,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:12,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:01:12,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:01:12,196 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:12,313 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:12,319 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:12,319 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:12,325 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:01:12,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:12,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:01:12,331 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:12,331 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:12,331 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:01:12,339 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:12,342 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:12,344 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:12,347 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:12,349 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:12,351 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:12,354 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:12,357 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:12,360 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:12,361 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:12,364 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:12,373 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:12,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:01:12,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:01:12,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:01:12,383 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:12,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:01:12,396 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:12,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:01:12,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:12,414 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:12,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:01:12,424 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:01:12,424 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:12,424 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:12,424 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:12,425 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:12,425 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:12,425 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:01:12,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:12,425 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:01:12,426 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:12,427 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:01:12,427 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:01:12,427 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:01:12,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:01:12,429 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:01:12,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:01:12,431 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:01:12,431 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:01:12,431 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:01:12,431 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:01:12,431 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:01:12,431 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:01:12,432 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:12,432 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:01:12,432 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:12,432 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:12,432 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:12,433 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:01:12,433 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:01:12,433 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:01:12,433 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:01:12,437 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:01:12,437 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:12,438 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:12,438 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:12,440 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 161/400.
2025-08-04 21:01:12,540 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:12,541 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:12,542 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2543 anomalous samples to GAN training data (target: 2543).
2025-08-04 21:01:12,543 - ClientAppLogger [Client 1] - INFO - [Client] Round 161: Training GAN with 11020 samples (8477 normal, 2543 anomalous).
2025-08-04 21:01:12,543 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:20,653 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7796
2025-08-04 21:01:20,654 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7796
2025-08-04 21:01:20,654 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:20,665 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5149, Threshold=0.5443, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:01:20,666 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:01:20,666 - ClientAppLogger [Client 1] - INFO - Fit completed for round 161. Duration: 8.23s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 161, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0835305392893604, 'd_loss': 0.7795768092699796, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.226186037063599, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11020}
2025-08-04 21:01:20,666 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:01:25,959 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:25,960 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:25,960 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:25,960 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:01:25,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:01:25,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:26,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:26,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:26,468 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:01:26,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:01:26,512 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:26,652 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:26,659 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:26,659 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:26,665 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:01:26,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:26,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:01:26,671 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:26,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:26,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:01:26,680 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:26,683 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:26,686 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:26,688 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:26,690 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:26,692 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:26,695 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:26,697 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:26,700 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:26,702 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:26,704 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:26,713 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:26,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:01:26,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:01:26,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:01:26,724 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:26,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:01:26,735 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:26,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:01:26,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:26,755 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:26,760 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:01:26,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:01:26,766 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:26,766 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:26,766 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:26,766 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:26,766 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:26,766 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:01:26,767 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:26,767 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:01:26,767 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:26,768 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:01:26,768 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:01:26,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:26,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:01:26,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:26,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:26,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:26,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:01:26,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:01:26,770 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:01:26,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:01:26,770 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:01:26,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:01:26,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:01:26,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:01:26,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:01:26,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:01:26,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:01:26,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:01:26,774 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:26,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:01:26,774 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:26,774 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:26,775 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:26,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:01:26,775 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:01:26,775 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:01:26,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:01:26,783 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:01:26,783 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:26,784 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:26,784 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:26,786 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:26,786 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:26,786 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:26,786 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:26,798 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5167, Threshold=0.5477, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:01:26,798 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5167
2025-08-04 21:01:38,093 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:38,093 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:38,093 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:38,093 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:01:38,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:01:38,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:38,540 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:38,540 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:38,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:01:38,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:01:38,678 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:38,805 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:38,811 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:38,811 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:38,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:01:38,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:38,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:01:38,824 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:38,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:38,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:01:38,833 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:38,836 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,839 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:38,841 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:38,844 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:38,846 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:38,849 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,851 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:38,854 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:38,856 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:38,858 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:38,868 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:38,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:01:38,873 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:01:38,873 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:01:38,878 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:38,878 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:01:38,887 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:38,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:01:38,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:38,904 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:38,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:01:38,925 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:01:38,925 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:38,925 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:38,925 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:38,926 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:38,926 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:38,926 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:01:38,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:38,927 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:01:38,927 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:38,928 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:01:38,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:01:38,929 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:01:38,930 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:01:38,930 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:01:38,930 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:01:38,934 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:01:38,934 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:01:38,935 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:01:38,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:01:38,935 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:01:38,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:01:38,935 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:38,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:01:38,936 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:38,936 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:38,936 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:38,937 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:01:38,937 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:01:38,937 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:01:38,937 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:01:38,943 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:01:38,943 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:38,944 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:38,944 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:38,946 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:38,946 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:38,946 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:38,947 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:38,959 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5676, Threshold=0.6318, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:01:38,959 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5676
2025-08-04 21:01:50,268 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:50,269 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:50,269 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:50,269 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:01:50,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:01:50,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:50,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:50,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:50,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:01:50,827 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:01:50,827 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:50,968 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:50,974 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:50,974 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:50,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:01:50,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:50,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:01:50,986 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:50,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:50,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:01:50,995 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:50,998 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:51,000 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:51,002 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:51,005 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:51,007 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:51,010 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:51,012 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:51,015 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:51,018 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:51,021 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:51,033 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:51,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:01:51,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:01:51,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:01:51,044 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:51,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:01:51,054 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:51,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:01:51,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:51,070 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:51,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:01:51,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:01:51,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:51,080 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:51,081 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:51,081 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:51,081 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:51,082 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:01:51,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:51,082 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:01:51,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:51,083 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:01:51,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:01:51,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:51,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:01:51,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:51,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:51,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:51,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:01:51,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:01:51,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:01:51,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:01:51,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:01:51,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:01:51,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:51,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:01:51,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:51,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:51,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:51,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:01:51,091 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:01:51,091 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:01:51,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:01:51,097 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:01:51,098 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:51,099 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:51,099 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:51,101 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:51,101 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:51,101 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:51,102 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:51,113 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5029, Threshold=0.5248, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:01:51,113 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5029
2025-08-04 21:01:56,408 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:56,408 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:56,408 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:56,408 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:01:56,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:01:56,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:56,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:56,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:56,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:01:56,907 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:01:56,907 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:57,034 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:57,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:57,040 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:57,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:01:57,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:57,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:01:57,050 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:57,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:57,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:01:57,058 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:57,061 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:57,063 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:57,066 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:57,068 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:57,070 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:57,073 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:57,075 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:57,078 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:57,080 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:57,082 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:57,091 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:57,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:01:57,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:01:57,096 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:01:57,100 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:57,101 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:01:57,109 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:57,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:01:57,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:57,126 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:57,133 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:01:57,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:01:57,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:57,138 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:57,138 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:57,139 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:57,139 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:57,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:01:57,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:57,140 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:01:57,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:57,141 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:01:57,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:01:57,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:57,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:01:57,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:57,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:57,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:57,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:01:57,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:01:57,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:01:57,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:01:57,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:01:57,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:01:57,146 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:01:57,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:01:57,146 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:01:57,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:01:57,146 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:01:57,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:01:57,147 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:57,147 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:01:57,147 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:57,147 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:57,147 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:57,148 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:01:57,148 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:01:57,148 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:01:57,148 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:01:57,154 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:01:57,154 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:57,155 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:57,155 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:57,157 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 164/400.
2025-08-04 21:01:57,258 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:57,258 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:57,259 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2590 anomalous samples to GAN training data (target: 2590).
2025-08-04 21:01:57,260 - ClientAppLogger [Client 1] - INFO - [Client] Round 164: Training GAN with 11224 samples (8634 normal, 2590 anomalous).
2025-08-04 21:01:57,260 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:05,171 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7786
2025-08-04 21:02:05,172 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7786
2025-08-04 21:02:05,172 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:05,183 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5445, Threshold=0.5852, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:02:05,183 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:02:05,184 - ClientAppLogger [Client 1] - INFO - Fit completed for round 164. Duration: 8.03s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 164, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083489703945152, 'd_loss': 0.778558153530061, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.026989221572876, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 11224}
2025-08-04 21:02:05,184 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:02:10,511 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:10,511 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:10,511 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:10,511 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:02:10,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:02:10,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:10,962 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:10,962 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:11,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:02:11,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:02:11,117 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:11,300 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:11,307 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:11,307 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:11,317 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:02:11,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:11,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:02:11,333 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:11,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:11,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:02:11,344 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:11,347 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,350 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:11,352 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:11,355 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:11,357 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:11,360 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,363 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:11,366 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:11,369 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:11,372 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:11,384 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:11,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:02:11,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:02:11,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:02:11,401 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:11,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:02:11,415 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:11,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:02:11,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:11,433 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:11,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:02:11,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:02:11,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:11,455 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:11,455 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:11,456 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:11,456 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:11,456 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:02:11,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:11,457 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:02:11,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:02:11,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:11,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:02:11,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:11,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:11,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:11,460 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:02:11,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:02:11,460 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:02:11,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:02:11,461 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:02:11,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:02:11,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:02:11,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:02:11,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:02:11,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:02:11,466 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:02:11,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:02:11,466 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:11,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:02:11,467 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:11,467 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:11,467 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:11,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:02:11,467 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:02:11,468 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:02:11,468 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:02:11,474 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:02:11,475 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:11,476 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:11,476 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:11,478 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:11,481 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:11,481 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:11,482 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:11,495 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5444, Threshold=0.5849, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:02:11,496 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5444
2025-08-04 21:02:16,757 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:16,758 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:16,758 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:16,758 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:02:16,758 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:02:16,759 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:17,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:17,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:17,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:02:17,219 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:02:17,219 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:17,340 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:17,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:17,346 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:17,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:02:17,356 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:17,356 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:02:17,357 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:17,357 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:17,357 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:02:17,365 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:17,368 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:17,370 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:17,373 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:17,375 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:17,378 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:17,380 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:17,383 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:17,386 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:17,388 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:17,390 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:17,398 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:17,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:02:17,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:02:17,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:02:17,408 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:17,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:02:17,417 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:17,417 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:02:17,417 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:17,431 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:17,436 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:02:17,440 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:02:17,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:17,441 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:17,441 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:17,441 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:17,441 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:17,441 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:02:17,442 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:17,442 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:02:17,442 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:17,443 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:02:17,443 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:02:17,444 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:17,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:02:17,444 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:17,444 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:17,444 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:17,444 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:02:17,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:02:17,445 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:02:17,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:02:17,445 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:02:17,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:02:17,447 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:02:17,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:02:17,447 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:02:17,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:02:17,448 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:02:17,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:02:17,448 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:17,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:02:17,448 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:17,449 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:17,449 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:17,449 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:02:17,449 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:02:17,449 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:02:17,449 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:02:17,453 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:02:17,453 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:17,454 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:17,454 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:17,456 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 165/400.
2025-08-04 21:02:17,557 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:17,557 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:17,559 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2606 anomalous samples to GAN training data (target: 2606).
2025-08-04 21:02:17,560 - ClientAppLogger [Client 1] - INFO - [Client] Round 165: Training GAN with 11294 samples (8688 normal, 2606 anomalous).
2025-08-04 21:02:17,560 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:25,679 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7791
2025-08-04 21:02:25,680 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7791
2025-08-04 21:02:25,680 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:25,691 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5571, Threshold=0.5991, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:02:25,691 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:02:25,691 - ClientAppLogger [Client 1] - INFO - Fit completed for round 165. Duration: 8.24s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 165, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083576055216498, 'd_loss': 0.7791117659317237, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.235224485397339, 'cpu_percent_fit': 12.4875, 'ram_mb_fit': 3.48046875, 'accumulated_train_samples_this_round': 11294}
2025-08-04 21:02:25,691 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:02:30,964 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:30,964 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:30,964 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:30,964 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:02:30,964 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:02:30,964 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:31,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:31,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:31,550 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:02:31,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:02:31,614 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:31,808 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:31,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:31,816 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:31,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:02:31,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:31,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:02:31,835 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:31,836 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:31,836 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:02:31,847 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:31,850 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:31,852 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:31,855 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:31,858 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:31,861 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:31,864 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:31,866 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:31,869 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:31,872 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:31,875 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:31,887 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:31,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:02:31,893 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:02:31,893 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:02:31,902 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:31,903 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:02:31,920 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:31,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:02:31,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:31,939 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:31,945 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:02:31,954 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:02:31,954 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:31,954 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:31,954 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:31,955 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:31,956 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:31,956 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:02:31,956 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:31,956 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:02:31,956 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:31,958 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:02:31,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:02:31,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:31,959 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:02:31,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:31,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:31,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:31,960 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:02:31,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:02:31,960 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:02:31,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:02:31,960 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:02:31,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:02:31,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:02:31,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:02:31,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:02:31,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:02:31,967 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:02:31,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:02:31,967 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:31,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:02:31,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:31,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:31,970 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:31,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:02:31,971 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:02:31,971 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:02:31,971 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:02:31,982 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:02:31,982 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:31,984 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:31,985 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:31,987 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:31,987 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:31,987 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:31,988 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:32,004 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5564, Threshold=0.5983, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:02:32,005 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5564
2025-08-04 21:02:37,285 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:37,285 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:37,285 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:37,285 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:02:37,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:02:37,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:37,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:37,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:37,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:02:37,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:02:37,803 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:37,941 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:37,947 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:37,947 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:37,952 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:02:37,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:37,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:02:37,957 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:37,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:37,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:02:37,966 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:37,968 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:37,970 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:37,973 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:37,976 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:37,978 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:37,980 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:37,983 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:37,985 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:37,987 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:37,990 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:37,999 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:37,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:02:38,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:02:38,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:02:38,009 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:38,009 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:02:38,018 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:38,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:02:38,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:38,035 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:38,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:02:38,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:02:38,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:38,045 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:38,045 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:38,046 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:38,046 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:38,046 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:02:38,046 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:38,047 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:02:38,047 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:38,048 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:02:38,048 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:02:38,048 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:38,048 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:02:38,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:38,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:38,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:38,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:02:38,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:02:38,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:02:38,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:02:38,050 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:02:38,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:02:38,053 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:02:38,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:02:38,053 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:02:38,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:02:38,054 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:02:38,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:02:38,054 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:38,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:02:38,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:38,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:38,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:38,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:02:38,055 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:02:38,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:02:38,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:02:38,061 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:02:38,061 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:38,062 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:38,062 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:38,064 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 166/400.
2025-08-04 21:02:38,164 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:38,165 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:38,166 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2622 anomalous samples to GAN training data (target: 2622).
2025-08-04 21:02:38,168 - ClientAppLogger [Client 1] - INFO - [Client] Round 166: Training GAN with 11364 samples (8742 normal, 2622 anomalous).
2025-08-04 21:02:38,168 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:46,608 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7776
2025-08-04 21:02:46,608 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7776
2025-08-04 21:02:46,608 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:46,619 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5009, Threshold=0.5256, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:02:46,619 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:02:46,620 - ClientAppLogger [Client 1] - INFO - Fit completed for round 166. Duration: 8.56s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 166, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083566813626704, 'd_loss': 0.7776128005452745, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.556087017059326, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 6.265625, 'accumulated_train_samples_this_round': 11364}
2025-08-04 21:02:46,620 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:02:51,879 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:51,879 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:51,879 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:51,879 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:02:51,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:02:51,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:52,190 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:52,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:52,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:02:52,319 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:02:52,319 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:52,495 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:52,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:52,504 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:52,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:02:52,523 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:52,523 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:02:52,524 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:52,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:52,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:02:52,535 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:52,538 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:52,540 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:52,543 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:52,545 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:52,548 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:52,551 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:52,554 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:52,557 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:52,559 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:52,562 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:52,577 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:52,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:02:52,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:02:52,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:02:52,594 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:52,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:02:52,611 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:52,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:02:52,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:52,631 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:52,637 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:02:52,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:02:52,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:52,656 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:52,656 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:52,657 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:52,657 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:52,657 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:02:52,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:52,657 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:02:52,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:52,659 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:02:52,659 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:02:52,660 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:52,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:02:52,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:52,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:52,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:52,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:02:52,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:02:52,662 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:02:52,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:02:52,662 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:02:52,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:02:52,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:02:52,668 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:02:52,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:02:52,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:02:52,669 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:02:52,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:02:52,670 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:52,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:02:52,671 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:52,672 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:52,672 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:52,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:02:52,672 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:02:52,672 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:02:52,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:02:52,682 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:02:52,682 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:52,684 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:52,684 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:52,685 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:52,685 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:52,686 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:52,686 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:52,700 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5063, Threshold=0.5309, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:02:52,700 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5063
2025-08-04 21:02:57,971 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:57,971 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:57,972 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:57,972 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:02:57,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:02:57,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:58,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:58,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:58,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:02:58,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:02:58,438 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:58,586 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:58,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:58,592 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:58,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:02:58,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:58,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:02:58,607 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:58,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:58,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:02:58,616 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:58,619 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:58,621 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:58,623 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:58,626 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:58,629 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:58,632 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:58,634 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:58,637 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:58,639 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:58,642 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:58,653 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:58,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:02:58,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:02:58,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:02:58,664 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:58,664 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:02:58,676 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:58,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:02:58,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:58,692 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:58,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:02:58,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:02:58,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:58,705 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:58,705 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:58,705 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:58,706 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:58,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:02:58,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:58,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:02:58,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:58,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:02:58,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:02:58,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:02:58,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:02:58,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:02:58,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:02:58,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:02:58,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:02:58,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:02:58,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:02:58,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:02:58,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:02:58,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:02:58,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:58,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:02:58,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:58,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:58,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:58,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:02:58,716 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:02:58,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:02:58,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:02:58,722 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:02:58,722 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:58,724 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:58,724 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:58,726 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 167/400.
2025-08-04 21:02:58,827 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:58,828 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:58,837 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2637 anomalous samples to GAN training data (target: 2637).
2025-08-04 21:02:58,839 - ClientAppLogger [Client 1] - INFO - [Client] Round 167: Training GAN with 11430 samples (8793 normal, 2637 anomalous).
2025-08-04 21:02:58,839 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:07,323 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7785
2025-08-04 21:03:07,323 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7785
2025-08-04 21:03:07,323 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:07,336 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5613, Threshold=0.6021, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:03:07,336 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:03:07,337 - ClientAppLogger [Client 1] - INFO - Fit completed for round 167. Duration: 8.61s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 167, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834877606305966, 'd_loss': 0.7784631183266326, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.610496997833252, 'cpu_percent_fit': 12.48125, 'ram_mb_fit': 7.71484375, 'accumulated_train_samples_this_round': 11430}
2025-08-04 21:03:07,337 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:03:12,605 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:12,605 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:12,605 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:12,605 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:03:12,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:03:12,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:12,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:12,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:13,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:03:13,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:03:13,101 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:13,221 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:13,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:13,227 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:13,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:03:13,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:13,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:03:13,238 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:13,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:13,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:03:13,247 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:13,251 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:13,254 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:13,256 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:13,259 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:13,261 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:13,264 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:13,267 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:13,269 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:13,271 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:13,274 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:13,283 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:13,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:03:13,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:03:13,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:03:13,294 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:13,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:03:13,304 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:13,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:03:13,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:13,320 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:13,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:03:13,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:03:13,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:13,338 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:13,338 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:13,339 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:13,339 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:13,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:03:13,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:13,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:03:13,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:13,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:03:13,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:03:13,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:13,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:03:13,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:13,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:13,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:13,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:03:13,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:03:13,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:03:13,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:03:13,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:03:13,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:03:13,346 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:13,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:03:13,348 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:13,348 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:13,348 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:13,348 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:03:13,348 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:03:13,349 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:03:13,349 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:03:13,355 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:03:13,355 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:13,356 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:13,357 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:13,358 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:13,358 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:13,358 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:13,359 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:13,370 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5593, Threshold=0.5998, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:03:13,370 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5593
2025-08-04 21:03:18,652 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:18,652 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:18,652 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:18,653 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:03:18,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:03:18,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:19,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:19,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:19,125 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:03:19,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:03:19,163 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:19,287 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:19,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:19,293 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:19,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:03:19,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:19,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:03:19,304 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:19,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:19,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:03:19,312 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:19,316 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:19,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:19,320 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:19,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:19,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:19,327 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:19,330 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:19,333 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:19,334 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:19,337 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:19,346 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:19,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:03:19,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:03:19,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:03:19,355 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:19,356 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:03:19,363 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:19,364 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:03:19,364 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:19,379 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:19,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:03:19,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:03:19,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:19,388 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:19,389 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:19,389 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:19,389 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:19,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:03:19,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:19,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:03:19,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:19,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:03:19,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:03:19,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:19,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:03:19,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:19,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:19,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:19,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:03:19,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:03:19,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:03:19,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:03:19,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:03:19,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:03:19,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:19,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:03:19,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:19,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:19,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:19,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:03:19,399 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:03:19,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:03:19,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:03:19,403 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:03:19,403 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:19,404 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:19,404 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:19,406 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 168/400.
2025-08-04 21:03:19,515 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:19,515 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:19,530 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2653 anomalous samples to GAN training data (target: 2653).
2025-08-04 21:03:19,532 - ClientAppLogger [Client 1] - INFO - [Client] Round 168: Training GAN with 11498 samples (8845 normal, 2653 anomalous).
2025-08-04 21:03:19,532 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:27,933 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7786
2025-08-04 21:03:27,933 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7786
2025-08-04 21:03:27,934 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:27,948 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5457, Threshold=0.5807, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:03:27,948 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 21:03:27,948 - ClientAppLogger [Client 1] - INFO - Fit completed for round 168. Duration: 8.54s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 168, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834824771046705, 'd_loss': 0.7786321906436731, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 8.542701244354248, 'cpu_percent_fit': 12.475, 'ram_mb_fit': 15.35546875, 'accumulated_train_samples_this_round': 11498}
2025-08-04 21:03:27,949 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 21:03:33,289 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:33,290 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:33,290 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:33,290 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:03:33,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:03:33,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:33,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:33,829 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:03:33,981 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:03:33,981 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:34,103 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:34,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:34,109 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:34,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:03:34,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:34,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:03:34,121 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:34,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:34,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:03:34,129 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:34,133 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:34,135 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:34,138 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:34,140 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:34,143 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:34,145 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:34,148 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:34,151 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:34,153 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:34,155 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:34,164 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:34,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:03:34,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:03:34,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:03:34,173 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:34,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:03:34,183 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:34,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:03:34,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:34,200 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:34,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:03:34,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:03:34,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:34,212 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:34,212 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:34,212 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:34,213 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:34,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:03:34,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:34,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:03:34,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:34,215 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:03:34,215 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:03:34,215 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:34,215 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:03:34,216 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:03:34,217 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:03:34,217 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:03:34,218 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:03:34,218 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:03:34,219 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:03:34,219 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:03:34,219 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:03:34,219 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:03:34,219 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:34,219 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:03:34,220 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:34,220 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:34,220 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:34,220 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:03:34,221 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:03:34,221 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:03:34,221 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:03:34,225 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:03:34,225 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:34,226 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:34,226 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:34,228 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:34,228 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:34,228 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:34,229 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:34,240 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5442, Threshold=0.5790, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:03:34,240 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5442
2025-08-04 21:03:45,566 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:45,566 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:45,567 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:45,567 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:03:45,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:03:45,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:46,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:46,077 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:46,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:03:46,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:03:46,237 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:46,367 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:46,372 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:46,372 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:46,377 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:03:46,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:46,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:03:46,383 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:46,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:46,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:03:46,392 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:46,395 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,397 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:46,399 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:46,402 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:46,404 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:46,406 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,409 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:46,412 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:46,413 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:46,416 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:46,424 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:46,424 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:03:46,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:03:46,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:03:46,433 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:46,433 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:03:46,441 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:46,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:03:46,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:46,456 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:46,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:03:46,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:03:46,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:46,465 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:46,466 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:46,466 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:46,466 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:46,466 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:03:46,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:46,467 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:03:46,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:46,468 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:03:46,468 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:03:46,469 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:46,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:03:46,469 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:46,469 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:46,469 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:46,470 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:03:46,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:03:46,470 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:03:46,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:03:46,470 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:03:46,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:03:46,472 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:03:46,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:03:46,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:03:46,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:03:46,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:03:46,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:03:46,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:46,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:03:46,474 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:46,474 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:46,475 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:46,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:03:46,475 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:03:46,475 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:03:46,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:03:46,478 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:03:46,479 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:46,480 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:46,480 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:46,482 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:46,482 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:46,482 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:46,483 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:46,494 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4980, Threshold=0.5030, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:03:46,494 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4980
2025-08-04 21:03:57,772 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:57,772 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:57,772 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:57,772 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:03:57,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:03:57,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:58,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:58,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:58,218 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:03:58,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:03:58,258 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:58,412 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:58,421 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:58,421 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:58,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:03:58,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:58,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:03:58,437 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:58,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:58,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:03:58,447 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:58,450 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:58,453 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:58,455 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:58,458 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:58,460 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:58,463 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:58,466 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:58,468 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:58,470 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:58,473 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:58,484 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:58,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:03:58,490 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:03:58,490 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:03:58,495 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:58,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:03:58,506 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:58,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:03:58,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:58,524 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:58,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:03:58,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:03:58,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:58,537 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:58,537 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:58,537 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:58,538 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:58,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:03:58,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:58,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:03:58,539 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:58,540 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:03:58,540 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:03:58,541 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:58,541 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:03:58,541 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:58,541 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:58,541 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:58,541 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:03:58,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:03:58,542 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:03:58,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:03:58,542 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:03:58,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:03:58,546 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:03:58,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:03:58,547 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:03:58,547 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:03:58,547 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:03:58,547 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:03:58,547 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:58,548 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:03:58,548 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:58,548 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:58,549 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:58,549 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:03:58,549 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:03:58,549 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:03:58,550 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:03:58,555 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:03:58,555 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:58,557 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:58,557 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:58,558 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:58,559 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:58,559 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:58,560 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:58,572 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5665, Threshold=0.6220, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:03:58,572 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5665
2025-08-04 21:04:15,867 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:15,867 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:04:15,867 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:04:15,867 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 21:04:15,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 21:04:15,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:22,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:22,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:22,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 21:04:22,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 21:04:22,673 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:23,697 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:24,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:24,079 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:24,789 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 21:04:24,904 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:24,905 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 21:04:24,905 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:24,906 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:24,906 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 21:04:24,919 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:24,923 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:24,926 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:24,929 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:24,932 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:24,934 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:24,936 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:24,939 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:24,942 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:24,944 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:24,947 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:24,957 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:24,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 21:04:24,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 21:04:24,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 21:04:24,969 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:24,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 21:04:24,981 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:24,981 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 21:04:24,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:24,998 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 21:04:25,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 21:04:25,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,243 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,243 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,244 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,245 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,245 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 21:04:25,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,246 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 21:04:25,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,249 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 21:04:25,250 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,250 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,251 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,252 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,252 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,252 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,253 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 21:04:25,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 21:04:25,253 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 21:04:25,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 21:04:25,254 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 21:04:25,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 21:04:25,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 21:04:25,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 21:04:25,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 21:04:25,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 21:04:25,267 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 21:04:25,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 21:04:25,269 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 21:04:25,273 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,273 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,274 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 21:04:25,276 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 21:04:25,276 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 21:04:25,276 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 21:04:25,289 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 21:04:25,290 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,293 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,293 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:04:25,295 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,296 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,296 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,297 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,316 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5663, Threshold=0.6276, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 21:04:25,316 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5663
