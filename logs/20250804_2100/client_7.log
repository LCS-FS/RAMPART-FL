2025-08-04 21:00:16,176 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:16,176 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:00:16,176 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:00:16,176 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:00:16,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:00:16,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:16,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:16,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:16,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:00:16,749 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:00:16,749 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:16,917 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:16,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:16,927 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:16,935 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:00:16,942 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:16,942 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:00:16,943 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:16,943 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:16,943 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:00:16,953 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:16,956 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,958 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:16,961 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:16,964 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:16,967 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:16,970 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,972 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:16,975 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:16,977 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:16,980 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:16,990 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:16,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:00:16,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:00:16,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:00:17,001 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:17,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:00:17,010 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:17,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:00:17,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:17,027 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:17,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:00:17,040 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:00:17,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:17,042 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:17,042 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:17,043 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:17,043 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:17,043 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:00:17,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:17,044 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:00:17,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:17,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:00:17,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:00:17,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:17,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:00:17,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:17,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:17,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:17,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:00:17,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:00:17,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:00:17,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:00:17,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:00:17,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:00:17,048 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:00:17,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:00:17,048 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:00:17,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:00:17,049 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:00:17,049 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:00:17,049 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:17,049 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:00:17,049 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:17,050 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:17,053 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:17,053 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:00:17,053 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:00:17,054 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:00:17,054 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:00:17,060 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:00:17,063 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:17,064 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:17,065 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:00:17,066 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:17,066 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:17,066 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:17,067 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:17,102 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5360, Threshold=0.5884, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 21:00:17,102 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5360
2025-08-04 21:00:40,426 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:40,426 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:00:40,426 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:00:40,427 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:00:40,428 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:00:40,429 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:40,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:40,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:40,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:00:41,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:00:41,011 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:41,161 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:41,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:41,166 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:41,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:00:41,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:41,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:00:41,177 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:41,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:41,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:00:41,185 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:41,188 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:41,191 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:41,193 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:41,196 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:41,198 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:41,201 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:41,204 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:41,206 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:41,208 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:41,211 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:41,221 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:41,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:00:41,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:00:41,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:00:41,232 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:41,232 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:00:41,244 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:41,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:00:41,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:41,259 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:41,264 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:00:41,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:00:41,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:41,270 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:41,270 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:41,271 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:41,271 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:41,271 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:00:41,271 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:41,271 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:00:41,272 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:41,273 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:00:41,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:00:41,274 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:00:41,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:00:41,275 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:00:41,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:00:41,275 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:00:41,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:00:41,276 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:00:41,276 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:00:41,276 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:00:41,276 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:00:41,276 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:00:41,277 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:41,277 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:00:41,277 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:41,278 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:41,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:41,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:00:41,281 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:00:41,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:00:41,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:00:41,288 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:00:41,288 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:41,289 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:41,290 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:00:41,291 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:41,291 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:41,291 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:41,292 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:41,326 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5210, Threshold=0.5652, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 21:00:41,326 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5210
2025-08-04 21:01:01,649 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:01,649 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:01:01,650 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:01:01,650 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:01:01,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:01:01,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:02,095 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:02,095 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:02,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:01:02,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:01:02,224 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:02,346 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:02,353 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:02,353 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:02,359 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:01:02,365 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:02,365 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:01:02,365 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:02,365 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:02,365 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:01:02,375 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:02,378 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:02,380 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:02,382 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:02,385 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:02,387 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:02,390 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:02,392 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:02,395 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:02,397 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:02,400 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:02,409 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:02,409 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:01:02,414 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:01:02,414 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:01:02,419 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:02,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:01:02,428 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:02,428 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:01:02,428 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:02,443 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:02,448 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:01:02,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:01:02,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:02,454 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:02,454 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:02,454 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:02,454 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:02,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:01:02,455 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:02,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:01:02,455 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:02,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:01:02,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:01:02,457 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:02,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:01:02,457 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:02,457 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:02,457 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:02,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:01:02,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:01:02,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:01:02,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:01:02,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:01:02,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:01:02,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:01:02,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:01:02,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:01:02,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:01:02,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:01:02,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:01:02,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:02,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:01:02,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:02,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:02,460 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:02,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:01:02,461 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:01:02,461 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:01:02,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:01:02,467 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:01:02,467 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:02,468 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:02,469 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:01:02,470 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:02,470 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:02,470 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:02,471 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:02,506 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5393, Threshold=0.5876, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:01:02,506 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5393
2025-08-04 21:01:10,766 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:10,766 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:01:10,766 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:01:10,766 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:01:10,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:01:10,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:11,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:11,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:11,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:01:11,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:01:11,221 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:11,332 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:11,338 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:11,338 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:11,343 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:01:11,348 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:11,349 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:01:11,349 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:11,349 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:11,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:01:11,358 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:11,361 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:11,363 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:11,365 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:11,368 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:11,370 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:11,373 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:11,375 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:11,378 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:11,380 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:11,383 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:11,391 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:11,391 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:01:11,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:01:11,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:01:11,401 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:11,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:01:11,409 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:11,410 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:01:11,410 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:11,426 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:11,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:01:11,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:01:11,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:11,441 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:11,442 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:11,442 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:11,442 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:11,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:01:11,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:11,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:01:11,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:11,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:01:11,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:01:11,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:01:11,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:01:11,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:01:11,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:01:11,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:01:11,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:01:11,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:01:11,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:01:11,447 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:01:11,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:01:11,447 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:01:11,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:11,447 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:01:11,448 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:11,448 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:11,448 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:11,448 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:01:11,448 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:01:11,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:01:11,449 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:01:11,457 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:01:11,457 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:11,459 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:11,459 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:01:11,460 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 161/400.
2025-08-04 21:01:11,561 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:11,562 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:11,563 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 66 anomalous samples to GAN training data (target: 66).
2025-08-04 21:01:11,564 - ClientAppLogger [Client 7] - INFO - [Client] Round 161: Training GAN with 288 samples (222 normal, 66 anomalous).
2025-08-04 21:01:11,564 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:11,788 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7740
2025-08-04 21:01:11,788 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7740
2025-08-04 21:01:11,788 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:11,821 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5115, Threshold=0.5609, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 21:01:11,821 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8131
2025-08-04 21:01:11,822 - ClientAppLogger [Client 7] - INFO - Fit completed for round 161. Duration: 0.36s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 161, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083472837342156, 'd_loss': 0.7740240083800423, 'post_fit_local_f1': 0.8131083711875405, 'fit_time_seconds': 0.36151814460754395, 'cpu_percent_fit': 24.71875, 'ram_mb_fit': 8.3359375, 'accumulated_train_samples_this_round': 288}
2025-08-04 21:01:11,822 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 21:01:26,126 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:26,126 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:01:26,126 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:01:26,127 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:01:26,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:01:26,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:26,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:26,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:26,628 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:01:26,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:01:26,650 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:26,774 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:26,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:26,781 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:26,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:01:26,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:26,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:01:26,807 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:26,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:26,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:01:26,815 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:26,818 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:26,820 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:26,823 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:26,827 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:26,829 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:26,832 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:26,835 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:26,838 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:26,840 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:26,842 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:26,852 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:26,852 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:01:26,857 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:01:26,857 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:01:26,862 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:26,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:01:26,873 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:26,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:01:26,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:26,888 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:26,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:01:26,897 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:01:26,897 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:26,898 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:26,898 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:26,898 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:26,898 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:26,899 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:01:26,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:26,899 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:01:26,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:26,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:01:26,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:01:26,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:26,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:01:26,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:26,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:01:26,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:01:26,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:01:26,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:01:26,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:01:26,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:01:26,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:01:26,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:01:26,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:26,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:01:26,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:26,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:26,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:26,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:01:26,905 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:01:26,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:01:26,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:01:26,914 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:01:26,914 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:26,915 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:26,916 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:01:26,917 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:26,917 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:26,917 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:26,918 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:26,950 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5109, Threshold=0.5532, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:01:26,951 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5109
2025-08-04 21:01:38,251 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:38,251 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:01:38,251 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:01:38,251 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:01:38,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:01:38,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:38,640 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:38,641 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:38,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:01:38,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:01:38,773 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:38,912 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:38,918 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:38,918 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:38,924 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:01:38,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:38,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:01:38,931 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:38,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:38,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:01:38,941 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:38,944 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,946 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:38,949 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:38,951 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:38,954 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:38,956 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,959 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:38,962 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:38,964 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:38,967 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:38,976 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:38,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:01:38,982 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:01:38,982 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:01:38,987 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:38,987 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:01:38,997 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:38,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:01:38,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:39,012 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:39,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:01:39,022 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:01:39,022 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:39,022 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:39,022 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:39,023 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:39,023 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:39,023 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:01:39,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:39,024 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:01:39,024 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:39,025 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:01:39,025 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:01:39,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:01:39,027 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:01:39,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:01:39,027 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:01:39,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:01:39,027 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:01:39,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:01:39,028 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:39,029 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:39,029 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:39,029 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:01:39,029 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:01:39,029 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:01:39,030 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:01:39,035 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:01:39,036 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:39,037 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:39,037 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:01:39,039 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:39,039 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:39,039 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:39,040 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:39,074 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5612, Threshold=0.6360, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 21:01:39,075 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5612
2025-08-04 21:01:50,433 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:50,433 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:01:50,433 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:01:50,433 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:01:50,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:01:50,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:50,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:50,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:50,925 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:01:50,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:01:50,973 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:51,118 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:51,124 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:51,124 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:51,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:01:51,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:51,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:01:51,136 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:51,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:51,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:01:51,144 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:51,147 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:51,149 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:51,151 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:51,154 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:51,156 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:51,159 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:51,161 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:51,163 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:51,165 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:51,167 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:51,176 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:51,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:01:51,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:01:51,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:01:51,186 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:51,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:01:51,196 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:51,197 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:01:51,197 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:51,211 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:51,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:01:51,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:01:51,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:51,221 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:51,222 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:51,222 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:51,222 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:51,222 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:01:51,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:51,223 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:01:51,223 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:51,224 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:01:51,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:01:51,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:51,225 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:01:51,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:51,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:51,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:51,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:01:51,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:01:51,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:01:51,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:01:51,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:01:51,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:01:51,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:01:51,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:01:51,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:01:51,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:01:51,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:01:51,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:01:51,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:51,228 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:01:51,228 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:51,228 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:51,228 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:51,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:01:51,229 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:01:51,229 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:01:51,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:01:51,235 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:01:51,235 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:51,236 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:51,236 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:01:51,238 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:51,238 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:51,238 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:51,239 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:51,273 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4969, Threshold=0.5256, Accuracy=0.7341, F1=0.8144, Precision=0.9729, Recall=0.7003
2025-08-04 21:01:51,274 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7341, F1: 0.8144, Prec: 0.9729, Rec: 0.7003, Avg Anomaly Score: 0.4969
2025-08-04 21:02:11,604 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:11,604 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:02:11,604 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:02:11,604 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:02:11,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:02:11,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:11,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:11,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:11,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:02:12,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:02:12,009 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:12,120 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:12,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:12,126 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:12,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:02:12,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:12,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:02:12,137 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:12,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:12,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:02:12,145 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:12,148 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:12,151 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:12,153 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:12,156 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:12,158 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:12,161 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:12,163 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:12,165 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:12,167 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:12,170 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:12,178 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:12,178 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:02:12,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:02:12,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:02:12,187 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:12,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:02:12,196 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:12,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:02:12,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:12,212 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:12,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:02:12,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:02:12,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:12,222 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:12,223 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:12,223 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:12,223 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:12,223 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:02:12,223 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:12,224 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:02:12,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:12,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:02:12,225 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:02:12,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:02:12,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:02:12,227 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:12,228 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:02:12,228 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:12,228 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:12,228 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:12,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:02:12,229 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:02:12,229 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:02:12,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:02:12,233 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:02:12,233 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:12,235 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:12,235 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:02:12,236 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:12,236 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:12,236 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:12,237 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:12,272 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5376, Threshold=0.5892, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 21:02:12,272 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5376
2025-08-04 21:02:32,595 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:32,596 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:02:32,596 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:02:32,596 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:02:32,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:02:32,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:32,939 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:32,939 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:33,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:02:33,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:02:33,048 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:33,144 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:33,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:33,150 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:33,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:02:33,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:33,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:02:33,208 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:33,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:33,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:02:33,217 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:33,220 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:33,222 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:33,225 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:33,227 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:33,230 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:33,232 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:33,235 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:33,237 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:33,239 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:33,242 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:33,251 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:33,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:02:33,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:02:33,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:02:33,262 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:33,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:02:33,272 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:33,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:02:33,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:33,288 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:33,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:02:33,297 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:02:33,297 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:33,297 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:33,298 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:33,298 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:33,298 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:33,298 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:02:33,298 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:33,299 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:02:33,299 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:33,300 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:02:33,300 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:02:33,300 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:02:33,301 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:02:33,302 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:02:33,302 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:02:33,302 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:02:33,302 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:02:33,302 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:02:33,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:02:33,303 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:02:33,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:02:33,303 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:33,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:02:33,304 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:33,304 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:33,304 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:33,304 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:02:33,305 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:02:33,305 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:02:33,305 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:02:33,312 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:02:33,313 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:33,314 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:33,314 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:02:33,315 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:33,316 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:33,316 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:33,316 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:33,349 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5496, Threshold=0.6032, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:02:33,349 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5496
2025-08-04 21:02:53,718 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:53,718 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:02:53,719 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:02:53,719 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:02:53,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:02:53,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:54,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:54,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:54,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:02:54,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:02:54,224 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:54,342 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:54,349 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:54,350 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:54,356 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:02:54,388 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:54,389 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:02:54,389 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:54,389 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:54,390 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:02:54,398 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:54,401 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:54,403 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:54,406 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:54,409 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:54,411 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:54,414 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:54,416 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:54,419 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:54,420 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:54,423 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:54,432 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:54,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:02:54,436 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:02:54,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:02:54,442 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:54,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:02:54,453 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:54,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:02:54,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:54,468 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:54,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:02:54,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:02:54,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:54,478 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:54,478 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:54,478 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:54,478 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:54,478 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:02:54,478 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:54,479 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:02:54,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:54,480 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:02:54,480 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:02:54,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:54,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:02:54,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:54,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:54,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:54,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:02:54,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:02:54,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:02:54,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:02:54,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:02:54,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:02:54,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:54,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:02:54,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:54,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:54,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:54,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:02:54,485 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:02:54,485 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:02:54,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:02:54,493 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:02:54,493 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:54,494 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:54,494 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:02:54,496 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:54,496 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:54,496 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:54,497 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:54,529 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5006, Threshold=0.5345, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:02:54,529 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5006
2025-08-04 21:02:59,819 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:59,819 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:02:59,819 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:02:59,819 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:02:59,819 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:02:59,819 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:00,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:00,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:00,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:00,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:00,273 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:00,396 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:00,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:00,401 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:00,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:00,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:00,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:00,425 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:00,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:00,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:00,434 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:00,437 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:00,439 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:00,441 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:00,444 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:00,446 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:00,449 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:00,451 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:00,454 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:00,456 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:00,458 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:00,466 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:00,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:00,471 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:00,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:00,477 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:00,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:00,490 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:00,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:00,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:00,506 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:00,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:00,515 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:00,515 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:00,515 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:00,515 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:00,515 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:00,516 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:00,516 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:00,516 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:00,516 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:00,516 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:00,518 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:00,518 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:00,519 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:00,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:00,519 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:00,519 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:00,519 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:00,519 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:00,520 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:00,521 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:00,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:00,521 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:00,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:00,521 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:00,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:00,522 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:00,522 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:00,522 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:00,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:00,523 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:00,523 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:00,523 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:00,532 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:00,532 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:00,533 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:00,533 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:00,535 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 167/400.
2025-08-04 21:03:00,635 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:00,635 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:00,637 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 69 anomalous samples to GAN training data (target: 69).
2025-08-04 21:03:00,637 - ClientAppLogger [Client 7] - INFO - [Client] Round 167: Training GAN with 300 samples (231 normal, 69 anomalous).
2025-08-04 21:03:00,638 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:00,880 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.7751
2025-08-04 21:03:00,881 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.7751
2025-08-04 21:03:00,881 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:00,913 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4818, Threshold=0.4991, Accuracy=0.7341, F1=0.8144, Precision=0.9729, Recall=0.7003
2025-08-04 21:03:00,913 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8144
2025-08-04 21:03:00,914 - ClientAppLogger [Client 7] - INFO - Fit completed for round 167. Duration: 0.38s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 167, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0844820578893026, 'd_loss': 0.7750669569969177, 'post_fit_local_f1': 0.8144062297209604, 'fit_time_seconds': 0.37898969650268555, 'cpu_percent_fit': 24.9125, 'ram_mb_fit': 10.40234375, 'accumulated_train_samples_this_round': 300}
2025-08-04 21:03:00,914 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 21:03:15,323 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:15,323 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:03:15,324 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:03:15,324 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:03:15,324 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:03:15,324 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:15,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:15,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:15,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:15,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:15,917 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:16,030 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:16,036 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:16,036 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:16,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:16,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:16,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:16,048 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:16,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:16,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:16,058 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:16,061 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:16,063 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:16,066 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:16,068 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:16,070 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:16,073 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:16,076 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:16,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:16,080 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:16,083 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:16,092 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:16,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:16,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:16,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:16,102 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:16,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:16,110 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:16,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:16,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:16,126 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:16,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:16,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:16,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:16,142 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:16,142 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:16,142 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:16,142 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:16,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:16,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:16,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:16,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:16,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:16,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:16,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:16,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:16,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:16,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:16,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:16,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:16,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:16,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:16,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:16,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:16,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:16,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:16,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:16,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:16,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:16,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:16,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:16,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:16,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:16,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:16,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:16,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:16,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:16,149 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:16,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:16,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:16,157 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:16,157 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:16,158 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:16,158 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:16,160 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:16,160 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:16,160 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:16,161 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:16,195 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5524, Threshold=0.6027, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:03:16,195 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5524
2025-08-04 21:03:21,474 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:21,475 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:03:21,475 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:03:21,475 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:03:21,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:03:21,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:21,847 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:21,847 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:21,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:21,952 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:21,953 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:22,060 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:22,065 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:22,065 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:22,071 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:22,090 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:22,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:22,091 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:22,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:22,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:22,100 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:22,103 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:22,105 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:22,107 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:22,110 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:22,112 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:22,115 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:22,117 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:22,120 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:22,122 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:22,125 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:22,134 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:22,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:22,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:22,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:22,144 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:22,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:22,154 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:22,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:22,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:22,170 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:22,175 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:22,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:22,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:22,180 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:22,180 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:22,180 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:22,181 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:22,181 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:22,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:22,181 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:22,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:22,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:22,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:22,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:22,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:22,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:22,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:22,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:22,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:22,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:22,185 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:22,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:22,185 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:22,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:22,186 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:22,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:22,186 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:22,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:22,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:22,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:22,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:22,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:22,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:22,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:22,188 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:22,188 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:22,188 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:22,188 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:22,188 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:22,197 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:22,198 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:22,199 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:22,199 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:22,200 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 168/400.
2025-08-04 21:03:22,302 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:22,302 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:22,304 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 69 anomalous samples to GAN training data (target: 69).
2025-08-04 21:03:22,304 - ClientAppLogger [Client 7] - INFO - [Client] Round 168: Training GAN with 301 samples (232 normal, 69 anomalous).
2025-08-04 21:03:22,304 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:22,549 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0831, Avg D Loss: 0.7694
2025-08-04 21:03:22,550 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0831, Avg D Loss: 0.7694
2025-08-04 21:03:22,550 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:22,583 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4911, Threshold=0.5176, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:03:22,583 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8138
2025-08-04 21:03:22,584 - ClientAppLogger [Client 7] - INFO - Fit completed for round 168. Duration: 0.38s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 168, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083097763552618, 'd_loss': 0.7693807458956773, 'post_fit_local_f1': 0.8137573004542504, 'fit_time_seconds': 0.38314342498779297, 'cpu_percent_fit': 24.85, 'ram_mb_fit': 6.90234375, 'accumulated_train_samples_this_round': 301}
2025-08-04 21:03:22,584 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 21:03:30,855 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:30,855 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:03:30,855 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:03:30,856 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:03:30,856 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:03:30,856 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:31,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:31,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:31,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:31,296 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:31,296 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:31,432 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:31,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:31,438 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:31,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:31,449 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:31,449 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:31,449 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:31,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:31,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:31,458 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:31,461 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:31,463 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:31,465 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:31,468 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:31,470 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:31,473 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:31,475 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:31,478 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:31,480 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:31,482 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:31,492 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:31,493 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:31,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:31,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:31,502 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:31,502 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:31,510 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:31,511 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:31,511 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:31,526 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:31,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:31,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:31,536 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:31,536 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:31,536 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:31,537 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:31,537 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:31,537 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:31,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:31,537 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:31,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:31,539 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:31,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:31,539 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:31,540 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:31,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:31,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:31,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:31,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:31,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:31,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:31,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:31,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:31,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:31,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:31,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:31,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:31,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:31,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:31,543 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:31,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:31,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:31,549 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:31,549 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:31,550 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:31,550 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:31,551 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:31,552 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:31,552 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:31,552 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:31,585 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5375, Threshold=0.5824, Accuracy=0.7341, F1=0.8144, Precision=0.9729, Recall=0.7003
2025-08-04 21:03:31,585 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7341, F1: 0.8144, Prec: 0.9729, Rec: 0.7003, Avg Anomaly Score: 0.5375
2025-08-04 21:03:42,859 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:42,859 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:03:42,859 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:03:42,859 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:03:42,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:03:42,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:43,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:43,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:43,326 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:43,371 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:43,372 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:43,505 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:43,511 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:43,511 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:43,516 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:43,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:43,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:43,522 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:43,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:43,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:43,531 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:43,534 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:43,536 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:43,538 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:43,541 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:43,543 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:43,545 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:43,548 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:43,551 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:43,553 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:43,555 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:43,565 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:43,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:43,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:43,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:43,575 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:43,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:43,586 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:43,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:43,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:43,602 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:43,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:43,613 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:43,613 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:43,613 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:43,614 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:43,614 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:43,614 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:43,614 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:43,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:43,615 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:43,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:43,616 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:43,616 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:43,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:43,617 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:43,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:43,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:43,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:43,617 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:43,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:43,619 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:43,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:43,619 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:43,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:43,619 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:43,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:43,620 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:43,620 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:43,620 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:43,621 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:43,621 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:43,621 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:43,621 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:43,629 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:43,629 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:43,630 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:43,631 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:43,632 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:43,632 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:43,632 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:43,633 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:43,668 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4919, Threshold=0.5034, Accuracy=0.7350, F1=0.8151, Precision=0.9736, Recall=0.7009
2025-08-04 21:03:43,669 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7350, F1: 0.8151, Prec: 0.9736, Rec: 0.7009, Avg Anomaly Score: 0.4919
2025-08-04 21:03:51,927 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:51,927 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:03:51,927 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:03:51,927 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:03:51,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:03:51,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:52,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:52,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:52,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:52,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:52,352 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:52,467 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:52,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:52,472 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:52,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:52,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:52,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:52,483 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:52,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:52,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:52,491 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:52,494 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:52,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:52,498 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:52,501 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:52,503 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:52,505 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:52,508 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:52,511 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:52,512 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:52,515 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:52,523 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:52,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:52,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:52,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:52,533 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:52,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:52,541 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:52,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:52,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:52,556 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:52,561 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:52,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:52,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:52,565 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:52,566 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:52,566 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:52,566 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:52,566 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:52,567 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:52,567 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:52,567 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:52,568 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:52,568 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:52,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:52,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:52,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:52,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:52,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:52,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:52,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:52,570 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:52,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:52,570 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:52,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:52,570 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:52,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:52,571 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:52,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:52,571 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:52,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:52,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:52,572 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:52,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:52,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:52,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:52,573 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:52,573 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:52,573 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:52,573 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:52,578 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:52,578 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:52,580 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:52,580 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:52,581 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 170/400.
2025-08-04 21:03:52,682 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:52,682 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:52,686 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 70 anomalous samples to GAN training data (target: 70).
2025-08-04 21:03:52,687 - ClientAppLogger [Client 7] - INFO - [Client] Round 170: Training GAN with 305 samples (235 normal, 70 anomalous).
2025-08-04 21:03:52,687 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:52,930 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.7724
2025-08-04 21:03:52,931 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.7724
2025-08-04 21:03:52,931 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:52,965 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5250, Threshold=0.5721, Accuracy=0.7341, F1=0.8144, Precision=0.9729, Recall=0.7003
2025-08-04 21:03:52,966 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8144
2025-08-04 21:03:52,966 - ClientAppLogger [Client 7] - INFO - Fit completed for round 170. Duration: 0.38s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 170, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834176207370447, 'd_loss': 0.7724047297923291, 'post_fit_local_f1': 0.8144062297209604, 'fit_time_seconds': 0.3845353126525879, 'cpu_percent_fit': 24.44375, 'ram_mb_fit': 4.03125, 'accumulated_train_samples_this_round': 305}
2025-08-04 21:03:52,966 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 21:03:58,251 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:58,258 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:03:58,258 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:03:58,258 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:03:58,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:03:58,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:58,636 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:58,637 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:58,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:03:58,778 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:03:58,778 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:58,894 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:58,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:58,900 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:58,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:03:58,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:58,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:03:58,911 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:58,912 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:58,912 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:03:58,920 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:58,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:58,925 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:58,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:58,930 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:58,932 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:58,935 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:58,937 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:58,940 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:58,942 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:58,944 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:58,953 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:58,954 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:03:58,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:03:58,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:03:58,963 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:58,963 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:03:58,972 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:58,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:03:58,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:58,992 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:58,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:03:59,009 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:03:59,009 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:59,010 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:59,010 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:59,010 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:59,010 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:59,011 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:03:59,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:59,011 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:03:59,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:59,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:03:59,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:03:59,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:59,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:03:59,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:59,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:59,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:59,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:03:59,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:03:59,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:03:59,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:03:59,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:03:59,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:03:59,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:03:59,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:03:59,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:03:59,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:03:59,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:03:59,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:03:59,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:59,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:03:59,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:59,018 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:59,018 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:59,018 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:03:59,018 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:03:59,018 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:03:59,018 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:03:59,027 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:03:59,027 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:59,028 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:59,028 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:03:59,030 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:59,030 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:59,030 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:59,031 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:59,070 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5599, Threshold=0.6238, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 21:03:59,071 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5599
2025-08-04 21:04:07,350 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:07,350 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:04:07,350 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:04:07,350 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:04:07,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:04:07,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:07,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:07,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:07,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:04:07,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:04:07,832 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:07,950 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:07,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:07,957 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:07,963 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:04:07,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:07,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:04:07,984 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:07,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:07,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:04:07,993 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:07,996 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:07,999 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:08,001 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:08,003 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:08,005 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:08,008 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:08,011 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:08,013 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:08,015 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:08,018 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:08,027 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:08,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:04:08,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:04:08,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:04:08,038 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:08,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:04:08,050 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:08,051 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:04:08,051 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:08,067 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:08,072 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:04:08,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:04:08,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:08,077 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:08,077 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:08,078 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:08,078 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:08,078 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:04:08,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:08,079 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:04:08,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:08,080 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:04:08,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:04:08,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:08,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:04:08,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:08,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:08,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:08,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:04:08,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:04:08,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:04:08,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:04:08,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:04:08,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:04:08,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:04:08,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:04:08,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:04:08,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:04:08,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:04:08,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:04:08,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:08,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:04:08,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:08,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:08,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:08,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:04:08,086 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:04:08,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:04:08,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:04:08,095 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:04:08,095 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:08,096 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:08,097 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:04:08,098 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 171/400.
2025-08-04 21:04:08,199 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:08,200 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:08,201 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 70 anomalous samples to GAN training data (target: 70).
2025-08-04 21:04:08,202 - ClientAppLogger [Client 7] - INFO - [Client] Round 171: Training GAN with 305 samples (235 normal, 70 anomalous).
2025-08-04 21:04:08,202 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 21:04:08,453 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.7702
2025-08-04 21:04:08,454 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.7702
2025-08-04 21:04:08,454 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:04:08,488 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5110, Threshold=0.5569, Accuracy=0.7341, F1=0.8144, Precision=0.9729, Recall=0.7003
2025-08-04 21:04:08,488 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8144
2025-08-04 21:04:08,488 - ClientAppLogger [Client 7] - INFO - Fit completed for round 171. Duration: 0.39s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 171, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834366559200594, 'd_loss': 0.7701819706549411, 'post_fit_local_f1': 0.8144062297209604, 'fit_time_seconds': 0.390012264251709, 'cpu_percent_fit': 24.85, 'ram_mb_fit': 14.30078125, 'accumulated_train_samples_this_round': 305}
2025-08-04 21:04:08,489 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 21:04:22,534 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:22,535 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 21:04:22,537 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 21:04:22,537 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 21:04:22,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 21:04:22,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:25,480 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:25,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:25,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 21:04:25,639 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 21:04:25,639 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:25,796 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,803 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,809 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 21:04:25,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,818 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,818 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,819 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 21:04:25,829 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,833 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,835 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,838 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,842 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,844 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,847 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,849 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,852 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,854 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,856 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,868 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 21:04:25,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 21:04:25,880 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 21:04:25,893 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 21:04:25,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,913 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 21:04:25,926 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 21:04:25,926 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,926 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,926 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,927 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,927 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,927 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 21:04:25,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,928 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 21:04:25,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,929 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 21:04:25,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,930 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 21:04:25,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 21:04:25,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 21:04:25,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 21:04:25,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 21:04:25,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 21:04:25,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 21:04:25,934 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 21:04:25,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 21:04:25,934 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 21:04:25,935 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 21:04:25,935 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 21:04:25,935 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,935 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 21:04:25,936 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,936 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,936 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,937 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 21:04:25,937 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 21:04:25,937 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 21:04:25,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 21:04:25,942 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 21:04:25,943 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,944 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,945 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 21:04:25,946 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,946 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,946 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,947 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,985 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5599, Threshold=0.6317, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 21:04:25,985 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5599
